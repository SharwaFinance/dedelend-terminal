{"version":3,"sources":["img/icon-edit.svg","img sync /^/icon/-.*/.svg$","views/gmx-test/img/ddl/ic_eth_40.svg","views/options/img/ddl/ic_eth_40.svg","views/gmx-test/img/ddl sync /^/ic_.*_40/.svg$","views/options/img/ddl sync /^/ic_.*_40/.svg$","img/icon-wallet.svg","img/icon-link.svg","views/gmx-test/img/DROP_DOWN.svg","views/gmx-test/img/ddl/icon_dollar.svg","views/gmx-test/img/ddl/icon_dollar_active.svg","views/gmx-test/img/ddl/icon_market.svg","views/gmx-test/img/ddl/icon_market_active.svg","views/gmx-test/img/ddl/icon_trigger.svg","views/gmx-test/img/ddl/icon_trigger_active.svg","views/gmx-test/img/ddl/icon_withdraw.svg","views/gmx-test/img/ddl/icon_withdraw_active.svg","views/gmx-test/img/ddl/long.svg","views/gmx-test/img/ddl/long_active.svg","views/gmx-test/img/ddl/short.svg","views/gmx-test/img/ddl/short_active.svg","views/gmx-test/img/gmx-logo-with-name.svg","views/gmx-test/img/position-share-bg.png","views/gmx-test/img/swap.svg","img/icon-settings.svg","img/icon-BTC.svg","img/icon-ETH.svg","img/icon-btn-up.svg","img/icon-call-active.svg","img/icon-call.svg","img/icon-down-small.svg","img/icon-market.svg","img/icon-put-active.svg","img/icon-put.svg","views/options/img/DROP_DOWN.svg","views/options/img/ddl/icon_dollar.svg","views/options/img/ddl/icon_dollar_active.svg","views/options/img/ddl/icon_market.svg","views/options/img/ddl/icon_market_active.svg","views/options/img/ddl/icon_trigger.svg","views/options/img/ddl/icon_trigger_active.svg","views/options/img/ddl/icon_withdraw.svg","views/options/img/ddl/icon_withdraw_active.svg","views/options/img/gmx-logo-with-name.svg","views/options/img/position-share-bg.png","views/gmx-test/img/ddl/ic_btc_40.svg","views/gmx-test/img/ddl/ic_dai_40.svg","views/gmx-test/img/ddl/ic_frax_40.svg","views/gmx-test/img/ddl/ic_link_40.svg","views/gmx-test/img/ddl/ic_uni_40.svg","views/gmx-test/img/ddl/ic_usdc_40.svg","views/gmx-test/img/ddl/ic_usdt_40.svg","views/gmx-test/img/ddl/ic_weth_40.svg","views/gmx-test/img/ic_arbitrum_24.svg","views/gmx-test/img/ic_avalanche_24.svg","views/gmx-test/img/ic_avax_24.svg","views/gmx-test/img/ic_btc.b_24.svg","views/gmx-test/img/ic_btc_24.svg","views/gmx-test/img/ic_busd_24.svg","views/gmx-test/img/ic_dai_24.svg","views/gmx-test/img/ic_eth_24.svg","views/gmx-test/img/ic_frax_24.svg","views/gmx-test/img/ic_glp_24.svg","views/gmx-test/img/ic_gmx_24.svg","views/gmx-test/img/ic_link_24.svg","views/gmx-test/img/ic_mim_24.svg","views/gmx-test/img/ic_settings_24.svg","views/gmx-test/img/ic_tether_24.svg","views/gmx-test/img/ic_uni_24.svg","views/gmx-test/img/ic_usdc.e_24.svg","views/gmx-test/img/ic_usdc_24.svg","views/gmx-test/img/ic_usdt_24.svg","views/gmx-test/img/ic_wallet_24.svg","views/gmx-test/img/ic_wavax_24.svg","views/gmx-test/img/ic_weth_24.svg","img/icon-GMX.svg","img/icon-GNS.svg","img/icon-down-small-white.svg","views/options/img/coinbaseWallet.png","views/options/img/ddl/ic_btc_40.svg","views/options/img/ddl/ic_dai_40.svg","views/options/img/ddl/ic_frax_40.svg","views/options/img/ddl/ic_link_40.svg","views/options/img/ddl/ic_uni_40.svg","views/options/img/ddl/ic_usdc_40.svg","views/options/img/ddl/ic_usdt_40.svg","views/options/img/ddl/ic_weth_40.svg","views/options/img/ic_arbitrum_24.svg","views/options/img/ic_avalanche_24.svg","views/options/img/ic_avax_24.svg","views/options/img/ic_btc.b_24.svg","views/options/img/ic_btc_24.svg","views/options/img/ic_busd_24.svg","views/options/img/ic_dai_24.svg","views/options/img/ic_eth_24.svg","views/options/img/ic_frax_24.svg","views/options/img/ic_glp_24.svg","views/options/img/ic_gmx_24.svg","views/options/img/ic_link_24.svg","views/options/img/ic_mim_24.svg","views/options/img/ic_settings_24.svg","views/options/img/ic_tether_24.svg","views/options/img/ic_uni_24.svg","views/options/img/ic_usdc.e_24.svg","views/options/img/ic_usdc_24.svg","views/options/img/ic_usdt_24.svg","views/options/img/ic_wallet_24.svg","views/options/img/ic_wavax_24.svg","views/options/img/ic_weth_24.svg","views/options/img/metamask.png","views/options/img/walletconnect-circle-blue.svg","views/gmx-test/img sync /^/.*$","views/gmx-test/img/Anyswap.png","views/gmx-test/img/Anyswap.svg","views/gmx-test/img/Artwork.svg","views/gmx-test/img/Artwork_gmx.svg","views/gmx-test/img/Banxa.png","views/gmx-test/img/Hop.png","views/gmx-test/img/Hop.svg","views/gmx-test/img/Hop_dark.png","views/gmx-test/img/Hop_dark.svg","views/gmx-test/img/Synapse.png","views/gmx-test/img/Synapse.svg","views/gmx-test/img/binance.png","views/gmx-test/img/bscscan.png","views/gmx-test/img/btn_big_arbitrum.png","views/gmx-test/img/btn_big_avalanche.png","views/gmx-test/img/btn_big_bsc.png","views/gmx-test/img/btn_big_purchasegmx.png","views/gmx-test/img/btn_big_purchasegmx.svg","views/gmx-test/img/buy_gmx.svg","views/gmx-test/img/buy_gmx_bond.svg","views/gmx-test/img/buy_transfer_eth.svg","views/gmx-test/img/coinbaseWallet.png","views/gmx-test/img/coingecko.png","views/gmx-test/img/cross.svg","views/gmx-test/img/ddl/chevron-down.svg","views/gmx-test/img/ddl/chevron-down_sm.svg","views/gmx-test/img/ddl/ic_btc_40.png","views/gmx-test/img/ddl/ic_dai_40.png","views/gmx-test/img/ddl/ic_eth_40.png","views/gmx-test/img/ddl/ic_frax_40.png","views/gmx-test/img/ddl/ic_link_40.png","views/gmx-test/img/ddl/ic_uni_40.png","views/gmx-test/img/ddl/ic_usdc_40.png","views/gmx-test/img/ddl/ic_usdt_40.png","views/gmx-test/img/ddl/ic_weth_40.png","views/gmx-test/img/ddl/icon_arrow.svg","views/gmx-test/img/ddl/icon_check.svg","views/gmx-test/img/ddl/icon_close.svg","views/gmx-test/img/ddl/icon_close_sm.svg","views/gmx-test/img/ddl/icon_close_toast.svg","views/gmx-test/img/ddl/lock.svg","views/gmx-test/img/flag_en.svg","views/gmx-test/img/flag_es.svg","views/gmx-test/img/flag_fr.svg","views/gmx-test/img/flag_ja.svg","views/gmx-test/img/flag_ko.svg","views/gmx-test/img/flag_ru.svg","views/gmx-test/img/flag_zh.svg","views/gmx-test/img/glp_icon.svg","views/gmx-test/img/gmx-logo-final-white-small.png","views/gmx-test/img/gmx-logo-final-white.png","views/gmx-test/img/gmx-logo-final.png","views/gmx-test/img/gmx-logo-glow.png","views/gmx-test/img/gmx_logo.svg","views/gmx-test/img/graphite-01.png","views/gmx-test/img/ic-communityproject.svg","views/gmx-test/img/ic_arbitrum_16.svg","views/gmx-test/img/ic_arbitrum_96.svg","views/gmx-test/img/ic_arbitrum_hover_16.svg","views/gmx-test/img/ic_arrowleft16.svg","views/gmx-test/img/ic_arrowright16.svg","views/gmx-test/img/ic_avalanche_16.svg","views/gmx-test/img/ic_avalanche_96.svg","views/gmx-test/img/ic_avax_30.svg","views/gmx-test/img/ic_avax_40.svg","views/gmx-test/img/ic_banxa.svg","views/gmx-test/img/ic_binance_logo.svg","views/gmx-test/img/ic_bsc.svg","views/gmx-test/img/ic_bsc_96.svg","views/gmx-test/img/ic_btc.b_40.svg","views/gmx-test/img/ic_btc_40.svg","views/gmx-test/img/ic_buy_glp.svg","views/gmx-test/img/ic_cash.png","views/gmx-test/img/ic_cash.svg","views/gmx-test/img/ic_checked.svg","views/gmx-test/img/ic_coingecko_16.svg","views/gmx-test/img/ic_coingecko_hover_16.svg","views/gmx-test/img/ic_convert_down.svg","views/gmx-test/img/ic_copy_16.svg","views/gmx-test/img/ic_cost.svg","views/gmx-test/img/ic_dai_40.svg","views/gmx-test/img/ic_discord.svg","views/gmx-test/img/ic_eth_40.svg","views/gmx-test/img/ic_frax_40.svg","views/gmx-test/img/ic_github.svg","views/gmx-test/img/ic_glp_40.svg","views/gmx-test/img/ic_glp_custom.svg","views/gmx-test/img/ic_gmx.svg","views/gmx-test/img/ic_gmx_30.svg","views/gmx-test/img/ic_gmx_40.svg","views/gmx-test/img/ic_gmx_64.svg","views/gmx-test/img/ic_gmx_arbitrum.svg","views/gmx-test/img/ic_gmx_avax.svg","views/gmx-test/img/ic_gmx_big.svg","views/gmx-test/img/ic_gmx_custom.svg","views/gmx-test/img/ic_gmx_footer.svg","views/gmx-test/img/ic_hop.svg","views/gmx-test/img/ic_info.svg","views/gmx-test/img/ic_language24.svg","views/gmx-test/img/ic_link_40.svg","views/gmx-test/img/ic_liquidity.svg","views/gmx-test/img/ic_medium.svg","views/gmx-test/img/ic_menu_dots.svg","views/gmx-test/img/ic_metamask_16.svg","views/gmx-test/img/ic_metamask_hover_16.svg","views/gmx-test/img/ic_mim_40.svg","views/gmx-test/img/ic_multiswap.svg","views/gmx-test/img/ic_new_link_16.svg","views/gmx-test/img/ic_olympus.svg","views/gmx-test/img/ic_olympus_arbitrum.svg","views/gmx-test/img/ic_selector_dropdowns.svg","views/gmx-test/img/ic_settings_16.svg","views/gmx-test/img/ic_sign in_16.svg","views/gmx-test/img/ic_sign_out_16.svg","views/gmx-test/img/ic_simpleswaps.svg","views/gmx-test/img/ic_stats.svg","views/gmx-test/img/ic_stats_big.svg","views/gmx-test/img/ic_synapse.svg","views/gmx-test/img/ic_telegram.svg","views/gmx-test/img/ic_tokens.svg","views/gmx-test/img/ic_totaluser.svg","views/gmx-test/img/ic_trading.svg","views/gmx-test/img/ic_transfer_avax.svg","views/gmx-test/img/ic_twitter.svg","views/gmx-test/img/ic_uni_40.svg","views/gmx-test/img/ic_usdc.e_40.svg","views/gmx-test/img/ic_usdc_40.svg","views/gmx-test/img/ic_usdt_40.svg","views/gmx-test/img/ic_wavax_40.svg","views/gmx-test/img/ic_weth_40.svg","views/gmx-test/img/lg_arbitrum.svg","views/gmx-test/img/logo_GMX.svg","views/gmx-test/img/logo_GMX_small.svg","views/gmx-test/img/long.svg","views/gmx-test/img/metamask-text.svg","views/gmx-test/img/metamask.png","views/gmx-test/img/page-not-found.svg","views/gmx-test/img/short.svg","views/gmx-test/img/trading.jpg","views/gmx-test/img/wallet-connect-text.svg","views/gmx-test/img/walletconnect-circle-blue.svg","views/gmx-test/img/wave-01.png","views/gmx-test/img/wave-02.png","views/gmx-test/img sync /^/ic_.*_24/.svg$","img/icon-GNS_v2.svg","img/icon-Hegic.svg","img/icon-Lyra.svg","img/icon-Premia.svg","img/icon-WBTC.svg","img/icon-dollar.svg","img/icon-down.svg","img/icon-hint.svg","img/icon-repay.svg","img/icon-sort.svg","img/icon-usdc.svg","img/icon-user.svg","views/options/img sync /^/.*$","views/options/img/Anyswap.png","views/options/img/Anyswap.svg","views/options/img/Artwork.svg","views/options/img/Artwork_gmx.svg","views/options/img/Banxa.png","views/options/img/Hop.png","views/options/img/Hop.svg","views/options/img/Hop_dark.png","views/options/img/Hop_dark.svg","views/options/img/Synapse.png","views/options/img/Synapse.svg","views/options/img/binance.png","views/options/img/bscscan.png","views/options/img/btn_big_arbitrum.png","views/options/img/btn_big_avalanche.png","views/options/img/btn_big_bsc.png","views/options/img/btn_big_purchasegmx.png","views/options/img/btn_big_purchasegmx.svg","views/options/img/buy_gmx.svg","views/options/img/buy_gmx_bond.svg","views/options/img/buy_transfer_eth.svg","views/options/img/coingecko.png","views/options/img/cross.svg","views/options/img/ddl/chevron-down.svg","views/options/img/ddl/chevron-down_sm.svg","views/options/img/ddl/ic_btc_40.png","views/options/img/ddl/ic_dai_40.png","views/options/img/ddl/ic_eth_40.png","views/options/img/ddl/ic_frax_40.png","views/options/img/ddl/ic_link_40.png","views/options/img/ddl/ic_uni_40.png","views/options/img/ddl/ic_usdc_40.png","views/options/img/ddl/ic_usdt_40.png","views/options/img/ddl/ic_weth_40.png","views/options/img/ddl/icon_arrow.svg","views/options/img/ddl/icon_check.svg","views/options/img/ddl/icon_close.svg","views/options/img/ddl/icon_close_sm.svg","views/options/img/ddl/icon_close_toast.svg","views/options/img/ddl/lock.svg","views/options/img/ddl/long.svg","views/options/img/ddl/long_active.svg","views/options/img/ddl/short.svg","views/options/img/ddl/short_active.svg","views/options/img/flag_en.svg","views/options/img/flag_es.svg","views/options/img/flag_fr.svg","views/options/img/flag_ja.svg","views/options/img/flag_ko.svg","views/options/img/flag_ru.svg","views/options/img/flag_zh.svg","views/options/img/glp_icon.svg","views/options/img/gmx-logo-final-white-small.png","views/options/img/gmx-logo-final-white.png","views/options/img/gmx-logo-final.png","views/options/img/gmx-logo-glow.png","views/options/img/gmx_logo.svg","views/options/img/graphite-01.png","views/options/img/ic-communityproject.svg","views/options/img/ic_arbitrum_16.svg","views/options/img/ic_arbitrum_96.svg","views/options/img/ic_arbitrum_hover_16.svg","views/options/img/ic_arrowleft16.svg","views/options/img/ic_arrowright16.svg","views/options/img/ic_avalanche_16.svg","views/options/img/ic_avalanche_96.svg","views/options/img/ic_avax_30.svg","views/options/img/ic_avax_40.svg","views/options/img/ic_banxa.svg","views/options/img/ic_binance_logo.svg","views/options/img/ic_bsc.svg","views/options/img/ic_bsc_96.svg","views/options/img/ic_btc.b_40.svg","views/options/img/ic_btc_40.svg","views/options/img/ic_buy_glp.svg","views/options/img/ic_cash.png","views/options/img/ic_cash.svg","views/options/img/ic_checked.svg","views/options/img/ic_coingecko_16.svg","views/options/img/ic_coingecko_hover_16.svg","views/options/img/ic_convert_down.svg","views/options/img/ic_copy_16.svg","views/options/img/ic_cost.svg","views/options/img/ic_dai_40.svg","views/options/img/ic_discord.svg","views/options/img/ic_eth_40.svg","views/options/img/ic_frax_40.svg","views/options/img/ic_github.svg","views/options/img/ic_glp_40.svg","views/options/img/ic_glp_custom.svg","views/options/img/ic_gmx.svg","views/options/img/ic_gmx_30.svg","views/options/img/ic_gmx_40.svg","views/options/img/ic_gmx_64.svg","views/options/img/ic_gmx_arbitrum.svg","views/options/img/ic_gmx_avax.svg","views/options/img/ic_gmx_big.svg","views/options/img/ic_gmx_custom.svg","views/options/img/ic_gmx_footer.svg","views/options/img/ic_hop.svg","views/options/img/ic_info.svg","views/options/img/ic_language24.svg","views/options/img/ic_link_40.svg","views/options/img/ic_liquidity.svg","views/options/img/ic_medium.svg","views/options/img/ic_menu_dots.svg","views/options/img/ic_metamask_16.svg","views/options/img/ic_metamask_hover_16.svg","views/options/img/ic_mim_40.svg","views/options/img/ic_multiswap.svg","views/options/img/ic_new_link_16.svg","views/options/img/ic_olympus.svg","views/options/img/ic_olympus_arbitrum.svg","views/options/img/ic_selector_dropdowns.svg","views/options/img/ic_settings_16.svg","views/options/img/ic_sign in_16.svg","views/options/img/ic_sign_out_16.svg","views/options/img/ic_simpleswaps.svg","views/options/img/ic_stats.svg","views/options/img/ic_stats_big.svg","views/options/img/ic_synapse.svg","views/options/img/ic_telegram.svg","views/options/img/ic_tokens.svg","views/options/img/ic_totaluser.svg","views/options/img/ic_trading.svg","views/options/img/ic_transfer_avax.svg","views/options/img/ic_twitter.svg","views/options/img/ic_uni_40.svg","views/options/img/ic_usdc.e_40.svg","views/options/img/ic_usdc_40.svg","views/options/img/ic_usdt_40.svg","views/options/img/ic_wavax_40.svg","views/options/img/ic_weth_40.svg","views/options/img/lg_arbitrum.svg","views/options/img/logo_GMX.svg","views/options/img/logo_GMX_small.svg","views/options/img/long.svg","views/options/img/metamask-text.svg","views/options/img/page-not-found.svg","views/options/img/short.svg","views/options/img/swap.svg","views/options/img/trading.jpg","views/options/img/wallet-connect-text.svg","views/options/img/wave-01.png","views/options/img/wave-02.png","views/options/img sync /^/ic_.*_24/.svg$","components/UI/logo/Logo.jsx","components/UI/button/Button.jsx","components/Wallet.jsx","context/context.js","components/utils/wallet.js","components/utils/providers.js","components/utils/contracts.js","components/utils/sepThousands.js","components/utils/math.js","components/utils/stats.js","components/Tabs.jsx","Header.jsx","Footer.jsx","views/gmx-test/config/Addresses.js","views/gmx-test/config/Tokens.js","views/gmx-test/lib/legacy.js","views/gmx-test/config/chains.js","views/gmx-test/domain/common.js","views/gmx-test/lib/contracts/fetcher.ts","views/gmx-test/lib/helperToast.ts","views/gmx-test/components/ToastifyDebug/ToastifyDebug.tsx","views/gmx-test/lib/contracts/transactionErrors.ts","views/gmx-test/lib/contracts/constants.js","views/gmx-test/lib/contracts/utils.ts","views/gmx-test/lib/contracts/callContract.tsx","views/gmx-test/domain/prices.js","views/gmx-test/domain/legacy.js","views/gmx-test/config/ui.js","views/gmx-test/components/Tooltip/Tooltip.js","components/utils/notifications.js","views/gmx-test/components/Tab/Tab.js","views/gmx-test/lib/useLockBodyScroll.ts","views/gmx-test/components/Modal/Modal.js","views/gmx-test/components/Common/Portal.js","views/gmx-test/components/Tooltip/TooltipWithPortal.js","views/gmx-test/components/Exchange/TokenSelector.js","views/gmx-test/components/Exchange/ExchangeInfoRow.js","views/gmx-test/components/Checkbox/Checkbox.js","views/gmx-test/components/StatsTooltip/StatsTooltipRow.tsx","views/gmx-test/components/SlippageInput/SlippageInput.jsx","components/UI/input/NumberInput_v3.jsx","components/utils/utils.js","views/gmx-test/components/Exchange/ConfirmationBox.js","views/gmx-test/components/Referrals/referralsHelper.js","views/gmx-test/domain/referrals.js","views/gmx-test/components/Exchange/NoLiquidityErrorModal.tsx","components/UI/modal/Modal.jsx","components/utils/constants.js","components/UI/modal/ChooseMarketModal.jsx","views/gmx-test/lib/GNS_legacy.js","components/UI/modal/SLTPModal.jsx","components/UI/Selector/Selector.jsx","views/gmx-test/components/Exchange/SwapBox.js","views/gmx-test/components/Exchange/ChartTokenSelector.js","views/gmx-test/components/Exchange/ExchangeTVChart.js","views/gmx-test/components/Exchange/PositionSeller.js","views/gmx-test/components/Exchange/PositionEditor.js","views/gmx-test/components/Exchange/OrdersToa.js","views/gmx-test/components/Common/SpinningLoader.js","views/gmx-test/components/Exchange/PositionShare.js","views/gmx-test/lib/useLoadImage.js","views/gmx-test/components/Exchange/PositionsItem.jsx","views/gmx-test/components/Exchange/PositionsList.js","views/gmx-test/components/Exchange/OrderEditor.js","views/gmx-test/components/Exchange/OrderEditorGNS.jsx","views/gmx-test/components/Exchange/OrdersList.js","views/gmx-test/components/Exchange/TradeHistory.js","views/gmx-test/components/Exchange/ExchangeBanner.js","views/gmx-test/pages/Exchange/Exchange.js","views/gmx-test/config/events.js","views/gmx-test/components/EventToast/AnnouncementIcon.js","views/gmx-test/components/EventToast/EventToast.js","views/gmx-test/components/EventToast/useEventToast.js","views/gmx-test/components/EventToast/EventToastContainer.js","views/gmx-test/components/Common/SEO.js","views/gmx-test/components/ModalViews/RedirectModal.js","views/gmx-test/lib/i18n.js","views/gmx-test/App/App.js","views/gmx-test/lib/useRouteQuery.js","views/options/config/Addresses.js","views/options/config/Tokens.js","views/options/lib/legacyOptions.js","views/options/config/chains.js","views/options/domain/common.js","views/options/lib/contracts/fetcher.ts","views/options/lib/helperToast.ts","views/options/lib/contracts/transactionErrors.ts","views/options/lib/contracts/constants.js","views/options/domain/prices.js","views/options/domain/legacy.js","views/options/components/Tab/TabOptions.js","views/options/components/Exchange/SwapBoxOptions.js","views/options/components/Exchange/ChartTokenSelectorOptions.js","views/options/config/ui.js","views/options/components/Tooltip/Tooltip.js","views/options/components/Exchange/ExchangeTVChartOptions.js","views/options/components/Checkbox/Checkbox.js","views/options/lib/useLockBodyScroll.ts","views/options/components/Modal/Modal.js","views/options/components/Exchange/PositionSeller.js","views/options/components/Exchange/PositionEditor.js","views/options/domain/referrals.js","views/options/components/Exchange/PositionsListOptions.js","components/UI/loader/Loader.jsx","views/options/components/Exchange/OptionsItem.jsx","components/UI/Filter/Filter.jsx","views/options/components/Exchange/OptionsList.jsx","views/options/pages/Exchange/ExchangeOptions.js","views/options/config/events.js","views/options/components/EventToast/AnnouncementIcon.js","views/options/components/EventToast/EventToast.js","views/options/components/EventToast/useEventToast.js","views/options/components/EventToast/EventToastContainer.js","views/options/components/Common/SEO.js","views/options/components/ModalViews/RedirectModal.js","views/options/lib/i18n.js","views/options/App/App.js","views/options/lib/useRouteQuery.js","components/AppRouter.jsx","components/UI/warning/Warning.jsx","App.js","index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","Logo","className","href","Button","children","disabled","clickHandler","isMain","props","classes","cx","btnActive","childProps","toString","Wallet","addr","address","setAddress","useState","open","setOpen","closeWallet","document","removeEventListener","onClick","stopPropagation","addEventListener","src","icon_wallet","alt","slice","xmlns","width","height","viewBox","fill","clipPath","d","rel","target","icon_link","GlobalStatsContext","createContext","UserStatsContext","ARBITRUM","requestAccount","setWalletAddress","window","ethereum","networkVersion","Number","alert","request","method","params","chainId","ethers","utils","hexlify","location","reload","console","log","chainName","nativeCurrency","symbol","decimals","rpcUrls","blockExplorerUrls","accounts","on","connectWallet","netProvider","getDefaultProvider","mmProvider","providers","Web3Provider","undefined","signer","getSigner","DDL_POOL","Contract","_DDL_POOL","abi","USDC","connect","_USDC","HEGIC_STRATEGIES","HegicStrategy_CALL_100_BTC_1","HegicStrategy_CALL_100_ETH_1","HegicStrategy_CALL_110_BTC_1","HegicStrategy_CALL_110_ETH_1","HegicStrategy_CALL_120_BTC_1","HegicStrategy_CALL_120_ETH_1","HegicStrategy_CALL_130_BTC_1","HegicStrategy_CALL_130_ETH_1","HegicStrategy_PUT_100_BTC_1","HegicStrategy_PUT_100_ETH_1","HegicStrategy_PUT_70_BTC_1","HegicStrategy_PUT_70_ETH_1","HegicStrategy_PUT_80_BTC_1","HegicStrategy_PUT_80_ETH_1","HegicStrategy_PUT_90_BTC_1","HegicStrategy_PUT_90_ETH_1","HegicStrategy_CALL_100_BTC_2","HegicStrategy_CALL_100_ETH_2","HegicStrategy_CALL_110_BTC_2","HegicStrategy_CALL_110_ETH_2","HegicStrategy_CALL_120_BTC_2","HegicStrategy_CALL_120_ETH_2","HegicStrategy_CALL_130_BTC_2","HegicStrategy_CALL_130_ETH_2","HegicStrategy_PUT_100_BTC_2","HegicStrategy_PUT_100_ETH_2","HegicStrategy_PUT_70_BTC_2","HegicStrategy_PUT_70_ETH_2","HegicStrategy_PUT_80_BTC_2","HegicStrategy_PUT_80_ETH_2","HegicStrategy_PUT_90_BTC_2","HegicStrategy_PUT_90_ETH_2","HegicStrategy_CALL_100_BTC_3","HegicStrategy_CALL_100_ETH_3","HegicStrategy_CALL_110_BTC_3","HegicStrategy_CALL_110_ETH_3","HegicStrategy_CALL_120_BTC_3","HegicStrategy_CALL_120_ETH_3","HegicStrategy_CALL_130_BTC_3","HegicStrategy_CALL_130_ETH_3","HegicStrategy_PUT_100_BTC_3","HegicStrategy_PUT_100_ETH_3","HegicStrategy_PUT_70_BTC_3","HegicStrategy_PUT_70_ETH_3","HegicStrategy_PUT_80_BTC_3","HegicStrategy_PUT_80_ETH_3","HegicStrategy_PUT_90_BTC_3","HegicStrategy_PUT_90_ETH_3","HegicStrategy_CALL_100_BTC_4","HegicStrategy_CALL_100_ETH_4","HegicStrategy_CALL_110_BTC_4","HegicStrategy_CALL_110_ETH_4","HegicStrategy_CALL_120_BTC_4","HegicStrategy_CALL_120_ETH_4","HegicStrategy_CALL_130_BTC_4","HegicStrategy_CALL_130_ETH_4","HegicStrategy_PUT_100_BTC_4","HegicStrategy_PUT_100_ETH_4","HegicStrategy_PUT_70_BTC_4","HegicStrategy_PUT_70_ETH_4","HegicStrategy_PUT_80_BTC_4","HegicStrategy_PUT_80_ETH_4","HegicStrategy_PUT_90_BTC_4","HegicStrategy_PUT_90_ETH_4","PRICE_CALCULATORS","PriceCalculator_PUT_100_BTC","PriceCalculator_PUT_100_ETH","PriceCalculator_PUT_70_BTC","PriceCalculator_PUT_70_ETH","PriceCalculator_PUT_80_BTC","PriceCalculator_PUT_80_ETH","PriceCalculator_PUT_90_BTC","PriceCalculator_PUT_90_ETH","PriceCalculator_CALL_100_BTC","PriceCalculator_CALL_100_ETH","PriceCalculator_CALL_110_BTC","PriceCalculator_CALL_110_ETH","PriceCalculator_CALL_120_BTC","PriceCalculator_CALL_120_ETH","PriceCalculator_CALL_130_BTC","PriceCalculator_CALL_130_ETH","HEGIC_BUY_URLS","PUT_100_BTC","PUT_100_ETH","PUT_70_BTC","PUT_70_ETH","PUT_80_BTC","PUT_80_ETH","PUT_90_BTC","PUT_90_ETH","CALL_100_BTC","CALL_100_ETH","CALL_110_BTC","CALL_110_ETH","CALL_120_BTC","CALL_120_ETH","CALL_130_BTC","CALL_130_ETH","CHAI_CONTRACT_ETH","CHAI_CONTRACT_BTC","PremiaPools","ETH","BTC","separateThousands","num","symb","str","split","intPart","fractionPart","hasFraction","replace","length","convertInputNum","result","match","substr","removeNonNumeric","sepToNumber","join","floor","fraction","Math","formatForContract","val","getGlobalStats","globalStats","getTotalBalance","totalBalance","toNumber","totalLocked","totalSupplied","round","formatUnits","availToBorrow","totalBorrowed","utilRate","borrowAPY","getUserStats","walletAddress","balanceOf","balance","shareOf","curBalance","avail","min","userStats","Tabs","links","cls","link","isHidden","linkCls","isActive","isExternal","to","name","Header","setGlobalStats","useContext","setUserStats","useEffect","then","stats","loc","useLocation","headerLinks","find","pathname","Footer","rx","fillRule","clipRule","CONTRACTS","Treasury","BUSD","GMT","Vault","Router","Reader","AmmFactory","AmmFactoryV2","OrderBook","OrderBookReader","GmxMigrator","USDG","NATIVE_TOKEN","XGMT","GMT_USDG_PAIR","XGMT_USDG_PAIR","GMT_USDG_FARM","XGMT_USDG_FARM","USDG_YIELD_TRACKER","XGMT_YIELD_TRACKER","GMT_USDG_FARM_TRACKER_XGMT","GMT_USDG_FARM_TRACKER_NATIVE","XGMT_USDG_FARM_TRACKER_XGMT","XGMT_USDG_FARM_TRACKER_NATIVE","AUTO","AUTO_USDG_PAIR","AUTO_USDG_FARM","AUTO_USDG_FARM_TRACKER_XGMT","AUTO_USDG_FARM_TRACKER_NATIVE","GMT_GMX_IOU","XGMT_GMX_IOU","GMT_USDG_GMX_IOU","XGMT_USDG_GMX_IOU","VaultReader","GlpManager","RewardRouter","RewardReader","GLP","GMX","ES_GMX","BN_GMX","ES_GMX_IOU","StakedGmxTracker","BonusGmxTracker","FeeGmxTracker","StakedGlpTracker","FeeGlpTracker","StakedGmxDistributor","StakedGlpDistributor","GmxVester","GlpVester","PositionRouter","PositionManager","ReferralStorage","ReferralReader","GlpRewardRouter","OrderExecutor","UniswapGmxEthPool","Multicall","TraderJoeGmxAvaxPool","getContract","market","TOKENS","coingeckoUrl","imageUrl","constants","AddressZero","isNative","isWrapped","baseSymbol","isUsdg","isStable","isShortable","isTempHidden","ADDITIONAL_TOKENS","CHAIN_IDS","TOKENS_MAP","TOKENS_BY_SYMBOL_MAP","j","tokens","concat","i","token","WRAPPED_TOKENS_MAP","NATIVE_TOKENS_MAP","getWrappedToken","getNativeToken","getTokens","isValidToken","getToken","getTokenBySymbol","getWhitelistedTokens","filter","MAINNET","createRandom","AVALANCHE","ARBITRUM_TESTNET","DEFAULT_CHAIN_ID","SELECTED_NETWORK_LOCAL_STORAGE_KEY","IS_NETWORK_DISABLED","CHAIN_NAMES_MAP","alchemyWhitelistedDomains","ARBITRUM_RPC_PROVIDERS","AVALANCHE_RPC_PROVIDERS","WALLET_CONNECT_LOCALSTORAGE_KEY","SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY","CURRENT_PROVIDER_LOCALSTORAGE_KEY","LANGUAGE_LOCALSTORAGE_KEY","getChainName","USDG_ADDRESS","BASIS_POINTS_DIVISOR","MAX_LEVERAGE","MAX_ALLOWED_LEVERAGE","USDG_DECIMALS","USD_DECIMALS","DUST_BNB","DUST_USD","expandDecimals","PRECISION","DEFAULT_MAX_USDG_AMOUNT","TAX_BASIS_POINTS","MARGIN_FEE_BASIS_POINTS","LIQUIDATION_FEE","THRESHOLD_REDEMPTION_VALUE","FUNDING_RATE_PRECISION","SWAP","INCREASE","DECREASE","LONG","SHORT","MARKET","LIMIT","STOP","LEVERAGE_ORDER_OPTIONS","SWAP_ORDER_OPTIONS","SWAP_OPTIONS","SLIPPAGE_BPS_KEY","REFERRAL_CODE_KEY","REFERRAL_CODE_QUERY_PARAM","TRIGGER_PREFIX_ABOVE","TRIGGER_PREFIX_BELOW","HIGH_EXECUTION_FEES_MAP","coingecko","arbitrum","LINK","UNI","USDT","DAI","MIM","FRAX","avalanche","AVAX","supportedChainIds","isDevelopment","push","injectedConnector","InjectedConnector","getWalletConnectConnector","localStorage","getItem","WalletConnectConnector","rpc","qrcode","deserialize","data","entries","key","value","_type","bigNumberify","isHomeSite","process","REACT_APP_IS_HOME_SITE","helperToast","content","opts","toast","dismiss","success","error","useLocalStorageByChainId","defaultValue","useLocalStorage","internalValue","setInternalValue","setValue","useCallback","useLocalStorageSerializeKey","JSON","stringify","getLiquidationPriceFromDelta","liquidationAmount","size","collateral","averagePrice","isLong","eq","gt","priceDelta","sub","mul","div","add","replaceNativeTokenAddress","path","nativeTokenAddress","updatedPath","getMarginFee","sizeDelta","afterFeeUsd","getServerBaseUrl","hostname","includes","fromLocalStorage","getServerUrl","isTriggerRatioInverted","fromTokenInfo","toTokenInfo","maxPrice","lt","getExchangeRate","tokenAInfo","tokenBInfo","inverted","minPrice","getMostAbundantStableToken","infoTokens","availableAmount","whitelistedTokens","stableToken","t","info","getTokenInfo","adjustedAvailableAmount","adjustForDecimals","shouldInvertTriggerRatio","tokenA","tokenB","getExchangeRateDisplay","rate","rateValue","formatAmount","omitSymbols","adjustForDecimalsFactory","n","number","amount","divDecimals","mulDecimals","getFeeBasisPoints","usdgDelta","feeBasisPoints","taxBasisPoints","increment","usdgSupply","totalTokenWeights","usdgAmount","initialAmount","nextAmount","targetAmount","weight","getTargetUsdgAmount","initialDiff","nextDiff","rebateBps","averageDiff","taxBps","getNextFromAmount","toAmount","fromTokenAddress","toTokenAddress","toTokenPriceUsd","ratio","forSwap","fromTokenMinPrice","toTokenMaxPrice","fromToken","toToken","contractMinPrice","contractMaxPrice","fromAmountBasedOnRatio","adjustDecimals","isZero","fromAmount","swapFeeBasisPoints","feeBasisPoints0","feeBasisPoints1","getNextToAmount","toAmountBasedOnRatio","getSwapFeeBasisPoints","redemptionAmount","expectedAmount","getProfitPrice","closePrice","position","profitPrice","calculatePositionDelta","price","lastIncreasedTime","delta","pendingDelta","minProfitExpired","Date","now","hasProfit","lte","deltaPercentage","pendingDeltaPercentage","getDeltaStr","deltaStr","deltaPercentageStr","getLeverage","increaseSize","collateralDelta","increaseCollateral","entryFundingRate","cumulativeFundingRate","includeDelta","nextSize","gte","remainingCollateral","fundingFee","getLiquidationPrice","adjustedDelta","positionFee","liquidationPriceForFees","liquidationPriceForMaxLeverage","getUsd","tokenAddress","max","orderOption","triggerPriceUsd","getTriggerPrice","getPositionKey","account","collateralTokenAddress","indexTokenAddress","getPositionContractKey","collateralToken","indexToken","solidityKeccak256","BSC_RPC_PROVIDERS","RPC_PROVIDERS","FALLBACK_PROVIDERS","host","formatDateTime","time","formatDateFn","activateInjectedProvider","providerName","isCoinbaseWallet","isMetaMask","provider","setSelectedProvider","getInjectedConnector","useChainId","useWeb3React","chainIdFromLocalStorage","parseInt","removeItem","clearWalletConnectData","clearWalletLinkData","x","startsWith","getProvider","library","_","sample","StaticJsonRpcProvider","getFallbackProvider","BigNumber","from","pow","limitDecimals","maxDecimals","amountStr","dotIndex","indexOf","_parseOrdersData","ordersData","indexes","extractor","uintPropsLength","addressPropsLength","uintProps","addressProps","count","orders","sliced","order","index","parseDecreaseOrdersData","decreaseOrdersData","triggerPrice","triggerAboveThreshold","type","parseIncreaseOrdersData","increaseOrdersData","purchaseToken","purchaseTokenAmount","parseSwapOrdersData","swapOrdersData","shouldUnwrap","amountIn","minOut","triggerRatio","every","tokenDecimals","displayDecimals","useCommas","minDecimals","padEnd","padDecimals","numberWithCommas","formatAmountFree","parseFloat","trimZeroDecimals","parseValue","pValue","isNaN","parseUnits","parts","getExplorerUrl","usePrevious","ref","useRef","current","approveTokens","setIsApproving","spender","onApproveSubmitted","pendingTxns","setPendingTxns","includeMessage","Token","approve","MaxUint256","res","txUrl","hash","pendingTxn","message","catch","failMsg","finally","shouldRaiseGasError","replaceNative","NETWORK_METADATA","addNetwork","metadata","switchNetwork","active","setItem","chainIdHex","setTokenUsingIndexPrices","indexPrices","indexPrice","indexPriceBn","spreadBps","MAX_PRICE_DEVIATION_BASIS_POINTS","minPrimaryPrice","halfSpreadBps","getInfoTokens","tokenBalances","vaultTokenInfo","fundingRateInfo","vaultPropsLength","parse","poolAmount","reservedAmount","bufferAmount","maxUsdgAmount","globalShortSize","maxGlobalShortSize","maxGlobalLongSize","guaranteedUsd","maxPrimaryPrice","maxAvailableShort","hasMaxAvailableShort","availableUsd","maxAvailableLong","hasMaxAvailableLong","remainingLongSize","maxLongCapacity","managedUsd","managedAmount","fundingRate","CHART_PERIODS","sleep","ms","Promise","isAddressZero","isLocal","getPositionForOrder","positionsMap","getOrderError","positionForOrder","parseEther","nativeTokenSymbol","defaultCollateralSymbol","defaultFlagOrdersEnabled","positionReaderPropsLength","v2","SWAP_ORDER_EXECUTION_GAS_FEE","INCREASE_ORDER_EXECUTION_GAS_FEE","DECREASE_ORDER_EXECUTION_GAS_FEE","wrappedTokenSymbol","getConstant","chainlinkClient","createClient","arbitrumGraphClient","avalancheGraphClient","arbitrumReferralsGraphClient","avalancheReferralsGraphClient","uri","ApolloClient","cache","InMemoryCache","fetcher","contractInfo","additionalArgs","args","arg0","arg1","isAddress","contractCall","getContractCall","shouldCallFallback","handleFallback","reject","fallbackProvider","contractName","setTimeout","contract","ToastifyDebug","old","NOT_ENOUGH_FUNDS","USER_DENIED","SLIPPAGE","RPC_ERROR","TX_ERROR_PATTERNS","msg","extractError","ex","patterns","pattern","matchCode","matchMessage","GAS_PRICE_ADJUSTMENT_MAP","MAX_GAS_PRICE_MAP","setGasPrice","txnOpts","maxGasPrice","premium","getGasPrice","gasPrice","getFeeData","feeData","maxPriorityFeePerGas","maxFeePerGas","getGasLimit","estimateGas","gasLimit","callContract","Array","isArray","sentMsg","hideSuccessMsg","successMsg","autoCloseToast","errorData","originalError","autoClose","FEED_ID_MAP","BTC_USD","ETH_USD","BNB_USD","LINK_USD","UNI_USD","SUSHI_USD","AVAX_USD","AAVE_USD","YFI_USD","SPELL_USD","timezoneOffset","getTimezoneOffset","getChartPricesFromStats","period","timeDiff","url","done","fetch","lastEx","ok","status","statusText","json","prices","OBSOLETE_THRESHOLD","updatedAt","toISOString","close","c","high","h","low","l","getChainlinkChartPricesFromGraph","tokenSymbol","marketName","feedId","requests","query","gql","all","chunks","uniqTs","Set","forEach","chunk","rounds","item","has","unixTimestamp","sort","periodTime","candles","first","prevTsGroup","prevPrice","ts","tsGroup","getCandlesFromPrices","err","useChartPrices","currentAveragePrice","swrKey","useSWR","warn","dedupingInterval","focusThrottleInterval","updatePrices","mutate","currentAveragePriceString","retPrices","useMemo","periodSeconds","priceData","getStablePriceData","_prices","currentCandleTime","last","averagePriceValue","newCandle","appendCurrentAveragePrice","newPrices","prevTime","fillGaps","getGmxGraphClient","invariant","condition","errorMsg","useMinExecutionFee","multiplier","positionRouterAddress","minExecutionFee","finalExecutionFee","estimatedExecutionFee","finalExecutionFeeUSD","isFeeHigh","getHighExecutionFee","minExecutionFeeUSD","minExecutionFeeErrorMessage","useHasOutdatedUi","text","hasOutdatedUi","approvePlugin","pluginAddress","routerAddress","createSwapOrder","executionFee","shouldWrap","orderBookAddress","fromETH","createDecreaseOrder","cancelSwapOrder","cancelDecreaseOrder","cancelIncreaseOrder","handleCancelOrder","func","cancelMultipleOrders","getIndexes","ordersWithTypes","allIndexes","groupBy","v","updateDecreaseOrder","updateIncreaseOrder","updateSwapOrder","IS_TOUCH","Tooltip","enabled","visible","setVisible","intervalCloseRef","intervalOpenRef","trigger","onMouseEnter","clearInterval","onMouseClick","onMouseLeave","style","disableHandleStyle","handleClassName","handle","renderContent","notifySuccess","errAlert","setIsLoading","reason","Tab","options","option","setOption","onChange","optionLabels","icons","disabledTooltip","opt","disabledNode","label","disabledList","el","TOUCH_MOVE_CONTAINER_CLASS_NAME","allowTouchMoveFn","body","parentElement","Modal","isVisible","setIsVisible","zIndex","onAfterOpen","allowContentTouchMove","disableBodyScrollLock","isNifty","modalRef","closeModal","disableLock","disableBodyScroll","allowTouchMove","enableBodyScroll","clearAllBodyScrollLocks","useLockBodyScroll","keyCode","AnimatePresence","motion","initial","animate","exit","variants","hidden","opacity","visibility","transition","duration","overflow","fontSize","transformStyle","transformOrigin","transform","Portal","root","createElement","appendChild","removeChild","createPortal","TooltipWithPortal","coords","setCoords","tooltipWidth","setTooltipWidth","handlerRef","updateTooltipCoords","rect","getBoundingClientRect","left","top","y","scrollY","fitHandleWidth","closeOnDoubleClick","TokenSelector","isModalVisible","setIsModalVisible","searchKeyword","setSearchKeyword","tokenInfo","mintingCap","showMintingCap","selectedTokenLabel","showBalances","showTokenImgInDropdown","showSymbolImage","showNewCaret","getTokenState","visibleTokens","onSelectToken","tokenImage","require","toLowerCase","filteredTokens","tokenIndex","tokenPopupImage","mintAmount","tokenState","portalClassName","default","stroke","strokeWidth","strokeLinecap","strokeLinejoin","dropDownIcon","ExchangeInfoRow","isTop","isWarning","Checkbox","isChecked","setIsChecked","selected","StatsTooltipRow","showDollar","SlippageInput","placeholder","onFocus","classList","onBlur","remove","NumberInput_v3","title","displayValueTitle","displayValue","hasError","hasFocus","setHasFocus","msToTimeLeft","hours","days","fromBigNumber","HIGH_SPREAD_THRESHOLD","ConfirmationBox","isSwap","isMarketOrder","isShort","isHigherSlippageAllowed","setIsHigherSlippageAllowed","onConfirmationClick","setIsConfirming","shortCollateralAddress","hasExistingPosition","leverage","existingPosition","existingLiquidationPrice","displayLiquidationPrice","shortCollateralToken","isPendingConfirmation","fees","feesUsd","isSubmitting","fromUsdMin","toUsdMax","nextAveragePrice","feeBps","savedSlippageAmount","userSlippage","setUserSlippage","allowedSlippage","TPValue","setTPValue","SLValue","setSLValue","TPHasError","setTPHasError","SLHasError","setSLHasError","liquidity","fromTokenUsd","toTokenUsd","isProfitWarningAccepted","setIsProfitWarningAccepted","isTriggerWarningAccepted","setIsTriggerWarningAccepted","isLimitOrdersVisible","setIsLimitOrdersVisible","onCancelOrderClick","collateralAfterFees","existingOrder","wrappedToken","sameToken","existingOrders","existingTriggerOrders","decreaseOrdersThatWillBeExecuted","markPrice","takeProfit","toFixed","stopLoss","getError","borderTakeProfit","isTP","percentage","openPriceNum","getSlTpFromPercentage","hasPendingProfit","spread","fromSpread","toSpread","isHigh","getSpread","showSpread","renderSpreadWarning","renderFeeWarning","MIN_PROFIT_TIME","renderMinProfitWarning","renderExistingOrderWarning","sizeInToken","p","triggerPricePrefix","renderExistingTriggerErrors","existingTriggerOrderLength","orderText","renderExistingTriggerWarning","renderMain","renderExecutionFee","renderAvailableLiquidity","availableLiquidity","formattedValue","isLiquidityRisk","riskThresholdBps","poolWithoutBuffer","adjustedMaxGlobalShortSize","sizeTokens","renderMarginSection","renderSwapSection","action","getPrimaryText","REGEX_VERIFY_BYTES32","getGraphClient","decodeReferralCode","hexCode","parseBytes32String","substring","String","fromCharCode","trim","encodeReferralCode","final","HashZero","formatBytes32String","useUserReferralCode","localStorageCode","referralStorageAddress","onChainCode","localStorageCodeOwner","test","attachedOnChain","userReferralCode","userReferralCodeString","NoLiquidityErrorModal","outputCurrency","modalError","setModalError","nativeToken","inputCurrency","swapTokenSymbol","oneInchSwapUrl","rootUrl","get1InchSwapUrl","Boolean","resetModal","isObligatory","onMouseDown","marketsList","GNS_FEES_MULTIPLIER","marketsOptions","PremiaStrikeRangeMultiplier","Call","Put","ChooseMarketModal","setMarkets","markets","liqs","draftMarkets","icon","liqInfo","defaultChecked","checked","findIndex","splice","GNS_PAIRS","SLTPModal","onApply","btnText","setIsSubmitting","lineHeight","getBtnText","Selector","items","chosenItem","onSelect","isOpen","setIsOpen","closeSelector","SWAP_ICONS","longImg","shortImg","swapImg","longActiveImg","shortActiveImg","leverageSliderHandle","dragging","restProps","prefixCls","overlay","placement","Handle","SwapBox","positions","pendingPositions","setPendingPositions","setFromTokenAddress","setToTokenAddress","swapOption","setSwapOption","tokenSelection","setTokenSelection","isConfirming","setIsPendingConfirmation","flagOrdersEnabled","savedIsPnlInLeverage","orderBookApproved","positionRouterApproved","isWaitingForPluginApproval","approveOrderBook","approvePositionRouter","setIsWaitingForPluginApproval","isWaitingForPositionRouterApproval","setIsWaitingForPositionRouterApproval","isPluginApproving","isPositionRouterApproving","savedShouldDisableValidationForTesting","pendingPositionsGNS","setPendingPositionsGNS","fromValue","setFromValue","toValue","setToValue","anchorOnFromAmount","setAnchorOnFromAmount","isApproving","isWaitingForApproval","setIsWaitingForApproval","DEFAULT_SLIPPAGE_AMOUNT","setShortCollateralAddress","leverageOption","setLeverageOption","isLeverageSliderEnabled","hasLeverageOption","setOrderOption","positionKey","orderOptions","orderOptionLabels","triggerPriceValue","setTriggerPriceValue","fromTokens","stableTokens","indexTokens","shortableTokens","toTokens","needOrderBookApproval","prevNeedOrderBookApproval","needPositionRouterApproval","prevNeedPositionRouterApproval","tokenAllowanceAddress","tokenAllowance","tokenAllowanceGNS","GNS_Storage","Api","curPairSymbol","GNS_contract","GNS_PairIndex","openInterestDai","GNS_Info","openInterest","maxOpenInterest","liq","repeat","liquidityData","setLiquidity","modal","setModal","modalVisible","setModalVisible","suitableMarket","setSuitableMarket","reduce","fromBalance","toBalance","isPotentialWrap","isWrapOrUnwrap","needApproval","prevFromTokenAddress","prevNeedApproval","prevToTokenAddress","triggerRatioValue","setTriggerRatioValue","triggerRatioInverted","maxToTokenOut","maxToTokenOutUSD","maxFromTokenInUSD","entryMarkPrice","nextToAmount","nextToValue","nextFromAmount","nextFromValue","updateSwapAmounts","leverageMultiplier","fromUsdMinAfterFee","toNumerator","toDenominator","baseFromAmountUsd","swapFees","updateLeverageAmounts","liquidationPrice","nextDelta","nextHasProfit","nextPrice","divisor","getNextAveragePrice","liqPriceDistance","getToLabel","currentRate","usdgFromAmount","getSwapError","requiredAmount","swapAmount","nextUsdgAmount","sizeUsd","stableTokenAmount","getLeverageError","isPrimaryEnabled","isStopOrder","hasInputFocus","setHasInputFocus","hasInputError","setHasInputError","inputVal","wrap","WETH","unwrap","swap","multiPath","createIncreaseOrder","referralCode","increasePosition","tokenAddress0","refPrice","priceBasisPoints","priceLimit","boundedFromAmount","contractAddress","pendingChanges","showFromAndToSection","showTriggerPriceSection","showTriggerRatioSection","feeTokenPrice","openTrade","pairIndex","posSize","openPrice","roundLeverage","typeOfOrder","slippage","GNS_Trading","tsc","positionSizeDai","wait","curLeverage","marks","GNS","setFromValueToMaximumAvailable","maxAvailableAmount","icon_settings","Fragment","shouldShowMaxButton","getTokenLabel","evt","positive","negative","step","approveFromToken","errorCode","isSupportedChain","charAt","indexTokenInfo","nextToAmountUsd","ChartTokenSelector","selectedToken","as","Items","Item","marginLeft","marginRight","getChartToken","RED_COLOR","GREEN_COLOR","ExchangeTVChart","savedShouldShowPositionLines","currentChart","setCurrentChart","currentSeries","setCurrentSeries","setPeriod","hoveredCandlestick","setHoveredCandlestick","chartToken","setChartToken","tmp","previousMarketName","currentOrders","chartRef","updatePriceData","chartInited","setChartInited","scaleChart","timeScale","setVisibleRange","onCrosshairMove","seriesPrices","values","point","chart","createChart","offsetWidth","offsetHeight","layout","backgroundColor","textColor","fontFamily","localization","timeFormatter","businessDayOrTimestamp","grid","vertLines","color","horzLines","rightOffset","borderVisible","barSpacing","timeVisible","fixLeftEdge","priceScale","crosshair","horzLine","vertLine","mode","subscribeCrosshairMove","series","addCandlestickSeries","lineColor","topColor","bottomColor","lineWidth","priceLineColor","downColor","wickDownColor","upColor","wickUpColor","interval","setInterval","resizeChart","resize","setData","lines","line","removePriceLine","deltaPrice","candleStatsHtml","candlestick","timeThreshold","average","CLOSE_ICONS","Market","marketImg","Market_active","marketActiveImg","Stop","triggerImg","Stop_active","triggerActiveImg","ORDER_SIZE_DUST_USD","getTokenAmount","usdAmount","shouldSwap","receiveToken","isCollateralWrapped","isSameToken","isUnwrap","PositionSeller","setOrdersToaOpen","initTab","keepLeverage","prevIsVisible","savedRecieveTokenAddress","setSavedRecieveTokenAddress","swapToToken","setSwapToToken","maxAmount","maxAmountFormatted","maxAmountFormattedFree","convertedAmount","convertedAmountFormatted","nextLeverage","nextLiquidationPrice","isClosing","nextCollateral","isNotEnoughReceiveTokenLiquidity","isCollateralPoolCapacityExceeded","swapFeeToken","swapFee","ret","isSwapAllowed","receiveAmount","convertedReceiveAmount","totalFees","executionFeeUsd","residualSize","abs","deductions","collateralInfo","receiveTokenInfo","onClickPrimary","minProfitExpiration","minProfitTimeExpired","withdrawETH","prefix","warning","tokenOptionInfo","convertedTokenAmount","maxInUsd","maxIn","maxOut","maxOutUsd","fromInfo","toInfo","getSwapLimits","DEPOSIT","WITHDRAW","EDIT_OPTIONS","EDIT_ICONS","depositImg","withdrawImg","depositActiveImg","withdrawActiveImg","PositionEditor","nextLeverageExcludingPnl","isSwapping","setIsSwapping","isDeposit","isWithdrawal","resetForm","depositCollateral","collateralSnapshot","expectingCollateralChange","withdrawCollateral","OrdersToa","SpinningLoader","ROOT_SHARE_URL","UPLOAD_URL","UPLOAD_SHARE","config","quality","canvasWidth","canvasHeight","getShareURL","imageInfo","PositionShareCard","positionRef","userAffiliateCode","uploadedImageInfo","uploadedImageError","sharePositionBgImg","deltaAfterFeesPercentageStr","homeURL","backgroundImage","gmxLogo","PositionShare","setIsPositionShareModalOpen","isPositionShareModalOpen","positionToShare","affiliateCodes","setAffiliateCodes","variables","parsedAffiliateCodes","referrerTotalStats","useAffiliateCodes","setUploadedImageInfo","setUploadedImageError","useCopyToClipboard","copyToClipboard","sourceLoaded","setSourceLoaded","img","Image","onload","useLoadImage","shareBgImg","tweetLink","hashtag","finalURL","encodeURIComponent","getTwitterIntentURL","element","toJpeg","dataUrl","download","click","image","PositionsItem","onPositionClick","setListSection","positionOrders","hasPositionProfit","showPnlAfterFees","positionDelta","hasOrderError","borrowFeeUSD","editPosition","sellPosition","isLarge","isPending","openSLTPModal","isCloseLoading","setIsCloseLoading","hasPendingChanges","openOrderModal","triggerPricesGMX","triggerOrdersGMX","SL","TP","muted","hasLowCollateral","icon_edit","display","deltaAfterFeesStr","sl","tp","getOrdersForPosition","hasMatchingIndexToken","hasMatchingCollateralToken","PositionsList","positionsGNS","positionsDataIsLoading","setMarket","positionsLoading","hasPositions","SLTPModalInfo","setSLTPModalInfo","curVal","orderName","setSLTP","newValue","positionToEditKey","setPositionToEditKey","positionToSellKey","setPositionToSellKey","isPositionEditorVisible","setIsPositionEditorVisible","isPositionSellerVisible","setIsPositionSellerVisible","positionSellerTab","setPositionSellerTab","setCollateralTokenAddress","ordersToaOpen","setLoading","closeTradeMarket","renderSLTPModal","borrowFeeRate","pos","trader","ADDRESS_ZERO","assign","buy","tokenSymb","tokenAddr","curPrice","initCollateral","pendingDeltaAfterFees","deltaBeforeFeesStr","entryPrice","liqPrice","posKey","colSpan","OrderEditor","setEditingOrder","initialRatio","indexTokenMarkPrice","OrderEditorGNS","priceValue","setPriceValue","SLVal","TPVal","updateOpenLimitOrder","OrdersList","ordersGNS","hideActions","cancelOrderIdList","setCancelOrderIdList","hasOrders","marketIconGNS","marketIconGMX","editingOrder","editingOrderGNS","setEditingOrderGNS","orderEditorGNSVisible","setOrderEditorGNSVisible","onCancelClick","cancelOpenLimitOrder","onEditClick","renderHead","renderEmptyRow","renderActions","renderLargeList","indexTokenSymbol","collateralTokenInfo","collateralUSD","renderLargeListGNS","ord","positionSize","renderSmallListGNS","renderSmallList","getOrderActionTitle","actionDisplay","renderLiquidationTooltip","liquidationData","minCollateral","borrowFee","loss","getLiquidationData","liquidationsDataMap","timestamp","TradeHistory","shouldShowPaginationButtons","pageIds","setPageIds","pageIndex","setPageIndex","forSingleAccount","afterId","urlItem","URL","searchParams","append","trades","updateTrades","item0","item1","data0","data1","time0","time1","block0","blockNumber","block1","useTrades","liquidationsData","graphClient","_data","liquidatedPositions","useLiquidationsData","memo","getMsg","trade","tradeData","defaultMsg","tokenAmount","tokenIn","tokenOut","amountOut","acceptablePrice","flags","isOrderExecution","isLiquidation","longShortDisplay","executionPriceDisplay","executionPrice","sizeDeltaDisplay","increase","priceDisplay","getPositionDisplay","fromAmountDisplay","toAmountDisplay","amountInDisplay","minOutDisplay","tradesWithMessages","txhash","lastTrade","ExchangeBanner","hideBanner","notifications","pushSuccessNotification","transactionHash","pushErrorNotification","getFundingFee","getTokenAddress","applyPendingChanges","Exchange","forwardRef","setSavedIsPnlInLeverage","savedShowPnlAfterFees","setSavedShouldShowPositionLines","showBanner","setShowBanner","bannerHidden","setBannerHidden","updatedPositions","setUpdatedPositions","currentAccount","vaultAddress","readerAddress","usdgAddress","whitelistedTokenAddresses","positionQuery","collateralTokens","getPositionQuery","defaultTokenSelection","selectedSwapOption","newTokenSelection","tokenAddresses","positionData","positionDataError","positionsGNSLoading","setPositionsGNSLoading","pair","openTrades","positionsGNSError","VaultV2","vaultReaderAddress","indexPricesUrl","refreshInterval","refreshWhenHidden","useInfoTokens","currentTokenPriceStr","propsLength","contractKey","hasRealisedProfit","realisedPnl","updatedPosition","collateralAfterFee","closingFee","hasProfitAfterFees","deltaPercentageAfterFees","netValue","getPositions","useImperativeHandle","onUpdatePosition","reserveAmount","onClosePosition","onIncreasePosition","fee","indexTokenItem","onDecreasePosition","onCancelIncreasePosition","blockGap","timeGap","onCancelDecreasePosition","receiver","overrideAccount","connectedAccount","shouldRequest","orderBookReaderAddress","orderBookContract","orderBookReaderContract","fetchIndexesFromServer","ordersIndexesUrl","a","b","decrease","fetchLastIndex","_hex","fetchLastIndexes","getRange","_indexes","knownIndexes","lastIndex","getOrders","parseFunc","serverIndexes","lastIndexes","swapOrders","increaseOrders","decreaseOrders","useAccountOrders","getOpenLimitOrder","ordersGNSData","setOrdersGNS","setIsPluginApproving","setIsPositionRouterApproving","setIsCancelMultipleOrderProcessing","tx","posLength","ordersLength","LIST_SECTIONS","listSection","LIST_SECTIONS_LABELS","Orders","Positions","getListSection","section","hiddenLimit","getTime","homeEventsData","validTill","bodyText","buttons","newTab","appEventsData","Icon","EventToast","event","button","useEventToast","isHome","visited","setVisited","isFuture","custom","EventToastContainer","useWindowScroll","breakpoint","createBreakpoint","XL","L","S","useBreakpoint","reverseOrder","gutter","containerClassName","containerStyle","right","toastOptions","Infinity","SEO","customMeta","meta","description","Helmet","property","RedirectPopupModal","redirectModalVisible","setRedirectModalVisible","appRedirectUrl","setRedirectPopupTimestamp","setShouldHideRedirectModal","shouldHideRedirectModal","removeRedirectPopupTimestamp","dynamicActivate","locale","i18n","activate","loadLocaleData","en","plurals","es","zh","ko","ru","ja","fr","getLibrary","autoRefreshOnNetworkChange","Jelly","cssTransition","enter","arbWsProvider","WebSocketProvider","avaxWsProvider","JsonRpcProvider","FullApp","setRegisterVisible","exchangeRef","connector","deactivate","history","useNavigate","activatingConnector","setActivatingConnector","triedEager","tried","setTried","shouldTryWalletConnect","rawData","connected","SyntaxError","currentProviderName","isAuthorized","useEagerConnect","suppress","injected","handleConnect","handleChainChanged","handleAccountsChanged","handleNetworkChanged","networkId","removeListener","useInactiveListener","search","React","URLSearchParams","useRouteQuery","get","encodedReferralCode","queryParams","delete","connectInjectedWallet","fn","UnsupportedChainIdError","errString","getInjectedHandler","attemptActivateWallet","selectedToPage","isSettingsVisible","setIsSettingsVisible","setSavedSlippageAmount","slippageAmount","setSlippageAmount","isPnlInLeverage","setIsPnlInLeverage","shouldDisableValidationForTesting","setShouldDisableValidationForTesting","setShowPnlAfterFees","setSavedShowPnlAfterFees","setSavedShouldDisableValidationForTesting","decodedRefCode","checkPendingTxns","updatedPendingTxns","getTransactionReceipt","receipt","wsVaultAbi","VaultV2b","wsProvider","getWsProvider","wsVault","wsPositionRouter","callExchangeRef","off","dgAddress","limit","hideProgressBar","newestOnTop","closeOnClick","draggable","pauseOnHover","basisPoints","GMXInterface","CALL","callIcon","putIcon","callActiveIcon","putActiveIcon","ASSET_OPTIONS","assetOption","setAssetOption","amountValue","setAmountValue","setOptions","setOptionsLength","setOptionsExpectedLength","isOptionsLoading","setIsOptionsLoading","optionPrices","setOptionPrices","scrollToList","chaiMarkPrice","isCall","expirationDate","expDateUTC","getUTCHours","setUTCDate","getUTCDate","setUTCHours","periodEightAM","fetchLyraOptions","strikes","lyra","Lyra","periodMs","mkt","baseToken","boardId","liveBoards","prevBd","curBd","prev","expiryTimestamp","cur","expDate","board","liveBoardsMap","strike","strikeId","strikePrice","strategy","toUpperCase","expiry","buyUrl","quoteOption","ask","pricePerOption","cost","fetchPremiaOptions","PremiaPool_ABI","getPoolSettings","base","DAI_ABI","strikeFormatted","rangeMultiplier","markPriceFormatted","lowerBoundary","higherBoundary","quote","fixedFromFloat","fixedToBn","baseCost64x64","feeCost64x64","totalSupply","fetchAvailableOptions","periodDays","strategies","expectedLength","strategySentiment","strikeScale","strategyTokenSymbol","strategyIsCall","strategyAddress","strategyContract","HegicStrategy_ABI","priceName","priceAddress","priceContract","PriceCalculator_ABI","urlName","periodS","getAvailableContracts","calculatePremium","fetchHegicOptions","assetIcons","iconETH","iconBTC","marginBottom","format","Loader","cy","r","OptionsItem","logo","isITM","isBtnDisabled","textAlign","Filter","selectedItems","setSelectedItems","closeFilter","icon_curve","icon_down","itemIcon","isSelected","OptionsList","optionsExpectedLength","isLoading","scrollRef","chaiAddress","Chai_ABI","latestAnswer","listFrontier","setListFrontier","unfoldVisible","setUnfoldVisible","filterOptions","arr","sortType","setSortType","sortedOptions","setSortedOptions","sortOptions","param","dir","isInit","sortFn","prevEl","prevParam","prevDir","optPriceObj","scrollTo","behavior","icon_btnUp","scrollIntoView","navigator","userAgent","Options","AppRouter","setSupplyStep","allowance","setPath","nav","Warning","App","setDgAddress","registerVisible","Provider","ReactDOM","createRoot","getElementById","render","StrictMode"],"mappings":"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AA0B,wC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,8C,+BCAzC,OAAe,cAA0B,6C,0+lGCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,sC,iGCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,iD,2FCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cA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OAAe,suB,+BCAf,OAAe,8zB,+BCAf,OAAe,khB,+BCAf,OAAe,kmB,+BCAf,OAAe,skB,+BCAf,OAAe,k7B,+BCAf,OAAe,syB,+BCAf,OAAe,02B,+BCAf,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,4C,+BCAzC,OAAe,cAA0B,gC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,03C,+BCAf,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,00D,+BCAf,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,iD,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,iD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,4C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,gC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,iC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,qD,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,wICAzC,IAAIH,EAAM,CACT,uBAAwB,I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zBS,EAAOC,QAAUb,EACjBA,EAAeE,GAAK,G,+BCnNpB,OAAe,svC,+BCAf,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,8/C,+BCAf,OAAe,s1D,+BCAf,OAAe,cAA0B,+B,+BCAzC,OAAe,spE,+BCAf,OAAe,cAA0B,oC,+BCAzC,OAAe,07D,+BCAf,OAAe,cAA0B,mC,+BCAzC,OAAe,kwC,+BCAf,OAAe,kvG,+BCAf,OAAe,cAA0B,4C,+BCAzC,OAAe,8lK,+BCAf,OAAe,cAA0B,uC,+BCAzC,OAAe,8lY,+BCAf,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,4C,+BCAzC,OAAe,s/S,+BCAf,OAAe,cAA0B,iC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,szB,+BCAf,OAAe,suB,+BCAf,OAAe,8zB,+BCAf,OAAe,khB,+BCAf,OAAe,kmB,+BCAf,OAAe,skB,+BCAf,OAAe,k7B,+BCAf,OAAe,syB,+BCAf,OAAe,02B,+BCAf,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,4C,+BCAzC,OAAe,cAA0B,gC,+BCAzC,OAAe,cAA0B,gC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,iC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,03C,+BCAf,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,00D,+BCAf,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,iD,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,iD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe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","file":"static/js/main.79ac2a83.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/icon-edit.233d1510.svg\";","var map = {\n\t\"./icon-BTC.svg\": 267,\n\t\"./icon-ETH.svg\": 268,\n\t\"./icon-GMX.svg\": 359,\n\t\"./icon-GNS.svg\": 360,\n\t\"./icon-GNS_v2.svg\": 754,\n\t\"./icon-Hegic.svg\": 755,\n\t\"./icon-Lyra.svg\": 756,\n\t\"./icon-Premia.svg\": 757,\n\t\"./icon-WBTC.svg\": 758,\n\t\"./icon-btn-up.svg\": 269,\n\t\"./icon-call-active.svg\": 270,\n\t\"./icon-call.svg\": 271,\n\t\"./icon-dollar.svg\": 759,\n\t\"./icon-down-small-white.svg\": 361,\n\t\"./icon-down-small.svg\": 272,\n\t\"./icon-down.svg\": 760,\n\t\"./icon-edit.svg\": 88,\n\t\"./icon-hint.svg\": 761,\n\t\"./icon-link.svg\": 247,\n\t\"./icon-market.svg\": 273,\n\t\"./icon-put-active.svg\": 274,\n\t\"./icon-put.svg\": 275,\n\t\"./icon-repay.svg\": 762,\n\t\"./icon-settings.svg\": 266,\n\t\"./icon-sort.svg\": 763,\n\t\"./icon-usdc.svg\": 764,\n\t\"./icon-user.svg\": 765,\n\t\"./icon-wallet.svg\": 246\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 145;","export default __webpack_public_path__ + \"static/media/ic_eth_40.1b83dd3c.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_40.1b83dd3c.svg\";","var map = {\n\t\"./ic_btc_40.svg\": 314,\n\t\"./ic_dai_40.svg\": 315,\n\t\"./ic_eth_40.svg\": 185,\n\t\"./ic_frax_40.svg\": 316,\n\t\"./ic_link_40.svg\": 317,\n\t\"./ic_uni_40.svg\": 318,\n\t\"./ic_usdc_40.svg\": 319,\n\t\"./ic_usdt_40.svg\": 320,\n\t\"./ic_weth_40.svg\": 321\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 244;","var map = {\n\t\"./ic_btc_40.svg\": 367,\n\t\"./ic_dai_40.svg\": 368,\n\t\"./ic_eth_40.svg\": 192,\n\t\"./ic_frax_40.svg\": 369,\n\t\"./ic_link_40.svg\": 370,\n\t\"./ic_uni_40.svg\": 371,\n\t\"./ic_usdc_40.svg\": 372,\n\t\"./ic_usdt_40.svg\": 373,\n\t\"./ic_weth_40.svg\": 374\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 245;","export default __webpack_public_path__ + \"static/media/icon-wallet.5b677892.svg\";","export default __webpack_public_path__ + \"static/media/icon-link.436183a1.svg\";","export default __webpack_public_path__ + \"static/media/DROP_DOWN.ef525fad.svg\";","export default __webpack_public_path__ + \"static/media/icon_dollar.f46a93fe.svg\";","export default __webpack_public_path__ + \"static/media/icon_dollar_active.3a2a7bba.svg\";","export default __webpack_public_path__ + \"static/media/icon_market.05f6ef86.svg\";","export default __webpack_public_path__ + \"static/media/icon_market_active.af684a3e.svg\";","export default __webpack_public_path__ + \"static/media/icon_trigger.c4291240.svg\";","export default __webpack_public_path__ + \"static/media/icon_trigger_active.a6e3f64a.svg\";","export default __webpack_public_path__ + \"static/media/icon_withdraw.29572b6d.svg\";","export default __webpack_public_path__ + \"static/media/icon_withdraw_active.7210cab7.svg\";","export default __webpack_public_path__ + \"static/media/long.0f8a81b9.svg\";","export default __webpack_public_path__ + \"static/media/long_active.8a037ed6.svg\";","export default __webpack_public_path__ + \"static/media/short.c75b3ee9.svg\";","export default __webpack_public_path__ + \"static/media/short_active.d3098d1c.svg\";","export default __webpack_public_path__ + \"static/media/gmx-logo-with-name.03a4464f.svg\";","export default __webpack_public_path__ + \"static/media/position-share-bg.900fbfaa.png\";","export default __webpack_public_path__ + \"static/media/swap.40fb8e49.svg\";","export default __webpack_public_path__ + \"static/media/icon-settings.269e4d1c.svg\";","export default __webpack_public_path__ + \"static/media/icon-BTC.d1a85829.svg\";","export default __webpack_public_path__ + \"static/media/icon-ETH.11294773.svg\";","export default __webpack_public_path__ + \"static/media/icon-btn-up.13730dce.svg\";","export default __webpack_public_path__ + \"static/media/icon-call-active.867eabe7.svg\";","export default __webpack_public_path__ + \"static/media/icon-call.7aeed2e7.svg\";","export default __webpack_public_path__ + \"static/media/icon-down-small.c32a162b.svg\";","export default __webpack_public_path__ + \"static/media/icon-market.9e95abb6.svg\";","export default __webpack_public_path__ + \"static/media/icon-put-active.d85cad03.svg\";","export default __webpack_public_path__ + \"static/media/icon-put.216aa799.svg\";","export default __webpack_public_path__ + \"static/media/DROP_DOWN.ef525fad.svg\";","export default __webpack_public_path__ + \"static/media/icon_dollar.f46a93fe.svg\";","export default __webpack_public_path__ + \"static/media/icon_dollar_active.3a2a7bba.svg\";","export default __webpack_public_path__ + \"static/media/icon_market.05f6ef86.svg\";","export default __webpack_public_path__ + \"static/media/icon_market_active.af684a3e.svg\";","export default __webpack_public_path__ + \"static/media/icon_trigger.c4291240.svg\";","export default __webpack_public_path__ + \"static/media/icon_trigger_active.a6e3f64a.svg\";","export default __webpack_public_path__ + \"static/media/icon_withdraw.29572b6d.svg\";","export default __webpack_public_path__ + \"static/media/icon_withdraw_active.7210cab7.svg\";","export default __webpack_public_path__ + \"static/media/gmx-logo-with-name.03a4464f.svg\";","export default __webpack_public_path__ + \"static/media/position-share-bg.900fbfaa.png\";","export default __webpack_public_path__ + \"static/media/ic_btc_40.1ebc220b.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_40.ff92bfa1.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_40.4728adab.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_40.e61956ee.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_40.45c0523a.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_40.8bf1ff5d.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_40.d7851f5e.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_40.8dbce838.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_24.21ec7bfe.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_24.be4891c9.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_24.43583fc4.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc.b_24.bab8cadc.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_24.f992927a.svg\";","export default __webpack_public_path__ + \"static/media/ic_busd_24.2432ce58.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_24.bafa9da6.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_24.6b1d8a1d.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_24.7349c478.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_24.eff381d9.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_24.2b59d7e0.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_24.0d641e52.svg\";","export default __webpack_public_path__ + \"static/media/ic_mim_24.b6a1708c.svg\";","export default __webpack_public_path__ + \"static/media/ic_settings_24.25d2f4a7.svg\";","export default __webpack_public_path__ + \"static/media/ic_tether_24.a7c88dcd.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_24.47e903f7.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc.e_24.0952740b.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_24.0952740b.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_24.5ab8778d.svg\";","export default __webpack_public_path__ + \"static/media/ic_wallet_24.4be97369.svg\";","export default __webpack_public_path__ + \"static/media/ic_wavax_24.43583fc4.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_24.bc395894.svg\";","export default __webpack_public_path__ + \"static/media/icon-GMX.195e3c0f.svg\";","export default __webpack_public_path__ + \"static/media/icon-GNS.eb30a0a6.svg\";","export default __webpack_public_path__ + \"static/media/icon-down-small-white.56e18ad5.svg\";","export default __webpack_public_path__ + \"static/media/coinbaseWallet.ae86a337.png\";","export default __webpack_public_path__ + \"static/media/ic_btc_40.1ebc220b.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_40.ff92bfa1.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_40.4728adab.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_40.e61956ee.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_40.45c0523a.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_40.8bf1ff5d.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_40.d7851f5e.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_40.8dbce838.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_24.21ec7bfe.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_24.be4891c9.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_24.43583fc4.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc.b_24.bab8cadc.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_24.f992927a.svg\";","export default __webpack_public_path__ + \"static/media/ic_busd_24.2432ce58.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_24.bafa9da6.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_24.6b1d8a1d.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_24.7349c478.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_24.eff381d9.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_24.2b59d7e0.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_24.0d641e52.svg\";","export default __webpack_public_path__ + \"static/media/ic_mim_24.b6a1708c.svg\";","export default __webpack_public_path__ + \"static/media/ic_settings_24.25d2f4a7.svg\";","export default __webpack_public_path__ + \"static/media/ic_tether_24.a7c88dcd.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_24.47e903f7.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc.e_24.0952740b.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_24.0952740b.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_24.5ab8778d.svg\";","export default __webpack_public_path__ + \"static/media/ic_wallet_24.4be97369.svg\";","export default __webpack_public_path__ + \"static/media/ic_wavax_24.43583fc4.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_24.bc395894.svg\";","export default __webpack_public_path__ + \"static/media/metamask.4b5d438a.png\";","export default __webpack_public_path__ + \"static/media/walletconnect-circle-blue.31c29967.svg\";","var map = {\n\t\"./Anyswap.png\": 521,\n\t\"./Anyswap.svg\": 522,\n\t\"./Artwork.svg\": 523,\n\t\"./Artwork_gmx.svg\": 524,\n\t\"./Banxa.png\": 525,\n\t\"./DROP_DOWN.svg\": 249,\n\t\"./Hop.png\": 526,\n\t\"./Hop.svg\": 527,\n\t\"./Hop_dark.png\": 528,\n\t\"./Hop_dark.svg\": 529,\n\t\"./Synapse.png\": 530,\n\t\"./Synapse.svg\": 531,\n\t\"./binance.png\": 532,\n\t\"./bscscan.png\": 533,\n\t\"./btn_big_arbitrum.png\": 534,\n\t\"./btn_big_avalanche.png\": 535,\n\t\"./btn_big_bsc.png\": 536,\n\t\"./btn_big_purchasegmx.png\": 537,\n\t\"./btn_big_purchasegmx.svg\": 538,\n\t\"./buy_gmx.svg\": 539,\n\t\"./buy_gmx_bond.svg\": 540,\n\t\"./buy_transfer_eth.svg\": 541,\n\t\"./coinbaseWallet.png\": 542,\n\t\"./coingecko.png\": 543,\n\t\"./cross.svg\": 544,\n\t\"./ddl/chevron-down.svg\": 545,\n\t\"./ddl/chevron-down_sm.svg\": 546,\n\t\"./ddl/ic_btc_40.png\": 547,\n\t\"./ddl/ic_btc_40.svg\": 314,\n\t\"./ddl/ic_dai_40.png\": 548,\n\t\"./ddl/ic_dai_40.svg\": 315,\n\t\"./ddl/ic_eth_40.png\": 549,\n\t\"./ddl/ic_eth_40.svg\": 185,\n\t\"./ddl/ic_frax_40.png\": 550,\n\t\"./ddl/ic_frax_40.svg\": 316,\n\t\"./ddl/ic_link_40.png\": 551,\n\t\"./ddl/ic_link_40.svg\": 317,\n\t\"./ddl/ic_uni_40.png\": 552,\n\t\"./ddl/ic_uni_40.svg\": 318,\n\t\"./ddl/ic_usdc_40.png\": 553,\n\t\"./ddl/ic_usdc_40.svg\": 319,\n\t\"./ddl/ic_usdt_40.png\": 554,\n\t\"./ddl/ic_usdt_40.svg\": 320,\n\t\"./ddl/ic_weth_40.png\": 555,\n\t\"./ddl/ic_weth_40.svg\": 321,\n\t\"./ddl/icon_arrow.svg\": 556,\n\t\"./ddl/icon_check.svg\": 557,\n\t\"./ddl/icon_close.svg\": 558,\n\t\"./ddl/icon_close_sm.svg\": 559,\n\t\"./ddl/icon_close_toast.svg\": 560,\n\t\"./ddl/icon_dollar.svg\": 250,\n\t\"./ddl/icon_dollar_active.svg\": 251,\n\t\"./ddl/icon_market.svg\": 252,\n\t\"./ddl/icon_market_active.svg\": 253,\n\t\"./ddl/icon_trigger.svg\": 254,\n\t\"./ddl/icon_trigger_active.svg\": 255,\n\t\"./ddl/icon_withdraw.svg\": 256,\n\t\"./ddl/icon_withdraw_active.svg\": 257,\n\t\"./ddl/lock.svg\": 561,\n\t\"./ddl/long.svg\": 258,\n\t\"./ddl/long_active.svg\": 259,\n\t\"./ddl/short.svg\": 260,\n\t\"./ddl/short_active.svg\": 261,\n\t\"./flag_en.svg\": 562,\n\t\"./flag_es.svg\": 563,\n\t\"./flag_fr.svg\": 564,\n\t\"./flag_ja.svg\": 565,\n\t\"./flag_ko.svg\": 566,\n\t\"./flag_ru.svg\": 567,\n\t\"./flag_zh.svg\": 568,\n\t\"./glp_icon.svg\": 569,\n\t\"./gmx-logo-final-white-small.png\": 570,\n\t\"./gmx-logo-final-white.png\": 571,\n\t\"./gmx-logo-final.png\": 572,\n\t\"./gmx-logo-glow.png\": 573,\n\t\"./gmx-logo-with-name.svg\": 262,\n\t\"./gmx_logo.svg\": 574,\n\t\"./graphite-01.png\": 575,\n\t\"./ic-communityproject.svg\": 576,\n\t\"./ic_arbitrum_16.svg\": 577,\n\t\"./ic_arbitrum_24.svg\": 322,\n\t\"./ic_arbitrum_96.svg\": 578,\n\t\"./ic_arbitrum_hover_16.svg\": 579,\n\t\"./ic_arrowleft16.svg\": 580,\n\t\"./ic_arrowright16.svg\": 581,\n\t\"./ic_avalanche_16.svg\": 582,\n\t\"./ic_avalanche_24.svg\": 323,\n\t\"./ic_avalanche_96.svg\": 583,\n\t\"./ic_avax_24.svg\": 324,\n\t\"./ic_avax_30.svg\": 584,\n\t\"./ic_avax_40.svg\": 585,\n\t\"./ic_banxa.svg\": 586,\n\t\"./ic_binance_logo.svg\": 587,\n\t\"./ic_bsc.svg\": 588,\n\t\"./ic_bsc_96.svg\": 589,\n\t\"./ic_btc.b_24.svg\": 325,\n\t\"./ic_btc.b_40.svg\": 590,\n\t\"./ic_btc_24.svg\": 326,\n\t\"./ic_btc_40.svg\": 591,\n\t\"./ic_busd_24.svg\": 327,\n\t\"./ic_buy_glp.svg\": 592,\n\t\"./ic_cash.png\": 593,\n\t\"./ic_cash.svg\": 594,\n\t\"./ic_checked.svg\": 595,\n\t\"./ic_coingecko_16.svg\": 596,\n\t\"./ic_coingecko_hover_16.svg\": 597,\n\t\"./ic_convert_down.svg\": 598,\n\t\"./ic_copy_16.svg\": 599,\n\t\"./ic_cost.svg\": 600,\n\t\"./ic_dai_24.svg\": 328,\n\t\"./ic_dai_40.svg\": 601,\n\t\"./ic_discord.svg\": 602,\n\t\"./ic_eth_24.svg\": 329,\n\t\"./ic_eth_40.svg\": 603,\n\t\"./ic_frax_24.svg\": 330,\n\t\"./ic_frax_40.svg\": 604,\n\t\"./ic_github.svg\": 605,\n\t\"./ic_glp_24.svg\": 331,\n\t\"./ic_glp_40.svg\": 606,\n\t\"./ic_glp_custom.svg\": 607,\n\t\"./ic_gmx.svg\": 608,\n\t\"./ic_gmx_24.svg\": 332,\n\t\"./ic_gmx_30.svg\": 609,\n\t\"./ic_gmx_40.svg\": 610,\n\t\"./ic_gmx_64.svg\": 611,\n\t\"./ic_gmx_arbitrum.svg\": 612,\n\t\"./ic_gmx_avax.svg\": 613,\n\t\"./ic_gmx_big.svg\": 614,\n\t\"./ic_gmx_custom.svg\": 615,\n\t\"./ic_gmx_footer.svg\": 616,\n\t\"./ic_hop.svg\": 617,\n\t\"./ic_info.svg\": 618,\n\t\"./ic_language24.svg\": 619,\n\t\"./ic_link_24.svg\": 333,\n\t\"./ic_link_40.svg\": 620,\n\t\"./ic_liquidity.svg\": 621,\n\t\"./ic_medium.svg\": 622,\n\t\"./ic_menu_dots.svg\": 623,\n\t\"./ic_metamask_16.svg\": 624,\n\t\"./ic_metamask_hover_16.svg\": 625,\n\t\"./ic_mim_24.svg\": 334,\n\t\"./ic_mim_40.svg\": 626,\n\t\"./ic_multiswap.svg\": 627,\n\t\"./ic_new_link_16.svg\": 628,\n\t\"./ic_olympus.svg\": 629,\n\t\"./ic_olympus_arbitrum.svg\": 630,\n\t\"./ic_selector_dropdowns.svg\": 631,\n\t\"./ic_settings_16.svg\": 632,\n\t\"./ic_settings_24.svg\": 335,\n\t\"./ic_sign in_16.svg\": 633,\n\t\"./ic_sign_out_16.svg\": 634,\n\t\"./ic_simpleswaps.svg\": 635,\n\t\"./ic_stats.svg\": 636,\n\t\"./ic_stats_big.svg\": 637,\n\t\"./ic_synapse.svg\": 638,\n\t\"./ic_telegram.svg\": 639,\n\t\"./ic_tether_24.svg\": 336,\n\t\"./ic_tokens.svg\": 640,\n\t\"./ic_totaluser.svg\": 641,\n\t\"./ic_trading.svg\": 642,\n\t\"./ic_transfer_avax.svg\": 643,\n\t\"./ic_twitter.svg\": 644,\n\t\"./ic_uni_24.svg\": 337,\n\t\"./ic_uni_40.svg\": 645,\n\t\"./ic_usdc.e_24.svg\": 338,\n\t\"./ic_usdc.e_40.svg\": 646,\n\t\"./ic_usdc_24.svg\": 339,\n\t\"./ic_usdc_40.svg\": 647,\n\t\"./ic_usdt_24.svg\": 340,\n\t\"./ic_usdt_40.svg\": 648,\n\t\"./ic_wallet_24.svg\": 341,\n\t\"./ic_wavax_24.svg\": 342,\n\t\"./ic_wavax_40.svg\": 649,\n\t\"./ic_weth_24.svg\": 343,\n\t\"./ic_weth_40.svg\": 650,\n\t\"./lg_arbitrum.svg\": 651,\n\t\"./logo_GMX.svg\": 652,\n\t\"./logo_GMX_small.svg\": 653,\n\t\"./long.svg\": 654,\n\t\"./metamask-text.svg\": 655,\n\t\"./metamask.png\": 656,\n\t\"./page-not-found.svg\": 657,\n\t\"./position-share-bg.png\": 263,\n\t\"./short.svg\": 658,\n\t\"./swap.svg\": 264,\n\t\"./trading.jpg\": 659,\n\t\"./wallet-connect-text.svg\": 660,\n\t\"./walletconnect-circle-blue.svg\": 661,\n\t\"./wave-01.png\": 662,\n\t\"./wave-02.png\": 663\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 520;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAAAZlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+Vn2moAAAAInRSTlMABhQdEgsKKUeEstIZdbP/wlfRwTjgpJRm8fDhhaNlk3ZW+c569wAAAsRJREFUeAHs0AEBwEAMAjFaCv4lbz7+IiHSrJ+3I40vfVzOo72it3JaxHLxI4IIIogggggiiCDia9cMdx5FwSj8aw84Ug4qCoL96t7/Te68YL7GjrPpn0nsxCepLXrA8IQ3NoY/IULp5keLJ0YbHKM1/gfd3PQni7Ak6b6bXU9y8DigIz1+hx9JsvefKwITyfBsVCIOgrPkjlGp7WDiPJqPFWF6kvHpISgox6R+DXKyI35DpK6LJn6oCPEwW/rNw6bEZC4Hc+0iu/Irmttw7wDdKKB8bSKwaDRPF6bpANUM96/aTT2GR3dOEeLBY9p7ABY6vDJkGJakG1N24krVdp+h5qRRaceyNPptgfg0O8dBuiVKt/spRbTiAa8esP4qQjFIxABwnMq85GO2K3Hm+PBVogcCqWp8zAaIMrKTHAL1CUVE8sgDJk7YU+fXlYgrOiJVneBaxjBrS44d4LkC41SOFtClergALkPI7oQiJoYjD5HUeGFMzU/qGi9T0ZKZ+1IZFRMzY5mpZ2ctvLTMfWQaiogAwY4nFOG4HHuY8ILnhtqJCFSlMryvKnIv57DOWGlWKph+Dstii4h6r8BTiggvHnQ88iCBTv8kct2JUAylMtyIgsvirOstFKNrJdV9l4atkTOWRmRSOw9YORx5QHIo5HEnAjaVylhrf5WsZKy0WivSYkmtRQQ9RFM4oQiTmW76q3/WReChh/h8sPqdiI51Yi1/3L4eafZ1DFOOClBz/69+sIiQe93SbE4oAj5TmOOzWHj0pLc0KChOOxHI9EXpMpN0ul5pZWi2pZFl+LkHnJOMUyf9Z7m0bIP6blNY8D59xoZROETV88Wf/5T3Eb6dVm3wPp4r3sS5v/bFjL83KRtcIlRL6/EuYfkbRFzvLC8Rl4hLxCXiEnGJuET8A+HaTFa3F17bC68Np9uG02sL8rYF+T+idSlyqmiqtwAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/Anyswap.491d1f32.svg\";","export default __webpack_public_path__ + \"static/media/Artwork.a2d41b8c.svg\";","export default __webpack_public_path__ + \"static/media/Artwork_gmx.cc61d732.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAAoCAMAAABO8gGqAAABcVBMVEUAAAAoKDwnKTsnKTsnKTuGh5HJyc6urrWFhpA1Nkehoqrx8vO7vMF4eoVCRFRrbHhQUWARbooBqMcRcojKys////+vr7ZdX2zW19ry8vMUZIIBo8cBqMYBrMUUbYCTlJ0iN00BnsgAoscArMUDqbwiO0zl5ee8vcLX2NsNd50Bp8YBrcYAscQPgpHk5OYeRF8AmcgAo8cUaYEBssUAtsMdTl0Gh7gBmckPdpMPe5IBtsQIn6mgoalcXmtqa3gWVnoBlcoAmckDmMAlMUQiOUwDqr0Bu8MYYm4lL0QDicIBlMoAu8MDtrolM0MSYI0Bj8oFi7clMkQFpbMAv8EUd34iNU0Bi8sBkMsbTGgZXm8AwMIAxMEiPUwKb6gBi8wLeqcKl6EAv8IBxcEMl5YbRWkBhs0gPVYgRFUBwMIAycAdUlwGeLwBhswRY4wPh48Fuq8UVoQBgs0Azr8YaWwKbKkBzsAKqZ4ZS3IDfcQCxLcbXmRL8BeXAAAABHRSTlMAM7D2JaXEwgAAAp1JREFUeAHszjEBADAQArF7wL/myigDURA4OaWsg3OK+VCqCaeaSbkFF/xswQUfa2XRJa8OxNFNYF6gvUkz7u7u7u7u7m6f/1UqZArW/9wNhZ26kd+JZWvy/uMsjOPGQg8c247rOmHblrwm4a8UQ+K2HUswIp3JGhL0BOEmGRGHBzm6FYA29IXwUBCe5eMgUlAVQKUpLCouKTUvKFyaBO4KwCdBSSoqyMrgWV7wcUGK/VFeUZmpqq4xJej4SLIWSlpSIbGjgm6KBJE6eGgxVo/TSzRUFDU2NbeYEvRpUT39OCE7h9sKpJVHBblU8x0hh0a0tVd0dFZ1dfcYFrRCgp6sy6QRCeb0liNBligQwoXndSxEb19FPxtoHhwyJDg8goy6lAofNxyH7mUk6Ftqy5Eg1pJ6zoix8YnJKTY90z07ZzokQvepVa5xyg0mRs6hQ4KIpdJDzC8s9hXCtXRwaXnFtGDeX9MCHryNkaD6Oh4VrBcYFGJ1bXxdXjc2Z7e2jQjWlyk8lAC4q1v6+IgEVSjCgjmBJJlmZ3dvcR+rg6XDo2MzIaG6LGhaS/3zSTAIBaaJFrhePkuxgJPTtbOgPL+4vDIqWKYap1CGUhoPCbIUPBBaEM+SWu4Livv1ze7eLVPc3R89PBoQ1MvDW9UMetifpF1OgtKJBFPBCWIJPdHs6fn0hWleLx/eDAi6tgK6iYQ2COOQIBBHQT0iNb85HbD3j2fYg30VcBY3D8IefPj8MprieNAsikeC2sbTAXboRJG5+v54Pl0bn5BncVf37MXlw8/vPwrWkUdBXQrXrVZEKZDa8DDFyLAO92r0RCmA6/8rr0iFhKCWNjAEgWmwsmq0RY0XjDpw1IGjDhx14KAfwBz0Q8CDfhB90E9DAACtALoxSNWoNwAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAYAAACZvCZrAAAFLElEQVR4Ae3aBWwcRxTG8QjKQqsUEtOJpTJzw+U2zMmGmZlJVIYwYznMya0ZjslU58Jo2Nu43L7Os2ej7eiMMt+30s8ws+a7f2Zn044PIrpbeFDonPAA4EHhbnsceDBJeEC4P2EBwAOyBZ0rIiFrkWSdAAAgm/BgO1kKdeUAAFhJdJaBUCYBABAIAKhzIAAAEAgAQCAAAIEAAAQCABAIAEAg8tcEHIExrqhPc/ui26Pt78wBAAIRmRXs4h3pIe9wH3lGBLa30V80AAJx6aszT0dXHFt+bslxZ+H841Q49xTlzzpDeTOcFJmWHM2dlr4/PD1zBq8a7qwgluU7vMP95B4cINfAMLlGFfbm8QbmELoIVa1Q2qvzANCAgbjyyekuRYuPUNHCY1Q4/wQVzLHioFNkajKFJ6dRaEI6BcdlkX9MDvlHe5zBCcGR/LHuoSE9R8Qhu18eZfYuKIuuvdnQT9QVVHl0qWK+izoP0IAQiPOrTmpFC49TwTyOw2nKm3mW8qaLOExJqYhDcEKGiEO2CEMO+TQ3eYd7yTMsQK7BQZ9reO7MrL4ch0JKf7+I0j88vx+BgDYGlxiFi07PLFygr8ifp888tyKzS8ESV5eCha4ukRkuLTzR9YV/tMvvG+khD8dhqIjDoBDl9I9QVp98yvyI43CO0t45Tym9LlJG72saAgEJBpuUvOfg00IrcgaGjOz+uZRZEYdfKO09jsMFSu51iZJ7XKWzXa6VucbecrSAQIwU9gtOYXu8c+TYcuV8thz7GoBA1ENgftSR1a/gQMaHHIcopb4t4tDzEundOQ7X6czrt4SSA80YiPaCT46fF3T5mo/98T6/7Xxd4iMqPI0HGyR8IMx9W3sbO74pMw/+UOt/+dP7np+Z+vZFEYfLIg7X6OyblXE49UoJnXzJoAYOhE9wxuGLEwinHFPvqsyU4yvifH6/YP/ZOQyG/Fx4wAECEdvxDZk719bpCZH24TVN78ZxuEGnXyumUy+X0skXY3TipdsNvYLwC3ocfiUQDiUCqgNCWQ0rFHUOqwjAJYa5Y+15EQiK7V6/oi4fl/xOsXb6NV41lJKza7l2ppvZO7yC2jfTJUbvGs6fqczLz48N0LgAgeDLitjezSPN3eu/4FUEu/3Tzjo9KU6/VrrjxAsmnXih/EAz3+acWcP5vesRCA0POEjcQFgrB46DZefasl/376n10ppXDMeeLT9/9KnfKX3gH45mDEQXZf9B9YWcdyifv31NMQFIvEDk6O1tYVCVmfs2abVeRfT4q8vhx/887xxIzRkIdl6Iqk96+X6ZoKufv4o9C6dg4HYnJPQKIrZjrd+KgrqS4PfN3es+55DU5XM2cyB6225TjpRzM2QcDOFp9fPbboF+JDnl2Ew82CChA8GXEhyD6vAt0NiejTN4v6IVBMIa99P/D12Jg/r5z9vONay9BwDc5ty7cYUSBUNZSdjfdpp7NnzOG5vGd9u6sPLvxNt7NizncQ5JC/pFta8yLvE3KR3S/QAIhE1sp7zUkMx9WzTewJTv14m1wdmiKYEAQCBquNSwrxSMnet28DhvVJoyHvb5qt43dnxt8KVIGwoEAALBYns3zLQ/4dX/L1Exv3PdAXVlwe/zOM+3ojgwzbqrAYBA1IK5a50uVwa2SwUAQCDkSqFyRbDWj180AAIBAAgEACAQANDwEAgAQCAAAIEAAATiAdsgAMADViAeFJKsCQAA2YQHORB3cynkAFYSAFg5JMkm3N2ODxmJB3kQABLeg1Yc/gOptOvB5Z4VkgAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/Hop.4b77c9e3.svg\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/Hop_dark.423942af.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAABmFBMVEUAAAD///////////////////////+PcOZ/UON5R+KNT+iFQeWSYOi4hfWIP+aRP+iIP+WUP+ibPeqSPOiiauz///////////////95VON4U+O3N/C1LO9+WOL///////9yS+F4SeO/JvK+IvF4SOP///////////////9+WOWHVeXRQPbKHvTRO/b///////////+pOOyxKu6+KfG7JvCxKu+wRPH///////////////////////////////////+qL+21J+/CIvLTS/PCIPK2J++sMuz///////////+eT+2iOOu3QfG8MPDNQPbUH/beGff1Zv/gGPjVIfXNNvS+MvOiNuv///////96SOKHQeaZQ+noMvrvDfv3A/3vC/vmRPmHP+V6R+J7SOKIQuaXQefvDfz3Bf2ZQeehNuuzPu27MPDUHfbeG/fTIfWiNuurMuy2J/DBIPGtQO2wKu68KPGwKe7NKvXKHvR3SOJ4SOJ3UuK/SfG0Ku+7QfF7V+OUPuidPeqIQOaRPueQP+eQT+iFQOV6R+MNOs0rAAAAhnRSTlMABhQdEgsKKXb/V/84Gf+z/7OF4SkpZYRWdnVmwVeT////wv//lIU4s1dXOMI44MLSdv+U0v9H4dFHV6PBGbJ10v/gKf//o/DxZkekR3Y4lIUZk4VHZrN2pPHwdjiz/8Ip8fDS4Xaz4XazV3WUhYWkpP//V/+z/2bB//+FOMJHZrKF/8KzVzMrutwAAANDSURBVHgB7NDFAQRBCERRfHxa8091PYK9Ur8Fzo+IRdMnTMRqHslzUyaxQGFC6oHClfQ90f8QgAAEIACxAOLTuq2AeLcfOyDO67dcZ2qI8y6/rdQzM8TV+m/rYz65LYvt9nkgju7mDWSXp2Q5JdsfxkqscmunzMzMzPjqf4+isrv3iQq6yZzfQlf4W5gZZhkrYRHlFRoqqyo1VVckZGuQmlm6ImrrNNQ31GtqrP0ZtZDbYGeQl6yIpmYNLa1tmpqbfkYdV3WeU9JnxF9//6Pp3//+T45mfdUJDsJkRDkTmMlEPjClqhj59g4iYcqOIK8QmBnkDSiW24MalnoRnV3dPQp6evv6k6MW5mWRBFrUOdmY8ui6GMYF6ccUhQyAox+5HvoSwMYsEaiy50ZYSLeIgcGh4ZHRMYDxicmp6aGZgaSodBHbDUmYdYAGOQsCURBxGn4OgEUZIk+SrTmAjEcrhypBJADkHLIUi5hfWFT90vLK6pqixfWNpLCYi1AtiwINzUL2tjZcF8C2iTIOiWCEcxgXHEk5pqyRzGguxSI2t7aLInZ2d5YU7W1tQnKz52jJS5p4x6NpL7yJANNH9H0E4BFQy6GI/8J8hw1quwTUQjfdW2P/4HDq6Bhg/Phk6vDgNGlrSCFVP0urYQ6ZmmOB4k2EhXOcW1kSoU9VqjHuIgaStourWiblh+XZ+YU+LC/Oz5LXAs7q8c2qDxayLyL0JiERqI0x0EtjDgooFNss5SIur641Xd9cJkcjX1LH1ZA8h3bGFxE8BhYqEVxfKhBliHwXZBQULfIUi6hu1nB7d6upufpnNIehWWa2ozruCoizX0W4oSGMMFIisEYYvjpQYxI1WKBAYIiO0JNpfmLf/3hiP9QmZIWLiBGXxDJC9lWEpKrFkdFFmkXM5qjCI4ooj/F3OCfT/I54fNTw9Pyi6fXxl0vjnRwvwRT9K54R7H3EjL2T/WdDoRve0AhlNTbwEmGOJZ42opr8UB6YaWqGslqaCA7MqFuLuxuw4QmIkTJUJ2ruoYEns3vqD/XB29a2VjA9OpzfPjqcPzrBgxWMBsRoQIwGxGhAjAYEK4geXUwGXV44urwQuuB0dMEpdAny6BJkAMRHfxzYlb9eAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/Synapse.3cfd1d07.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAAAn1BMVEUAAAD////////////////////////1vjzzuzPzui/yvDTyujD////////////////2xE3/////////////////1nrzuzH////////////////zvTb1wELzvDL0wEbyvDb////////////////////////0uzDzuzHzuy/////////////////////////////0vDLyujD////////1wD3k7xDPAAAANXRSTlMABhQdEgsKZqT/o/EpRzgZOIX/wcIZ0nbx4JSEScJFiVeEk6NlsvbR8vDS4dFmpLPB8FZ1ZcrSjpcAAAKDSURBVHgB7NABAcBQFAFAD/SPvPX4LsIBRz2PB5ycPi7Wge7UhNJpBHV+i1jEIr527aipUR8IAPjTP4KSpGxigaoK0P49AFDv7vt/ttvNmpnrVfrgE7TZmcBOlIf8Jlkk5hsQNwHCRRTfBgjnEKNEgCAHkrhyCHJgieuGYAeWuGYIdri7uTsjkUgKRamW6kIh2GEjNmckUnBh0ECCvUyI+y07CJbY3n8NkUkps7wQQtndRUKQBDuQxIwDQki67UBdao14eESJpw1ebpFg84SX55dZiJJulWtJbWopKGRtqoTqSJXIxlSaOxtTl8LF/mDqZOkQD/H/jzwtXuNXngzPP+KXOYhDroWAFNuh7WwONNQGOttTJqEBa6HVrrPHzgYzPbifj0uGIIeYJdAhZgl0iE8lUhiMMUWOHAxBF91bGv6EfbaljLQUpK6kYOdIwzf0jJ5ArgRiy3VyHqKz1vZQe4iee+nFqt2YE4RwVdSiTmEFxbRjF4z8bS1LY8sO55fG6BCoTR5ClAeAwoBEiPETQvPoKTIYDEVbrKFYvlOxjKhYvp8vlqKzBMGNIUqwaZp2DkIyhJ8GfipxLByC68PH5+vzg+vEPIQ9gbAdZdkRhOBFIpRCp9KnS4egOkkS5MAVcx5CwXQCMVA2HENMrXuftpPQueEH01X8iU0S7BBHMzOiqaqqafPkGIJaJX8aOIZI8vaX3Bf02yOYvdy3vV48hJf47R3mvzXyt0T8CyF2AGAzGP+GEMpSr1sOZY/ppFf2GR6Jb4T6cpRS+NBqdRszUdiq8w5h89Y7hO18cggQ4R88sxEgAkSACBABIkD855JwmCwcL+Tjhf7AaThwGo4g8xHkP7gaLtKObnJaAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/btn_big_arbitrum.ff6ad480.png\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAf8AAAB/CAMAAADW6DvgAAABF1BMVEUbIDIeITUbHDAXGCwhGi2HLjhhJjNhJzNOIzJPIzI8HzBYJjNrKDRqKDRYJTM7Hy+QMDhGITGsNTwqHC51KjWaMTqPMDkzHi8eIDYbHDBFITB0KjYeITaiMzt+LDceITajMzt9LDdCIDCZMTo4HzA+IDBLKDmBMT15LzuuOD+TND05JjhRIzJyKjVwKjU2Hi+RMDgyHi8oIzdSIzJUKTp7LDYjGy5PJDKeMjuELThAIDBjJjSbMjqKLzg5HzBUJDJ5LDYlGy5hJzSSMDkfGSxqKDUpHC5EITEnGy5VJDMcGS02HS9DIDFAIDFFITFDIDAsHC4eITYcHzMaGy8TFiMeITUAAAASFiIcHzJlLDowJDduLjpCJjgHX8VeAAAAWXRSTlM4+O////////////////////////////+18P//+f/////////////////////////////////////////////////////////////////////6vvJR+SRTwHfs7R4AAA1sSURBVHgB7d2Hmuo6lgVgute2jKRNkLYoTcPgQ01NzjnnnKdzvO//HAOc2+jjkGRjwFT5vzmHtSwkWTaDwTe+iZOowJYqkY2GWhP2KIMvkLGsRuMJnf9Hm6lDiwq/UeBGRDOPBfUwGgh+bfZCuEY08ZvfGPzCt3Ca1vhMOCLL3DrCl5zBUWLUyRZYBVpMI54i/yRa5iHdOn+wnzmYqcGVvjX4xcx/OWszwldacIQxOCM6xVwOJ0gAWr6Uy4rQKpvyv6WoeDRHJoUrKEW4zuATTiOFrawhIFobT/4hJOdbELFFL36N0C6aeu9XEXdgFJcTXCYa1xB2N8zfCoCsISAq5doouXFKcTmfvPgNg5aRVZZwJ+SUGkecZwyuY4LcLH/GPlERR8hY6TYHOXKV31J4dqKVGgpOU4RrqZJuk390+JJTdBB+sNT6JCfl//zEspoTjmNcT8IQtChepeX8FQ4RGyQ0rlhuMMkhv7ESvBfR8miCI1SLE1tvkO+XLuZPFse4INiiYQjmJpPcuJxN1/E7vCtGqcMpYWhzZfvSav5acJRUJUDD10ITcIv8zcwCxuD9Icf7U8KocA2aTCbjclS8+c+Q7Zd/JeVfOzR+e5kpQdJq/noa8Y6R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\"","export default __webpack_public_path__ + \"static/media/btn_big_bsc.5e5ec82b.png\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/btn_big_purchasegmx.86c08dee.svg\";","export default __webpack_public_path__ + \"static/media/buy_gmx.01459500.svg\";","export default __webpack_public_path__ + \"static/media/buy_gmx_bond.ed3174dc.svg\";","export default __webpack_public_path__ + \"static/media/buy_transfer_eth.373e200e.svg\";","export default __webpack_public_path__ + \"static/media/coinbaseWallet.ae86a337.png\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/cross.2c9772ea.svg\";","export default __webpack_public_path__ + \"static/media/chevron-down.88670207.svg\";","export default __webpack_public_path__ + \"static/media/chevron-down_sm.697f08ea.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHjSURBVHgBfVO/a1NRFP7Ova8NQYkZigSDJbqJQh4Ogk4NiqIuCiJuDZgOQhGKk1P9C1Tq4KJQR12yiRWkg4ODg3EQp7ahpTSUQtMftE2bvNN7zstLXtMfH7x3f5zznXO+c+8l9GB7IlsEYZgBn8BpBtUJqFjCZP/o4qe4L3VI7zM5apkyM3wcjyq8oJB8VqvKwkRENM10L9EMXEbfvY8w2ev6Oaif+kdk2VBDG/bSYySefEffrTe69q69iMfMUZPK6tfWWIxbeeUfTOYqzGAB2FoGDVyBHRwCNhbAqzOiNjN+P1U10pyjxFF/Sse9r0+x+/k2kDgD7+bbjr3FQdELu3oEOXsD3FiHzZd0pEQKvL7QrQ7kGzmOXqI0SpyDuW9K9PyRsIofY93gQNrIOcaJ9uIdWL8Ulvb/C1p/P2C3/Ci05UuxzKh7hKDi4gx1IrqsxpUskC5LqZQ6HxpdFd3MXLEv754mQ/Qg2gwWf2m3ldBYA5066wLMOwlTaP1+7cpptNn8Snu18+7cH2lcR7O7EKLZ5kew93Ncgx0AczX5fOmCp/Nm8BCWpkGUi7Kr5tkpHIIjunMqaBL5Jcdq4YYYToDoFD/1R+xhRNicyBQt0TAz+URIu/teJ3Ik4snkaO3Aq9oHE/y09owWmgYAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGoSURBVHgBpVM7SwNBEJ7ZXHwSH6CFlQG1sPMB5hAUrQQro8ZgpWCpkNhZCLn8ApPCTrC0CDGpUvpsYoQQLSysoq2CSKIhJHfj7pm73AmagB8szDc3s/PNzB7CD5QSsps0ChDBEqdu3UmQA0Y5xli43ZvOW+PRSopxTxAJDuAPaERhly+jGJwZxkdMVhol6wmIoUJsSrEpKMblTSQ6FrZjcBFY34S96ksW1OeUzaeq5O3yZ5LsWwaFzAoiuVIA9SllHkf/OLQtxAE7BswLJAl1tViIyXMM6dz44JzcB+01qydaIQ37wTEwA+XrnboyUufxM+EJkAoR4WidPeQKxqERSqfTRv9Bia+sx1hG+Wr7VwVGgcrDkckJqef/CtQq3vEZNFQgDa8B8gFX0numD5mWYy5f+oLbeWswOl36xMVh/RPgHN0CacgP1fuINSzfvnx7KQlLBdp1ACaELaqLVUrdI2ak9v4I1bMNoEqx3j+QUmuj1ldcDvFnqkAzQFI6VzJh2wXNXiIG17F6E7VwO95OZHeLU+MvE8c4Hau583zOyXIVo73r9r/xCzLjs4Txvi/RAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHoSURBVHgBfVPPaxNBFP7eTBI31Wr8RdpDYRURxUMCIogemoJnrUdva/QoWC9etN0kXgXJP6C5eRK8efHSkygICYq0IDR4MIm1ECGaNMnOczNpNrtT6INd9s1775vv+2aHYITjNmwB+RCMZT+195arIFQVvGKlOF8P91M4ybvNFbB4gYOCveLLZ/OFSSqC4dVWwRw+lZK4cTUZBSDp5lcbUYC8+8sBkWtu9uDOUVw8m0D6pNwH4jxtLU8ZMPYNX89aWJiL6e8rlyyzDCFIsxX33e0cpmYF1G8tHQ7yE8cEMucTJobtPGnkBAvOmJWbSzOQPuuNrQE+fumh+dvTUo7MRDz3e2Qmxh6lRhomkYgT4v5T2+zrvLfL2Nzpw0oQTh+X6PwbBr0MSsVIcpu9KWp/wPj2vQ9PAecW4nptOGT8/KPAKsqUwG3hKaqZEqxDhAt2HOufu9hpe0jNSixeTqLTjSIopqoWdXettUUgO1y8d3sW1/yT+FDb1azevO/gb5dD9Ln+qpQ+o4+RCY9MFq/fdfTuSYvw6WsvMrwnoKCNHL2q6883MouPR/91blIe+F79aI4NG7GIUAcXKqV0eexDKJy1bVf4RRwQCmqlUporBzzMBn0blXR9WVm/mB3rRZ0Yb5XwyuZt/A/V0KylFRZwagAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEHSURBVHgBjVMLEYQgEGUuAQ3EJNrACNLACEYwgjYwAhGwAZqAa8DxdsAB8Rx3Zt3Zx779gYyVIr0qr9arCxZ+zx5EeNWB8E9NiCuIhnP+RHThvEhARK21W9fVCSHcMAxumiay8JdlccaYmECnM1JmBNyJtZbsPM9pJ7QDFQFUQCAqNE1DGCx8yGUs8M6tOiklBXVdl83ati3hGCHB7cd/eOy/qiqy27Zl29z3nayvnMIc5G/0juMgW9d1RvaVsyRBvsXMcUF935OPljEzMPjXmWUElFLZdq+Cq0yWdr44DRAVcLc4xNLGcaQOcAYc56G6SfsXAC5tvX5hZwL2/Lb1HTEVyV7+VT9KbxPpO/XgrgAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFDSURBVHgBrZIxUoNQEIbfvkcVmxyBJmoSC3MDPIGWJmNBTgCeALhBPEGoJCVHwBNoJRgbvEGqjEXYdWHChHlA4Uz+hvfe/PuxO/uD6JH58D4cDC58Pt4jwjLbjJIuH3QXDlwA6RDRsGEMCyyCbDPOewE3T98WIq1LjugTUoACwxpUAa4fU1MpY81/tDSzz+YfCdITAE1oTnR4TqNJbJQ3KZXVLCYSCVGxbLQbThZfHgjpkqjGYpjh8DeWrQ4R/DS6vNNn/Xy9Cgo8zHR/C6AU5KJHOrQT8F+dHwBEZp+5zIj+ZugPKMifLrZmMzRauNoAxCJRSvHqhFXe2WLzau3pfLviHX8QoV9y6mIOz44Q4+P5JA6U3RGa03hVIa32v/uXPJ7tWoBa43nmggCnCeoIl+gFHLsxeQyPK2+RE5hFo7cu3x+G+J1ieOsLEAAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEuSURBVHgBlVO9UgJBDP6wszut7LxWG6mtHF9AHR8A3gB9Anpt7C3Aws5CZ9TKmbOhgzlooIKDBjoWKuhCQrif5ff4ZjJ7m82X5MvuAUsgojybx2ZIYRb7HDaBD102n7YjkLh1xIDSwU6wBzGEn9SYcPfTJsgJ2bNcZsKeDjf2rIlKVd63ubehnsXwDrh4dmV69QHgOsBoCvTGwN078PDD/n4yKitkxyKOJmo3ZyIKKF4DhUtN9Pirq8KRto3VdvGPWzR2m7LmP1jKE1HhOxIoletR1c8m8NXSyu6R+v47al0DnLIvk4nECfktIjuHGiQayzXgpcJJjoHbc6B0DzR4FhcnYXQ5vC7fuiqZ9tWrrnGb+h3MVQa7X5gkCvXHkDjXGjKle6L+CnEpSeq/agZ2kCMI5PSNywAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAI/SURBVHgBfVNNaFNBEJ7dF6sRUhJUqglK/KG8kEKF1tSCQiH1WEguHltvXgJG0iLtJcnFIFFsIR48xpteInpsAgpCTPRQpcHnXw1CA4KY0iCK5L11ZrfvNemhA8vb2flm9vtm9jHYY/qtatA0XTc4FzEQEKQzAbCGnzXOzaxxZ7LZi2e9Tmj+ddJi/D7sYwxE1shPZGyfOzcv1DJ2cuJKAGYvDTlJc5eHID5+FBQbliZsXwF9oX6NAgHfQSglR8BzSIPS25/4dclVXm9D5IwHY2EZI+xwqhZzCggGaXWzHyrrvyD3/Dt0/prSp7XZ/geLT75BpbEFD+bOKSkaSLZcT72ZomZFznrkLYVySwJyV0/DoFuTKzHtl2eF1U3MZBKHtwb1VHXKJbgYpSAdFl/9cHST5mjuPTLpwgVK2LEKyomGfVDf6IDg2igXgnkpQPoJbFthtSXpFq/rEDpx2DnfRgyxktIxlzMmtsghzdQwMgJ8aP2G2HIDEsXPOIXjToFBxGz/MVUfMJczy3xHTrnRhumwV92CgKWZU3Kc8fFj6O8yi474sJltuTfpcRn3Jl/gvln/2pENio+pec8+NFDWAIT8bslEvgd8GwHvgNSPAppf8pGXkrOwxE3GWWnx8QY8Qs2USNOgriu9TLEZOyILqxzISBk2teH5WpoxlqFkApPR7MmWZk6Cx+2C28/U+xBCZD7dncj2FegtAvualfyYv7hie2xvWE9Wg9YBLY2B86AWWdMS7KnW7a4Yy/1/43+jYdjzTW6D2QAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHYSURBVHgBlVM9SCNBFH4zu0rk7nSvuuO8g72zuas81MafQrEVRYuUatDeYONfkU0VtVDSC0HFysJYWigR/Cn9AdFGXDCYiEViUBR15jkz68ZNiIIfPN7bN+9973vDLIEimLGg8UQrghxIFyXElDmOaBOCiTLGo3ZgyvbWE+9H9cJEUCRCCGjAGyAMw8lAxHK/NTf4OT9mCbqICH3wHihprepsIbnVrUReQfXCeL9wMUX02YBfn76W7D2/zUDyJqtizp66U4HpuP5yFnKL/H/qYLi2vSTBzME6zBxuOEI0fVa4ODFj4/8fNdhzixq//VYmMfivWfm5423ldy/PlEH+PlibznRqAvJ88iiTUlZVXgH+mnqoLPfB3MkOVJb5IHmbLVDEdK1W58gN7/Tcw70ikF7i+uFOxdLkuSRcOz92FAAYupdRypNF/po61XiUuXBW+dukLlCSuM0SCJDVGWMJTdMKSNw9ww0doghhILEEpYCI+zQtX5Z4ZfBBiGY73RvZpM4uPAwfhNjfkl5pz61s2196mkWStHqL5GUun+7B1f1N0XRuXfRNRl+IXvFjcTREkFrvDM5yZFaqbyrqUVKI77ERk2h0iKJQQ8B0RoKNwOOc43y66G98Bj1CxfZyFDl9AAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAILSURBVHgBdVJNaBNBFP5msjFRobsVsRVtGEE9RVgFT0VIQS9ejBfFk6voRRA82aBoLkLoLacetZ4EDzYo2INCAtKDl2bxKBTWRDH4uyuIxmRnnDdN0iS07zLvvZnvvfd98xjG7NtMwYNilxljrlLK0WeoTz/BsTTZKD0efsv6zk8xL2SXLyvAxTbGGAKekHOTwUIwABtgzKtKQVAcyTaacajPv8gmp2Hz1JYFLEoMA5/8fodfqg3oxMfd/3D362uc3XkUtydOGTC9kx2+rN3jrMfxEV28/PMeGcvBK7eD04UryOVyBlCr1fD25iKuhYcHE2gNPIvE6SeacYTWyT14sDKiiykiXgg8PXcPF37MmFws4XFNwgi02v5gOp8p3dhSLCEE0ldnERGlDXN1Z+WQN8HSJhMEAcrlMlzXRaVSQT6fHynS7Eawk/vIdSzdOaQCGcs2VWnEMAzhOI7x+3EURajX6+YHehZSZ59o2TyNS7uOwfd9eJ5nbse7rr9Zw2wq04uUz6VSA3Wyepz712+Z0ceNik49W99MKLZkluT7wTt1BeWeaC2ioTmROMVi0fAmqz5fQerhGi7GR3pABHs/lQ4Z8OfpeZFM8KreN7Habox0tFkK2R1TQx0RdGI5t7+1EAx2e7gAtjG9XX43lucJSDEbf/DlQMHjDHpxuJ6ZvlH/BqRPHPWoI9vzH5xq3+2NFxVlAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/icon_arrow.59b289c0.svg\";","export default __webpack_public_path__ + \"static/media/icon_check.a37b7ce5.svg\";","export default __webpack_public_path__ + \"static/media/icon_close.9972202b.svg\";","export default __webpack_public_path__ + \"static/media/icon_close_sm.be2b83ff.svg\";","export default __webpack_public_path__ + \"static/media/icon_close_toast.d527cc94.svg\";","export default __webpack_public_path__ + \"static/media/lock.3a55a760.svg\";","export default __webpack_public_path__ + \"static/media/flag_en.c92a8361.svg\";","export default __webpack_public_path__ + \"static/media/flag_es.4ba7dfef.svg\";","export default __webpack_public_path__ + \"static/media/flag_fr.589da1a2.svg\";","export default __webpack_public_path__ + \"static/media/flag_ja.81aa61af.svg\";","export default __webpack_public_path__ + \"static/media/flag_ko.97c8fe63.svg\";","export default __webpack_public_path__ + \"static/media/flag_ru.0c71e16b.svg\";","export default __webpack_public_path__ + \"static/media/flag_zh.fd0e8daf.svg\";","export default __webpack_public_path__ + \"static/media/glp_icon.ef02d046.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABPCAQAAAC3gKgqAAADyUlEQVR4Ae3BfWhVdQDH4e/Z3Uvb2lZukS5sOEI3UHS95xbBqg2iQmcvpCRZZClYkBoWaAvpD0ncHxVCFjE0iyE6eyFqK6K3RRTaiy1ptaXljDnL29h2t7v7iZGeTuuen9vd7r3nynke+Xw+n8/n800EWToXUMKrVCnVkcELwPsUKbWxlH5GbcZS6mI23/OPk9QqVZHNTv7VxiVKTawkhFMDAaUeKujkv4LUKdWQTzP/9zWlSi2sI0w0O8hU6qCSbqIbYLlSBYW04O4w5UoFWNQTwWQ3OfI+aujFbIhV8jqKaePsuqiQlxGggfHZT768iyX8xfiMsF5eRSnfMn7dVMmLyOJlJqaFafIe7mOQiYnwFJa8hXl0MHG91MhLyKWJ2LRRLO/gEYaJ1TYC8gau5iixC7JIXsAFvI1ZK3sxOcAsJR9PEMGki/mUcBCTF8lUcnEDv2MyxCpJoo4g7vpZqmTiIj7EbDc5kkSABkzaKVOykMYzmP1AuU6jmM8x2UW2koNb+AOTAe6VA7WcxN0QDysZmMkXmO0gUw5YbMakkwVKNNJ5DrODzNIYFPEBJs3kKbG4iz5MgixWFFzPcdyFeUyJxGV8h9lWAoqKxxnB3TEWKlE4j0bMPmOGbAQIyEYBb2DSQqESg/sZxKSXm+XAA6yWA1fQhbsIm5QIzOMnzOqxZKOCI3RzrRxYzRDuTnCj4o3z2YNZC4Wykc9+Rr3LNNnI4TVMPmGG4otHCWNyjIVyYB1hRkXYKAfKOYzJs6QpfriGXzEJs1YOVNLNGT1Uy4HlDODuFLcrXriQdzDbR55sFNKK00dcLBtZvITJV5QoPthIBJOfmS8bFk8z1hbSZKOUbzDZTqamHtX0YBLiQTlQQy9j/cmtcuAO+nDXzzJNNabzMWaNZMtGMW1E8yUzZSOdBkzaKdNUIo0tmB1itmwE2Iab58mQjWLaMNlJtqYOt3EKkyB3yoHFBHHTx91yoJZe3IV4SONi6awo0V5dLpNf1KiQLI1C6bpHZXJ3SIusDp2GpXo9qXS56VKddUCTRwbbmWqvkCUbRbRiso88TR7L6GeqDbJCDlRxHHdh1mqymEM78dDBXDmwgRHc/cZ1mgyy2UW8NJErGwW8icl7FCp2rCREvAyzRg5cyRHcRdikWLGATuLpKFfJgTUM4+4ENykW5NNMvL1FgWzk0oTJp0zXxLGeMPE2wgY5MJcfMdlKQBNDJT0kQi/VcmAFIdz1s0Qu0hVdjpoV0fhZik1Al2JZ6IzXVag5iii6dOXKq7Dk8/l8Pp/Pd676GwYUP6Kwt1/bAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/gmx-logo-final-white.b7833ed6.png\";","export default __webpack_public_path__ + \"static/media/gmx-logo-final.0b59e423.png\";","export default __webpack_public_path__ + \"static/media/gmx-logo-glow.83c5aea5.png\";","export default __webpack_public_path__ + \"static/media/gmx_logo.2b33868e.svg\";","export default __webpack_public_path__ + \"static/media/graphite-01.6f3526cd.png\";","export default __webpack_public_path__ + \"static/media/ic-communityproject.9b5f97dd.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_16.f4c1a9fe.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_96.b12913b6.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_hover_16.d779b479.svg\";","export default __webpack_public_path__ + \"static/media/ic_arrowleft16.21502a04.svg\";","export default __webpack_public_path__ + \"static/media/ic_arrowright16.b425521a.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_16.90aca01d.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_96.b6255c50.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_30.403cd87e.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_40.ba220dde.svg\";","export default __webpack_public_path__ + \"static/media/ic_banxa.06412144.svg\";","export default __webpack_public_path__ + \"static/media/ic_binance_logo.46794a16.svg\";","export default __webpack_public_path__ + \"static/media/ic_bsc.8de996f1.svg\";","export default __webpack_public_path__ + \"static/media/ic_bsc_96.369f1d28.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc.b_40.1560513c.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_40.1560513c.svg\";","export default __webpack_public_path__ + \"static/media/ic_buy_glp.8eb00e6a.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAsCAYAAAAq/ZsdAAAFI0lEQVR4Ac1ZA5AsSRCd2FkMvm2cbdu2bdu2bdt3obN9X6tGrW3vxv6x509e5dwtukZdXYt5EW9ZNf1eZFZmVbVJL8yyfJpZlT2UYIw4VzrVlC3IJXINChNhriLXZJOh56gon4Ahbw5RHs8SO+JRwrmmbEMuIfuYiRzgNYNzcK4pG5Gryk9j+vCkGs7JGgOiqYdjj7MEzj/OErrfCHHuBBiS9slR5XpMpXTEMZtf037hcdYgiPAEe3gHU7bghBkw43hrsNWoGZw77iLNqnqWWVW+yVElNR1xDG2mZ51gCRxg1BDOHT8nkrQFFfgLpVvP+rmorRUe6ekJPtrTU3P6Lt7PDRh6Ydy85CjSlVRkxKxIusr2TrXVMBq3NnVtOGq2b5An1TBdxyfFiPwRFbmep/cc1FCvMfRgTzfY/yqLzP6iehJTTVEW5SqyRA3FU0zUEP7dUkRiW13W0X3EIu/Tx9kCDyTjsZbABWNvRi1ckUuUOr0phpxdTuDGzg742+MG4vdrDLWEQvG/v9DfB4c01ofiG9WysiWmCUF5+cxcVaniMYNrxhGNgl6scnpg578anbsfMHgKjcj+oznmfcesyKuoyCC/GT784vDBwnfqk66hY63Bv+g6WiFuRpVf5dyrwT8eD/DCR/3fWBeDZauaYaMHW1IVBwfl9SLV7HTeUylGJxnQ5Cq3B9a4fEA8G6CSeu4Pac2cQP7jrNXVsOPpPelK+Ff8JbyoaBoVOMBbzW6iRYAFVjhrURmsLGxFwRre0xiDy6q1fzuAeKGgSIVDNvKkK+Uq19rKJdKLQzsAHmI5ZmEpIbBVcReK1c0tV3fB8kebMvUnB5rS1W+ouBgl8PKk5iZg8fWAH0Vy07a6DPbbySFsCrc193JFh+k9qVDkBHixnUmxNNx6VTesvL8ZRYuZov2mnREqnHYsmv0A3/ZriwHLw0kILOuI3o2rioUi6WFtqLKJ8Pv1LtCLCk9qYzP/qYZdj+7Xu4H9KjHdiHIP00S5iUVgb+KCL3rjJVkXvNHkppaXtsCOp/bqPmIcawudwDRS5S9RMxutaxsWdHZFDN7tikGxEzKiLwQJhrYhPbDpg208Z6YWxpD0i4ihXMojSChB2JC5x1ti8OfgUFNNxEvt2jl7Egcs+LSexxBoduc0Ql4RQxsVtukuy9hUGWAkNWMOI0GYsqacwxATJbMitxk1YysqgwOJl6fX4BZIA/ydHTPr92o4YoEPhXKvJUy5P40amlZUmZBij7XEv6dMQW80s6Gt3u3kv1CxhT4wIUQu4Dcr7dCIbfYPVTAszYnEIsAAK6PGzFEkPNSLeOkYMvS3ETP2deWwB3GwZriPEGw0dyODsPDdeqNXXiv+v2OTndxbnj9rYC/iRBHxMs2PxAqHnLu6DnY5vk/sDo8K/I23uVpKCRxJwsNCvhvgiUxyM5uXdMKitxoMmUHiBYspDlWdkavIMs8WaObq6gRBuAnFNYELvYVJQexD+HeMJptmx5Eobc6tMPeLWjhyrk/IEHNiVd5BU3qiNefvGq6ewy7+Y6kJPNhtWdIFtnVlsNFDicdwYUOIPEJ2zFXjrx8bKMO5RC5KGqFfqwzdyyE3+bQN8ktVmPldNWxyeyvsv71T2AxS6D4PK0q6D79+d22N/vyRqIBYjionAvohf6d7wIuXReJGkGcuGF8zqMWYCzZKlqBTTIg4UcNQdISBR2GBF1rCxGejhjF/S4cVhj9aYlHBZ/Lf1/Gn4QFxc+PIdK9a/gVaRiAcqhHzNAAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/ic_cash.21569a1d.svg\";","export default __webpack_public_path__ + \"static/media/ic_checked.b4f2217c.svg\";","export default __webpack_public_path__ + \"static/media/ic_coingecko_16.ef20d202.svg\";","export default __webpack_public_path__ + \"static/media/ic_coingecko_hover_16.ef20d202.svg\";","export default __webpack_public_path__ + \"static/media/ic_convert_down.74b7eb02.svg\";","export default __webpack_public_path__ + \"static/media/ic_copy_16.fafdf331.svg\";","export default __webpack_public_path__ + \"static/media/ic_cost.56371371.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_40.6f901476.svg\";","export default __webpack_public_path__ + \"static/media/ic_discord.be4d716c.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_40.5e255508.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_40.1e127166.svg\";","export default __webpack_public_path__ + \"static/media/ic_github.dbd4de8a.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_40.087335c1.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_custom.11dd75db.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx.bf8fb0b1.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_30.375de394.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_40.8cd483b1.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_64.f4caeaad.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_arbitrum.59f04e87.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_avax.fb50658c.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_big.a0a74216.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_custom.fd35b66a.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_footer.e7821eb2.svg\";","export default __webpack_public_path__ + \"static/media/ic_hop.0f4a98a0.svg\";","export default __webpack_public_path__ + \"static/media/ic_info.f334ee0a.svg\";","export default __webpack_public_path__ + \"static/media/ic_language24.ceaebef6.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_40.4bb3a048.svg\";","export default __webpack_public_path__ + \"static/media/ic_liquidity.f00d35e4.svg\";","export default __webpack_public_path__ + \"static/media/ic_medium.f6051b2e.svg\";","export default __webpack_public_path__ + \"static/media/ic_menu_dots.87c2cfaa.svg\";","export default __webpack_public_path__ + \"static/media/ic_metamask_16.aa3dce32.svg\";","export default __webpack_public_path__ + \"static/media/ic_metamask_hover_16.aa3dce32.svg\";","export default __webpack_public_path__ + \"static/media/ic_mim_40.42c8b575.svg\";","export default __webpack_public_path__ + \"static/media/ic_multiswap.e577f4fa.svg\";","export default __webpack_public_path__ + \"static/media/ic_new_link_16.5b7cb7bf.svg\";","export default __webpack_public_path__ + \"static/media/ic_olympus.70b17676.svg\";","export default __webpack_public_path__ + \"static/media/ic_olympus_arbitrum.b358dc93.svg\";","export default __webpack_public_path__ + \"static/media/ic_selector_dropdowns.aaf0b8f0.svg\";","export default __webpack_public_path__ + \"static/media/ic_settings_16.9d97766b.svg\";","export default __webpack_public_path__ + \"static/media/ic_sign in_16.b6f5b1d9.svg\";","export default __webpack_public_path__ + \"static/media/ic_sign_out_16.1b0564f3.svg\";","export default __webpack_public_path__ + \"static/media/ic_simpleswaps.4cd51f2a.svg\";","export default __webpack_public_path__ + \"static/media/ic_stats.f0a18011.svg\";","export default __webpack_public_path__ + \"static/media/ic_stats_big.4a4ebfb7.svg\";","export default __webpack_public_path__ + \"static/media/ic_synapse.b100121a.svg\";","export default __webpack_public_path__ + \"static/media/ic_telegram.af1a4a66.svg\";","export default __webpack_public_path__ + \"static/media/ic_tokens.6a27251b.svg\";","export default __webpack_public_path__ + \"static/media/ic_totaluser.e274ef10.svg\";","export default __webpack_public_path__ + \"static/media/ic_trading.2c53815a.svg\";","export default __webpack_public_path__ + \"static/media/ic_transfer_avax.53893264.svg\";","export default __webpack_public_path__ + \"static/media/ic_twitter.9f35b403.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_40.efe1f12f.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc.e_40.27f415ba.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_40.27f415ba.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_40.e357d24a.svg\";","export default __webpack_public_path__ + \"static/media/ic_wavax_40.ba36eda4.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_40.334ca16a.svg\";","export default __webpack_public_path__ + \"static/media/lg_arbitrum.bdf133fe.svg\";","export default __webpack_public_path__ + \"static/media/logo_GMX.b956aa96.svg\";","export default __webpack_public_path__ + \"static/media/logo_GMX_small.f593fa5c.svg\";","export default __webpack_public_path__ + \"static/media/long.0bc4a064.svg\";","export default __webpack_public_path__ + \"static/media/metamask-text.2f9c2df2.svg\";","export default __webpack_public_path__ + \"static/media/metamask.4b5d438a.png\";","export default __webpack_public_path__ + \"static/media/page-not-found.bb90d073.svg\";","export default __webpack_public_path__ + \"static/media/short.1f94a0c2.svg\";","export default __webpack_public_path__ + \"static/media/trading.7ea1604c.jpg\";","export default __webpack_public_path__ + \"static/media/wallet-connect-text.78166b41.svg\";","export default __webpack_public_path__ + \"static/media/walletconnect-circle-blue.31c29967.svg\";","export default __webpack_public_path__ + \"static/media/wave-01.3c9bce1e.png\";","export default __webpack_public_path__ + \"static/media/wave-02.4a56e8c7.png\";","var map = {\n\t\"./ic_arbitrum_24.svg\": 322,\n\t\"./ic_avalanche_24.svg\": 323,\n\t\"./ic_avax_24.svg\": 324,\n\t\"./ic_btc.b_24.svg\": 325,\n\t\"./ic_btc_24.svg\": 326,\n\t\"./ic_busd_24.svg\": 327,\n\t\"./ic_dai_24.svg\": 328,\n\t\"./ic_eth_24.svg\": 329,\n\t\"./ic_frax_24.svg\": 330,\n\t\"./ic_glp_24.svg\": 331,\n\t\"./ic_gmx_24.svg\": 332,\n\t\"./ic_link_24.svg\": 333,\n\t\"./ic_mim_24.svg\": 334,\n\t\"./ic_settings_24.svg\": 335,\n\t\"./ic_tether_24.svg\": 336,\n\t\"./ic_uni_24.svg\": 337,\n\t\"./ic_usdc.e_24.svg\": 338,\n\t\"./ic_usdc_24.svg\": 339,\n\t\"./ic_usdt_24.svg\": 340,\n\t\"./ic_wallet_24.svg\": 341,\n\t\"./ic_wavax_24.svg\": 342,\n\t\"./ic_weth_24.svg\": 343\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 748;","export default __webpack_public_path__ + \"static/media/icon-GNS_v2.43bcc479.svg\";","export default __webpack_public_path__ + \"static/media/icon-Hegic.548cf977.svg\";","export default __webpack_public_path__ + \"static/media/icon-Lyra.e63606a9.svg\";","export default __webpack_public_path__ + \"static/media/icon-Premia.edf430d0.svg\";","export default __webpack_public_path__ + \"static/media/icon-WBTC.a98dae38.svg\";","export default __webpack_public_path__ + \"static/media/icon-dollar.c1bac52e.svg\";","export default __webpack_public_path__ + \"static/media/icon-down.5f041f55.svg\";","export default __webpack_public_path__ + \"static/media/icon-hint.1458d991.svg\";","export default __webpack_public_path__ + \"static/media/icon-repay.78acc3e0.svg\";","export default __webpack_public_path__ + \"static/media/icon-sort.ee46ea33.svg\";","export default __webpack_public_path__ + \"static/media/icon-usdc.ac0408a8.svg\";","export default __webpack_public_path__ + \"static/media/icon-user.346ff90d.svg\";","var map = {\n\t\"./Anyswap.png\": 793,\n\t\"./Anyswap.svg\": 794,\n\t\"./Artwork.svg\": 795,\n\t\"./Artwork_gmx.svg\": 796,\n\t\"./Banxa.png\": 797,\n\t\"./DROP_DOWN.svg\": 276,\n\t\"./Hop.png\": 798,\n\t\"./Hop.svg\": 799,\n\t\"./Hop_dark.png\": 800,\n\t\"./Hop_dark.svg\": 801,\n\t\"./Synapse.png\": 802,\n\t\"./Synapse.svg\": 803,\n\t\"./binance.png\": 804,\n\t\"./bscscan.png\": 805,\n\t\"./btn_big_arbitrum.png\": 806,\n\t\"./btn_big_avalanche.png\": 807,\n\t\"./btn_big_bsc.png\": 808,\n\t\"./btn_big_purchasegmx.png\": 809,\n\t\"./btn_big_purchasegmx.svg\": 810,\n\t\"./buy_gmx.svg\": 811,\n\t\"./buy_gmx_bond.svg\": 812,\n\t\"./buy_transfer_eth.svg\": 813,\n\t\"./coinbaseWallet.png\": 366,\n\t\"./coingecko.png\": 814,\n\t\"./cross.svg\": 815,\n\t\"./ddl/chevron-down.svg\": 816,\n\t\"./ddl/chevron-down_sm.svg\": 817,\n\t\"./ddl/ic_btc_40.png\": 818,\n\t\"./ddl/ic_btc_40.svg\": 367,\n\t\"./ddl/ic_dai_40.png\": 819,\n\t\"./ddl/ic_dai_40.svg\": 368,\n\t\"./ddl/ic_eth_40.png\": 820,\n\t\"./ddl/ic_eth_40.svg\": 192,\n\t\"./ddl/ic_frax_40.png\": 821,\n\t\"./ddl/ic_frax_40.svg\": 369,\n\t\"./ddl/ic_link_40.png\": 822,\n\t\"./ddl/ic_link_40.svg\": 370,\n\t\"./ddl/ic_uni_40.png\": 823,\n\t\"./ddl/ic_uni_40.svg\": 371,\n\t\"./ddl/ic_usdc_40.png\": 824,\n\t\"./ddl/ic_usdc_40.svg\": 372,\n\t\"./ddl/ic_usdt_40.png\": 825,\n\t\"./ddl/ic_usdt_40.svg\": 373,\n\t\"./ddl/ic_weth_40.png\": 826,\n\t\"./ddl/ic_weth_40.svg\": 374,\n\t\"./ddl/icon_arrow.svg\": 827,\n\t\"./ddl/icon_check.svg\": 828,\n\t\"./ddl/icon_close.svg\": 829,\n\t\"./ddl/icon_close_sm.svg\": 830,\n\t\"./ddl/icon_close_toast.svg\": 831,\n\t\"./ddl/icon_dollar.svg\": 277,\n\t\"./ddl/icon_dollar_active.svg\": 278,\n\t\"./ddl/icon_market.svg\": 279,\n\t\"./ddl/icon_market_active.svg\": 280,\n\t\"./ddl/icon_trigger.svg\": 281,\n\t\"./ddl/icon_trigger_active.svg\": 282,\n\t\"./ddl/icon_withdraw.svg\": 283,\n\t\"./ddl/icon_withdraw_active.svg\": 284,\n\t\"./ddl/lock.svg\": 832,\n\t\"./ddl/long.svg\": 833,\n\t\"./ddl/long_active.svg\": 834,\n\t\"./ddl/short.svg\": 835,\n\t\"./ddl/short_active.svg\": 836,\n\t\"./flag_en.svg\": 837,\n\t\"./flag_es.svg\": 838,\n\t\"./flag_fr.svg\": 839,\n\t\"./flag_ja.svg\": 840,\n\t\"./flag_ko.svg\": 841,\n\t\"./flag_ru.svg\": 842,\n\t\"./flag_zh.svg\": 843,\n\t\"./glp_icon.svg\": 844,\n\t\"./gmx-logo-final-white-small.png\": 845,\n\t\"./gmx-logo-final-white.png\": 846,\n\t\"./gmx-logo-final.png\": 847,\n\t\"./gmx-logo-glow.png\": 848,\n\t\"./gmx-logo-with-name.svg\": 285,\n\t\"./gmx_logo.svg\": 849,\n\t\"./graphite-01.png\": 850,\n\t\"./ic-communityproject.svg\": 851,\n\t\"./ic_arbitrum_16.svg\": 852,\n\t\"./ic_arbitrum_24.svg\": 375,\n\t\"./ic_arbitrum_96.svg\": 853,\n\t\"./ic_arbitrum_hover_16.svg\": 854,\n\t\"./ic_arrowleft16.svg\": 855,\n\t\"./ic_arrowright16.svg\": 856,\n\t\"./ic_avalanche_16.svg\": 857,\n\t\"./ic_avalanche_24.svg\": 376,\n\t\"./ic_avalanche_96.svg\": 858,\n\t\"./ic_avax_24.svg\": 377,\n\t\"./ic_avax_30.svg\": 859,\n\t\"./ic_avax_40.svg\": 860,\n\t\"./ic_banxa.svg\": 861,\n\t\"./ic_binance_logo.svg\": 862,\n\t\"./ic_bsc.svg\": 863,\n\t\"./ic_bsc_96.svg\": 864,\n\t\"./ic_btc.b_24.svg\": 378,\n\t\"./ic_btc.b_40.svg\": 865,\n\t\"./ic_btc_24.svg\": 379,\n\t\"./ic_btc_40.svg\": 866,\n\t\"./ic_busd_24.svg\": 380,\n\t\"./ic_buy_glp.svg\": 867,\n\t\"./ic_cash.png\": 868,\n\t\"./ic_cash.svg\": 869,\n\t\"./ic_checked.svg\": 870,\n\t\"./ic_coingecko_16.svg\": 871,\n\t\"./ic_coingecko_hover_16.svg\": 872,\n\t\"./ic_convert_down.svg\": 873,\n\t\"./ic_copy_16.svg\": 874,\n\t\"./ic_cost.svg\": 875,\n\t\"./ic_dai_24.svg\": 381,\n\t\"./ic_dai_40.svg\": 876,\n\t\"./ic_discord.svg\": 877,\n\t\"./ic_eth_24.svg\": 382,\n\t\"./ic_eth_40.svg\": 878,\n\t\"./ic_frax_24.svg\": 383,\n\t\"./ic_frax_40.svg\": 879,\n\t\"./ic_github.svg\": 880,\n\t\"./ic_glp_24.svg\": 384,\n\t\"./ic_glp_40.svg\": 881,\n\t\"./ic_glp_custom.svg\": 882,\n\t\"./ic_gmx.svg\": 883,\n\t\"./ic_gmx_24.svg\": 385,\n\t\"./ic_gmx_30.svg\": 884,\n\t\"./ic_gmx_40.svg\": 885,\n\t\"./ic_gmx_64.svg\": 886,\n\t\"./ic_gmx_arbitrum.svg\": 887,\n\t\"./ic_gmx_avax.svg\": 888,\n\t\"./ic_gmx_big.svg\": 889,\n\t\"./ic_gmx_custom.svg\": 890,\n\t\"./ic_gmx_footer.svg\": 891,\n\t\"./ic_hop.svg\": 892,\n\t\"./ic_info.svg\": 893,\n\t\"./ic_language24.svg\": 894,\n\t\"./ic_link_24.svg\": 386,\n\t\"./ic_link_40.svg\": 895,\n\t\"./ic_liquidity.svg\": 896,\n\t\"./ic_medium.svg\": 897,\n\t\"./ic_menu_dots.svg\": 898,\n\t\"./ic_metamask_16.svg\": 899,\n\t\"./ic_metamask_hover_16.svg\": 900,\n\t\"./ic_mim_24.svg\": 387,\n\t\"./ic_mim_40.svg\": 901,\n\t\"./ic_multiswap.svg\": 902,\n\t\"./ic_new_link_16.svg\": 903,\n\t\"./ic_olympus.svg\": 904,\n\t\"./ic_olympus_arbitrum.svg\": 905,\n\t\"./ic_selector_dropdowns.svg\": 906,\n\t\"./ic_settings_16.svg\": 907,\n\t\"./ic_settings_24.svg\": 388,\n\t\"./ic_sign in_16.svg\": 908,\n\t\"./ic_sign_out_16.svg\": 909,\n\t\"./ic_simpleswaps.svg\": 910,\n\t\"./ic_stats.svg\": 911,\n\t\"./ic_stats_big.svg\": 912,\n\t\"./ic_synapse.svg\": 913,\n\t\"./ic_telegram.svg\": 914,\n\t\"./ic_tether_24.svg\": 389,\n\t\"./ic_tokens.svg\": 915,\n\t\"./ic_totaluser.svg\": 916,\n\t\"./ic_trading.svg\": 917,\n\t\"./ic_transfer_avax.svg\": 918,\n\t\"./ic_twitter.svg\": 919,\n\t\"./ic_uni_24.svg\": 390,\n\t\"./ic_uni_40.svg\": 920,\n\t\"./ic_usdc.e_24.svg\": 391,\n\t\"./ic_usdc.e_40.svg\": 921,\n\t\"./ic_usdc_24.svg\": 392,\n\t\"./ic_usdc_40.svg\": 922,\n\t\"./ic_usdt_24.svg\": 393,\n\t\"./ic_usdt_40.svg\": 923,\n\t\"./ic_wallet_24.svg\": 394,\n\t\"./ic_wavax_24.svg\": 395,\n\t\"./ic_wavax_40.svg\": 924,\n\t\"./ic_weth_24.svg\": 396,\n\t\"./ic_weth_40.svg\": 925,\n\t\"./lg_arbitrum.svg\": 926,\n\t\"./logo_GMX.svg\": 927,\n\t\"./logo_GMX_small.svg\": 928,\n\t\"./long.svg\": 929,\n\t\"./metamask-text.svg\": 930,\n\t\"./metamask.png\": 397,\n\t\"./page-not-found.svg\": 931,\n\t\"./position-share-bg.png\": 286,\n\t\"./short.svg\": 932,\n\t\"./swap.svg\": 933,\n\t\"./trading.jpg\": 934,\n\t\"./wallet-connect-text.svg\": 935,\n\t\"./walletconnect-circle-blue.svg\": 398,\n\t\"./wave-01.png\": 936,\n\t\"./wave-02.png\": 937\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 792;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAAAZlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+Vn2moAAAAInRSTlMABhQdEgsKKUeEstIZdbP/wlfRwTjgpJRm8fDhhaNlk3ZW+c569wAAAsRJREFUeAHs0AEBwEAMAjFaCv4lbz7+IiHSrJ+3I40vfVzOo72it3JaxHLxI4IIIogggggiiCDia9cMdx5FwSj8aw84Ug4qCoL96t7/Te68YL7GjrPpn0nsxCepLXrA8IQ3NoY/IULp5keLJ0YbHKM1/gfd3PQni7Ak6b6bXU9y8DigIz1+hx9JsvefKwITyfBsVCIOgrPkjlGp7WDiPJqPFWF6kvHpISgox6R+DXKyI35DpK6LJn6oCPEwW/rNw6bEZC4Hc+0iu/Irmttw7wDdKKB8bSKwaDRPF6bpANUM96/aTT2GR3dOEeLBY9p7ABY6vDJkGJakG1N24krVdp+h5qRRaceyNPptgfg0O8dBuiVKt/spRbTiAa8esP4qQjFIxABwnMq85GO2K3Hm+PBVogcCqWp8zAaIMrKTHAL1CUVE8sgDJk7YU+fXlYgrOiJVneBaxjBrS44d4LkC41SOFtClergALkPI7oQiJoYjD5HUeGFMzU/qGi9T0ZKZ+1IZFRMzY5mpZ2ctvLTMfWQaiogAwY4nFOG4HHuY8ILnhtqJCFSlMryvKnIv57DOWGlWKph+Dstii4h6r8BTiggvHnQ88iCBTv8kct2JUAylMtyIgsvirOstFKNrJdV9l4atkTOWRmRSOw9YORx5QHIo5HEnAjaVylhrf5WsZKy0WivSYkmtRQQ9RFM4oQiTmW76q3/WReChh/h8sPqdiI51Yi1/3L4eafZ1DFOOClBz/69+sIiQe93SbE4oAj5TmOOzWHj0pLc0KChOOxHI9EXpMpN0ul5pZWi2pZFl+LkHnJOMUyf9Z7m0bIP6blNY8D59xoZROETV88Wf/5T3Eb6dVm3wPp4r3sS5v/bFjL83KRtcIlRL6/EuYfkbRFzvLC8Rl4hLxCXiEnGJuET8A+HaTFa3F17bC68Np9uG02sL8rYF+T+idSlyqmiqtwAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/Anyswap.491d1f32.svg\";","export default __webpack_public_path__ + \"static/media/Artwork.a2d41b8c.svg\";","export default __webpack_public_path__ + \"static/media/Artwork_gmx.cc61d732.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAAoCAMAAABO8gGqAAABcVBMVEUAAAAoKDwnKTsnKTsnKTuGh5HJyc6urrWFhpA1Nkehoqrx8vO7vMF4eoVCRFRrbHhQUWARbooBqMcRcojKys////+vr7ZdX2zW19ry8vMUZIIBo8cBqMYBrMUUbYCTlJ0iN00BnsgAoscArMUDqbwiO0zl5ee8vcLX2NsNd50Bp8YBrcYAscQPgpHk5OYeRF8AmcgAo8cUaYEBssUAtsMdTl0Gh7gBmckPdpMPe5IBtsQIn6mgoalcXmtqa3gWVnoBlcoAmckDmMAlMUQiOUwDqr0Bu8MYYm4lL0QDicIBlMoAu8MDtrolM0MSYI0Bj8oFi7clMkQFpbMAv8EUd34iNU0Bi8sBkMsbTGgZXm8AwMIAxMEiPUwKb6gBi8wLeqcKl6EAv8IBxcEMl5YbRWkBhs0gPVYgRFUBwMIAycAdUlwGeLwBhswRY4wPh48Fuq8UVoQBgs0Azr8YaWwKbKkBzsAKqZ4ZS3IDfcQCxLcbXmRL8BeXAAAABHRSTlMAM7D2JaXEwgAAAp1JREFUeAHszjEBADAQArF7wL/myigDURA4OaWsg3OK+VCqCaeaSbkFF/xswQUfa2XRJa8OxNFNYF6gvUkz7u7u7u7u7m6f/1UqZArW/9wNhZ26kd+JZWvy/uMsjOPGQg8c247rOmHblrwm4a8UQ+K2HUswIp3JGhL0BOEmGRGHBzm6FYA29IXwUBCe5eMgUlAVQKUpLCouKTUvKFyaBO4KwCdBSSoqyMrgWV7wcUGK/VFeUZmpqq4xJej4SLIWSlpSIbGjgm6KBJE6eGgxVo/TSzRUFDU2NbeYEvRpUT39OCE7h9sKpJVHBblU8x0hh0a0tVd0dFZ1dfcYFrRCgp6sy6QRCeb0liNBligQwoXndSxEb19FPxtoHhwyJDg8goy6lAofNxyH7mUk6Ftqy5Eg1pJ6zoix8YnJKTY90z07ZzokQvepVa5xyg0mRs6hQ4KIpdJDzC8s9hXCtXRwaXnFtGDeX9MCHryNkaD6Oh4VrBcYFGJ1bXxdXjc2Z7e2jQjWlyk8lAC4q1v6+IgEVSjCgjmBJJlmZ3dvcR+rg6XDo2MzIaG6LGhaS/3zSTAIBaaJFrhePkuxgJPTtbOgPL+4vDIqWKYap1CGUhoPCbIUPBBaEM+SWu4Livv1ze7eLVPc3R89PBoQ1MvDW9UMetifpF1OgtKJBFPBCWIJPdHs6fn0hWleLx/eDAi6tgK6iYQ2COOQIBBHQT0iNb85HbD3j2fYg30VcBY3D8IefPj8MprieNAsikeC2sbTAXboRJG5+v54Pl0bn5BncVf37MXlw8/vPwrWkUdBXQrXrVZEKZDa8DDFyLAO92r0RCmA6/8rr0iFhKCWNjAEgWmwsmq0RY0XjDpw1IGjDhx14KAfwBz0Q8CDfhB90E9DAACtALoxSNWoNwAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAYAAACZvCZrAAAFLElEQVR4Ae3aBWwcRxTG8QjKQqsUEtOJpTJzw+U2zMmGmZlJVIYwYznMya0ZjslU58Jo2Nu43L7Os2ej7eiMMt+30s8ws+a7f2Zn044PIrpbeFDonPAA4EHhbnsceDBJeEC4P2EBwAOyBZ0rIiFrkWSdAAAgm/BgO1kKdeUAAFhJdJaBUCYBABAIAKhzIAAAEAgAQCAAAIEAAAQCABAIAEAg8tcEHIExrqhPc/ui26Pt78wBAAIRmRXs4h3pIe9wH3lGBLa30V80AAJx6aszT0dXHFt+bslxZ+H841Q49xTlzzpDeTOcFJmWHM2dlr4/PD1zBq8a7qwgluU7vMP95B4cINfAMLlGFfbm8QbmELoIVa1Q2qvzANCAgbjyyekuRYuPUNHCY1Q4/wQVzLHioFNkajKFJ6dRaEI6BcdlkX9MDvlHe5zBCcGR/LHuoSE9R8Qhu18eZfYuKIuuvdnQT9QVVHl0qWK+izoP0IAQiPOrTmpFC49TwTyOw2nKm3mW8qaLOExJqYhDcEKGiEO2CEMO+TQ3eYd7yTMsQK7BQZ9reO7MrL4ch0JKf7+I0j88vx+BgDYGlxiFi07PLFygr8ifp888tyKzS8ESV5eCha4ukRkuLTzR9YV/tMvvG+khD8dhqIjDoBDl9I9QVp98yvyI43CO0t45Tym9LlJG72saAgEJBpuUvOfg00IrcgaGjOz+uZRZEYdfKO09jsMFSu51iZJ7XKWzXa6VucbecrSAQIwU9gtOYXu8c+TYcuV8thz7GoBA1ENgftSR1a/gQMaHHIcopb4t4tDzEundOQ7X6czrt4SSA80YiPaCT46fF3T5mo/98T6/7Xxd4iMqPI0HGyR8IMx9W3sbO74pMw/+UOt/+dP7np+Z+vZFEYfLIg7X6OyblXE49UoJnXzJoAYOhE9wxuGLEwinHFPvqsyU4yvifH6/YP/ZOQyG/Fx4wAECEdvxDZk719bpCZH24TVN78ZxuEGnXyumUy+X0skXY3TipdsNvYLwC3ocfiUQDiUCqgNCWQ0rFHUOqwjAJYa5Y+15EQiK7V6/oi4fl/xOsXb6NV41lJKza7l2ppvZO7yC2jfTJUbvGs6fqczLz48N0LgAgeDLitjezSPN3eu/4FUEu/3Tzjo9KU6/VrrjxAsmnXih/EAz3+acWcP5vesRCA0POEjcQFgrB46DZefasl/376n10ppXDMeeLT9/9KnfKX3gH45mDEQXZf9B9YWcdyifv31NMQFIvEDk6O1tYVCVmfs2abVeRfT4q8vhx/887xxIzRkIdl6Iqk96+X6ZoKufv4o9C6dg4HYnJPQKIrZjrd+KgrqS4PfN3es+55DU5XM2cyB6225TjpRzM2QcDOFp9fPbboF+JDnl2Ew82CChA8GXEhyD6vAt0NiejTN4v6IVBMIa99P/D12Jg/r5z9vONay9BwDc5ty7cYUSBUNZSdjfdpp7NnzOG5vGd9u6sPLvxNt7NizncQ5JC/pFta8yLvE3KR3S/QAIhE1sp7zUkMx9WzTewJTv14m1wdmiKYEAQCBquNSwrxSMnet28DhvVJoyHvb5qt43dnxt8KVIGwoEAALBYns3zLQ/4dX/L1Exv3PdAXVlwe/zOM+3ojgwzbqrAYBA1IK5a50uVwa2SwUAQCDkSqFyRbDWj180AAIBAAgEACAQANDwEAgAQCAAAIEAAATiAdsgAMADViAeFJKsCQAA2YQHORB3cynkAFYSAFg5JMkm3N2ODxmJB3kQABLeg1Yc/gOptOvB5Z4VkgAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/Hop.4b77c9e3.svg\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/Hop_dark.423942af.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAABmFBMVEUAAAD///////////////////////+PcOZ/UON5R+KNT+iFQeWSYOi4hfWIP+aRP+iIP+WUP+ibPeqSPOiiauz///////////////95VON4U+O3N/C1LO9+WOL///////9yS+F4SeO/JvK+IvF4SOP///////////////9+WOWHVeXRQPbKHvTRO/b///////////+pOOyxKu6+KfG7JvCxKu+wRPH///////////////////////////////////+qL+21J+/CIvLTS/PCIPK2J++sMuz///////////+eT+2iOOu3QfG8MPDNQPbUH/beGff1Zv/gGPjVIfXNNvS+MvOiNuv///////96SOKHQeaZQ+noMvrvDfv3A/3vC/vmRPmHP+V6R+J7SOKIQuaXQefvDfz3Bf2ZQeehNuuzPu27MPDUHfbeG/fTIfWiNuurMuy2J/DBIPGtQO2wKu68KPGwKe7NKvXKHvR3SOJ4SOJ3UuK/SfG0Ku+7QfF7V+OUPuidPeqIQOaRPueQP+eQT+iFQOV6R+MNOs0rAAAAhnRSTlMABhQdEgsKKXb/V/84Gf+z/7OF4SkpZYRWdnVmwVeT////wv//lIU4s1dXOMI44MLSdv+U0v9H4dFHV6PBGbJ10v/gKf//o/DxZkekR3Y4lIUZk4VHZrN2pPHwdjiz/8Ip8fDS4Xaz4XazV3WUhYWkpP//V/+z/2bB//+FOMJHZrKF/8KzVzMrutwAAANDSURBVHgB7NDFAQRBCERRfHxa8091PYK9Ur8Fzo+IRdMnTMRqHslzUyaxQGFC6oHClfQ90f8QgAAEIACxAOLTuq2AeLcfOyDO67dcZ2qI8y6/rdQzM8TV+m/rYz65LYvt9nkgju7mDWSXp2Q5JdsfxkqscmunzMzMzPjqf4+isrv3iQq6yZzfQlf4W5gZZhkrYRHlFRoqqyo1VVckZGuQmlm6ImrrNNQ31GtqrP0ZtZDbYGeQl6yIpmYNLa1tmpqbfkYdV3WeU9JnxF9//6Pp3//+T45mfdUJDsJkRDkTmMlEPjClqhj59g4iYcqOIK8QmBnkDSiW24MalnoRnV3dPQp6evv6k6MW5mWRBFrUOdmY8ui6GMYF6ccUhQyAox+5HvoSwMYsEaiy50ZYSLeIgcGh4ZHRMYDxicmp6aGZgaSodBHbDUmYdYAGOQsCURBxGn4OgEUZIk+SrTmAjEcrhypBJADkHLIUi5hfWFT90vLK6pqixfWNpLCYi1AtiwINzUL2tjZcF8C2iTIOiWCEcxgXHEk5pqyRzGguxSI2t7aLInZ2d5YU7W1tQnKz52jJS5p4x6NpL7yJANNH9H0E4BFQy6GI/8J8hw1quwTUQjfdW2P/4HDq6Bhg/Phk6vDgNGlrSCFVP0urYQ6ZmmOB4k2EhXOcW1kSoU9VqjHuIgaStourWiblh+XZ+YU+LC/Oz5LXAs7q8c2qDxayLyL0JiERqI0x0EtjDgooFNss5SIur641Xd9cJkcjX1LH1ZA8h3bGFxE8BhYqEVxfKhBliHwXZBQULfIUi6hu1nB7d6upufpnNIehWWa2ozruCoizX0W4oSGMMFIisEYYvjpQYxI1WKBAYIiO0JNpfmLf/3hiP9QmZIWLiBGXxDJC9lWEpKrFkdFFmkXM5qjCI4ooj/F3OCfT/I54fNTw9Pyi6fXxl0vjnRwvwRT9K54R7H3EjL2T/WdDoRve0AhlNTbwEmGOJZ42opr8UB6YaWqGslqaCA7MqFuLuxuw4QmIkTJUJ2ruoYEns3vqD/XB29a2VjA9OpzfPjqcPzrBgxWMBsRoQIwGxGhAjAYEK4geXUwGXV44urwQuuB0dMEpdAny6BJkAMRHfxzYlb9eAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/Synapse.3cfd1d07.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAAAn1BMVEUAAAD////////////////////////1vjzzuzPzui/yvDTyujD////////////////2xE3/////////////////1nrzuzH////////////////zvTb1wELzvDL0wEbyvDb////////////////////////0uzDzuzHzuy/////////////////////////////0vDLyujD////////1wD3k7xDPAAAANXRSTlMABhQdEgsKZqT/o/EpRzgZOIX/wcIZ0nbx4JSEScJFiVeEk6NlsvbR8vDS4dFmpLPB8FZ1ZcrSjpcAAAKDSURBVHgB7NABAcBQFAFAD/SPvPX4LsIBRz2PB5ycPi7Wge7UhNJpBHV+i1jEIr527aipUR8IAPjTP4KSpGxigaoK0P49AFDv7vt/ttvNmpnrVfrgE7TZmcBOlIf8Jlkk5hsQNwHCRRTfBgjnEKNEgCAHkrhyCHJgieuGYAeWuGYIdri7uTsjkUgKRamW6kIh2GEjNmckUnBh0ECCvUyI+y07CJbY3n8NkUkps7wQQtndRUKQBDuQxIwDQki67UBdao14eESJpw1ebpFg84SX55dZiJJulWtJbWopKGRtqoTqSJXIxlSaOxtTl8LF/mDqZOkQD/H/jzwtXuNXngzPP+KXOYhDroWAFNuh7WwONNQGOttTJqEBa6HVrrPHzgYzPbifj0uGIIeYJdAhZgl0iE8lUhiMMUWOHAxBF91bGv6EfbaljLQUpK6kYOdIwzf0jJ5ArgRiy3VyHqKz1vZQe4iee+nFqt2YE4RwVdSiTmEFxbRjF4z8bS1LY8sO55fG6BCoTR5ClAeAwoBEiPETQvPoKTIYDEVbrKFYvlOxjKhYvp8vlqKzBMGNIUqwaZp2DkIyhJ8GfipxLByC68PH5+vzg+vEPIQ9gbAdZdkRhOBFIpRCp9KnS4egOkkS5MAVcx5CwXQCMVA2HENMrXuftpPQueEH01X8iU0S7BBHMzOiqaqqafPkGIJaJX8aOIZI8vaX3Bf02yOYvdy3vV48hJf47R3mvzXyt0T8CyF2AGAzGP+GEMpSr1sOZY/ppFf2GR6Jb4T6cpRS+NBqdRszUdiq8w5h89Y7hO18cggQ4R88sxEgAkSACBABIkD855JwmCwcL+Tjhf7AaThwGo4g8xHkP7gaLtKObnJaAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/btn_big_arbitrum.ff6ad480.png\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAf8AAAB/CAMAAADW6DvgAAABF1BMVEUbIDIeITUbHDAXGCwhGi2HLjhhJjNhJzNOIzJPIzI8HzBYJjNrKDRqKDRYJTM7Hy+QMDhGITGsNTwqHC51KjWaMTqPMDkzHi8eIDYbHDBFITB0KjYeITaiMzt+LDceITajMzt9LDdCIDCZMTo4HzA+IDBLKDmBMT15LzuuOD+TND05JjhRIzJyKjVwKjU2Hi+RMDgyHi8oIzdSIzJUKTp7LDYjGy5PJDKeMjuELThAIDBjJjSbMjqKLzg5HzBUJDJ5LDYlGy5hJzSSMDkfGSxqKDUpHC5EITEnGy5VJDMcGS02HS9DIDFAIDFFITFDIDAsHC4eITYcHzMaGy8TFiMeITUAAAASFiIcHzJlLDowJDduLjpCJjgHX8VeAAAAWXRSTlM4+O////////////////////////////+18P//+f/////////////////////////////////////////////////////////////////////6vvJR+SRTwHfs7R4AAA1sSURBVHgB7d2Hmuo6lgVgute2jKRNkLYoTcPgQ01NzjnnnKdzvO//HAOc2+jjkGRjwFT5vzmHtSwkWTaDwTe+iZOowJYqkY2GWhP2KIMvkLGsRuMJnf9Hm6lDiwq/UeBGRDOPBfUwGgh+bfZCuEY08ZvfGPzCt3Ca1vhMOCLL3DrCl5zBUWLUyRZYBVpMI54i/yRa5iHdOn+wnzmYqcGVvjX4xcx/OWszwldacIQxOCM6xVwOJ0gAWr6Uy4rQKpvyv6WoeDRHJoUrKEW4zuATTiOFrawhIFobT/4hJOdbELFFL36N0C6aeu9XEXdgFJcTXCYa1xB2N8zfCoCsISAq5doouXFKcTmfvPgNg5aRVZZwJ+SUGkecZwyuY4LcLH/GPlERR8hY6TYHOXKV31J4dqKVGgpOU4RrqZJuk390+JJTdBB+sNT6JCfl//zEspoTjmNcT8IQtChepeX8FQ4RGyQ0rlhuMMkhv7ESvBfR8miCI1SLE1tvkO+XLuZPFse4INiiYQjmJpPcuJxN1/E7vCtGqcMpYWhzZfvSav5acJRUJUDD10ITcIv8zcwCxuD9Icf7U8KocA2aTCbjclS8+c+Q7Zd/JeVfOzR+e5kpQdJq/noa8Y6R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\"","export default __webpack_public_path__ + \"static/media/btn_big_bsc.5e5ec82b.png\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/btn_big_purchasegmx.86c08dee.svg\";","export default __webpack_public_path__ + \"static/media/buy_gmx.01459500.svg\";","export default __webpack_public_path__ + \"static/media/buy_gmx_bond.ed3174dc.svg\";","export default __webpack_public_path__ + \"static/media/buy_transfer_eth.373e200e.svg\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/cross.2c9772ea.svg\";","export default __webpack_public_path__ + \"static/media/chevron-down.88670207.svg\";","export default __webpack_public_path__ + \"static/media/chevron-down_sm.697f08ea.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHjSURBVHgBfVO/a1NRFP7Ova8NQYkZigSDJbqJQh4Ogk4NiqIuCiJuDZgOQhGKk1P9C1Tq4KJQR12yiRWkg4ODg3EQp7ahpTSUQtMftE2bvNN7zstLXtMfH7x3f5zznXO+c+8l9GB7IlsEYZgBn8BpBtUJqFjCZP/o4qe4L3VI7zM5apkyM3wcjyq8oJB8VqvKwkRENM10L9EMXEbfvY8w2ev6Oaif+kdk2VBDG/bSYySefEffrTe69q69iMfMUZPK6tfWWIxbeeUfTOYqzGAB2FoGDVyBHRwCNhbAqzOiNjN+P1U10pyjxFF/Sse9r0+x+/k2kDgD7+bbjr3FQdELu3oEOXsD3FiHzZd0pEQKvL7QrQ7kGzmOXqI0SpyDuW9K9PyRsIofY93gQNrIOcaJ9uIdWL8Ulvb/C1p/P2C3/Ci05UuxzKh7hKDi4gx1IrqsxpUskC5LqZQ6HxpdFd3MXLEv754mQ/Qg2gwWf2m3ldBYA5066wLMOwlTaP1+7cpptNn8Snu18+7cH2lcR7O7EKLZ5kew93Ncgx0AczX5fOmCp/Nm8BCWpkGUi7Kr5tkpHIIjunMqaBL5Jcdq4YYYToDoFD/1R+xhRNicyBQt0TAz+URIu/teJ3Ik4snkaO3Aq9oHE/y09owWmgYAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGoSURBVHgBpVM7SwNBEJ7ZXHwSH6CFlQG1sPMB5hAUrQQro8ZgpWCpkNhZCLn8ApPCTrC0CDGpUvpsYoQQLSysoq2CSKIhJHfj7pm73AmagB8szDc3s/PNzB7CD5QSsps0ChDBEqdu3UmQA0Y5xli43ZvOW+PRSopxTxAJDuAPaERhly+jGJwZxkdMVhol6wmIoUJsSrEpKMblTSQ6FrZjcBFY34S96ksW1OeUzaeq5O3yZ5LsWwaFzAoiuVIA9SllHkf/OLQtxAE7BswLJAl1tViIyXMM6dz44JzcB+01qydaIQ37wTEwA+XrnboyUufxM+EJkAoR4WidPeQKxqERSqfTRv9Bia+sx1hG+Wr7VwVGgcrDkckJqef/CtQq3vEZNFQgDa8B8gFX0numD5mWYy5f+oLbeWswOl36xMVh/RPgHN0CacgP1fuINSzfvnx7KQlLBdp1ACaELaqLVUrdI2ak9v4I1bMNoEqx3j+QUmuj1ldcDvFnqkAzQFI6VzJh2wXNXiIG17F6E7VwO95OZHeLU+MvE8c4Hau583zOyXIVo73r9r/xCzLjs4Txvi/RAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHoSURBVHgBfVPPaxNBFP7eTBI31Wr8RdpDYRURxUMCIogemoJnrUdva/QoWC9etN0kXgXJP6C5eRK8efHSkygICYq0IDR4MIm1ECGaNMnOczNpNrtT6INd9s1775vv+2aHYITjNmwB+RCMZT+195arIFQVvGKlOF8P91M4ybvNFbB4gYOCveLLZ/OFSSqC4dVWwRw+lZK4cTUZBSDp5lcbUYC8+8sBkWtu9uDOUVw8m0D6pNwH4jxtLU8ZMPYNX89aWJiL6e8rlyyzDCFIsxX33e0cpmYF1G8tHQ7yE8cEMucTJobtPGnkBAvOmJWbSzOQPuuNrQE+fumh+dvTUo7MRDz3e2Qmxh6lRhomkYgT4v5T2+zrvLfL2Nzpw0oQTh+X6PwbBr0MSsVIcpu9KWp/wPj2vQ9PAecW4nptOGT8/KPAKsqUwG3hKaqZEqxDhAt2HOufu9hpe0jNSixeTqLTjSIopqoWdXettUUgO1y8d3sW1/yT+FDb1azevO/gb5dD9Ln+qpQ+o4+RCY9MFq/fdfTuSYvw6WsvMrwnoKCNHL2q6883MouPR/91blIe+F79aI4NG7GIUAcXKqV0eexDKJy1bVf4RRwQCmqlUporBzzMBn0blXR9WVm/mB3rRZ0Yb5XwyuZt/A/V0KylFRZwagAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEHSURBVHgBjVMLEYQgEGUuAQ3EJNrACNLACEYwgjYwAhGwAZqAa8DxdsAB8Rx3Zt3Zx779gYyVIr0qr9arCxZ+zx5EeNWB8E9NiCuIhnP+RHThvEhARK21W9fVCSHcMAxumiay8JdlccaYmECnM1JmBNyJtZbsPM9pJ7QDFQFUQCAqNE1DGCx8yGUs8M6tOiklBXVdl83ati3hGCHB7cd/eOy/qiqy27Zl29z3nayvnMIc5G/0juMgW9d1RvaVsyRBvsXMcUF935OPljEzMPjXmWUElFLZdq+Cq0yWdr44DRAVcLc4xNLGcaQOcAYc56G6SfsXAC5tvX5hZwL2/Lb1HTEVyV7+VT9KbxPpO/XgrgAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFDSURBVHgBrZIxUoNQEIbfvkcVmxyBJmoSC3MDPIGWJmNBTgCeALhBPEGoJCVHwBNoJRgbvEGqjEXYdWHChHlA4Uz+hvfe/PuxO/uD6JH58D4cDC58Pt4jwjLbjJIuH3QXDlwA6RDRsGEMCyyCbDPOewE3T98WIq1LjugTUoACwxpUAa4fU1MpY81/tDSzz+YfCdITAE1oTnR4TqNJbJQ3KZXVLCYSCVGxbLQbThZfHgjpkqjGYpjh8DeWrQ4R/DS6vNNn/Xy9Cgo8zHR/C6AU5KJHOrQT8F+dHwBEZp+5zIj+ZugPKMifLrZmMzRauNoAxCJRSvHqhFXe2WLzau3pfLviHX8QoV9y6mIOz44Q4+P5JA6U3RGa03hVIa32v/uXPJ7tWoBa43nmggCnCeoIl+gFHLsxeQyPK2+RE5hFo7cu3x+G+J1ieOsLEAAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEuSURBVHgBlVO9UgJBDP6wszut7LxWG6mtHF9AHR8A3gB9Anpt7C3Aws5CZ9TKmbOhgzlooIKDBjoWKuhCQrif5ff4ZjJ7m82X5MvuAUsgojybx2ZIYRb7HDaBD102n7YjkLh1xIDSwU6wBzGEn9SYcPfTJsgJ2bNcZsKeDjf2rIlKVd63ubehnsXwDrh4dmV69QHgOsBoCvTGwN078PDD/n4yKitkxyKOJmo3ZyIKKF4DhUtN9Pirq8KRto3VdvGPWzR2m7LmP1jKE1HhOxIoletR1c8m8NXSyu6R+v47al0DnLIvk4nECfktIjuHGiQayzXgpcJJjoHbc6B0DzR4FhcnYXQ5vC7fuiqZ9tWrrnGb+h3MVQa7X5gkCvXHkDjXGjKle6L+CnEpSeq/agZ2kCMI5PSNywAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAI/SURBVHgBfVNNaFNBEJ7dF6sRUhJUqglK/KG8kEKF1tSCQiH1WEguHltvXgJG0iLtJcnFIFFsIR48xpteInpsAgpCTPRQpcHnXw1CA4KY0iCK5L11ZrfvNemhA8vb2flm9vtm9jHYY/qtatA0XTc4FzEQEKQzAbCGnzXOzaxxZ7LZi2e9Tmj+ddJi/D7sYwxE1shPZGyfOzcv1DJ2cuJKAGYvDTlJc5eHID5+FBQbliZsXwF9oX6NAgHfQSglR8BzSIPS25/4dclVXm9D5IwHY2EZI+xwqhZzCggGaXWzHyrrvyD3/Dt0/prSp7XZ/geLT75BpbEFD+bOKSkaSLZcT72ZomZFznrkLYVySwJyV0/DoFuTKzHtl2eF1U3MZBKHtwb1VHXKJbgYpSAdFl/9cHST5mjuPTLpwgVK2LEKyomGfVDf6IDg2igXgnkpQPoJbFthtSXpFq/rEDpx2DnfRgyxktIxlzMmtsghzdQwMgJ8aP2G2HIDEsXPOIXjToFBxGz/MVUfMJczy3xHTrnRhumwV92CgKWZU3Kc8fFj6O8yi474sJltuTfpcRn3Jl/gvln/2pENio+pec8+NFDWAIT8bslEvgd8GwHvgNSPAppf8pGXkrOwxE3GWWnx8QY8Qs2USNOgriu9TLEZOyILqxzISBk2teH5WpoxlqFkApPR7MmWZk6Cx+2C28/U+xBCZD7dncj2FegtAvualfyYv7hie2xvWE9Wg9YBLY2B86AWWdMS7KnW7a4Yy/1/43+jYdjzTW6D2QAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHYSURBVHgBlVM9SCNBFH4zu0rk7nSvuuO8g72zuas81MafQrEVRYuUatDeYONfkU0VtVDSC0HFysJYWigR/Cn9AdFGXDCYiEViUBR15jkz68ZNiIIfPN7bN+9973vDLIEimLGg8UQrghxIFyXElDmOaBOCiTLGo3ZgyvbWE+9H9cJEUCRCCGjAGyAMw8lAxHK/NTf4OT9mCbqICH3wHihprepsIbnVrUReQfXCeL9wMUX02YBfn76W7D2/zUDyJqtizp66U4HpuP5yFnKL/H/qYLi2vSTBzME6zBxuOEI0fVa4ODFj4/8fNdhzixq//VYmMfivWfm5423ldy/PlEH+PlibznRqAvJ88iiTUlZVXgH+mnqoLPfB3MkOVJb5IHmbLVDEdK1W58gN7/Tcw70ikF7i+uFOxdLkuSRcOz92FAAYupdRypNF/po61XiUuXBW+dukLlCSuM0SCJDVGWMJTdMKSNw9ww0doghhILEEpYCI+zQtX5Z4ZfBBiGY73RvZpM4uPAwfhNjfkl5pz61s2196mkWStHqL5GUun+7B1f1N0XRuXfRNRl+IXvFjcTREkFrvDM5yZFaqbyrqUVKI77ERk2h0iKJQQ8B0RoKNwOOc43y66G98Bj1CxfZyFDl9AAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAILSURBVHgBdVJNaBNBFP5msjFRobsVsRVtGEE9RVgFT0VIQS9ejBfFk6voRRA82aBoLkLoLacetZ4EDzYo2INCAtKDl2bxKBTWRDH4uyuIxmRnnDdN0iS07zLvvZnvvfd98xjG7NtMwYNilxljrlLK0WeoTz/BsTTZKD0efsv6zk8xL2SXLyvAxTbGGAKekHOTwUIwABtgzKtKQVAcyTaacajPv8gmp2Hz1JYFLEoMA5/8fodfqg3oxMfd/3D362uc3XkUtydOGTC9kx2+rN3jrMfxEV28/PMeGcvBK7eD04UryOVyBlCr1fD25iKuhYcHE2gNPIvE6SeacYTWyT14sDKiiykiXgg8PXcPF37MmFws4XFNwgi02v5gOp8p3dhSLCEE0ldnERGlDXN1Z+WQN8HSJhMEAcrlMlzXRaVSQT6fHynS7Eawk/vIdSzdOaQCGcs2VWnEMAzhOI7x+3EURajX6+YHehZSZ59o2TyNS7uOwfd9eJ5nbse7rr9Zw2wq04uUz6VSA3Wyepz712+Z0ceNik49W99MKLZkluT7wTt1BeWeaC2ioTmROMVi0fAmqz5fQerhGi7GR3pABHs/lQ4Z8OfpeZFM8KreN7Habox0tFkK2R1TQx0RdGI5t7+1EAx2e7gAtjG9XX43lucJSDEbf/DlQMHjDHpxuJ6ZvlH/BqRPHPWoI9vzH5xq3+2NFxVlAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/icon_arrow.59b289c0.svg\";","export default __webpack_public_path__ + \"static/media/icon_check.a37b7ce5.svg\";","export default __webpack_public_path__ + \"static/media/icon_close.9972202b.svg\";","export default __webpack_public_path__ + \"static/media/icon_close_sm.be2b83ff.svg\";","export default __webpack_public_path__ + \"static/media/icon_close_toast.d527cc94.svg\";","export default __webpack_public_path__ + \"static/media/lock.3a55a760.svg\";","export default __webpack_public_path__ + \"static/media/long.0f8a81b9.svg\";","export default __webpack_public_path__ + \"static/media/long_active.8a037ed6.svg\";","export default __webpack_public_path__ + \"static/media/short.c75b3ee9.svg\";","export default __webpack_public_path__ + \"static/media/short_active.d3098d1c.svg\";","export default __webpack_public_path__ + \"static/media/flag_en.c92a8361.svg\";","export default __webpack_public_path__ + \"static/media/flag_es.4ba7dfef.svg\";","export default __webpack_public_path__ + \"static/media/flag_fr.589da1a2.svg\";","export default __webpack_public_path__ + \"static/media/flag_ja.81aa61af.svg\";","export default __webpack_public_path__ + \"static/media/flag_ko.97c8fe63.svg\";","export default __webpack_public_path__ + \"static/media/flag_ru.0c71e16b.svg\";","export default __webpack_public_path__ + \"static/media/flag_zh.fd0e8daf.svg\";","export default __webpack_public_path__ + \"static/media/glp_icon.ef02d046.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABPCAQAAAC3gKgqAAADyUlEQVR4Ae3BfWhVdQDH4e/Z3Uvb2lZukS5sOEI3UHS95xbBqg2iQmcvpCRZZClYkBoWaAvpD0ncHxVCFjE0iyE6eyFqK6K3RRTaiy1ptaXljDnL29h2t7v7iZGeTuuen9vd7r3nynke+Xw+n8/n800EWToXUMKrVCnVkcELwPsUKbWxlH5GbcZS6mI23/OPk9QqVZHNTv7VxiVKTawkhFMDAaUeKujkv4LUKdWQTzP/9zWlSi2sI0w0O8hU6qCSbqIbYLlSBYW04O4w5UoFWNQTwWQ3OfI+aujFbIhV8jqKaePsuqiQlxGggfHZT768iyX8xfiMsF5eRSnfMn7dVMmLyOJlJqaFafIe7mOQiYnwFJa8hXl0MHG91MhLyKWJ2LRRLO/gEYaJ1TYC8gau5iixC7JIXsAFvI1ZK3sxOcAsJR9PEMGki/mUcBCTF8lUcnEDv2MyxCpJoo4g7vpZqmTiIj7EbDc5kkSABkzaKVOykMYzmP1AuU6jmM8x2UW2koNb+AOTAe6VA7WcxN0QDysZmMkXmO0gUw5YbMakkwVKNNJ5DrODzNIYFPEBJs3kKbG4iz5MgixWFFzPcdyFeUyJxGV8h9lWAoqKxxnB3TEWKlE4j0bMPmOGbAQIyEYBb2DSQqESg/sZxKSXm+XAA6yWA1fQhbsIm5QIzOMnzOqxZKOCI3RzrRxYzRDuTnCj4o3z2YNZC4Wykc9+Rr3LNNnI4TVMPmGG4otHCWNyjIVyYB1hRkXYKAfKOYzJs6QpfriGXzEJs1YOVNLNGT1Uy4HlDODuFLcrXriQdzDbR55sFNKK00dcLBtZvITJV5QoPthIBJOfmS8bFk8z1hbSZKOUbzDZTqamHtX0YBLiQTlQQy9j/cmtcuAO+nDXzzJNNabzMWaNZMtGMW1E8yUzZSOdBkzaKdNUIo0tmB1itmwE2Iab58mQjWLaMNlJtqYOt3EKkyB3yoHFBHHTx91yoJZe3IV4SONi6awo0V5dLpNf1KiQLI1C6bpHZXJ3SIusDp2GpXo9qXS56VKddUCTRwbbmWqvkCUbRbRiso88TR7L6GeqDbJCDlRxHHdh1mqymEM78dDBXDmwgRHc/cZ1mgyy2UW8NJErGwW8icl7FCp2rCREvAyzRg5cyRHcRdikWLGATuLpKFfJgTUM4+4ENykW5NNMvL1FgWzk0oTJp0zXxLGeMPE2wgY5MJcfMdlKQBNDJT0kQi/VcmAFIdz1s0Qu0hVdjpoV0fhZik1Al2JZ6IzXVag5iii6dOXKq7Dk8/l8Pp/Pd676GwYUP6Kwt1/bAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/gmx-logo-final-white.b7833ed6.png\";","export default __webpack_public_path__ + \"static/media/gmx-logo-final.0b59e423.png\";","export default __webpack_public_path__ + \"static/media/gmx-logo-glow.83c5aea5.png\";","export default __webpack_public_path__ + \"static/media/gmx_logo.2b33868e.svg\";","export default __webpack_public_path__ + \"static/media/graphite-01.6f3526cd.png\";","export default __webpack_public_path__ + \"static/media/ic-communityproject.9b5f97dd.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_16.f4c1a9fe.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_96.b12913b6.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_hover_16.d779b479.svg\";","export default __webpack_public_path__ + \"static/media/ic_arrowleft16.21502a04.svg\";","export default __webpack_public_path__ + \"static/media/ic_arrowright16.b425521a.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_16.90aca01d.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_96.b6255c50.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_30.403cd87e.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_40.ba220dde.svg\";","export default __webpack_public_path__ + \"static/media/ic_banxa.06412144.svg\";","export default __webpack_public_path__ + \"static/media/ic_binance_logo.46794a16.svg\";","export default __webpack_public_path__ + \"static/media/ic_bsc.8de996f1.svg\";","export default __webpack_public_path__ + \"static/media/ic_bsc_96.369f1d28.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc.b_40.1560513c.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_40.1560513c.svg\";","export default __webpack_public_path__ + \"static/media/ic_buy_glp.8eb00e6a.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAsCAYAAAAq/ZsdAAAFI0lEQVR4Ac1ZA5AsSRCd2FkMvm2cbdu2bdu2bdt3obN9X6tGrW3vxv6x509e5dwtukZdXYt5EW9ZNf1eZFZmVbVJL8yyfJpZlT2UYIw4VzrVlC3IJXINChNhriLXZJOh56gon4Ahbw5RHs8SO+JRwrmmbEMuIfuYiRzgNYNzcK4pG5Gryk9j+vCkGs7JGgOiqYdjj7MEzj/OErrfCHHuBBiS9slR5XpMpXTEMZtf037hcdYgiPAEe3gHU7bghBkw43hrsNWoGZw77iLNqnqWWVW+yVElNR1xDG2mZ51gCRxg1BDOHT8nkrQFFfgLpVvP+rmorRUe6ekJPtrTU3P6Lt7PDRh6Ydy85CjSlVRkxKxIusr2TrXVMBq3NnVtOGq2b5An1TBdxyfFiPwRFbmep/cc1FCvMfRgTzfY/yqLzP6iehJTTVEW5SqyRA3FU0zUEP7dUkRiW13W0X3EIu/Tx9kCDyTjsZbABWNvRi1ckUuUOr0phpxdTuDGzg742+MG4vdrDLWEQvG/v9DfB4c01ofiG9WysiWmCUF5+cxcVaniMYNrxhGNgl6scnpg578anbsfMHgKjcj+oznmfcesyKuoyCC/GT784vDBwnfqk66hY63Bv+g6WiFuRpVf5dyrwT8eD/DCR/3fWBeDZauaYaMHW1IVBwfl9SLV7HTeUylGJxnQ5Cq3B9a4fEA8G6CSeu4Pac2cQP7jrNXVsOPpPelK+Ff8JbyoaBoVOMBbzW6iRYAFVjhrURmsLGxFwRre0xiDy6q1fzuAeKGgSIVDNvKkK+Uq19rKJdKLQzsAHmI5ZmEpIbBVcReK1c0tV3fB8kebMvUnB5rS1W+ouBgl8PKk5iZg8fWAH0Vy07a6DPbbySFsCrc193JFh+k9qVDkBHixnUmxNNx6VTesvL8ZRYuZov2mnREqnHYsmv0A3/ZriwHLw0kILOuI3o2rioUi6WFtqLKJ8Pv1LtCLCk9qYzP/qYZdj+7Xu4H9KjHdiHIP00S5iUVgb+KCL3rjJVkXvNHkppaXtsCOp/bqPmIcawudwDRS5S9RMxutaxsWdHZFDN7tikGxEzKiLwQJhrYhPbDpg208Z6YWxpD0i4ihXMojSChB2JC5x1ti8OfgUFNNxEvt2jl7Egcs+LSexxBoduc0Ql4RQxsVtukuy9hUGWAkNWMOI0GYsqacwxATJbMitxk1YysqgwOJl6fX4BZIA/ydHTPr92o4YoEPhXKvJUy5P40amlZUmZBij7XEv6dMQW80s6Gt3u3kv1CxhT4wIUQu4Dcr7dCIbfYPVTAszYnEIsAAK6PGzFEkPNSLeOkYMvS3ETP2deWwB3GwZriPEGw0dyODsPDdeqNXXiv+v2OTndxbnj9rYC/iRBHxMs2PxAqHnLu6DnY5vk/sDo8K/I23uVpKCRxJwsNCvhvgiUxyM5uXdMKitxoMmUHiBYspDlWdkavIMs8WaObq6gRBuAnFNYELvYVJQexD+HeMJptmx5Eobc6tMPeLWjhyrk/IEHNiVd5BU3qiNefvGq6ewy7+Y6kJPNhtWdIFtnVlsNFDicdwYUOIPEJ2zFXjrx8bKMO5RC5KGqFfqwzdyyE3+bQN8ktVmPldNWxyeyvsv71T2AxS6D4PK0q6D79+d22N/vyRqIBYjionAvohf6d7wIuXReJGkGcuGF8zqMWYCzZKlqBTTIg4UcNQdISBR2GBF1rCxGejhjF/S4cVhj9aYlHBZ/Lf1/Gn4QFxc+PIdK9a/gVaRiAcqhHzNAAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/ic_cash.21569a1d.svg\";","export default __webpack_public_path__ + \"static/media/ic_checked.b4f2217c.svg\";","export default __webpack_public_path__ + \"static/media/ic_coingecko_16.ef20d202.svg\";","export default __webpack_public_path__ + \"static/media/ic_coingecko_hover_16.ef20d202.svg\";","export default __webpack_public_path__ + \"static/media/ic_convert_down.74b7eb02.svg\";","export default __webpack_public_path__ + \"static/media/ic_copy_16.fafdf331.svg\";","export default __webpack_public_path__ + \"static/media/ic_cost.56371371.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_40.6f901476.svg\";","export default __webpack_public_path__ + \"static/media/ic_discord.be4d716c.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_40.5e255508.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_40.1e127166.svg\";","export default __webpack_public_path__ + \"static/media/ic_github.dbd4de8a.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_40.087335c1.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_custom.11dd75db.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx.bf8fb0b1.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_30.375de394.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_40.8cd483b1.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_64.f4caeaad.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_arbitrum.59f04e87.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_avax.fb50658c.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_big.a0a74216.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_custom.fd35b66a.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_footer.e7821eb2.svg\";","export default __webpack_public_path__ + \"static/media/ic_hop.0f4a98a0.svg\";","export default __webpack_public_path__ + \"static/media/ic_info.f334ee0a.svg\";","export default __webpack_public_path__ + \"static/media/ic_language24.ceaebef6.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_40.4bb3a048.svg\";","export default __webpack_public_path__ + \"static/media/ic_liquidity.f00d35e4.svg\";","export default __webpack_public_path__ + \"static/media/ic_medium.f6051b2e.svg\";","export default __webpack_public_path__ + \"static/media/ic_menu_dots.87c2cfaa.svg\";","export default __webpack_public_path__ + \"static/media/ic_metamask_16.aa3dce32.svg\";","export default __webpack_public_path__ + \"static/media/ic_metamask_hover_16.aa3dce32.svg\";","export default __webpack_public_path__ + \"static/media/ic_mim_40.42c8b575.svg\";","export default __webpack_public_path__ + \"static/media/ic_multiswap.e577f4fa.svg\";","export default __webpack_public_path__ + \"static/media/ic_new_link_16.5b7cb7bf.svg\";","export default __webpack_public_path__ + \"static/media/ic_olympus.70b17676.svg\";","export default __webpack_public_path__ + \"static/media/ic_olympus_arbitrum.b358dc93.svg\";","export default __webpack_public_path__ + \"static/media/ic_selector_dropdowns.aaf0b8f0.svg\";","export default __webpack_public_path__ + \"static/media/ic_settings_16.9d97766b.svg\";","export default __webpack_public_path__ + \"static/media/ic_sign in_16.b6f5b1d9.svg\";","export default __webpack_public_path__ + \"static/media/ic_sign_out_16.1b0564f3.svg\";","export default __webpack_public_path__ + \"static/media/ic_simpleswaps.4cd51f2a.svg\";","export default __webpack_public_path__ + \"static/media/ic_stats.f0a18011.svg\";","export default __webpack_public_path__ + \"static/media/ic_stats_big.4a4ebfb7.svg\";","export default __webpack_public_path__ + \"static/media/ic_synapse.b100121a.svg\";","export default __webpack_public_path__ + \"static/media/ic_telegram.af1a4a66.svg\";","export default __webpack_public_path__ + \"static/media/ic_tokens.6a27251b.svg\";","export default __webpack_public_path__ + \"static/media/ic_totaluser.e274ef10.svg\";","export default __webpack_public_path__ + \"static/media/ic_trading.2c53815a.svg\";","export default __webpack_public_path__ + \"static/media/ic_transfer_avax.53893264.svg\";","export default __webpack_public_path__ + \"static/media/ic_twitter.9f35b403.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_40.efe1f12f.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc.e_40.27f415ba.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_40.27f415ba.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_40.e357d24a.svg\";","export default __webpack_public_path__ + \"static/media/ic_wavax_40.ba36eda4.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_40.334ca16a.svg\";","export default __webpack_public_path__ + \"static/media/lg_arbitrum.bdf133fe.svg\";","export default __webpack_public_path__ + \"static/media/logo_GMX.b956aa96.svg\";","export default __webpack_public_path__ + \"static/media/logo_GMX_small.f593fa5c.svg\";","export default __webpack_public_path__ + \"static/media/long.0bc4a064.svg\";","export default __webpack_public_path__ + \"static/media/metamask-text.2f9c2df2.svg\";","export default __webpack_public_path__ + \"static/media/page-not-found.bb90d073.svg\";","export default __webpack_public_path__ + \"static/media/short.1f94a0c2.svg\";","export default __webpack_public_path__ + \"static/media/swap.40fb8e49.svg\";","export default __webpack_public_path__ + \"static/media/trading.7ea1604c.jpg\";","export default __webpack_public_path__ + \"static/media/wallet-connect-text.78166b41.svg\";","export default __webpack_public_path__ + \"static/media/wave-01.3c9bce1e.png\";","export default __webpack_public_path__ + \"static/media/wave-02.4a56e8c7.png\";","var map = {\n\t\"./ic_arbitrum_24.svg\": 375,\n\t\"./ic_avalanche_24.svg\": 376,\n\t\"./ic_avax_24.svg\": 377,\n\t\"./ic_btc.b_24.svg\": 378,\n\t\"./ic_btc_24.svg\": 379,\n\t\"./ic_busd_24.svg\": 380,\n\t\"./ic_dai_24.svg\": 381,\n\t\"./ic_eth_24.svg\": 382,\n\t\"./ic_frax_24.svg\": 383,\n\t\"./ic_glp_24.svg\": 384,\n\t\"./ic_gmx_24.svg\": 385,\n\t\"./ic_link_24.svg\": 386,\n\t\"./ic_mim_24.svg\": 387,\n\t\"./ic_settings_24.svg\": 388,\n\t\"./ic_tether_24.svg\": 389,\n\t\"./ic_uni_24.svg\": 390,\n\t\"./ic_usdc.e_24.svg\": 391,\n\t\"./ic_usdc_24.svg\": 392,\n\t\"./ic_usdt_24.svg\": 393,\n\t\"./ic_wallet_24.svg\": 394,\n\t\"./ic_wavax_24.svg\": 395,\n\t\"./ic_weth_24.svg\": 396\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 953;","import React from 'react';\r\n\r\nconst Logo = () => {\r\n\treturn (\r\n\t\t<div className=\"logo-wrapper\">\r\n\t\t\t<a className='logo' href=\"/index.html\">DeDeLend</a>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Logo;","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\nconst Button = ({children, className, clickHandler, disabled, isMain, ...props}) => {\r\n\tconst classes = cx('btn', className, (isMain && 'btn_main'), (props.btnActive && 'btn_hlight'));\r\n\t\r\n\tconst childProps = { ...props };\r\n\tdelete childProps.btnActive;\r\n\t\r\n\treturn (\r\n\t\t<button {...childProps} disabled={disabled} className={classes} data-text={children}>\r\n\t\t\t{\r\n\t\t\t\tisMain ? \r\n\t\t\t\t\t<span>{children.toString()}</span> :\r\n\t\t\t\t\tchildren\r\n\t\t\t}\r\n\t\t</button>\r\n\t);\r\n};\r\n\r\nexport default Button;","import React, { useState } from 'react';\r\nimport icon_wallet from '../img/icon-wallet.svg';\r\nimport icon_link from '../img/icon-link.svg';\r\nimport Button from './UI/button/Button';\r\n\r\nconst Wallet = ({ address, setAddress }) => {\r\n\tconst [open, setOpen] = useState(false);\r\n\r\n\tfunction openWallet(e) {\r\n\t\tif (open) {\r\n\t\t\tcloseWallet();\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\te.stopPropagation();\r\n\t\tdocument.addEventListener('click', closeWallet);\r\n\t\tsetOpen(true);\r\n\t}\r\n\tfunction closeWallet() {\r\n\t\tdocument.removeEventListener('click', closeWallet);\r\n\t\tsetOpen(false);\r\n\t}\r\n\r\n\r\n\tfunction cutAddress(addr) {\r\n\t\tif (!addr) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\t\r\n\t\treturn addr.slice(0, 9) + '...' + addr.slice(-15);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<div className={\"wallet\" + (open ? \" active\" : \"\")}>\r\n\t\t\t<button className=\"wallet__header\" onClick={openWallet}>\r\n\t\t\t\t<div className=\"wallet__address\">\r\n\t\t\t\t\t<img src={icon_wallet} alt=\"ETH\" />\r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t{cutAddress(address)}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t</button>\r\n\t\t\t<div className=\"wallet__body\" onClick={(e) => e.stopPropagation()}>\r\n\t\t\t\t<button className=\"close-btn\" onClick={closeWallet}>\r\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" fill=\"none\">\r\n\t\t\t\t\t\t<g clipPath=\"url(#clip0_1830_494)\">\r\n\t\t\t\t\t\t\t<path d=\"M10 0.875L9.125 0L5 4.125L0.875 0L0 0.875L4.125 5L0 9.125L0.875 10L5 5.875L9.125 10L10 9.125L5.875 5L10 0.875Z\" fill=\"white\"/>\r\n\t\t\t\t\t\t</g>\r\n\t\t\t\t\t\t<defs>\r\n\t\t\t\t\t\t\t<clipPath id=\"clip0_1830_494\">\r\n\t\t\t\t\t\t\t\t<rect width=\"10\" height=\"10\" fill=\"white\"/>\r\n\t\t\t\t\t\t\t</clipPath>\r\n\t\t\t\t\t\t</defs>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</button>\r\n\t\t\t\t<a className=\"wallet__link\" href={`https://arbiscan.io/address/${address}`} rel='noreferrer' target='_blank'>\r\n\t\t\t\t\t<img src={icon_link} alt=\"external link\" />\r\n\t\t\t\t\t<span>View on Arbiscan</span>\r\n\t\t\t\t</a>\r\n\t\t\t\t<Button className=\"wallet__button\" btnActive={true} onClick={() => {\r\n\t\t\t\t\tsetAddress('');\r\n\t\t\t\t}}>\r\n\t\t\t\t\tDisconnect wallet\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Wallet;","import { createContext } from \"react\";\r\n\r\nexport const GlobalStatsContext = createContext(null)\r\nexport const UserStatsContext = createContext(null)","import { ethers } from 'ethers';\r\n\r\nconst ARBITRUM = 42161;\r\n\r\nexport const requestAccount = async (setWalletAddress) => {\r\n\tif (window.ethereum) {\r\n\t\ttry {\r\n\t\t\tif (window.ethereum.networkVersion && Number(window.ethereum.networkVersion) !== ARBITRUM) {\r\n\t\t\t\talert('Change your network (Arbitrum) and reload the page')\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait window.ethereum.request({\r\n\t\t\t\t\t\tmethod: \"wallet_switchEthereumChain\",\r\n\t\t\t\t\t\tparams: [{\r\n\t\t\t\t\t\t\tchainId: ethers.utils.hexlify(ARBITRUM)\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\twindow.location.reload()\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\tconsole.log(err);\r\n\r\n\t\t\t\t\tif (err.code === 4902) {\r\n\t\t\t\t\t\tawait window.ethereum.request({\r\n\t\t\t\t\t\t\tmethod: \"wallet_addEthereumChain\",\r\n\t\t\t\t\t\t\tparams: [{\r\n\t\t\t\t\t\t\t\tchainId: ethers.utils.hexlify(ARBITRUM),\r\n\t\t\t\t\t\t\t\tchainName: 'Arbitrum One',\r\n\t\t\t\t\t\t\t\tnativeCurrency: {\r\n\t\t\t\t\t\t\t\t\tsymbol: 'ETH',\r\n\t\t\t\t\t\t\t\t\tdecimals: 18\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\trpcUrls: ['https://arb1.arbitrum.io/rpc'],\r\n\t\t\t\t\t\t\t\tblockExplorerUrls: ['https://arbiscan.io/']\r\n\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\twindow.location.reload()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst accounts = await window.ethereum.request({\r\n\t\t\t\tmethod: 'eth_requestAccounts',\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tsetWalletAddress(accounts[0])\r\n\r\n\t\t\twindow.ethereum.on('accountsChanged', (accounts) => {\r\n\t\t\t\tsetWalletAddress(accounts[0])\r\n\t\t\t})\r\n\t\t} catch(e) {\r\n\t\t\tconsole.log(e);\r\n\t\t}\r\n\t\t\r\n\t} else {\r\n\t\talert('Please, install MetaMask extension to use this application.');\r\n\t}\r\n}\r\n\r\nexport const connectWallet = async (setWalletAddress) => {\r\n\tawait requestAccount(setWalletAddress);\r\n}\r\n\r\n\r\nexport const cutAddress = (addr, isAdaptive = true) => {\r\n\tif (!addr) {\r\n\t\treturn '';\r\n\t}\r\n\r\n\tif (isAdaptive && window.outerWidth <= 480) {\r\n\t\treturn addr.slice(0, 3) + '...' + addr.slice(-3);\r\n\t}\r\n\t\r\n\treturn addr.slice(0, 10) + '...' + addr.slice(-5);\r\n}","import { ethers } from 'ethers';\r\n\r\nexport const netProvider = new ethers.getDefaultProvider('https://arb-mainnet.g.alchemy.com/v2/r6kd0heyoOCe8RFndkyv0XW0F-BG38Fy');\r\n\r\n\r\nexport const mmProvider = window.ethereum ? new ethers.providers.Web3Provider(window.ethereum) : undefined;\r\n\r\nexport const signer = mmProvider?.getSigner()","import { ethers } from 'ethers';\r\nimport _DDL_POOL from '../../deployments/arbitrum_ddl/DDL_POOL.json'\r\nimport _USDC from \"../../deployments/arbitrum_ddl/USDC.json\";\r\nimport { netProvider, mmProvider, signer } from './providers.js';\r\n\r\n// Options Contracts\r\nexport const DDL_POOL = new ethers.Contract(_DDL_POOL.address, _DDL_POOL.abi, mmProvider ?? netProvider);\r\nexport const DDL_POOL_signed = DDL_POOL.connect(signer);\r\n\r\nexport const USDC = new ethers.Contract(_USDC.address, _USDC.abi, mmProvider ?? netProvider);\r\nexport const USDC_signed = USDC.connect(signer);\r\n\r\n\r\n// Hegic Strategies\r\nexport const HEGIC_STRATEGIES = {\r\n\tshort: {\r\n\t\tHegicStrategy_CALL_100_BTC_1: '0x527d1086C3DD22FcdB338F69D47A1e4bFE11E539',\r\n    HegicStrategy_CALL_100_ETH_1: '0x09a4B65b3144733f1bFBa6aEaBEDFb027a38Fb60',\r\n    HegicStrategy_CALL_110_BTC_1: '0x377191F680b52ce3d0060388fEF01be7ef68e3d5',\r\n    HegicStrategy_CALL_110_ETH_1: '0xF48f571DdD77dba9Ae10fefF6df04484685091D9',\r\n    HegicStrategy_CALL_120_BTC_1: '0x8Fb8529695237D4004cffb21499e7E49E982786a',\r\n    HegicStrategy_CALL_120_ETH_1: '0x96416b82C9DFA7649570c784Eb0D0FFcDE361cFE',\r\n    HegicStrategy_CALL_130_BTC_1: '0x32563D6151891c0A8d56eD644AcDEa6FE5f4E4eB',\r\n    HegicStrategy_CALL_130_ETH_1: '0xf8b8b54bE1Eb37E76873670Ac9DE3C28b507142C',\r\n\t\tHegicStrategy_PUT_100_BTC_1: '0xA8DF600289bEc25602741756f55f27ffFDAB69a6',\r\n    HegicStrategy_PUT_100_ETH_1: '0xaA0DfBFb8dA7f45BB41c0fB68B71FAEB959B22aa',\r\n    HegicStrategy_PUT_70_BTC_1: '0x7066286C1AA0FeBE0f63eF8a44F6Fea9F05FFBE0',\r\n    HegicStrategy_PUT_70_ETH_1: '0x35EF16F3c329a54050Ca120145340dfC2b4F9541',\r\n    HegicStrategy_PUT_80_BTC_1: '0x06c3Ba025bEd24Ea38c2BdDA4bcD2A7F9f5C30e1',\r\n    HegicStrategy_PUT_80_ETH_1: '0x77C8d12d9E2D21f6eE02E8ccA332fDe4BE5C2465',\r\n    HegicStrategy_PUT_90_BTC_1: '0xe115beD3b0752BBbbEF5C423021b464bBF93dC2c',\r\n    HegicStrategy_PUT_90_ETH_1: '0x6B7e5906F53d8bB365f4A6fA776Fd0f0caf57881',\r\n\t},\r\n\tmedShort: {\r\n\t\tHegicStrategy_CALL_100_BTC_2: '0x20ee3e61e8f1eB8ae959abf5F78bA8731d010Ac3',\r\n    HegicStrategy_CALL_100_ETH_2: '0x6418C3514923a6464A26A2ffA5f17bF1efC96a21',\r\n    HegicStrategy_CALL_110_BTC_2: '0xaFA483B18FE66251C8306C7018028f674F653012',\r\n    HegicStrategy_CALL_110_ETH_2: '0xaF38a4d9153B149F05FA85C2cCFAaA677c99040E',\r\n    HegicStrategy_CALL_120_BTC_2: '0xFe35F1AB7e18930d4316B86fCefBCF053bf44A45',\r\n    HegicStrategy_CALL_120_ETH_2: '0x1060e80c1156060a1E8DdB9C64Afe74564865Ee2',\r\n    HegicStrategy_CALL_130_BTC_2: '0xe4DB400BFC4D627559D592db4ca2839cb87Fbbfc',\r\n    HegicStrategy_CALL_130_ETH_2: '0xc00103524932d86770d4F671107b0E170BD0fe6c',\r\n\t\tHegicStrategy_PUT_100_BTC_2: '0xE0f083fd87ebAEBFCfa8236098048105d32639E4',\r\n    HegicStrategy_PUT_100_ETH_2: '0x2739A4C003080A5B3Ade22b92c3321EDa2Da3A9e',\r\n    HegicStrategy_PUT_70_BTC_2: '0x52442a8C632D4c998A8BDBf44A70481AA5599b0e',\r\n    HegicStrategy_PUT_70_ETH_2: '0x48EcF46Aa51992a064aB172439ABFE182F39b478',\r\n    HegicStrategy_PUT_80_BTC_2: '0xb02343D33d2447870E38b3452Ef59d0De7b3289d',\r\n    HegicStrategy_PUT_80_ETH_2: '0xb58ccd922B57422d0497904B7D9fccB922b8aaDf',\r\n    HegicStrategy_PUT_90_BTC_2: '0x7d0c3FDF0e8A6f475Ed1834ae05fDa1E519fd227',\r\n    HegicStrategy_PUT_90_ETH_2: '0x3e2a0fE32Cc000d87D9e5D6ed8b3D64e9c74C752',\r\n\t},\r\n\tmedLong: {\r\n\t\tHegicStrategy_CALL_100_BTC_3: '0x21a4b4441AA957735902507A72A58A3a1Caaa0dC',\r\n    HegicStrategy_CALL_100_ETH_3: '0xE377A1a97237b3B89a96d8B731A2ab10d5DaC16C',\r\n    HegicStrategy_CALL_110_BTC_3: '0x6c46e2531a42F618F2ae452971DC9a7c6AD48D15',\r\n    HegicStrategy_CALL_110_ETH_3: '0x05458B7d9531EaD242290De60bEaa3cC10C87560',\r\n    HegicStrategy_CALL_120_BTC_3: '0xe259410Bbfb45CE89FDA81ec0A97d36Da8Db4374',\r\n    HegicStrategy_CALL_120_ETH_3: '0x79F87E88088293FE34dEf4eBe71fBFa5367220B4',\r\n    HegicStrategy_CALL_130_BTC_3: '0x27806482457FC98F9C2e724b5E604C66BB5ba121',\r\n    HegicStrategy_CALL_130_ETH_3: '0xae2F4e15564995af79b7dd2378B2680f7Facc342',\r\n    HegicStrategy_PUT_100_BTC_3: '0x035b965c5B7bC20E00358ACF1794d2248eA1932A',\r\n    HegicStrategy_PUT_100_ETH_3: '0xf711D0BC60F37cA28845BA623ccd9C635E5073A1',\r\n    HegicStrategy_PUT_70_BTC_3: '0x55c4532e1790592120b7b27436842caD203E7CD3',\r\n    HegicStrategy_PUT_70_ETH_3: '0xF55F6d98e2F48F8D46757D5A6e225bf0ADC9651C',\r\n    HegicStrategy_PUT_80_BTC_3: '0x8dD239e0e51BCAAd503b06D818ce811e7D99c1Af',\r\n    HegicStrategy_PUT_80_ETH_3: '0xdF30cdb7abb3Ca707b82359A349D3b0C94d4a421',\r\n    HegicStrategy_PUT_90_BTC_3: '0xE56BEAfAe4731A21eF83fe81F63b95055e81E374',\r\n    HegicStrategy_PUT_90_ETH_3: '0x33a4B4403B8C6349371CbDf539138D78ec0Aab66',\r\n\t},\r\n\tlong: {\r\n\t\tHegicStrategy_CALL_100_BTC_4: '0xc07fBf677f417bb9FfDD8248A74c7FBcCFaDAe9e',\r\n    HegicStrategy_CALL_100_ETH_4: '0x2727B807D22fCAeB7F900F49894054Ed92b9125B',\r\n    HegicStrategy_CALL_110_BTC_4: '0x14d25367102A931E2E2F587F4ED94087dc585fd0',\r\n    HegicStrategy_CALL_110_ETH_4: '0xE53a20c824cEAB8151AF8Fc92E7Eb689cFbD1231',\r\n    HegicStrategy_CALL_120_BTC_4: '0xBAbccB37338488AFBaBECAE2C3D21b9a71289A73',\r\n    HegicStrategy_CALL_120_ETH_4: '0xB7b36483B256290435a060805bdF15B3f2b122eb',\r\n    HegicStrategy_CALL_130_BTC_4: '0x9fA4DFfBE3B129988e0d09536b0E2D74F6bF7D91',\r\n    HegicStrategy_CALL_130_ETH_4: '0x4dC39763ccC861dB1c8e80c34C0079c9A12f03E4',\r\n    HegicStrategy_PUT_100_BTC_4: '0xEd46f602212d1CbaCd699C876b4A49761421bf97',\r\n    HegicStrategy_PUT_100_ETH_4: '0x015FAA9aF7599e6cea597EBC7e7e04A149a3E992',\r\n    HegicStrategy_PUT_70_BTC_4: '0xa26541ccE18CcC6E21360562d34044ceb3B5A40e',\r\n    HegicStrategy_PUT_70_ETH_4: '0x5BBe6C4A66D4a48442dc0837a0eA859a11D7766C',\r\n    HegicStrategy_PUT_80_BTC_4: '0xFD203c73851986ad7e7B99457AeafF3d98e76228',\r\n    HegicStrategy_PUT_80_ETH_4: '0x7FD5E8B2Ef25A105bf6B1c45f62d8925Eaa068Bc',\r\n    HegicStrategy_PUT_90_BTC_4: '0x02d730e3dEb3B5876fE2Cba59423ef1Db8211DA1',\r\n    HegicStrategy_PUT_90_ETH_4: '0x3031EA515c2274024D93A8D3BfA91ce920E1192E',\r\n\t}\r\n}\r\n\r\nexport const PRICE_CALCULATORS = {\r\n  PriceCalculator_PUT_100_BTC: '0x4567600c2c813322F0CBb358a8d083296A7eEA37',\r\n  PriceCalculator_PUT_100_ETH: '0xB72FC913e45522cD721252476fEfB7F50a65E23A',\r\n  PriceCalculator_PUT_70_BTC: '0x3aFbaf00a6C42e6BE67f8a618b17fB3D441C1898',\r\n  PriceCalculator_PUT_70_ETH: '0xf3625e26cb920f762dEC8DB4fE4845E9384313C0',\r\n  PriceCalculator_PUT_80_BTC: '0x9C3BBe90191F8311939A34737c02A6B49e27caA5',\r\n  PriceCalculator_PUT_80_ETH: '0x58051Cb78094551afC202C50085B13bF00BF624E',\r\n  PriceCalculator_PUT_90_BTC: '0x56A2dC3fAc4bE0A1716c938295e141195e4A1cb3',\r\n  PriceCalculator_PUT_90_ETH: '0x1AF37c8412bCdAa6C6dD4D2E2aDae2B8292603D4',\r\n  PriceCalculator_CALL_100_BTC: '0xAA4483Da5c4D17830dE9a843d07C37b3eC028d9F',\r\n  PriceCalculator_CALL_100_ETH: '0xC62a0b7e480a23BdCfe13EA08BDAceDc278a14C1',\r\n  PriceCalculator_CALL_110_BTC: '0x04BFC83f6277cf50dFB032EFd348316aACbD7863',\r\n  PriceCalculator_CALL_110_ETH: '0x6316BC5f5dF141ae88C436Fe6047D334f1B7e485',\r\n  PriceCalculator_CALL_120_BTC: '0x965Ded687bc0Da3388c6925e0Eb330bD44629B77',\r\n  PriceCalculator_CALL_120_ETH: '0x321F8A71e8268f50eBd2f748D524E7750AD70798',\r\n  PriceCalculator_CALL_130_BTC: '0x4b350b7457b54C5A76828f81472f2719D801D0D5',\r\n  PriceCalculator_CALL_130_ETH: '0xffdc9da896d3301DE596b16a389138B70b1CBAdb',\r\n}\r\n\r\nexport const HEGIC_BUY_URLS = {\r\n  PUT_100_BTC: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=put-100&&strategyName=bear-put&asset=BTC&sentiment=bear\",\r\n  PUT_100_ETH: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=put-100&&strategyName=bear-put&asset=ETH&sentiment=bear\",\r\n  PUT_70_BTC: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=put-70&&strategyName=bear-put&asset=BTC&sentiment=bear\",\r\n  PUT_70_ETH: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=put-70&&strategyName=bear-put&asset=ETH&sentiment=bear\",\r\n  PUT_80_BTC: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=put-80&&strategyName=bear-put&asset=BTC&sentiment=bear\",\r\n  PUT_80_ETH: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=put-80&&strategyName=bear-put&asset=ETH&sentiment=bear\",\r\n  PUT_90_BTC: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=put-90&&strategyName=bear-put&asset=BTC&sentiment=bear\",\r\n  PUT_90_ETH: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=put-90&&strategyName=bear-put&asset=ETH&sentiment=bear\",\r\n\r\n  CALL_100_BTC: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=call-100&&strategyName=bull-call&asset=BTC&sentiment=bull\",\r\n  CALL_100_ETH: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=call-100&&strategyName=bull-call&asset=ETH\",\r\n  CALL_110_BTC: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=call-110&&strategyName=bull-call&asset=BTC&sentiment=bull\",\r\n  CALL_110_ETH: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=call-110&&strategyName=bull-call&asset=ETH\",\r\n  CALL_120_BTC: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=call-120&&strategyName=bull-call&asset=BTC&sentiment=bull\",\r\n  CALL_120_ETH: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=call-120&&strategyName=bull-call&asset=ETH\",\r\n  CALL_130_BTC: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=call-130&&strategyName=bull-call&asset=BTC&sentiment=bull\",\r\n  CALL_130_ETH: \"https://www.hegic.co/app#/arbitrum/trade/new?strikeName=call-130&&strategyName=bull-call&asset=ETH\",\r\n}\r\n\r\n\r\nexport const CHAI_CONTRACT_ETH = '0x639Fe6ab55C921f74e7fac1ee960C0B6293ba612';\r\nexport const CHAI_CONTRACT_BTC = '0x6ce185860a4963106506C203335A2910413708e9';\r\n\r\n\r\nexport const LyraQuoter = '0x23236b4c7772636b5224df56Be8168A2f42df31C';\r\n\r\nexport const PremiaPools = {\r\n  ETH: \"0xE5DbC4EDf467B609A063c7ea7fAb976C6b9BAa1a\",\r\n  BTC: \"0xb5fE3bc2eF4c34cC233922dfF2Fcb1B1BF89A38E\"\r\n}","export const separateThousands = (num, symb = \",\") => {\r\n\tif (typeof num === 'undefined' || num === null) {\r\n\t\treturn '';\r\n\t}\r\n\t\r\n\tconst str = num.toString();\r\n\tlet [intPart, fractionPart] = str.split('.')\r\n\tconst hasFraction = fractionPart !== undefined;\r\n\r\n\tintPart = intPart.replace(/\\B(?=(\\d{3})+(?!\\d))/g, hasFraction ? ',' : symb)\r\n\t\r\n\tif (hasFraction) {\r\n\t\tif (fractionPart.length === 1 && symb !== ' ') {\r\n\t\t\tfractionPart += '0'\r\n\t\t}\r\n\t\t\r\n\t\treturn intPart + '.' + fractionPart\r\n\t} else {\r\n\t\treturn intPart;\r\n\t}\r\n}\r\n\r\n\r\nconst removeNonNumeric = (num) => {\r\n\tlet result = num.toString().replace(/^\\./g, '').replace(/[^0-9.]/g, '').replace(/^0\\d/, '');\r\n\r\n\tif (result.match(/\\./g)?.length > 1) {\r\n\t\tresult = result.replace(/\\.$/, '')\r\n\t}\r\n\r\n\tlet [, fractionPart] = result.split('.')\r\n\r\n\tif (fractionPart?.length > 6) {\r\n\t\tresult = result.substr(0, result.length - 1)\r\n\t}\r\n\t\r\n\treturn result;\r\n}\r\n\r\nexport const convertInputNum = (num) => {\r\n\treturn separateThousands(removeNonNumeric(num), ' ');\r\n}\r\n\r\nexport const nonFractionConvert = (num) => {\r\n\tconst val = (num).replace(/[^0-9]/g, '').replace(/^0\\d/, '').replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\r\n\treturn val;\r\n}\r\n\r\n\r\nexport const sepToNumber = (str, symb = ' ') => {\r\n\tif (typeof str !== 'string') {\r\n\t\treturn str;\r\n\t}\r\n\r\n\tif (symb === ' ' && str.split(symb).length === 1) {\r\n\t\tsymb = ',';\r\n\t}\r\n\t\r\n\treturn Number(str.split(symb).join(''));\r\n}","import { sepToNumber } from \"./sepThousands\";\r\n\r\nexport const floor = (num, fraction = 2) => {\r\n\tif (typeof num !== 'number') {\r\n\t\treturn '...'\r\n\t}\r\n\t\r\n\treturn Math.floor(num * 10**fraction) / 10**fraction;\r\n}\r\n\r\n\r\nexport const formatForContract = (val, fraction = 6) => {\r\n\treturn Math.floor(sepToNumber(val) * 10**fraction);\r\n}","import { ethers } from \"ethers\"\r\nimport { USDC, DDL_POOL } from './contracts';\r\nimport { floor } from './math';\r\n\r\n\r\nexport const getGlobalStats = async () => {\r\n\tconst globalStats = {}\r\n\t\r\n\tconst totalBalance = (await DDL_POOL.getTotalBalance()).toNumber()\r\n\t\r\n\tconst totalLocked = (await DDL_POOL.totalLocked()).toNumber()\r\n\tconst totalSupplied = totalBalance + totalLocked;\r\n\tglobalStats.totalSupplied = Math.round(ethers.utils.formatUnits(totalSupplied, 6));\r\n\tglobalStats.availToBorrow = Math.round(ethers.utils.formatUnits(totalBalance, 6));\r\n\tglobalStats.totalBorrowed = Math.round(ethers.utils.formatUnits(totalLocked, 6));\r\n\t\r\n\tglobalStats.utilRate = floor(totalSupplied === 0 ? \r\n\t\t0 : (totalLocked / totalSupplied * 100))\r\n\tglobalStats.borrowAPY = 10;\r\n\t\r\n\t\r\n\treturn globalStats;\r\n}\r\n\r\nexport const getUserStats = async (walletAddress) => {\r\n\ttry {\r\n\t\tconst balance = Number(ethers.utils.formatUnits(await USDC.balanceOf(walletAddress), 6))\r\n\t\tconst curBalance = Number(ethers.utils.formatUnits(await DDL_POOL.shareOf(walletAddress), 6))\r\n\t\r\n\t\tconst totalBalance = (await DDL_POOL.getTotalBalance()).toNumber()\r\n\t\tconst avail = Math.min(curBalance, totalBalance)\r\n\t\r\n\t\tconst userStats = {\r\n\t\t\tbalance: floor(balance),\r\n\t\t\tcurBalance: floor(curBalance),\r\n\t\t\tavail: floor(avail),\r\n\t\t}\r\n\t\r\n\t\treturn userStats;\r\n\t} catch(err) {\r\n\t\tconsole.log(err);\r\n\t}\r\n\t\r\n}","import React from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport cx from 'classnames';\r\n\r\nconst Tabs = ({className, links}) => {\r\n\tconst cls = cx(className, 'tabs');\r\n\t\r\n\treturn (\r\n\t\t<div className={cls}>\r\n\t\t\t{links.map((link) => {\r\n\t\t\t\tif (link.isHidden) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst linkCls = cx('btn', 'btn_tab', link.isActive && 'active');\r\n\t\t\t\tconst linkEl = link.isExternal ?\r\n\t\t\t\t\t<a className={linkCls} target=\"_blank\" rel=\"noreferrer\" href={link.to}  key={link.to}>{link.name}</a>\r\n\t\t\t\t\t: <Link to={link.to} className={linkCls} key={link.to}>{link.name}</Link>\r\n\t\t\t\treturn (\r\n\t\t\t\t\tlinkEl\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t\t\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Tabs;","import React, { useContext, useEffect, useState } from 'react';\r\nimport Logo from './components/UI/logo/Logo'\r\nimport Button from './components/UI/button/Button';\r\nimport Wallet from './components/Wallet';\r\nimport { GlobalStatsContext, UserStatsContext } from './context/context';\r\nimport { ethers } from 'ethers';\r\nimport { connectWallet } from './components/utils/wallet';\r\nimport { getGlobalStats, getUserStats } from './components/utils/stats';\r\nimport { useLocation } from 'react-router-dom';\r\nimport Tabs from './components/Tabs';\r\n\r\n\r\nconst Header = (props) => {\r\n\tconst {\r\n\t\twalletAddress, \r\n\t\tsetWalletAddress,\r\n\t} = props;\r\n\r\n\tconst { setGlobalStats } = useContext(GlobalStatsContext)\r\n\tconst { setUserStats } = useContext(UserStatsContext)\r\n\t\r\n\r\n\tuseEffect(() => {\r\n\t\tconnectWallet(setWalletAddress)\r\n\r\n\t\tgetGlobalStats()\r\n\t\t\t.then(stats => {\r\n\t\t\t\tsetGlobalStats(stats)\r\n\t\t\t})\r\n\t}, [window.ethereum?.networkVersion])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (walletAddress) {\r\n\t\t\tgetUserStats(walletAddress)\r\n\t\t\t\t.then(stats => {\r\n\t\t\t\t\tsetUserStats(stats)\r\n\t\t\t\t})\r\n\t\t}\r\n\t}, [walletAddress])\r\n\r\n\r\n\tconst loc = useLocation();\r\n\tconst headerLinks = [\r\n\t\t{\r\n\t\t\tname: 'Perpetuals',\r\n\t\t\tto: '/perpetuals',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Options',\r\n\t\t\tto: '/options',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Borrow USDC',\r\n\t\t\tto: 'https://borrow.dedelend.co/',\r\n\t\t\tisExternal: true,\r\n\t\t},\r\n\t]\r\n\theaderLinks.find(link => {\r\n\t\tlink.isActive = loc.pathname === link.to;\r\n\t\treturn link.isActive;\r\n\t})\r\n\r\n\treturn (\r\n\t\t<header className='header'>\r\n\t\t\t<div className=\"header__content _container\">\r\n\t\t\t\t<div className=\"header__nav\">\r\n\t\t\t\t\t<Logo />\r\n\t\t\t\t\t<Tabs className='header__links' links={headerLinks} />\r\n\t\t\t\t</div>\r\n\t\t\t\t{walletAddress ?\r\n\t\t\t\t\t<Wallet address={walletAddress} \r\n\t\t\t\t\t\tsetAddress={setWalletAddress}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<Button isMain={true} onClick={(e) => {\r\n\t\t\t\t\t\tconnectWallet(setWalletAddress)\r\n\t\t\t\t\t}}>Connect wallet</Button>}\r\n\t\t\t</div>\r\n\t\t</header>\r\n\t);\r\n};\r\n\r\nexport default Header;","import React from 'react';\r\nimport Logo from './components/UI/logo/Logo';\r\n\r\nconst Footer = () => {\r\n\treturn (\r\n\t\t<footer className=\"footer\">\r\n\t\t\t<div className=\"footer__content _container\">\r\n\t\t\t\t<Logo></Logo>\r\n\t\t\t\t<div className=\"footer__smedia-items\">\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://mirror.xyz/0x0641bc55DDAb3b9636e82CbF87EDE3c3c533039d\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<g clipPath=\"url(#clip0_58_113)\">\r\n\t\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t\t<path d=\"M9 14C9 10.6863 11.6863 8 15 8C18.3137 8 21 10.6863 21 14V21.3929C21 22.2805 20.2805 23 19.3929 23H10.6071C9.71954 23 9 22.2805 9 21.3929V14Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t\t</g>\r\n\t\t\t\t\t\t\t<defs>\r\n\t\t\t\t\t\t\t\t<clipPath id=\"clip0_58_113\">\r\n\t\t\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"3\" fill=\"white\"/>\r\n\t\t\t\t\t\t\t\t</clipPath>\r\n\t\t\t\t\t\t\t</defs>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://github.com/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M15.5 8C11.3562 8 8 11.4411 8 15.6897C8 19.0924 10.1469 21.9664 13.1281 22.9853C13.5031 23.0526 13.6437 22.8219 13.6437 22.62C13.6437 22.4374 13.6344 21.8319 13.6344 21.1878C11.75 21.5435 11.2625 20.7168 11.1125 20.2843C11.0281 20.0632 10.6625 19.3808 10.3438 19.1981C10.0812 19.0539 9.70625 18.6983 10.3344 18.6887C10.925 18.6791 11.3469 19.2462 11.4875 19.4769C12.1625 20.64 13.2406 20.3131 13.6719 20.1113C13.7375 19.6115 13.9344 19.275 14.15 19.0828C12.4812 18.8905 10.7375 18.2273 10.7375 15.286C10.7375 14.4497 11.0281 13.7577 11.5063 13.2194C11.4313 13.0271 11.1688 12.2389 11.5812 11.1816C11.5812 11.1816 12.2094 10.9798 13.6437 11.9698C14.2437 11.7968 14.8812 11.7103 15.5187 11.7103C16.1562 11.7103 16.7937 11.7968 17.3938 11.9698C18.8281 10.9701 19.4563 11.1816 19.4563 11.1816C19.8687 12.2389 19.6063 13.0271 19.5312 13.2194C20.0094 13.7577 20.3 14.4401 20.3 15.286C20.3 18.2369 18.5469 18.8905 16.8781 19.0828C17.15 19.3231 17.3844 19.7845 17.3844 20.5054C17.3844 21.5339 17.375 22.3605 17.375 22.62C17.375 22.8219 17.5156 23.0622 17.8906 22.9853C19.3795 22.4699 20.6732 21.4888 21.5898 20.1801C22.5063 18.8714 22.9996 17.3009 23 15.6897C23 11.4411 19.6438 8 15.5 8Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://twitter.com/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M23 10.4234C22.4484 10.664 21.8558 10.8265 21.2328 10.8999C21.8756 10.5215 22.3565 9.92574 22.5858 9.22397C21.9819 9.57697 21.3209 9.82545 20.6317 9.95859C20.1682 9.47158 19.5543 9.14877 18.8852 9.0403C18.2162 8.93183 17.5295 9.04376 16.9317 9.35871C16.334 9.67366 15.8586 10.174 15.5794 10.7821C15.3002 11.3902 15.2328 12.0719 15.3877 12.7215C14.164 12.6611 12.9669 12.3481 11.8741 11.8029C10.7813 11.2577 9.81726 10.4924 9.04444 9.55683C8.78019 10.0054 8.62825 10.5255 8.62825 11.0794C8.62795 11.578 8.75273 12.069 8.99151 12.5088C9.23029 12.9486 9.57568 13.3236 9.99705 13.6005C9.50837 13.5852 9.03048 13.4552 8.60314 13.2215V13.2605C8.6031 13.9598 8.84892 14.6377 9.2989 15.1789C9.74888 15.7202 10.3753 16.0916 11.0719 16.2302C10.6185 16.3509 10.1433 16.3687 9.68193 16.2822C9.87847 16.8839 10.2613 17.4101 10.7768 17.7871C11.2923 18.1641 11.9148 18.373 12.5569 18.3846C11.4668 19.2268 10.1205 19.6836 8.73461 19.6816C8.48911 19.6816 8.24382 19.6675 8 19.6393C9.40677 20.5294 11.0444 21.0018 12.7168 21C18.3783 21 21.4733 16.3855 21.4733 12.3835C21.4733 12.2535 21.47 12.1221 21.4641 11.9921C22.0661 11.5637 22.5857 11.0332 22.9987 10.4254L23 10.4234Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://discord.gg/5DGZ7rzSfS\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M20.6981 10.9123C19.7418 10.4907 18.7169 10.179 17.645 10.0018C17.6355 10 17.6256 10.0012 17.6167 10.0051C17.6079 10.009 17.6005 10.0156 17.5956 10.0238C17.4644 10.2493 17.3182 10.5432 17.2157 10.7754C16.0789 10.6094 14.9232 10.6094 13.7864 10.7754C13.6722 10.5181 13.5435 10.2671 13.4008 10.0238C13.3959 10.0155 13.3886 10.0088 13.3798 10.0047C13.371 10.0005 13.3611 9.99908 13.3514 10.0006C12.2802 10.1778 11.2552 10.4894 10.2984 10.9117C10.2901 10.9151 10.2831 10.9208 10.2784 10.9282C8.33342 13.7238 7.80031 16.4504 8.06217 19.1428C8.0629 19.1494 8.065 19.1558 8.06833 19.1616C8.07166 19.1673 8.07616 19.1724 8.08155 19.1764C9.21676 19.9845 10.4829 20.6001 11.8271 20.9974C11.8364 21.0002 11.8465 21.0002 11.8558 20.9974C11.8652 20.9946 11.8735 20.989 11.8796 20.9815C12.1688 20.6033 12.4251 20.2021 12.6458 19.782C12.6489 19.7762 12.6506 19.7699 12.651 19.7635C12.6513 19.757 12.6502 19.7505 12.6478 19.7445C12.6454 19.7385 12.6417 19.733 12.6369 19.7285C12.6321 19.724 12.6264 19.7206 12.6202 19.7184C12.2164 19.5698 11.8252 19.3904 11.4502 19.1819C11.4435 19.1782 11.4378 19.1728 11.4337 19.1664C11.4296 19.16 11.4272 19.1526 11.4267 19.145C11.4262 19.1375 11.4276 19.1299 11.4308 19.123C11.4341 19.1161 11.439 19.1101 11.4452 19.1055C11.5239 19.0487 11.6027 18.9894 11.6777 18.9302C11.6844 18.9248 11.6926 18.9214 11.7012 18.9204C11.7098 18.9193 11.7185 18.9206 11.7264 18.9241C14.1807 20.002 16.8388 20.002 19.2643 18.9241C19.2723 18.9204 19.2811 18.9189 19.2898 18.9199C19.2986 18.9208 19.3068 18.9242 19.3137 18.9295C19.3887 18.9894 19.4668 19.0487 19.5462 19.1055C19.5525 19.11 19.5575 19.1159 19.5608 19.1228C19.5642 19.1296 19.5657 19.1371 19.5653 19.1447C19.565 19.1523 19.5627 19.1596 19.5587 19.1661C19.5547 19.1726 19.5491 19.1781 19.5425 19.1819C19.1687 19.3921 18.78 19.57 18.3719 19.7178C18.3656 19.7201 18.3599 19.7236 18.3551 19.7281C18.3504 19.7327 18.3466 19.7382 18.3442 19.7442C18.3418 19.7503 18.3407 19.7568 18.3411 19.7633C18.3414 19.7698 18.3432 19.7762 18.3463 19.782C18.5712 20.2018 18.8287 20.6014 19.1119 20.9809C19.1177 20.9887 19.1259 20.9945 19.1353 20.9976C19.1447 21.0006 19.1549 21.0008 19.1644 20.998C20.5108 20.6018 21.779 19.986 22.9155 19.1764C22.921 19.1726 22.9257 19.1677 22.9291 19.162C22.9326 19.1563 22.9348 19.15 22.9355 19.1434C23.248 16.0306 22.4118 13.326 20.7174 10.9294C20.7133 10.9216 20.7064 10.9155 20.6981 10.9123ZM13.0127 17.5033C12.2739 17.5033 11.6646 16.8501 11.6646 16.049C11.6646 15.2472 12.2621 14.5946 13.0127 14.5946C13.7689 14.5946 14.3726 15.2527 14.3607 16.049C14.3607 16.8507 13.7633 17.5033 13.0127 17.5033ZM17.9969 17.5033C17.2575 17.5033 16.6488 16.8501 16.6488 16.049C16.6488 15.2472 17.2457 14.5946 17.9969 14.5946C18.7531 14.5946 19.3568 15.2527 19.345 16.049C19.345 16.8507 18.7537 17.5033 17.9969 17.5033Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://t.me/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M21.9875 9.0789L8.70041 13.9664C7.79362 14.3138 7.79886 14.7964 8.53404 15.0115L11.9454 16.0267L19.8382 11.2764C20.2114 11.0598 20.5524 11.1763 20.2721 11.4136L13.8774 16.9188H13.8759L13.8774 16.9195L13.642 20.2737C13.9868 20.2737 14.1389 20.1228 14.3323 19.9448L15.9892 18.4079L19.4358 20.8363C20.0713 21.1701 20.5277 20.9985 20.6858 20.2751L22.9483 10.104C23.1798 9.2183 22.5938 8.81726 21.9875 9.0789Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</footer>\r\n\t);\r\n};\r\n\r\nexport default Footer;","const CONTRACTS = {\r\n  56: {\r\n    // bsc mainnet\r\n    Treasury: \"0xa44E7252a0C137748F523F112644042E5987FfC7\",\r\n    BUSD: \"0xe9e7cea3dedca5984780bafc599bd69add087d56\",\r\n    GMT: \"0x99e92123eB77Bc8f999316f622e5222498438784\",\r\n    Vault: \"0xc73A8DcAc88498FD4b4B1b2AaA37b0a2614Ff67B\",\r\n    Router: \"0xD46B23D042E976F8666F554E928e0Dc7478a8E1f\",\r\n    Reader: \"0x087A618fD25c92B61254DBe37b09E5E8065FeaE7\",\r\n    AmmFactory: \"0xBCfCcbde45cE874adCB698cC183deBcF17952812\",\r\n    AmmFactoryV2: \"0xcA143Ce32Fe78f1f7019d7d551a6402fC5350c73\",\r\n    OrderBook: \"0x1111111111111111111111111111111111111111\",\r\n    OrderBookReader: \"0x1111111111111111111111111111111111111111\",\r\n    GmxMigrator: \"0xDEF2af818514c1Ca1A9bBe2a4D45E28f260063f9\",\r\n    USDG: \"0x85E76cbf4893c1fbcB34dCF1239A91CE2A4CF5a7\",\r\n    NATIVE_TOKEN: \"0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c\",\r\n    XGMT: \"0xe304ff0983922787Fd84BC9170CD21bF78B16B10\",\r\n    GMT_USDG_PAIR: \"0xa41e57459f09a126F358E118b693789d088eA8A0\",\r\n    XGMT_USDG_PAIR: \"0x0b622208fc0691C2486A3AE6B7C875b4A174b317\",\r\n    GMT_USDG_FARM: \"0x3E8B08876c791dC880ADC8f965A02e53Bb9C0422\",\r\n    XGMT_USDG_FARM: \"0x68D7ee2A16AB7c0Ee1D670BECd144166d2Ae0759\",\r\n    USDG_YIELD_TRACKER: \"0x0EF0Cf825B8e9F89A43FfD392664131cFB4cfA89\",\r\n    XGMT_YIELD_TRACKER: \"0x82A012A9b3003b18B6bCd6052cbbef7Fa4892e80\",\r\n    GMT_USDG_FARM_TRACKER_XGMT: \"0x08FAb024BEfcb6068847726b2eccEAd18b6c23Cd\",\r\n    GMT_USDG_FARM_TRACKER_NATIVE: \"0xd8E26637B34B2487Cad1f91808878a391134C5c2\",\r\n    XGMT_USDG_FARM_TRACKER_XGMT: \"0x026A02F7F26C1AFccb9Cba7C4df3Dc810F4e92e8\",\r\n    XGMT_USDG_FARM_TRACKER_NATIVE: \"0x22458CEbD14a9679b2880147d08CA1ce5aa40E84\",\r\n    AUTO: \"0xa184088a740c695E156F91f5cC086a06bb78b827\",\r\n    AUTO_USDG_PAIR: \"0x0523FD5C53ea5419B4DAF656BC1b157dDFE3ce50\",\r\n    AUTO_USDG_FARM: \"0xE6958298328D02051769282628a3b4178D0F3A47\",\r\n    AUTO_USDG_FARM_TRACKER_XGMT: \"0x093b8be41c1A30704De84a9521632f9a139c08bd\",\r\n    AUTO_USDG_FARM_TRACKER_NATIVE: \"0x23ed48E5dce3acC7704d0ce275B7b9a0e346b63A\",\r\n    GMT_GMX_IOU: \"0x47052469970C2484729875CC9E2dd2683fcE71fb\",\r\n    XGMT_GMX_IOU: \"0xeB3733DFe3b68C9d26898De2493A3Bb59FDb4A7B\",\r\n    GMT_USDG_GMX_IOU: \"0x481312655F81b5e249780A6a49735335BF6Ca7f4\",\r\n    XGMT_USDG_GMX_IOU: \"0x8095F1A92526C304623483018aA28cC6E62EB1e1\",\r\n  },\r\n  97: {\r\n    // bsc testnet\r\n    Vault: \"0x1B183979a5cd95FAF392c8002dbF0D5A1C687D9a\",\r\n    Router: \"0x10800f683aa564534497a5b67F45bE3556a955AB\",\r\n    Reader: \"0x98D4742F1B6a821bae672Cd8721283b91996E454\",\r\n    AmmFactory: \"0x6725f303b657a9451d8ba641348b6761a6cc7a17\",\r\n    AmmFactoryV2: \"0x1111111111111111111111111111111111111111\",\r\n    OrderBook: \"0x9afD7B4f0b58d65F6b2978D3581383a06b2ac4e9\",\r\n    OrderBookReader: \"0x0713562970D1A802Fa3FeB1D15F9809943982Ea9\",\r\n    GmxMigrator: \"0xDEF2af818514c1Ca1A9bBe2a4D45E28f260063f9\",\r\n    USDG: \"0x2D549bdBf810523fe9cd660cC35fE05f0FcAa028\",\r\n    GMT: \"0xedba0360a44f885ed390fad01aa34d00d2532817\",\r\n    NATIVE_TOKEN: \"0x612777Eea37a44F7a95E3B101C39e1E2695fa6C2\",\r\n    XGMT: \"0x28cba798eca1a3128ffd1b734afb93870f22e613\",\r\n    GMT_USDG_PAIR: \"0xe0b0a315746f51932de033ab27223d85114c6b85\",\r\n    XGMT_USDG_PAIR: \"0x0108de1eea192ce8448080c3d90a1560cf643fa0\",\r\n    GMT_USDG_FARM: \"0xbe3cB06CE03cA692b77902040479572Ba8D01b0B\",\r\n    XGMT_USDG_FARM: \"0x138E92195D4B99CE3618092D3F9FA830d9A69B4b\",\r\n    USDG_YIELD_TRACKER: \"0x62B49Bc3bF252a5DB26D88ccc7E61119e3179B4f\",\r\n    XGMT_YIELD_TRACKER: \"0x5F235A582e0993eE9466FeEb8F7B4682993a57d0\",\r\n    GMT_USDG_FARM_TRACKER_XGMT: \"0x4f8EE3aE1152422cbCaFACd4e3041ba2D859913C\",\r\n    GMT_USDG_FARM_TRACKER_NATIVE: \"0xd691B26E544Fe370f39A776964c991363aF72e56\",\r\n    XGMT_USDG_FARM_TRACKER_XGMT: \"0xfd5617CFB082Ba9bcD62d654603972AE312bC695\",\r\n    XGMT_USDG_FARM_TRACKER_NATIVE: \"0x0354387DD85b7D8aaD1611B3D167A384d6AE0c28\",\r\n    GMT_GMX_IOU: \"0x47052469970C2484729875CC9E2dd2683fcE71fb\",\r\n    XGMT_GMX_IOU: \"0xeB3733DFe3b68C9d26898De2493A3Bb59FDb4A7B\",\r\n    GMT_USDG_GMX_IOU: \"0x481312655F81b5e249780A6a49735335BF6Ca7f4\",\r\n    XGMT_USDG_GMX_IOU: \"0x8095F1A92526C304623483018aA28cC6E62EB1e1\",\r\n  },\r\n  421611: {\r\n    // arbitrum testnet\r\n    Vault: \"0xBc9BC47A7aB63db1E0030dC7B60DDcDe29CF4Ffb\",\r\n    Router: \"0xe0d4662cdfa2d71477A7DF367d5541421FAC2547\",\r\n    VaultReader: \"0xFc371E380262536c819D12B9569106bf032cC41c\",\r\n    Reader: \"0x2E093c70E3A7E4919611d2555dFd8D697d2fC0a1\",\r\n    GlpManager: \"0xD875d99E09118d2Be80579b9d23E83469077b498\",\r\n    RewardRouter: \"0x0000000000000000000000000000000000000000\",\r\n    RewardReader: \"0x0000000000000000000000000000000000000000\",\r\n    NATIVE_TOKEN: \"0xB47e6A5f8b33b3F17603C83a0535A9dcD7E32681\",\r\n    GLP: \"0xb4f81Fa74e06b5f762A104e47276BA9b2929cb27\",\r\n    GMX: \"0x0000000000000000000000000000000000000000\",\r\n    ES_GMX: \"0x0000000000000000000000000000000000000000\",\r\n    BN_GMX: \"0x0000000000000000000000000000000000000000\",\r\n    USDG: \"0xBCDCaF67193Bf5C57be08623278fCB69f4cA9e68\",\r\n    ES_GMX_IOU: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    BonusGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    FeeGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGlpTracker: \"0x0000000000000000000000000000000000000000\",\r\n    FeeGlpTracker: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    StakedGmxDistributor: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGlpDistributor: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    GmxVester: \"0x0000000000000000000000000000000000000000\",\r\n    GlpVester: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    OrderBook: \"0xebD147E5136879520dDaDf1cA8FBa48050EFf016\",\r\n    OrderBookReader: \"0xC492c8d82DC576Ad870707bb40EDb63E2026111E\",\r\n\r\n    PositionRouter: \"0xB4bB78cd12B097603e2b55D2556c09C17a5815F8\",\r\n    PositionManager: \"0x168aDa266c2f10C1F37973B213d6178551030e44\",\r\n\r\n    // UniswapGmxEthPool: \"0x80A9ae39310abf666A87C743d6ebBD0E8C42158E\",\r\n    ReferralStorage: \"0x0000000000000000000000000000000000000000\",\r\n    ReferralReader: \"0x0000000000000000000000000000000000000000\",\r\n  },\r\n  42161: {\r\n    // arbitrum mainnet\r\n    Vault: \"0x489ee077994B6658eAfA855C308275EAd8097C4A\",\r\n    Router: \"0xaBBc5F99639c9B6bCb58544ddf04EFA6802F4064\",\r\n    VaultReader: \"0xfebB9f4CAC4cD523598fE1C5771181440143F24A\",\r\n    Reader: \"0x2b43c90D1B727cEe1Df34925bcd5Ace52Ec37694\",\r\n    GlpManager: \"0x3963FfC9dff443c2A94f21b129D429891E32ec18\",\r\n    RewardRouter: \"0xA906F338CB21815cBc4Bc87ace9e68c87eF8d8F1\",\r\n    GlpRewardRouter: \"0xB95DB5B167D75e6d04227CfFFA61069348d271F5\",\r\n    RewardReader: \"0x8BFb8e82Ee4569aee78D03235ff465Bd436D40E0\",\r\n    NATIVE_TOKEN: \"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1\",\r\n    GLP: \"0x4277f8F2c384827B5273592FF7CeBd9f2C1ac258\",\r\n    GMX: \"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a\",\r\n    ES_GMX: \"0xf42Ae1D54fd613C9bb14810b0588FaAa09a426cA\",\r\n    BN_GMX: \"0x35247165119B69A40edD5304969560D0ef486921\",\r\n    USDG: \"0x45096e7aA921f27590f8F19e457794EB09678141\",\r\n    ES_GMX_IOU: \"0x6260101218eC4cCfFF1b778936C6f2400f95A954\",\r\n    StakedGmxTracker: \"0x908C4D94D34924765f1eDc22A1DD098397c59dD4\",\r\n    BonusGmxTracker: \"0x4d268a7d4C16ceB5a606c173Bd974984343fea13\",\r\n    FeeGmxTracker: \"0xd2D1162512F927a7e282Ef43a362659E4F2a728F\",\r\n    StakedGlpTracker: \"0x1aDDD80E6039594eE970E5872D247bf0414C8903\",\r\n    FeeGlpTracker: \"0x4e971a87900b931fF39d1Aad67697F49835400b6\",\r\n\r\n    StakedGmxDistributor: \"0x23208B91A98c7C1CD9FE63085BFf68311494F193\",\r\n    StakedGlpDistributor: \"0x60519b48ec4183a61ca2B8e37869E675FD203b34\",\r\n\r\n    GmxVester: \"0x199070DDfd1CFb69173aa2F7e20906F26B363004\",\r\n    GlpVester: \"0xA75287d2f8b217273E7FCD7E86eF07D33972042E\",\r\n\r\n    OrderBook: \"0x09f77E8A13De9a35a7231028187e9fD5DB8a2ACB\",\r\n    OrderExecutor: \"0x7257ac5D0a0aaC04AA7bA2AC0A6Eb742E332c3fB\",\r\n    OrderBookReader: \"0xa27C20A7CF0e1C68C0460706bB674f98F362Bc21\",\r\n\r\n    PositionRouter: \"0xb87a436B93fFE9D75c5cFA7bAcFff96430b09868\",\r\n    PositionManager: \"0x75E42e6f01baf1D6022bEa862A28774a9f8a4A0C\",\r\n\r\n    UniswapGmxEthPool: \"0x80A9ae39310abf666A87C743d6ebBD0E8C42158E\",\r\n    ReferralStorage: \"0xe6fab3f0c7199b0d34d7fbe83394fc0e0d06e99d\",\r\n    ReferralReader: \"0x8Aa382760BCdCe8644C33e6C2D52f6304A76F5c8\",\r\n\r\n    Multicall: \"0xcA11bde05977b3631167028862bE2a173976CA11\",\r\n  },\r\n  43114: {\r\n    // avalanche\r\n    Vault: \"0x9ab2De34A33fB459b538c43f251eB825645e8595\",\r\n    Router: \"0x5F719c2F1095F7B9fc68a68e35B51194f4b6abe8\",\r\n    VaultReader: \"0x66eC8fc33A26feAEAe156afA3Cb46923651F6f0D\",\r\n    Reader: \"0x2eFEE1950ededC65De687b40Fd30a7B5f4544aBd\",\r\n    GlpManager: \"0xe1ae4d4b06A5Fe1fc288f6B4CD72f9F8323B107F\",\r\n    RewardRouter: \"0x82147C5A7E850eA4E28155DF107F2590fD4ba327\",\r\n    RewardReader: \"0x04Fc11Bd28763872d143637a7c768bD96E44c1b6\",\r\n    NATIVE_TOKEN: \"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7\",\r\n    GLP: \"0x01234181085565ed162a948b6a5e88758CD7c7b8\",\r\n    GMX: \"0x62edc0692BD897D2295872a9FFCac5425011c661\",\r\n    ES_GMX: \"0xFf1489227BbAAC61a9209A08929E4c2a526DdD17\",\r\n    BN_GMX: \"0x8087a341D32D445d9aC8aCc9c14F5781E04A26d2\",\r\n    USDG: \"0xc0253c3cC6aa5Ab407b5795a04c28fB063273894\",\r\n    ES_GMX_IOU: \"0x6260101218eC4cCfFF1b778936C6f2400f95A954\", // placeholder address\r\n\r\n    StakedGmxTracker: \"0x2bD10f8E93B3669b6d42E74eEedC65dd1B0a1342\",\r\n    BonusGmxTracker: \"0x908C4D94D34924765f1eDc22A1DD098397c59dD4\",\r\n    FeeGmxTracker: \"0x4d268a7d4C16ceB5a606c173Bd974984343fea13\",\r\n    StakedGlpTracker: \"0x9e295B5B976a184B14aD8cd72413aD846C299660\",\r\n    FeeGlpTracker: \"0xd2D1162512F927a7e282Ef43a362659E4F2a728F\",\r\n\r\n    StakedGmxDistributor: \"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a\",\r\n    StakedGlpDistributor: \"0xDd593Cf40734199afc9207eBe9ffF23dA4Bf7720\",\r\n\r\n    GmxVester: \"0x472361d3cA5F49c8E633FB50385BfaD1e018b445\",\r\n    GlpVester: \"0x62331A7Bd1dfB3A7642B7db50B5509E57CA3154A\",\r\n\r\n    OrderBook: \"0x4296e307f108B2f583FF2F7B7270ee7831574Ae5\",\r\n    OrderExecutor: \"0x4296e307f108B2f583FF2F7B7270ee7831574Ae5\",\r\n    OrderBookReader: \"0xccFE3E576f8145403d3ce8f3c2f6519Dae40683B\",\r\n\r\n    PositionRouter: \"0xffF6D276Bc37c61A23f06410Dce4A400f66420f8\",\r\n    PositionManager: \"0xA21B83E579f4315951bA658654c371520BDcB866\",\r\n\r\n    TraderJoeGmxAvaxPool: \"0x0c91a070f862666bbcce281346be45766d874d98\",\r\n    ReferralStorage: \"0x827ed045002ecdabeb6e2b0d1604cf5fc3d322f8\",\r\n    ReferralReader: \"0x505Ce16D3017be7D76a7C2631C0590E71A975083\",\r\n  },\r\n};\r\n\r\nexport function getContract(chainId, name, market) {\r\n  if (!CONTRACTS[chainId]) {\r\n    throw new Error(`Unknown chainId ${chainId}`);\r\n  }\r\n  if (!CONTRACTS[chainId][name]) {\r\n    throw new Error(`Unknown contract \"${name}\" for chainId ${chainId}`);\r\n  }\r\n  return CONTRACTS[chainId][name];\r\n}\r\n\r\nexport const XGMT_EXCLUDED_ACCOUNTS = [\r\n  \"0x330eef6b9b1ea6edd620c825c9919dc8b611d5d5\",\r\n  \"0xd9b1c23411adbb984b1c4be515fafc47a12898b2\",\r\n  \"0xa633158288520807f91ccc98aa58e0ea43acb400\",\r\n  \"0xffd0a93b4362052a336a7b22494f1b77018dd34b\",\r\n];\r\n","import { ethers } from \"ethers\";\r\nimport { getContract } from \"./Addresses\";\r\n\r\nconst TOKENS = {\r\n  56: [\r\n    {\r\n      name: \"Bitcoin (BTCB)\",\r\n      symbol: \"BTC\",\r\n      decimals: 18,\r\n      address: \"0x7130d2A12B9BCbFAe4f2634d864A1Ee1Ce3Ead9c\",\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-bitcoin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/14108/small/Binance-bitcoin.png\",\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: \"0x2170Ed0880ac9A755fd29B2688956BD959F933F8\",\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/ethereum\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png\",\r\n    },\r\n    {\r\n      name: \"Binance Coin\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/825/small/binance-coin-logo.png\",\r\n      isNative: true,\r\n    },\r\n    {\r\n      name: \"Wrapped Binance Coin\",\r\n      symbol: \"WBNB\",\r\n      decimals: 18,\r\n      address: getContract(56, \"NATIVE_TOKEN\"),\r\n      isWrapped: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/825/small/binance-coin-logo.png\",\r\n      baseSymbol: \"BNB\",\r\n    },\r\n    {\r\n      name: \"USD Gambit\",\r\n      symbol: \"USDG\",\r\n      decimals: 18,\r\n      address: getContract(56, \"USDG\"),\r\n      isUsdg: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/usd-gambit\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/15886/small/usdg-02.png\",\r\n    },\r\n    {\r\n      name: \"Binance USD\",\r\n      symbol: \"BUSD\",\r\n      decimals: 18,\r\n      address: \"0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-usd\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/9576/small/BUSD.png\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 18,\r\n      address: \"0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/small/USD_Coin_icon.png\",\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 18,\r\n      address: \"0x55d398326f99059fF775485246999027B3197955\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/tether\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/325/small/Tether-logo.png\",\r\n    },\r\n  ],\r\n  97: [\r\n    {\r\n      name: \"Bitcoin (BTCB)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0xb19C12715134bee7c4b1Ca593ee9E430dABe7b56\",\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: \"0x1958f7C067226c7C8Ac310Dc994D0cebAbfb2B02\",\r\n    },\r\n    {\r\n      name: \"Binance Coin\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n    },\r\n    {\r\n      name: \"Wrapped Binance Coin\",\r\n      symbol: \"WBNB\",\r\n      decimals: 18,\r\n      address: \"0x612777Eea37a44F7a95E3B101C39e1E2695fa6C2\",\r\n      isWrapped: true,\r\n      baseSymbol: \"BNB\",\r\n    },\r\n    {\r\n      name: \"USD Gambit\",\r\n      symbol: \"USDG\",\r\n      decimals: 18,\r\n      address: getContract(97, \"USDG\"),\r\n      isUsdg: true,\r\n    },\r\n    {\r\n      name: \"Binance USD\",\r\n      symbol: \"BUSD\",\r\n      decimals: 18,\r\n      address: \"0x3F223C4E5ac67099CB695834b20cCd5E5D5AA9Ef\",\r\n      isStable: true,\r\n    },\r\n  ],\r\n  421611: [\r\n    {\r\n      name: \"Bitcoin\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x27960f9A322BE96A1535E6c19B3958e80E6a2670\",\r\n      isShortable: true,\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n    },\r\n    // https://github.com/OffchainLabs/arbitrum/blob/950c2f91b2e951cd3764394e0a73eac3797aecf3/packages/arb-ts/src/lib/networks.ts#L65\r\n    {\r\n      name: \"Wrapped Ethereum\",\r\n      symbol: \"WETH\",\r\n      decimals: 18,\r\n      address: \"0xB47e6A5f8b33b3F17603C83a0535A9dcD7E32681\",\r\n      isWrapped: true,\r\n      baseSymbol: \"ETH\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xf0DCd4737A20ED33481A49De94C599944a3Ca737\",\r\n      isStable: true,\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 6,\r\n      address: \"0x818ED84bA1927945b631016e0d402Db50cE8865f\",\r\n      isStable: true,\r\n    },\r\n  ],\r\n  42161: [\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Wrapped Ethereum\",\r\n      symbol: \"WETH\",\r\n      decimals: 18,\r\n      address: \"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1\",\r\n      isWrapped: true,\r\n      baseSymbol: \"ETH\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/2518/thumb/weth.png?1628852295\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f\",\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n    {\r\n      name: \"Chainlink\",\r\n      symbol: \"LINK\",\r\n      decimals: 18,\r\n      address: \"0xf97f4df75117a78c1A5a0DBb814Af92458539FB4\",\r\n      isStable: false,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/877/thumb/chainlink-new-logo.png?1547034700\",\r\n    },\r\n    {\r\n      name: \"Uniswap\",\r\n      symbol: \"UNI\",\r\n      decimals: 18,\r\n      address: \"0xFa7F8980b0f1E64A2062791cc3b0871572f1F7f0\",\r\n      isStable: false,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12504/thumb/uniswap-uni.png?1600306604\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 6,\r\n      address: \"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/325/thumb/Tether-logo.png?1598003707\",\r\n    },\r\n    {\r\n      name: \"Dai\",\r\n      symbol: \"DAI\",\r\n      decimals: 18,\r\n      address: \"0xDA10009cBd5D07dd0CeCc66161FC93D7c9000da1\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/9956/thumb/4943.png?1636636734\",\r\n    },\r\n    {\r\n      name: \"Frax\",\r\n      symbol: \"FRAX\",\r\n      decimals: 18,\r\n      address: \"0x17FC002b466eEc40DaE837Fc4bE5c67993ddBd6F\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/13422/small/frax_logo.png?1608476506\",\r\n    },\r\n    {\r\n      name: \"Magic Internet Money\",\r\n      symbol: \"MIM\",\r\n      decimals: 18,\r\n      address: \"0xFEa7a6a0B346362BF88A9e4A88416B77a57D6c2A\",\r\n      isStable: true,\r\n      isTempHidden: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/16786/small/mimlogopng.png\",\r\n    },\r\n  ],\r\n  43114: [\r\n    {\r\n      name: \"Avalanche\",\r\n      symbol: \"AVAX\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png?1604021818\",\r\n    },\r\n    {\r\n      name: \"Wrapped AVAX\",\r\n      symbol: \"WAVAX\",\r\n      decimals: 18,\r\n      address: \"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7\",\r\n      isWrapped: true,\r\n      baseSymbol: \"AVAX\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png?1604021818\",\r\n    },\r\n    {\r\n      name: \"Ethereum (WETH.e)\",\r\n      symbol: \"ETH\",\r\n      address: \"0x49D5c2BdFfac6CE2BFdB6640F4F80f226bc10bAB\",\r\n      decimals: 18,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC.e)\",\r\n      symbol: \"BTC\",\r\n      address: \"0x50b7545627a5162F82A992c33b87aDc75187B218\",\r\n      decimals: 8,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (BTC.b)\",\r\n      symbol: \"BTC.b\",\r\n      address: \"0x152b9d0FdC40C096757F570A51E494bd4b943E50\",\r\n      decimals: 8,\r\n      isShortable: false,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/26115/thumb/btcb.png?1655921693\",\r\n    },\r\n    {\r\n      name: \"USD Coin (USDC.e)\",\r\n      symbol: \"USDC.e\",\r\n      address: \"0xA7D7079b0FEaD91F3e65f86E8915Cb59c1a4C664\",\r\n      decimals: 6,\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      address: \"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E\",\r\n      decimals: 6,\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"Magic Internet Money\",\r\n      symbol: \"MIM\",\r\n      address: \"0x130966628846BFd36ff31a822705796e8cb8C18D\",\r\n      decimals: 18,\r\n      isStable: true,\r\n      isTempHidden: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/16786/small/mimlogopng.png\",\r\n    },\r\n  ],\r\n};\r\n\r\nconst ADDITIONAL_TOKENS = {\r\n  42161: [\r\n    {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      address: getContract(42161, \"GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"Escrowed GMX\",\r\n      symbol: \"esGMX\",\r\n      address: getContract(42161, \"ES_GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      address: getContract(42161, \"GLP\"),\r\n      decimals: 18,\r\n    },\r\n  ],\r\n  43114: [\r\n    {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      address: getContract(43114, \"GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"Escrowed GMX\",\r\n      symbol: \"esGMX\",\r\n      address: getContract(43114, \"ES_GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      address: getContract(42161, \"GLP\"),\r\n      decimals: 18,\r\n    },\r\n  ],\r\n};\r\n\r\nconst CHAIN_IDS = [56, 97, 42161, 421611, 43114];\r\n\r\nconst TOKENS_MAP = {};\r\nconst TOKENS_BY_SYMBOL_MAP = {};\r\n\r\nfor (let j = 0; j < CHAIN_IDS.length; j++) {\r\n  const chainId = CHAIN_IDS[j];\r\n  TOKENS_MAP[chainId] = {};\r\n  TOKENS_BY_SYMBOL_MAP[chainId] = {};\r\n  let tokens = TOKENS[chainId];\r\n  if (ADDITIONAL_TOKENS[chainId]) {\r\n    tokens = tokens.concat(ADDITIONAL_TOKENS[chainId]);\r\n  }\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = tokens[i];\r\n    TOKENS_MAP[chainId][token.address] = token;\r\n    TOKENS_BY_SYMBOL_MAP[chainId][token.symbol] = token;\r\n  }\r\n}\r\n\r\nconst WRAPPED_TOKENS_MAP = {};\r\nconst NATIVE_TOKENS_MAP = {};\r\nfor (const chainId of CHAIN_IDS) {\r\n  for (const token of TOKENS[chainId]) {\r\n    if (token.isWrapped) {\r\n      WRAPPED_TOKENS_MAP[chainId] = token;\r\n    } else if (token.isNative) {\r\n      NATIVE_TOKENS_MAP[chainId] = token;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getWrappedToken(chainId) {\r\n  return WRAPPED_TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getNativeToken(chainId) {\r\n  return NATIVE_TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getTokens(chainId) {\r\n  return TOKENS[chainId];\r\n}\r\n\r\nexport function isValidToken(chainId, address) {\r\n  if (!TOKENS_MAP[chainId]) {\r\n    throw new Error(`Incorrect chainId ${chainId}`);\r\n  }\r\n  return address in TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getToken(chainId, address) {\r\n  if (!TOKENS_MAP[chainId]) {\r\n    throw new Error(`Incorrect chainId ${chainId}`);\r\n  }\r\n  if (!TOKENS_MAP[chainId][address]) {\r\n    throw new Error(`Incorrect address \"${address}\" for chainId ${chainId}`);\r\n  }\r\n  return TOKENS_MAP[chainId][address];\r\n}\r\n\r\nexport function getTokenBySymbol(chainId, symbol) {\r\n  const token = TOKENS_BY_SYMBOL_MAP[chainId][symbol];\r\n  if (!token) {\r\n    throw new Error(`Incorrect symbol \"${symbol}\" for chainId ${chainId}`);\r\n  }\r\n  return token;\r\n}\r\n\r\nexport function getWhitelistedTokens(chainId) {\r\n  return TOKENS[chainId].filter((token) => token.symbol !== \"USDG\");\r\n}\r\n\r\nexport function getVisibleTokens(chainId) {\r\n  return getWhitelistedTokens(chainId).filter((token) => !token.isWrapped && !token.isTempHidden);\r\n}\r\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { InjectedConnector } from \"@web3-react/injected-connector\";\r\nimport {\r\n  UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,\r\n  WalletConnectConnector,\r\n} from \"@web3-react/walletconnect-connector\";\r\nimport { toast } from \"react-toastify\";\r\nimport { UnsupportedChainIdError, useWeb3React } from \"@web3-react/core\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { ethers } from \"ethers\";\r\nimport { format as formatDateFn } from \"date-fns\";\r\nimport Token from \"../abis/Token.json\";\r\nimport _ from \"lodash\";\r\nimport { getContract } from \"../config/Addresses\";\r\nimport useSWR from \"swr\";\r\n\r\nimport OrderBookReader from \"../abis/OrderBookReader.json\";\r\nimport OrderBook from \"../abis/OrderBook.json\";\r\n\r\nimport { getWhitelistedTokens, isValidToken } from \"../config/Tokens\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport const UI_VERSION = \"1.3\";\r\n\r\n// use a random placeholder account instead of the zero address as the zero address might have tokens\r\nexport const PLACEHOLDER_ACCOUNT = ethers.Wallet.createRandom().address;\r\n\r\nexport const MAINNET = 56;\r\nexport const AVALANCHE = 43114;\r\nexport const TESTNET = 97;\r\nexport const ARBITRUM_TESTNET = 421611;\r\nexport const ARBITRUM = 42161;\r\n// TODO take it from web3\r\nexport const DEFAULT_CHAIN_ID = ARBITRUM;\r\nexport const CHAIN_ID = DEFAULT_CHAIN_ID;\r\n\r\nexport const MIN_PROFIT_TIME = 0;\r\n\r\nconst SELECTED_NETWORK_LOCAL_STORAGE_KEY = \"SELECTED_NETWORK\";\r\n\r\nexport const IS_NETWORK_DISABLED = {\r\n  [ARBITRUM]: false,\r\n  [AVALANCHE]: false,\r\n};\r\n\r\nconst CHAIN_NAMES_MAP = {\r\n  [MAINNET]: \"BSC\",\r\n  [TESTNET]: \"BSC Testnet\",\r\n  [ARBITRUM_TESTNET]: \"ArbRinkeby\",\r\n  [ARBITRUM]: \"Arbitrum\",\r\n  [AVALANCHE]: \"Avalanche\",\r\n};\r\n\r\nconst alchemyWhitelistedDomains = [\"gmx.io\", \"app.gmx.io\"];\r\n\r\nexport function getDefaultArbitrumRpcUrl() {\r\n  return \"https://arb1.arbitrum.io/rpc\";\r\n}\r\n\r\nexport function getAlchemyHttpUrl() {\r\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\r\n    return \"https://arb-mainnet.g.alchemy.com/v2/ha7CFsr1bx5ZItuR6VZBbhKozcKDY4LZ\";\r\n  }\r\n  return \"https://arb-mainnet.g.alchemy.com/v2/EmVYwUw0N2tXOuG0SZfe5Z04rzBsCbr2\";\r\n}\r\n\r\nexport function getAlchemyWsUrl() {\r\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\r\n    return \"wss://arb-mainnet.g.alchemy.com/v2/ha7CFsr1bx5ZItuR6VZBbhKozcKDY4LZ\";\r\n  }\r\n  return \"wss://arb-mainnet.g.alchemy.com/v2/EmVYwUw0N2tXOuG0SZfe5Z04rzBsCbr2\";\r\n}\r\n\r\nconst ARBITRUM_RPC_PROVIDERS = [getDefaultArbitrumRpcUrl()];\r\nconst AVALANCHE_RPC_PROVIDERS = [\"https://api.avax.network/ext/bc/C/rpc\"];\r\nexport const WALLET_CONNECT_LOCALSTORAGE_KEY = \"walletconnect\";\r\nexport const WALLET_LINK_LOCALSTORAGE_PREFIX = \"-walletlink\";\r\nexport const SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY = \"eagerconnect\";\r\nexport const CURRENT_PROVIDER_LOCALSTORAGE_KEY = \"currentprovider\";\r\nexport const LANGUAGE_LOCALSTORAGE_KEY = \"LANGUAGE_KEY\";\r\n\r\nexport function getChainName(chainId) {\r\n  return CHAIN_NAMES_MAP[chainId];\r\n}\r\n\r\nexport const USDG_ADDRESS = getContract(CHAIN_ID, \"USDG\");\r\n\r\nexport const BASIS_POINTS_DIVISOR = 10000;\r\nexport const MAX_LEVERAGE = 100 * BASIS_POINTS_DIVISOR;\r\nexport const MAX_ALLOWED_LEVERAGE = 50 * BASIS_POINTS_DIVISOR;\r\n\r\nexport const MAX_PRICE_DEVIATION_BASIS_POINTS = 750;\r\nexport const DEFAULT_GAS_LIMIT = 1 * 1000 * 1000;\r\nexport const SECONDS_PER_YEAR = 31536000;\r\nexport const USDG_DECIMALS = 18;\r\nexport const USD_DECIMALS = 30;\r\nexport const DEPOSIT_FEE = 30;\r\nexport const DUST_BNB = \"2000000000000000\";\r\nexport const DUST_USD = expandDecimals(1, USD_DECIMALS);\r\nexport const PRECISION = expandDecimals(1, 30);\r\nexport const GLP_DECIMALS = 18;\r\nexport const GMX_DECIMALS = 18;\r\nexport const DEFAULT_MAX_USDG_AMOUNT = expandDecimals(200 * 1000 * 1000, 18);\r\n\r\nexport const TAX_BASIS_POINTS = 50;\r\nexport const STABLE_TAX_BASIS_POINTS = 5;\r\nexport const MINT_BURN_FEE_BASIS_POINTS = 25;\r\nexport const SWAP_FEE_BASIS_POINTS = 30;\r\nexport const STABLE_SWAP_FEE_BASIS_POINTS = 1;\r\nexport const MARGIN_FEE_BASIS_POINTS = 10;\r\n\r\nexport const LIQUIDATION_FEE = expandDecimals(5, USD_DECIMALS);\r\n\r\nexport const TRADES_PAGE_SIZE = 100;\r\n\r\nexport const GLP_COOLDOWN_DURATION = 15 * 60;\r\nexport const THRESHOLD_REDEMPTION_VALUE = expandDecimals(993, 27); // 0.993\r\nexport const FUNDING_RATE_PRECISION = 1000000;\r\n\r\nexport const SWAP = \"Swap\";\r\nexport const INCREASE = \"Increase\";\r\nexport const DECREASE = \"Decrease\";\r\nexport const LONG = \"Long\";\r\nexport const SHORT = \"Short\";\r\n\r\nexport const MARKET = \"Market\";\r\nexport const LIMIT = \"Limit\";\r\nexport const STOP = \"Stop\";\r\nexport const BORROW = \"Borrow\";\r\n\r\n// Market/limit orders disabling\r\n// export const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT, STOP];\r\nexport const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT];\r\n\r\nexport const SWAP_ORDER_OPTIONS = [MARKET, LIMIT];\r\n\r\n// Swap disabling\r\n// export const SWAP_OPTIONS = [LONG, SHORT, SWAP];\r\nexport const SWAP_OPTIONS = [LONG, SHORT];\r\n\r\n\r\n// Default Slippage\r\nexport const DEFAULT_SLIPPAGE_AMOUNT = 30;\r\n// export const DEFAULT_SLIPPAGE_AMOUNT = 100;\r\n\r\nexport const DEFAULT_HIGHER_SLIPPAGE_AMOUNT = 100;\r\n\r\nexport const SLIPPAGE_BPS_KEY = \"Exchange-swap-slippage-basis-points-v3\";\r\nexport const CLOSE_POSITION_RECEIVE_TOKEN_KEY = \"Close-position-receive-token\";\r\nexport const IS_PNL_IN_LEVERAGE_KEY = \"Exchange-swap-is-pnl-in-leverage\";\r\nexport const SHOW_PNL_AFTER_FEES_KEY = \"Exchange-swap-show-pnl-after-fees\";\r\nexport const DISABLE_ORDER_VALIDATION_KEY = \"disable-order-validation\";\r\nexport const SHOULD_SHOW_POSITION_LINES_KEY = \"Exchange-swap-should-show-position-lines\";\r\nexport const REFERRAL_CODE_KEY = \"GMX-referralCode\";\r\nexport const REFERRAL_CODE_QUERY_PARAM = \"ref\";\r\nexport const REFERRALS_SELECTED_TAB_KEY = \"Referrals-selected-tab\";\r\nexport const MAX_REFERRAL_CODE_LENGTH = 20;\r\n\r\nexport const TRIGGER_PREFIX_ABOVE = \">\";\r\nexport const TRIGGER_PREFIX_BELOW = \"<\";\r\n\r\nexport const MIN_PROFIT_BIPS = 0;\r\n\r\nexport const GLPPOOLCOLORS = {\r\n  ETH: \"#6062a6\",\r\n  BTC: \"#F7931A\",\r\n  \"BTC.b\": \"#F7931A\",\r\n  USDC: \"#2775CA\",\r\n  \"USDC.e\": \"#2A5ADA\",\r\n  USDT: \"#67B18A\",\r\n  MIM: \"#9695F8\",\r\n  FRAX: \"#000\",\r\n  DAI: \"#FAC044\",\r\n  UNI: \"#E9167C\",\r\n  AVAX: \"#E84142\",\r\n  LINK: \"#3256D6\",\r\n};\r\n\r\nexport const HIGH_EXECUTION_FEES_MAP = {\r\n  [ARBITRUM]: 3, // 3 USD\r\n  [AVALANCHE]: 3, // 3 USD\r\n};\r\n\r\nexport function getHighExecutionFee(chainId) {\r\n  return HIGH_EXECUTION_FEES_MAP[chainId] || 3;\r\n}\r\n\r\nexport const ICONLINKS = {\r\n  [ARBITRUM_TESTNET]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a\",\r\n    },\r\n    GLP: {\r\n      arbitrum: \"https://testnet.arbiscan.io/token/0xb4f81Fa74e06b5f762A104e47276BA9b2929cb27\",\r\n    },\r\n  },\r\n  [ARBITRUM]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a\",\r\n    },\r\n    GLP: {\r\n      arbitrum: \"https://arbiscan.io/token/0x1aDDD80E6039594eE970E5872D247bf0414C8903\",\r\n    },\r\n    ETH: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/ethereum\",\r\n    },\r\n    BTC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      arbitrum: \"https://arbiscan.io/address/0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f\",\r\n    },\r\n    LINK: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/chainlink\",\r\n      arbitrum: \"https://arbiscan.io/address/0xf97f4df75117a78c1a5a0dbb814af92458539fb4\",\r\n    },\r\n    UNI: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/uniswap\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0\",\r\n    },\r\n    USDC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      arbitrum: \"https://arbiscan.io/address/0xff970a61a04b1ca14834a43f5de4533ebddb5cc8\",\r\n    },\r\n    USDT: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/tether\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9\",\r\n    },\r\n    DAI: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/dai\",\r\n      arbitrum: \"https://arbiscan.io/address/0xda10009cbd5d07dd0cecc66161fc93d7c9000da1\",\r\n    },\r\n    MIM: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfea7a6a0b346362bf88a9e4a88416b77a57d6c2a\",\r\n    },\r\n    FRAX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/frax\",\r\n      arbitrum: \"https://arbiscan.io/address/0x17fc002b466eec40dae837fc4be5c67993ddbd6f\",\r\n    },\r\n  },\r\n  [AVALANCHE]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      avalanche: \"https://snowtrace.io/address/0x62edc0692bd897d2295872a9ffcac5425011c661\",\r\n    },\r\n    GLP: {\r\n      avalanche: \"https://snowtrace.io/address/0x9e295B5B976a184B14aD8cd72413aD846C299660\",\r\n    },\r\n    AVAX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/avalanche\",\r\n    },\r\n    ETH: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/weth\",\r\n      avalanche: \"https://snowtrace.io/address/0x49d5c2bdffac6ce2bfdb6640f4f80f226bc10bab\",\r\n    },\r\n    BTC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      avalanche: \"https://snowtrace.io/address/0x50b7545627a5162f82a992c33b87adc75187b218\",\r\n    },\r\n    \"BTC.b\": {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      avalanche: \"https://snowtrace.io/address/0x152b9d0FdC40C096757F570A51E494bd4b943E50\",\r\n    },\r\n    MIM: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\r\n      avalanche: \"https://snowtrace.io/address/0x130966628846bfd36ff31a822705796e8cb8c18d\",\r\n    },\r\n    \"USDC.e\": {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin-avalanche-bridged-usdc-e\",\r\n      avalanche: \"https://snowtrace.io/address/0xa7d7079b0fead91f3e65f86e8915cb59c1a4c664\",\r\n    },\r\n    USDC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      avalanche: \"https://snowtrace.io/address/0xb97ef9ef8734c71904d8002f8b6bc66dd9c48a6e\",\r\n    },\r\n  },\r\n};\r\n\r\nexport const platformTokens = {\r\n  42161: {\r\n    // arbitrum\r\n    GMX: {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      decimals: 18,\r\n      address: getContract(ARBITRUM, \"GMX\"),\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/18323/small/arbit.png?1631532468\",\r\n    },\r\n    GLP: {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      decimals: 18,\r\n      address: getContract(ARBITRUM, \"StakedGlpTracker\"), // address of fsGLP token because user only holds fsGLP\r\n      imageUrl: \"https://github.com/gmx-io/gmx-assets/blob/main/GMX-Assets/PNG/GLP_LOGO%20ONLY.png?raw=true\",\r\n    },\r\n  },\r\n  43114: {\r\n    // avalanche\r\n    GMX: {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      decimals: 18,\r\n      address: getContract(AVALANCHE, \"GMX\"),\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/18323/small/arbit.png?1631532468\",\r\n    },\r\n    GLP: {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      decimals: 18,\r\n      address: getContract(AVALANCHE, \"StakedGlpTracker\"), // address of fsGLP token because user only holds fsGLP\r\n      imageUrl: \"https://github.com/gmx-io/gmx-assets/blob/main/GMX-Assets/PNG/GLP_LOGO%20ONLY.png?raw=true\",\r\n    },\r\n  },\r\n};\r\n\r\nconst supportedChainIds = [ARBITRUM, AVALANCHE];\r\nif (isDevelopment()) {\r\n  supportedChainIds.push(ARBITRUM_TESTNET);\r\n}\r\nconst injectedConnector = new InjectedConnector({\r\n  supportedChainIds,\r\n});\r\n\r\nconst getWalletConnectConnector = () => {\r\n  const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\r\n  return new WalletConnectConnector({\r\n    rpc: {\r\n      [AVALANCHE]: AVALANCHE_RPC_PROVIDERS[0],\r\n      [ARBITRUM]: ARBITRUM_RPC_PROVIDERS[0],\r\n      [ARBITRUM_TESTNET]: \"https://rinkeby.arbitrum.io/rpc\",\r\n    },\r\n    qrcode: true,\r\n    chainId,\r\n  });\r\n};\r\n\r\nexport function isSupportedChain(chainId) {\r\n  return supportedChainIds.includes(chainId);\r\n}\r\n\r\nexport function deserialize(data) {\r\n  for (const [key, value] of Object.entries(data)) {\r\n    if (value._type === \"BigNumber\") {\r\n      data[key] = bigNumberify(value.value);\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function isHomeSite() {\r\n  return process.env.REACT_APP_IS_HOME_SITE === \"true\";\r\n}\r\n\r\nexport const helperToast = {\r\n  success: (content, opts) => {\r\n    toast.dismiss();\r\n    toast.success(content, opts);\r\n  },\r\n  error: (content, opts) => {\r\n    toast.dismiss();\r\n    toast.error(content, opts);\r\n  },\r\n};\r\n\r\nexport function useLocalStorageByChainId(chainId, key, defaultValue) {\r\n  const [internalValue, setInternalValue] = useLocalStorage(key, {});\r\n\r\n  const setValue = useCallback(\r\n    (value) => {\r\n      setInternalValue((internalValue) => {\r\n        if (typeof value === \"function\") {\r\n          value = value(internalValue[chainId] || defaultValue);\r\n        }\r\n        const newInternalValue = {\r\n          ...internalValue,\r\n          [chainId]: value,\r\n        };\r\n        return newInternalValue;\r\n      });\r\n    },\r\n    [chainId, setInternalValue, defaultValue]\r\n  );\r\n\r\n  let value;\r\n  if (chainId in internalValue) {\r\n    value = internalValue[chainId];\r\n  } else {\r\n    value = defaultValue;\r\n  }\r\n\r\n  return [value, setValue];\r\n}\r\n\r\nexport function useLocalStorageSerializeKey(key, value, opts) {\r\n  key = JSON.stringify(key);\r\n  return useLocalStorage(key, value, opts);\r\n}\r\n\r\nfunction getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd) {\r\n  // Limit/stop orders are executed with price specified by user\r\n  if (orderOption && orderOption !== MARKET && triggerPriceUsd) {\r\n    return triggerPriceUsd;\r\n  }\r\n\r\n  // Market orders are executed with current market price\r\n  if (!info) {\r\n    return;\r\n  }\r\n  if (max && !info.maxPrice) {\r\n    return;\r\n  }\r\n  if (!max && !info.minPrice) {\r\n    return;\r\n  }\r\n  return max ? info.maxPrice : info.minPrice;\r\n}\r\n\r\nexport function getLiquidationPriceFromDelta({ liquidationAmount, size, collateral, averagePrice, isLong }) {\r\n  if (!size || size.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  if (liquidationAmount.gt(collateral)) {\r\n    const liquidationDelta = liquidationAmount.sub(collateral);\r\n    const priceDelta = liquidationDelta.mul(averagePrice).div(size);\r\n    return isLong ? averagePrice.add(priceDelta) : averagePrice.sub(priceDelta);\r\n  }\r\n\r\n  const liquidationDelta = collateral.sub(liquidationAmount);\r\n  const priceDelta = liquidationDelta.mul(averagePrice).div(size);\r\n\r\n  return isLong ? averagePrice.sub(priceDelta) : averagePrice.add(priceDelta);\r\n}\r\n\r\nexport const replaceNativeTokenAddress = (path, nativeTokenAddress) => {\r\n  if (!path) {\r\n    return;\r\n  }\r\n\r\n  let updatedPath = [];\r\n  for (let i = 0; i < path.length; i++) {\r\n    let address = path[i];\r\n    if (address === AddressZero) {\r\n      address = nativeTokenAddress;\r\n    }\r\n    updatedPath.push(address);\r\n  }\r\n\r\n  return updatedPath;\r\n};\r\n\r\nexport function getMarginFee(sizeDelta) {\r\n  if (!sizeDelta) {\r\n    return bigNumberify(0);\r\n  }\r\n  const afterFeeUsd = sizeDelta.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n  return sizeDelta.sub(afterFeeUsd);\r\n}\r\n\r\nexport function getServerBaseUrl(chainId) {\r\n  if (!chainId) {\r\n    throw new Error(\"chainId is not provided\");\r\n  }\r\n  if (document.location.hostname.includes(\"deploy-preview\")) {\r\n    const fromLocalStorage = localStorage.getItem(\"SERVER_BASE_URL\");\r\n    if (fromLocalStorage) {\r\n      return fromLocalStorage;\r\n    }\r\n  }\r\n  if (chainId === MAINNET) {\r\n    return \"https://gambit-server-staging.uc.r.appspot.com\";\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return \"https://gambit-server-devnet.uc.r.appspot.com\";\r\n  } else if (chainId === ARBITRUM) {\r\n    return \"https://gmx-server-mainnet.uw.r.appspot.com\";\r\n  } else if (chainId === AVALANCHE) {\r\n    return \"https://gmx-avax-server.uc.r.appspot.com\";\r\n  }\r\n  return \"https://gmx-server-mainnet.uw.r.appspot.com\";\r\n}\r\n\r\nexport function getServerUrl(chainId, path) {\r\n  return `${getServerBaseUrl(chainId)}${path}`;\r\n}\r\n\r\nexport function isTriggerRatioInverted(fromTokenInfo, toTokenInfo) {\r\n  if (!toTokenInfo || !fromTokenInfo) return false;\r\n  if (toTokenInfo.isStable || toTokenInfo.isUsdg) return true;\r\n  if (toTokenInfo.maxPrice) return toTokenInfo.maxPrice.lt(fromTokenInfo.maxPrice);\r\n  return false;\r\n}\r\n\r\nexport function getExchangeRate(tokenAInfo, tokenBInfo, inverted) {\r\n  if (!tokenAInfo || !tokenAInfo.minPrice || !tokenBInfo || !tokenBInfo.maxPrice) {\r\n    return;\r\n  }\r\n  if (inverted) {\r\n    return tokenAInfo.minPrice.mul(PRECISION).div(tokenBInfo.maxPrice);\r\n  }\r\n  return tokenBInfo.maxPrice.mul(PRECISION).div(tokenAInfo.minPrice);\r\n}\r\n\r\nexport function getMostAbundantStableToken(chainId, infoTokens) {\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  let availableAmount;\r\n  let stableToken = whitelistedTokens.find((t) => t.isStable);\r\n  for (let i = 0; i < whitelistedTokens.length; i++) {\r\n    const info = getTokenInfo(infoTokens, whitelistedTokens[i].address);\r\n    if (!info.isStable || !info.availableAmount) {\r\n      continue;\r\n    }\r\n\r\n    const adjustedAvailableAmount = adjustForDecimals(info.availableAmount, info.decimals, USD_DECIMALS);\r\n    if (!availableAmount || adjustedAvailableAmount.gt(availableAmount)) {\r\n      availableAmount = adjustedAvailableAmount;\r\n      stableToken = info;\r\n    }\r\n  }\r\n  return stableToken;\r\n}\r\n\r\nexport function shouldInvertTriggerRatio(tokenA, tokenB) {\r\n  if (tokenB.isStable || tokenB.isUsdg) return true;\r\n  if (tokenB.maxPrice && tokenA.maxPrice && tokenB.maxPrice.lt(tokenA.maxPrice)) return true;\r\n  return false;\r\n}\r\n\r\nexport function getExchangeRateDisplay(rate, tokenA, tokenB, opts = {}) {\r\n  if (!rate || !tokenA || !tokenB) return \"...\";\r\n  if (shouldInvertTriggerRatio(tokenA, tokenB)) {\r\n    [tokenA, tokenB] = [tokenB, tokenA];\r\n    rate = PRECISION.mul(PRECISION).div(rate);\r\n  }\r\n  const rateValue = formatAmount(rate, USD_DECIMALS, tokenA.isStable || tokenA.isUsdg ? 2 : 4, true);\r\n  if (opts.omitSymbols) {\r\n    return rateValue;\r\n  }\r\n  return `${rateValue} ${tokenA.symbol}/${tokenB.symbol}`;\r\n}\r\n\r\nconst adjustForDecimalsFactory = (n) => (number) => {\r\n  if (n === 0) {\r\n    return number;\r\n  }\r\n  if (n > 0) {\r\n    return number.mul(expandDecimals(1, n));\r\n  }\r\n  return number.div(expandDecimals(1, -n));\r\n};\r\n\r\nexport function adjustForDecimals(amount, divDecimals, mulDecimals) {\r\n  return amount.mul(expandDecimals(1, mulDecimals)).div(expandDecimals(1, divDecimals));\r\n}\r\n\r\nexport function getTargetUsdgAmount(token, usdgSupply, totalTokenWeights) {\r\n  if (!token || !token.weight || !usdgSupply) {\r\n    return;\r\n  }\r\n\r\n  if (usdgSupply.eq(0)) {\r\n    return bigNumberify(0);\r\n  }\r\n\r\n  return token.weight.mul(usdgSupply).div(totalTokenWeights);\r\n}\r\n\r\nexport function getFeeBasisPoints(\r\n  token,\r\n  usdgDelta,\r\n  feeBasisPoints,\r\n  taxBasisPoints,\r\n  increment,\r\n  usdgSupply,\r\n  totalTokenWeights\r\n) {\r\n  if (!token || !token.usdgAmount || !usdgSupply || !totalTokenWeights) {\r\n    return 0;\r\n  }\r\n\r\n  feeBasisPoints = bigNumberify(feeBasisPoints);\r\n  taxBasisPoints = bigNumberify(taxBasisPoints);\r\n\r\n  const initialAmount = token.usdgAmount;\r\n  let nextAmount = initialAmount.add(usdgDelta);\r\n  if (!increment) {\r\n    nextAmount = usdgDelta.gt(initialAmount) ? bigNumberify(0) : initialAmount.sub(usdgDelta);\r\n  }\r\n\r\n  const targetAmount = getTargetUsdgAmount(token, usdgSupply, totalTokenWeights);\r\n  if (!targetAmount || targetAmount.eq(0)) {\r\n    return feeBasisPoints.toNumber();\r\n  }\r\n\r\n  const initialDiff = initialAmount.gt(targetAmount)\r\n    ? initialAmount.sub(targetAmount)\r\n    : targetAmount.sub(initialAmount);\r\n  const nextDiff = nextAmount.gt(targetAmount) ? nextAmount.sub(targetAmount) : targetAmount.sub(nextAmount);\r\n\r\n  if (nextDiff.lt(initialDiff)) {\r\n    const rebateBps = taxBasisPoints.mul(initialDiff).div(targetAmount);\r\n    return rebateBps.gt(feeBasisPoints) ? 0 : feeBasisPoints.sub(rebateBps).toNumber();\r\n  }\r\n\r\n  let averageDiff = initialDiff.add(nextDiff).div(2);\r\n  if (averageDiff.gt(targetAmount)) {\r\n    averageDiff = targetAmount;\r\n  }\r\n  const taxBps = taxBasisPoints.mul(averageDiff).div(targetAmount);\r\n  return feeBasisPoints.add(taxBps).toNumber();\r\n}\r\n\r\nexport function getBuyGlpToAmount(fromAmount, swapTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\r\n  if (!fromAmount || !swapTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\r\n  if (!swapToken || !swapToken.minPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let glpAmount = fromAmount.mul(swapToken.minPrice).div(glpPrice);\r\n  glpAmount = adjustForDecimals(glpAmount, swapToken.decimals, USDG_DECIMALS);\r\n\r\n  let usdgAmount = fromAmount.mul(swapToken.minPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    swapToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  glpAmount = glpAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n  return { amount: glpAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getSellGlpFromAmount(toAmount, swapTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\r\n  if (!toAmount || !swapTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\r\n  if (!swapToken || !swapToken.maxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let glpAmount = toAmount.mul(swapToken.maxPrice).div(glpPrice);\r\n  glpAmount = adjustForDecimals(glpAmount, swapToken.decimals, USDG_DECIMALS);\r\n\r\n  let usdgAmount = toAmount.mul(swapToken.maxPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    swapToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  glpAmount = glpAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\r\n\r\n  return { amount: glpAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getBuyGlpFromAmount(toAmount, fromTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!toAmount || !fromTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  if (!fromToken || !fromToken.minPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let fromAmount = toAmount.mul(glpPrice).div(fromToken.minPrice);\r\n  fromAmount = adjustForDecimals(fromAmount, GLP_DECIMALS, fromToken.decimals);\r\n\r\n  const usdgAmount = toAmount.mul(glpPrice).div(PRECISION);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\r\n\r\n  return { amount: fromAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getSellGlpToAmount(toAmount, fromTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!toAmount || !fromTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  if (!fromToken || !fromToken.maxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let fromAmount = toAmount.mul(glpPrice).div(fromToken.maxPrice);\r\n  fromAmount = adjustForDecimals(fromAmount, GLP_DECIMALS, fromToken.decimals);\r\n\r\n  const usdgAmount = toAmount.mul(glpPrice).div(PRECISION);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n  return { amount: fromAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getNextFromAmount(\r\n  chainId,\r\n  toAmount,\r\n  fromTokenAddress,\r\n  toTokenAddress,\r\n  infoTokens,\r\n  toTokenPriceUsd,\r\n  ratio,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  forSwap\r\n) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n\r\n  if (!toAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (fromTokenAddress === toTokenAddress) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  if (fromToken.isNative && toToken.isWrapped) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  if (fromToken.isWrapped && toToken.isNative) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  // the realtime price should be used if it is for a transaction to open / close a position\r\n  // or if the transaction involves doing a swap and opening / closing a position\r\n  // otherwise use the contract price instead of realtime price for swaps\r\n\r\n  let fromTokenMinPrice;\r\n  if (fromToken) {\r\n    fromTokenMinPrice = forSwap ? fromToken.contractMinPrice : fromToken.minPrice;\r\n  }\r\n\r\n  let toTokenMaxPrice;\r\n  if (toToken) {\r\n    toTokenMaxPrice = forSwap ? toToken.contractMaxPrice : toToken.maxPrice;\r\n  }\r\n\r\n  if (!fromToken || !fromTokenMinPrice || !toToken || !toTokenMaxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const adjustDecimals = adjustForDecimalsFactory(fromToken.decimals - toToken.decimals);\r\n\r\n  let fromAmountBasedOnRatio;\r\n  if (ratio && !ratio.isZero()) {\r\n    fromAmountBasedOnRatio = toAmount.mul(ratio).div(PRECISION);\r\n  }\r\n\r\n  const fromAmount =\r\n    ratio && !ratio.isZero() ? fromAmountBasedOnRatio : toAmount.mul(toTokenMaxPrice).div(fromTokenMinPrice);\r\n\r\n  let usdgAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, toToken.decimals, USDG_DECIMALS);\r\n  const swapFeeBasisPoints =\r\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\r\n  const feeBasisPoints0 = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints1 = getFeeBasisPoints(\r\n    toToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\r\n\r\n  return {\r\n    amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints)),\r\n    feeBasisPoints,\r\n  };\r\n}\r\n\r\nexport function getNextToAmount(\r\n  chainId,\r\n  fromAmount,\r\n  fromTokenAddress,\r\n  toTokenAddress,\r\n  infoTokens,\r\n  toTokenPriceUsd,\r\n  ratio,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  forSwap\r\n) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!fromAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (fromTokenAddress === toTokenAddress) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  if (fromToken.isNative && toToken.isWrapped) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  if (fromToken.isWrapped && toToken.isNative) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  // the realtime price should be used if it is for a transaction to open / close a position\r\n  // or if the transaction involves doing a swap and opening / closing a position\r\n  // otherwise use the contract price instead of realtime price for swaps\r\n\r\n  let fromTokenMinPrice;\r\n  if (fromToken) {\r\n    fromTokenMinPrice = forSwap ? fromToken.contractMinPrice : fromToken.minPrice;\r\n  }\r\n\r\n  let toTokenMaxPrice;\r\n  if (toToken) {\r\n    toTokenMaxPrice = forSwap ? toToken.contractMaxPrice : toToken.maxPrice;\r\n  }\r\n\r\n  if (!fromTokenMinPrice || !toTokenMaxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const adjustDecimals = adjustForDecimalsFactory(toToken.decimals - fromToken.decimals);\r\n\r\n  let toAmountBasedOnRatio = bigNumberify(0);\r\n  if (ratio && !ratio.isZero()) {\r\n    toAmountBasedOnRatio = fromAmount.mul(PRECISION).div(ratio);\r\n  }\r\n\r\n  if (toTokenAddress === USDG_ADDRESS) {\r\n    const feeBasisPoints = getSwapFeeBasisPoints(fromToken.isStable);\r\n\r\n    if (ratio && !ratio.isZero()) {\r\n      const toAmount = toAmountBasedOnRatio;\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const toAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n    return {\r\n      amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n      feeBasisPoints,\r\n    };\r\n  }\r\n\r\n  if (fromTokenAddress === USDG_ADDRESS) {\r\n    const redemptionValue = toToken.redemptionAmount\r\n      .mul(toTokenPriceUsd || toTokenMaxPrice)\r\n      .div(expandDecimals(1, toToken.decimals));\r\n\r\n    if (redemptionValue.gt(THRESHOLD_REDEMPTION_VALUE)) {\r\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\r\n\r\n      const toAmount =\r\n        ratio && !ratio.isZero()\r\n          ? toAmountBasedOnRatio\r\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\r\n\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const expectedAmount = fromAmount;\r\n\r\n    const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n    if (!stableToken || stableToken.availableAmount.lt(expectedAmount)) {\r\n      const toAmount =\r\n        ratio && !ratio.isZero()\r\n          ? toAmountBasedOnRatio\r\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\r\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const feeBasisPoints0 = getSwapFeeBasisPoints(true);\r\n    const feeBasisPoints1 = getSwapFeeBasisPoints(false);\r\n\r\n    if (ratio && !ratio.isZero()) {\r\n      const toAmount = toAmountBasedOnRatio\r\n        .mul(BASIS_POINTS_DIVISOR - feeBasisPoints0 - feeBasisPoints1)\r\n        .div(BASIS_POINTS_DIVISOR);\r\n      return {\r\n        amount: adjustDecimals(toAmount),\r\n        path: [USDG_ADDRESS, stableToken.address, toToken.address],\r\n        feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\r\n      };\r\n    }\r\n\r\n    // get toAmount for USDG => stableToken\r\n    let toAmount = fromAmount.mul(PRECISION).div(stableToken.maxPrice);\r\n    // apply USDG => stableToken fees\r\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints0).div(BASIS_POINTS_DIVISOR);\r\n\r\n    // get toAmount for stableToken => toToken\r\n    toAmount = toAmount.mul(stableToken.minPrice).div(toTokenPriceUsd || toTokenMaxPrice);\r\n    // apply stableToken => toToken fees\r\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\r\n\r\n    return {\r\n      amount: adjustDecimals(toAmount),\r\n      path: [USDG_ADDRESS, stableToken.address, toToken.address],\r\n      feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\r\n    };\r\n  }\r\n\r\n  const toAmount =\r\n    ratio && !ratio.isZero()\r\n      ? toAmountBasedOnRatio\r\n      : fromAmount.mul(fromTokenMinPrice).div(toTokenPriceUsd || toTokenMaxPrice);\r\n\r\n  let usdgAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, fromToken.decimals, USDG_DECIMALS);\r\n  const swapFeeBasisPoints =\r\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\r\n  const feeBasisPoints0 = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints1 = getFeeBasisPoints(\r\n    toToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\r\n\r\n  return {\r\n    amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n    feeBasisPoints,\r\n  };\r\n}\r\n\r\nexport function getProfitPrice(closePrice, position) {\r\n  let profitPrice;\r\n  if (position && position.averagePrice && closePrice) {\r\n    profitPrice = position.isLong\r\n      ? position.averagePrice.mul(BASIS_POINTS_DIVISOR + MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR)\r\n      : position.averagePrice.mul(BASIS_POINTS_DIVISOR - MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR);\r\n  }\r\n  return profitPrice;\r\n}\r\n\r\nexport function calculatePositionDelta(\r\n  price,\r\n  { size, collateral, isLong, averagePrice, lastIncreasedTime },\r\n  sizeDelta\r\n) {\r\n  if (!sizeDelta) {\r\n    sizeDelta = size;\r\n  }\r\n  const priceDelta = averagePrice.gt(price) ? averagePrice.sub(price) : price.sub(averagePrice);\r\n  let delta = sizeDelta.mul(priceDelta).div(averagePrice);\r\n  const pendingDelta = delta;\r\n\r\n  const minProfitExpired = lastIncreasedTime + MIN_PROFIT_TIME < Date.now() / 1000;\r\n  const hasProfit = isLong ? price.gt(averagePrice) : price.lt(averagePrice);\r\n  if (!minProfitExpired && hasProfit && delta.mul(BASIS_POINTS_DIVISOR).lte(size.mul(MIN_PROFIT_BIPS))) {\r\n    delta = bigNumberify(0);\r\n  }\r\n\r\n  const deltaPercentage = delta.mul(BASIS_POINTS_DIVISOR).div(collateral);\r\n  const pendingDeltaPercentage = pendingDelta.mul(BASIS_POINTS_DIVISOR).div(collateral);\r\n\r\n  return {\r\n    delta,\r\n    pendingDelta,\r\n    pendingDeltaPercentage,\r\n    hasProfit,\r\n    deltaPercentage,\r\n  };\r\n}\r\n\r\nexport function getDeltaStr({ delta, deltaPercentage, hasProfit }) {\r\n  let deltaStr;\r\n  let deltaPercentageStr;\r\n\r\n  if (delta.gt(0)) {\r\n    deltaStr = hasProfit ? \"+\" : \"-\";\r\n    deltaPercentageStr = hasProfit ? \"+\" : \"-\";\r\n  } else {\r\n    deltaStr = \"\";\r\n    deltaPercentageStr = \"\";\r\n  }\r\n  deltaStr += `$${formatAmount(delta, USD_DECIMALS, 2, true)}`;\r\n  deltaPercentageStr += `${formatAmount(deltaPercentage, 2, 2)}%`;\r\n\r\n  return { deltaStr, deltaPercentageStr };\r\n}\r\n\r\nexport function getLeverage({\r\n  size,\r\n  sizeDelta,\r\n  increaseSize,\r\n  collateral,\r\n  collateralDelta,\r\n  increaseCollateral,\r\n  entryFundingRate,\r\n  cumulativeFundingRate,\r\n  hasProfit,\r\n  delta,\r\n  includeDelta,\r\n}) {\r\n  if (!size && !sizeDelta) {\r\n    return;\r\n  }\r\n  if (!collateral && !collateralDelta) {\r\n    return;\r\n  }\r\n\r\n  let nextSize = size ? size : bigNumberify(0);\r\n  if (sizeDelta) {\r\n    if (increaseSize) {\r\n      nextSize = size.add(sizeDelta);\r\n    } else {\r\n      if (sizeDelta.gte(size)) {\r\n        return;\r\n      }\r\n      nextSize = size.sub(sizeDelta);\r\n    }\r\n  }\r\n\r\n  let remainingCollateral = collateral ? collateral : bigNumberify(0);\r\n  if (collateralDelta) {\r\n    if (increaseCollateral) {\r\n      remainingCollateral = collateral.add(collateralDelta);\r\n    } else {\r\n      if (collateralDelta.gte(collateral)) {\r\n        return;\r\n      }\r\n      remainingCollateral = collateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  if (delta && includeDelta) {\r\n    if (hasProfit) {\r\n      remainingCollateral = remainingCollateral.add(delta);\r\n    } else {\r\n      if (delta.gt(remainingCollateral)) {\r\n        return;\r\n      }\r\n\r\n      remainingCollateral = remainingCollateral.sub(delta);\r\n    }\r\n  }\r\n\r\n  if (remainingCollateral.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  remainingCollateral = sizeDelta\r\n    ? remainingCollateral.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR)\r\n    : remainingCollateral;\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n    remainingCollateral = remainingCollateral.sub(fundingFee);\r\n  }\r\n\r\n  return nextSize.mul(BASIS_POINTS_DIVISOR).div(remainingCollateral);\r\n}\r\n\r\nexport function getLiquidationPrice(data) {\r\n  let {\r\n    isLong,\r\n    size,\r\n    collateral,\r\n    averagePrice,\r\n    entryFundingRate,\r\n    cumulativeFundingRate,\r\n    sizeDelta,\r\n    collateralDelta,\r\n    increaseCollateral,\r\n    increaseSize,\r\n    delta,\r\n    hasProfit,\r\n    includeDelta,\r\n  } = data;\r\n  if (!size || !collateral || !averagePrice) {\r\n    return;\r\n  }\r\n\r\n  let nextSize = size ? size : bigNumberify(0);\r\n  let remainingCollateral = collateral;\r\n\r\n  if (sizeDelta) {\r\n    if (increaseSize) {\r\n      nextSize = size.add(sizeDelta);\r\n    } else {\r\n      if (sizeDelta.gte(size)) {\r\n        return;\r\n      }\r\n      nextSize = size.sub(sizeDelta);\r\n    }\r\n\r\n    if (includeDelta && !hasProfit) {\r\n      const adjustedDelta = sizeDelta.mul(delta).div(size);\r\n      remainingCollateral = remainingCollateral.sub(adjustedDelta);\r\n    }\r\n  }\r\n\r\n  if (collateralDelta) {\r\n    if (increaseCollateral) {\r\n      remainingCollateral = remainingCollateral.add(collateralDelta);\r\n    } else {\r\n      if (collateralDelta.gte(remainingCollateral)) {\r\n        return;\r\n      }\r\n      remainingCollateral = remainingCollateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  let positionFee = getMarginFee(size).add(LIQUIDATION_FEE);\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n    positionFee = positionFee.add(fundingFee);\r\n  }\r\n\r\n  const liquidationPriceForFees = getLiquidationPriceFromDelta({\r\n    liquidationAmount: positionFee,\r\n    size: nextSize,\r\n    collateral: remainingCollateral,\r\n    averagePrice,\r\n    isLong,\r\n  });\r\n\r\n  const liquidationPriceForMaxLeverage = getLiquidationPriceFromDelta({\r\n    liquidationAmount: nextSize.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE),\r\n    size: nextSize,\r\n    collateral: remainingCollateral,\r\n    averagePrice,\r\n    isLong,\r\n  });\r\n\r\n  if (!liquidationPriceForFees) {\r\n    return liquidationPriceForMaxLeverage;\r\n  }\r\n  if (!liquidationPriceForMaxLeverage) {\r\n    return liquidationPriceForFees;\r\n  }\r\n\r\n  if (isLong) {\r\n    // return the higher price\r\n    return liquidationPriceForFees.gt(liquidationPriceForMaxLeverage)\r\n      ? liquidationPriceForFees\r\n      : liquidationPriceForMaxLeverage;\r\n  }\r\n\r\n  // return the lower price\r\n  return liquidationPriceForFees.lt(liquidationPriceForMaxLeverage)\r\n    ? liquidationPriceForFees\r\n    : liquidationPriceForMaxLeverage;\r\n}\r\n\r\nexport function getUsd(amount, tokenAddress, max, infoTokens, orderOption, triggerPriceUsd) {\r\n  if (!amount) {\r\n    return;\r\n  }\r\n  if (tokenAddress === USDG_ADDRESS) {\r\n    return amount.mul(PRECISION).div(expandDecimals(1, 18));\r\n  }\r\n  const info = getTokenInfo(infoTokens, tokenAddress);\r\n  const price = getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd);\r\n  if (!price) {\r\n    return;\r\n  }\r\n\r\n  return amount.mul(price).div(expandDecimals(1, info.decimals));\r\n}\r\n\r\nexport function getPositionKey(account, collateralTokenAddress, indexTokenAddress, isLong, nativeTokenAddress) {\r\n  const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n  const tokenAddress1 = indexTokenAddress === AddressZero ? nativeTokenAddress : indexTokenAddress;\r\n  return account + \":\" + tokenAddress0 + \":\" + tokenAddress1 + \":\" + isLong;\r\n}\r\n\r\nexport function getPositionContractKey(account, collateralToken, indexToken, isLong) {\r\n  return ethers.utils.solidityKeccak256(\r\n    [\"address\", \"address\", \"address\", \"bool\"],\r\n    [account, collateralToken, indexToken, isLong]\r\n  );\r\n}\r\n\r\nexport function getSwapFeeBasisPoints(isStable) {\r\n  return isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n}\r\n\r\n// BSC TESTNET\r\n// const RPC_PROVIDERS = [\r\n//   \"https://data-seed-prebsc-1-s1.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s1.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-1-s2.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s2.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-1-s3.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s3.binance.org:8545\"\r\n// ]\r\n\r\n// BSC MAINNET\r\nexport const BSC_RPC_PROVIDERS = [\r\n  \"https://bsc-dataseed.binance.org\",\r\n  \"https://bsc-dataseed1.defibit.io\",\r\n  \"https://bsc-dataseed1.ninicoin.io\",\r\n  \"https://bsc-dataseed2.defibit.io\",\r\n  \"https://bsc-dataseed3.defibit.io\",\r\n  \"https://bsc-dataseed4.defibit.io\",\r\n  \"https://bsc-dataseed2.ninicoin.io\",\r\n  \"https://bsc-dataseed3.ninicoin.io\",\r\n  \"https://bsc-dataseed4.ninicoin.io\",\r\n  \"https://bsc-dataseed1.binance.org\",\r\n  \"https://bsc-dataseed2.binance.org\",\r\n  \"https://bsc-dataseed3.binance.org\",\r\n  \"https://bsc-dataseed4.binance.org\",\r\n];\r\n\r\nconst RPC_PROVIDERS = {\r\n  [MAINNET]: BSC_RPC_PROVIDERS,\r\n  [ARBITRUM]: ARBITRUM_RPC_PROVIDERS,\r\n  [AVALANCHE]: AVALANCHE_RPC_PROVIDERS,\r\n};\r\n\r\nconst FALLBACK_PROVIDERS = {\r\n  [ARBITRUM]: [getAlchemyHttpUrl()],\r\n  [AVALANCHE]: [\"https://avax-mainnet.gateway.pokt.network/v1/lb/626f37766c499d003aada23b\"],\r\n};\r\n\r\nexport function shortenAddress(address, length) {\r\n  if (!length) {\r\n    return \"\";\r\n  }\r\n  if (!address) {\r\n    return address;\r\n  }\r\n  if (address.length < 10) {\r\n    return address;\r\n  }\r\n  let left = Math.floor((length - 3) / 2) + 1;\r\n  return address.substring(0, left) + \"...\" + address.substring(address.length - (length - (left + 3)), address.length);\r\n}\r\n\r\nexport function formatDateTime(time) {\r\n  return formatDateFn(time * 1000, \"dd MMM yyyy, h:mm a\");\r\n}\r\n\r\nexport function getTimeRemaining(time) {\r\n  const now = parseInt(Date.now() / 1000);\r\n  if (time < now) {\r\n    return \"0h 0m\";\r\n  }\r\n  const diff = time - now;\r\n  const hours = parseInt(diff / (60 * 60));\r\n  const minutes = parseInt((diff - hours * 60 * 60) / 60);\r\n  return `${hours}h ${minutes}m`;\r\n}\r\n\r\nexport function formatDate(time) {\r\n  return formatDateFn(time * 1000, \"dd MMM yyyy\");\r\n}\r\n\r\nexport function hasMetaMaskWalletExtension() {\r\n  return window.ethereum;\r\n}\r\n\r\nexport function hasCoinBaseWalletExtension() {\r\n  const { ethereum } = window;\r\n\r\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet) {\r\n    return false;\r\n  }\r\n  return window.ethereum.isCoinbaseWallet || ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\r\n}\r\n\r\nexport function activateInjectedProvider(providerName) {\r\n  const { ethereum } = window;\r\n\r\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet && !ethereum?.isMetaMask) {\r\n    return undefined;\r\n  }\r\n\r\n  let provider;\r\n  if (ethereum?.providers) {\r\n    switch (providerName) {\r\n      case \"CoinBase\":\r\n        provider = ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\r\n        break;\r\n      case \"MetaMask\":\r\n      default:\r\n        provider = ethereum.providers.find(({ isMetaMask }) => isMetaMask);\r\n        break;\r\n    }\r\n  }\r\n\r\n  if (provider) {\r\n    ethereum.setSelectedProvider(provider);\r\n  }\r\n}\r\n\r\nexport function getInjectedConnector() {\r\n  return injectedConnector;\r\n}\r\n\r\nexport function useChainId() {\r\n  let { chainId } = useWeb3React();\r\n\r\n  if (!chainId) {\r\n    const chainIdFromLocalStorage = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\r\n    if (chainIdFromLocalStorage) {\r\n      chainId = parseInt(chainIdFromLocalStorage);\r\n      if (!chainId) {\r\n        // localstorage value is invalid\r\n        localStorage.removeItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!chainId || !supportedChainIds.includes(chainId)) {\r\n    chainId = DEFAULT_CHAIN_ID;\r\n  }\r\n  return { chainId };\r\n}\r\n\r\nexport function useENS(address) {\r\n  const [ensName, setENSName] = useState();\r\n\r\n  useEffect(() => {\r\n    async function resolveENS() {\r\n      if (address) {\r\n        const provider = new ethers.providers.JsonRpcProvider(\"https://rpc.ankr.com/eth\");\r\n        const name = await provider.lookupAddress(address.toLowerCase());\r\n        if (name) setENSName(name);\r\n      }\r\n    }\r\n    resolveENS();\r\n  }, [address]);\r\n\r\n  return { ensName };\r\n}\r\n\r\nexport function clearWalletConnectData() {\r\n  localStorage.removeItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\r\n}\r\n\r\nexport function clearWalletLinkData() {\r\n  Object.entries(localStorage)\r\n    .map((x) => x[0])\r\n    .filter((x) => x.startsWith(WALLET_LINK_LOCALSTORAGE_PREFIX))\r\n    .map((x) => localStorage.removeItem(x));\r\n}\r\n\r\nexport function useEagerConnect(setActivatingConnector) {\r\n  const { activate, active } = useWeb3React();\r\n  const [tried, setTried] = useState(false);\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      if (Boolean(localStorage.getItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY)) !== true) {\r\n        // only works with WalletConnect\r\n        clearWalletConnectData();\r\n        // force clear localStorage connection for MM/CB Wallet (Brave legacy)\r\n        clearWalletLinkData();\r\n        return;\r\n      }\r\n\r\n      let shouldTryWalletConnect = false;\r\n      try {\r\n        // naive validation to not trigger Wallet Connect if data is corrupted\r\n        const rawData = localStorage.getItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\r\n        if (rawData) {\r\n          const data = JSON.parse(rawData);\r\n          if (data && data.connected) {\r\n            shouldTryWalletConnect = true;\r\n          }\r\n        }\r\n      } catch (ex) {\r\n        if (ex instanceof SyntaxError) {\r\n          // rawData is not a valid json\r\n          clearWalletConnectData();\r\n        }\r\n      }\r\n\r\n      if (shouldTryWalletConnect) {\r\n        try {\r\n          const connector = getWalletConnectConnector();\r\n          setActivatingConnector(connector);\r\n          await activate(connector, undefined, true);\r\n          // in case Wallet Connect is activated no need to check injected wallet\r\n          return;\r\n        } catch (ex) {\r\n          // assume data in localstorage is corrupted and delete it to not retry on next page load\r\n          clearWalletConnectData();\r\n        }\r\n      }\r\n\r\n      try {\r\n        const connector = getInjectedConnector();\r\n        const currentProviderName = localStorage.getItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY) ?? false;\r\n        if (currentProviderName !== false) {\r\n          activateInjectedProvider(currentProviderName);\r\n        }\r\n        const authorized = await connector.isAuthorized();\r\n        if (authorized) {\r\n          setActivatingConnector(connector);\r\n          await activate(connector, undefined, true);\r\n        }\r\n      } catch (ex) {}\r\n\r\n      setTried(true);\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []); // intentionally only running on mount (make sure it's only mounted once :))\r\n\r\n  // if the connection worked, wait until we get confirmation of that to flip the flag\r\n  useEffect(() => {\r\n    if (!tried && active) {\r\n      setTried(true);\r\n    }\r\n  }, [tried, active]);\r\n\r\n  return tried;\r\n}\r\n\r\nexport function useInactiveListener(suppress = false) {\r\n  const injected = getInjectedConnector();\r\n  const { active, error, activate } = useWeb3React();\r\n\r\n  useEffect(() => {\r\n    const { ethereum } = window;\r\n    if (ethereum && ethereum.on && !active && !error && !suppress) {\r\n      const handleConnect = () => {\r\n        activate(injected);\r\n      };\r\n      const handleChainChanged = (chainId) => {\r\n        activate(injected);\r\n      };\r\n      const handleAccountsChanged = (accounts) => {\r\n        if (accounts.length > 0) {\r\n          activate(injected);\r\n        }\r\n      };\r\n      const handleNetworkChanged = (networkId) => {\r\n        activate(injected);\r\n      };\r\n\r\n      ethereum.on(\"connect\", handleConnect);\r\n      ethereum.on(\"chainChanged\", handleChainChanged);\r\n      ethereum.on(\"accountsChanged\", handleAccountsChanged);\r\n      ethereum.on(\"networkChanged\", handleNetworkChanged);\r\n\r\n      return () => {\r\n        if (ethereum.removeListener) {\r\n          ethereum.removeListener(\"connect\", handleConnect);\r\n          ethereum.removeListener(\"chainChanged\", handleChainChanged);\r\n          ethereum.removeListener(\"accountsChanged\", handleAccountsChanged);\r\n          ethereum.removeListener(\"networkChanged\", handleNetworkChanged);\r\n        }\r\n      };\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [active, error, suppress, activate]);\r\n}\r\n\r\nexport function getProvider(library, chainId) {\r\n  let provider;\r\n  if (library) {\r\n    return library.getSigner();\r\n  }\r\n  provider = _.sample(RPC_PROVIDERS[chainId]);\r\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\r\n}\r\n\r\nexport function getFallbackProvider(chainId) {\r\n  if (!FALLBACK_PROVIDERS[chainId]) {\r\n    return;\r\n  }\r\n\r\n  const provider = _.sample(FALLBACK_PROVIDERS[chainId]);\r\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\r\n}\r\n\r\nexport function bigNumberify(n) {\r\n  try {\r\n    return ethers.BigNumber.from(n);\r\n  } catch (e) {\r\n    console.error(\"bigNumberify error\", e);\r\n    return undefined;\r\n  }\r\n}\r\n\r\nexport function expandDecimals(n, decimals) {\r\n  return bigNumberify(n).mul(bigNumberify(10).pow(decimals));\r\n}\r\n\r\nexport const trimZeroDecimals = (amount) => {\r\n  if (parseFloat(amount) === parseInt(amount)) {\r\n    return parseInt(amount).toString();\r\n  }\r\n  return amount;\r\n};\r\n\r\nexport const limitDecimals = (amount, maxDecimals) => {\r\n  let amountStr = amount.toString();\r\n  \r\n  if (maxDecimals === undefined) {\r\n    return amountStr;\r\n  }\r\n  if (maxDecimals === 0) {\r\n    return amountStr.split(\".\")[0];\r\n  }\r\n  const dotIndex = amountStr.indexOf(\".\");\r\n  if (dotIndex !== -1) {\r\n    let decimals = amountStr.length - dotIndex - 1;\r\n    if (decimals > maxDecimals) {\r\n      amountStr = amountStr.substr(0, amountStr.length - (decimals - maxDecimals));\r\n    }\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const padDecimals = (amount, minDecimals) => {\r\n  let amountStr = amount.toString();\r\n  const dotIndex = amountStr.indexOf(\".\");\r\n  if (dotIndex !== -1) {\r\n    const decimals = amountStr.length - dotIndex - 1;\r\n    if (decimals < minDecimals) {\r\n      amountStr = amountStr.padEnd(amountStr.length + (minDecimals - decimals), \"0\");\r\n    }\r\n  } else {\r\n    amountStr = amountStr + \".0000\";\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const formatKeyAmount = (map, key, tokenDecimals, displayDecimals, useCommas) => {\r\n  if (!map || !map[key]) {\r\n    return \"...\";\r\n  }\r\n\r\n  return formatAmount(map[key], tokenDecimals, displayDecimals, useCommas);\r\n};\r\n\r\nexport const formatArrayAmount = (arr, index, tokenDecimals, displayDecimals, useCommas) => {\r\n  if (!arr || !arr[index]) {\r\n    return \"...\";\r\n  }\r\n\r\n  return formatAmount(arr[index], tokenDecimals, displayDecimals, useCommas);\r\n};\r\n\r\nfunction _parseOrdersData(ordersData, account, indexes, extractor, uintPropsLength, addressPropsLength) {\r\n  if (!ordersData || ordersData.length === 0) {\r\n    return [];\r\n  }\r\n  const [uintProps, addressProps] = ordersData;\r\n  const count = uintProps.length / uintPropsLength;\r\n\r\n  const orders = [];\r\n  for (let i = 0; i < count; i++) {\r\n    const sliced = addressProps\r\n      .slice(addressPropsLength * i, addressPropsLength * (i + 1))\r\n      .concat(uintProps.slice(uintPropsLength * i, uintPropsLength * (i + 1)));\r\n\r\n    if (sliced[0] === AddressZero && sliced[1] === AddressZero) {\r\n      continue;\r\n    }\r\n\r\n    const order = extractor(sliced);\r\n    order.index = indexes[i];\r\n    order.account = account;\r\n    orders.push(order);\r\n  }\r\n\r\n  return orders;\r\n}\r\n\r\nfunction parseDecreaseOrdersData(chainId, decreaseOrdersData, account, indexes) {\r\n  const extractor = (sliced) => {\r\n    const isLong = sliced[4].toString() === \"1\";\r\n    return {\r\n      collateralToken: sliced[0],\r\n      indexToken: sliced[1],\r\n      collateralDelta: sliced[2],\r\n      sizeDelta: sliced[3],\r\n      isLong,\r\n      triggerPrice: sliced[5],\r\n      triggerAboveThreshold: sliced[6].toString() === \"1\",\r\n      type: DECREASE,\r\n    };\r\n  };\r\n  return _parseOrdersData(decreaseOrdersData, account, indexes, extractor, 5, 2).filter((order) => {\r\n    return isValidToken(chainId, order.collateralToken) && isValidToken(chainId, order.indexToken);\r\n  });\r\n}\r\n\r\nfunction parseIncreaseOrdersData(chainId, increaseOrdersData, account, indexes) {\r\n  const extractor = (sliced) => {\r\n    const isLong = sliced[5].toString() === \"1\";\r\n    return {\r\n      purchaseToken: sliced[0],\r\n      collateralToken: sliced[1],\r\n      indexToken: sliced[2],\r\n      purchaseTokenAmount: sliced[3],\r\n      sizeDelta: sliced[4],\r\n      isLong,\r\n      triggerPrice: sliced[6],\r\n      triggerAboveThreshold: sliced[7].toString() === \"1\",\r\n      type: INCREASE,\r\n    };\r\n  };\r\n  return _parseOrdersData(increaseOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\r\n    return (\r\n      isValidToken(chainId, order.purchaseToken) &&\r\n      isValidToken(chainId, order.collateralToken) &&\r\n      isValidToken(chainId, order.indexToken)\r\n    );\r\n  });\r\n}\r\n\r\nfunction parseSwapOrdersData(chainId, swapOrdersData, account, indexes) {\r\n  if (!swapOrdersData || !swapOrdersData.length) {\r\n    return [];\r\n  }\r\n\r\n  const extractor = (sliced) => {\r\n    const triggerAboveThreshold = sliced[6].toString() === \"1\";\r\n    const shouldUnwrap = sliced[7].toString() === \"1\";\r\n\r\n    return {\r\n      path: [sliced[0], sliced[1], sliced[2]].filter((address) => address !== AddressZero),\r\n      amountIn: sliced[3],\r\n      minOut: sliced[4],\r\n      triggerRatio: sliced[5],\r\n      triggerAboveThreshold,\r\n      type: SWAP,\r\n      shouldUnwrap,\r\n    };\r\n  };\r\n  return _parseOrdersData(swapOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\r\n    return order.path.every((token) => isValidToken(chainId, token));\r\n  });\r\n}\r\n\r\nexport function getOrderKey(order) {\r\n  return `${order.type}-${order.account}-${order.index}`;\r\n}\r\n\r\nexport function useAccountOrders(flagOrdersEnabled, overrideAccount) {\r\n  const { library, account: connectedAccount } = useWeb3React();\r\n  const active = true; // this is used in Actions.js so set active to always be true\r\n  const account = overrideAccount || connectedAccount;\r\n\r\n  const { chainId } = useChainId();\r\n  const shouldRequest = active && account && flagOrdersEnabled;\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const orderBookReaderAddress = getContract(chainId, \"OrderBookReader\");\r\n  const key = shouldRequest ? [active, chainId, orderBookAddress, account] : false;\r\n  const {\r\n    data: orders = [],\r\n    mutate: updateOrders,\r\n    error: ordersError,\r\n  } = useSWR(key, {\r\n    dedupingInterval: 5000,\r\n    fetcher: async (active, chainId, orderBookAddress, account) => {\r\n      const provider = getProvider(library, chainId);\r\n      const orderBookContract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\r\n      const orderBookReaderContract = new ethers.Contract(orderBookReaderAddress, OrderBookReader.abi, provider);\r\n\r\n      const fetchIndexesFromServer = () => {\r\n        const ordersIndexesUrl = `${getServerBaseUrl(chainId)}/orders_indices?account=${account}`;\r\n        return fetch(ordersIndexesUrl)\r\n          .then(async (res) => {\r\n            const json = await res.json();\r\n            const ret = {};\r\n            for (const key of Object.keys(json)) {\r\n              ret[key.toLowerCase()] = json[key].map((val) => parseInt(val.value)).sort((a, b) => a - b);\r\n            }\r\n\r\n            return ret;\r\n          })\r\n          .catch(() => ({ swap: [], increase: [], decrease: [] }));\r\n      };\r\n\r\n      const fetchLastIndex = async (type) => {\r\n        const method = type.toLowerCase() + \"OrdersIndex\";\r\n        return await orderBookContract[method](account).then((res) => bigNumberify(res._hex).toNumber());\r\n      };\r\n\r\n      const fetchLastIndexes = async () => {\r\n        const [swap, increase, decrease] = await Promise.all([\r\n          fetchLastIndex(\"swap\"),\r\n          fetchLastIndex(\"increase\"),\r\n          fetchLastIndex(\"decrease\"),\r\n        ]);\r\n\r\n        return { swap, increase, decrease };\r\n      };\r\n\r\n      const getRange = (to, from) => {\r\n        const LIMIT = 10;\r\n        const _indexes = [];\r\n        from = from || Math.max(to - LIMIT, 0);\r\n        for (let i = to - 1; i >= from; i--) {\r\n          _indexes.push(i);\r\n        }\r\n        return _indexes;\r\n      };\r\n\r\n      const getIndexes = (knownIndexes, lastIndex) => {\r\n        if (knownIndexes.length === 0) {\r\n          return getRange(lastIndex);\r\n        }\r\n        return [\r\n          ...knownIndexes,\r\n          ...getRange(lastIndex, knownIndexes[knownIndexes.length - 1] + 1).sort((a, b) => b - a),\r\n        ];\r\n      };\r\n\r\n      const getOrders = async (method, knownIndexes, lastIndex, parseFunc) => {\r\n        const indexes = getIndexes(knownIndexes, lastIndex);\r\n        const ordersData = await orderBookReaderContract[method](orderBookAddress, account, indexes);\r\n        const orders = parseFunc(chainId, ordersData, account, indexes);\r\n\r\n        return orders;\r\n      };\r\n\r\n      try {\r\n        const [serverIndexes, lastIndexes] = await Promise.all([fetchIndexesFromServer(), fetchLastIndexes()]);\r\n        const [swapOrders = [], increaseOrders = [], decreaseOrders = []] = await Promise.all([\r\n          getOrders(\"getSwapOrders\", serverIndexes.swap, lastIndexes.swap, parseSwapOrdersData),\r\n          getOrders(\"getIncreaseOrders\", serverIndexes.increase, lastIndexes.increase, parseIncreaseOrdersData),\r\n          getOrders(\"getDecreaseOrders\", serverIndexes.decrease, lastIndexes.decrease, parseDecreaseOrdersData),\r\n        ]);\r\n        return [...swapOrders, ...increaseOrders, ...decreaseOrders];\r\n      } catch (ex) {\r\n        console.error(ex);\r\n      }\r\n    },\r\n  });\r\n\r\n  return [orders, updateOrders, ordersError];\r\n}\r\n\r\nexport const formatAmount = (amount, tokenDecimals, displayDecimals, useCommas, defaultValue) => {\r\n  if (amount === null) {\r\n    return;\r\n  }\r\n  \r\n  if (!defaultValue) {\r\n    defaultValue = \"...\";\r\n  }\r\n  if (amount === undefined || amount.toString().length === 0) {\r\n    return defaultValue;\r\n  }\r\n  if (displayDecimals === undefined) {\r\n    displayDecimals = 4;\r\n  }\r\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\r\n  amountStr = limitDecimals(amountStr, displayDecimals);\r\n  if (displayDecimals !== 0) {\r\n    amountStr = padDecimals(amountStr, displayDecimals);\r\n  }\r\n  if (useCommas) {\r\n    return numberWithCommas(amountStr);\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const formatAmountFree = (amount, tokenDecimals, displayDecimals) => {\r\n  if (!amount) {\r\n    return \"...\";\r\n  }\r\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\r\n  amountStr = limitDecimals(amountStr, displayDecimals);\r\n  return trimZeroDecimals(amountStr);\r\n};\r\n\r\nexport const parseValue = (value, tokenDecimals) => {\r\n  const pValue = parseFloat(value);\r\n  if (isNaN(pValue)) {\r\n    return undefined;\r\n  }\r\n  value = limitDecimals(value, tokenDecimals);\r\n  const amount = ethers.utils.parseUnits(value, tokenDecimals);\r\n  return bigNumberify(amount);\r\n};\r\n\r\nexport function numberWithCommas(x) {\r\n  if (!x) {\r\n    return \"...\";\r\n  }\r\n  var parts = x.toString().split(\".\");\r\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n  return parts.join(\".\");\r\n}\r\n\r\nexport function getExplorerUrl(chainId) {\r\n  if (chainId === 3) {\r\n    return \"https://ropsten.etherscan.io/\";\r\n  } else if (chainId === 42) {\r\n    return \"https://kovan.etherscan.io/\";\r\n  } else if (chainId === MAINNET) {\r\n    return \"https://bscscan.com/\";\r\n  } else if (chainId === TESTNET) {\r\n    return \"https://testnet.bscscan.com/\";\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return \"https://testnet.arbiscan.io/\";\r\n  } else if (chainId === ARBITRUM) {\r\n    return \"https://arbiscan.io/\";\r\n  } else if (chainId === AVALANCHE) {\r\n    return \"https://snowtrace.io/\";\r\n  }\r\n  return \"https://etherscan.io/\";\r\n}\r\n\r\nexport function getAccountUrl(chainId, account) {\r\n  if (!account) {\r\n    return getExplorerUrl(chainId);\r\n  }\r\n  return getExplorerUrl(chainId) + \"address/\" + account;\r\n}\r\n\r\nexport function getTokenUrl(chainId, address) {\r\n  if (!address) {\r\n    return getExplorerUrl(chainId);\r\n  }\r\n  return getExplorerUrl(chainId) + \"token/\" + address;\r\n}\r\n\r\nexport function usePrevious(value) {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n\r\nexport function approveTokens({\r\n  setIsApproving,\r\n  library,\r\n  tokenAddress,\r\n  spender,\r\n  chainId,\r\n  onApproveSubmitted,\r\n  getTokenInfo,\r\n  infoTokens,\r\n  pendingTxns,\r\n  setPendingTxns,\r\n  includeMessage,\r\n}) {\r\n  setIsApproving(true);\r\n  const contract = new ethers.Contract(tokenAddress, Token.abi, library.getSigner());\r\n  contract\r\n    .approve(spender, ethers.constants.MaxUint256)\r\n    .then(async (res) => {\r\n      const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\r\n      helperToast.success(\r\n        <div>\r\n          Approval submitted!{\" \"}\r\n          <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n            View status.\r\n          </a>\r\n          <br />\r\n        </div>\r\n      );\r\n      if (onApproveSubmitted) {\r\n        onApproveSubmitted();\r\n      }\r\n      if (getTokenInfo && infoTokens && pendingTxns && setPendingTxns) {\r\n        const token = getTokenInfo(infoTokens, tokenAddress);\r\n        const pendingTxn = {\r\n          hash: res.hash,\r\n          message: includeMessage ? `${token.symbol} Approved!` : false,\r\n        };\r\n        setPendingTxns([...pendingTxns, pendingTxn]);\r\n      }\r\n    })\r\n    .catch((e) => {\r\n      console.error(e);\r\n      let failMsg;\r\n      if (\r\n        [\"not enough funds for gas\", \"failed to execute call with revert code InsufficientGasFunds\"].includes(\r\n          e.data?.message\r\n        )\r\n      ) {\r\n        failMsg = (\r\n          <div>\r\n            There is not enough ETH in your account on Arbitrum to send this transaction.\r\n            <br />\r\n            <br />\r\n            <a href={\"https://arbitrum.io/bridge-tutorial/\"} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              Bridge ETH to Arbitrum\r\n            </a>\r\n          </div>\r\n        );\r\n      } else if (e.message?.includes(\"User denied transaction signature\")) {\r\n        failMsg = \"Approval was cancelled\";\r\n      } else {\r\n        failMsg = \"Approval failed\";\r\n      }\r\n      helperToast.error(failMsg);\r\n    })\r\n    .finally(() => {\r\n      setIsApproving(false);\r\n    });\r\n}\r\n\r\nexport const shouldRaiseGasError = (token, amount) => {\r\n  if (!amount) {\r\n    return false;\r\n  }\r\n  if (token.address !== AddressZero) {\r\n    return false;\r\n  }\r\n  if (!token.balance) {\r\n    return false;\r\n  }\r\n  if (amount.gte(token.balance)) {\r\n    return true;\r\n  }\r\n  if (token.balance.sub(amount).lt(DUST_BNB)) {\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getTokenInfo = (infoTokens, tokenAddress, replaceNative, nativeTokenAddress) => {\r\n  if (replaceNative && tokenAddress === nativeTokenAddress) {\r\n    return infoTokens[AddressZero];\r\n  }\r\n  return infoTokens[tokenAddress];\r\n};\r\n\r\nconst NETWORK_METADATA = {\r\n  [MAINNET]: {\r\n    chainId: \"0x\" + MAINNET.toString(16),\r\n    chainName: \"BSC\",\r\n    nativeCurrency: {\r\n      name: \"BNB\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: BSC_RPC_PROVIDERS,\r\n    blockExplorerUrls: [\"https://bscscan.com\"],\r\n  },\r\n  [TESTNET]: {\r\n    chainId: \"0x\" + TESTNET.toString(16),\r\n    chainName: \"BSC Testnet\",\r\n    nativeCurrency: {\r\n      name: \"BNB\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: [\"https://data-seed-prebsc-1-s1.binance.org:8545/\"],\r\n    blockExplorerUrls: [\"https://testnet.bscscan.com/\"],\r\n  },\r\n  [ARBITRUM_TESTNET]: {\r\n    chainId: \"0x\" + ARBITRUM_TESTNET.toString(16),\r\n    chainName: \"Arbitrum Testnet\",\r\n    nativeCurrency: {\r\n      name: \"ETH\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: [\"https://rinkeby.arbitrum.io/rpc\"],\r\n    blockExplorerUrls: [\"https://rinkeby-explorer.arbitrum.io/\"],\r\n  },\r\n  [ARBITRUM]: {\r\n    chainId: \"0x\" + ARBITRUM.toString(16),\r\n    chainName: \"Arbitrum\",\r\n    nativeCurrency: {\r\n      name: \"ETH\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: ARBITRUM_RPC_PROVIDERS,\r\n    blockExplorerUrls: [getExplorerUrl(ARBITRUM)],\r\n  },\r\n  [AVALANCHE]: {\r\n    chainId: \"0x\" + AVALANCHE.toString(16),\r\n    chainName: \"Avalanche\",\r\n    nativeCurrency: {\r\n      name: \"AVAX\",\r\n      symbol: \"AVAX\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: AVALANCHE_RPC_PROVIDERS,\r\n    blockExplorerUrls: [getExplorerUrl(AVALANCHE)],\r\n  },\r\n};\r\n\r\nexport const addBscNetwork = async () => {\r\n  return addNetwork(NETWORK_METADATA[MAINNET]);\r\n};\r\n\r\nexport const addNetwork = async (metadata) => {\r\n  await window.ethereum.request({ method: \"wallet_addEthereumChain\", params: [metadata] }).catch();\r\n};\r\n\r\nexport const switchNetwork = async (chainId, active) => {\r\n  if (!active) {\r\n    // chainId in localStorage allows to switch network even if wallet is not connected\r\n    // or there is no wallet at all\r\n    localStorage.setItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY, chainId);\r\n    document.location.reload();\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const chainIdHex = \"0x\" + chainId.toString(16);\r\n    await window.ethereum.request({\r\n      method: \"wallet_switchEthereumChain\",\r\n      params: [{ chainId: chainIdHex }],\r\n    });\r\n    helperToast.success(\"Connected to \" + getChainName(chainId));\r\n    return getChainName(chainId);\r\n  } catch (ex) {\r\n    // https://docs.metamask.io/guide/rpc-api.html#other-rpc-methods\r\n    // This error code indicates that the chain has not been added to MetaMask.\r\n    // 4001 error means user has denied the request\r\n    // If the error code is not 4001, then we need to add the network\r\n    if (ex.code !== 4001) {\r\n      return await addNetwork(NETWORK_METADATA[chainId]);\r\n    }\r\n\r\n    console.error(\"error\", ex);\r\n  }\r\n};\r\n\r\nexport const getWalletConnectHandler = (activate, deactivate, setActivatingConnector) => {\r\n  const fn = async () => {\r\n    const walletConnect = getWalletConnectConnector();\r\n    setActivatingConnector(walletConnect);\r\n    activate(walletConnect, (ex) => {\r\n      if (ex instanceof UnsupportedChainIdError) {\r\n        helperToast.error(\"Unsupported chain. Switch to Arbitrum network on your wallet and try again\");\r\n        console.warn(ex);\r\n      } else if (!(ex instanceof UserRejectedRequestErrorWalletConnect)) {\r\n        helperToast.error(ex.message);\r\n        console.warn(ex);\r\n      }\r\n      clearWalletConnectData();\r\n      deactivate();\r\n    });\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport const getInjectedHandler = (activate) => {\r\n  const fn = async () => {\r\n    activate(getInjectedConnector(), (e) => {\r\n      const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\r\n\r\n      if (e instanceof UnsupportedChainIdError) {\r\n        helperToast.error(\r\n          <div>\r\n            <div>Your wallet is not connected to {getChainName(chainId)}.</div>\r\n            <br />\r\n            <div className=\"clickable underline margin-bottom\" onClick={() => switchNetwork(chainId, true)}>\r\n              Switch to {getChainName(chainId)}\r\n            </div>\r\n            <div className=\"clickable underline\" onClick={() => switchNetwork(chainId, true)}>\r\n              Add {getChainName(chainId)}\r\n            </div>\r\n          </div>\r\n        );\r\n        return;\r\n      }\r\n      const errString = e.message ?? e.toString();\r\n      helperToast.error(errString);\r\n    });\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport function isMobileDevice(navigator) {\r\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n}\r\n\r\nexport function setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress) {\r\n  if (!indexPrices) {\r\n    // console.log('return');\r\n    return;\r\n  }\r\n\r\n  // console.log('-------------------WENT THROUGH')\r\n\r\n  const tokenAddress = token.isNative ? nativeTokenAddress : token.address;\r\n\r\n  const indexPrice = indexPrices[tokenAddress];\r\n  if (!indexPrice) {\r\n    return;\r\n  }\r\n\r\n  const indexPriceBn = bigNumberify(indexPrice);\r\n  if (indexPriceBn.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  const spread = token.maxPrice.sub(token.minPrice);\r\n  const spreadBps = spread.mul(BASIS_POINTS_DIVISOR).div(token.maxPrice.add(token.minPrice).div(2));\r\n\r\n  if (spreadBps.gt(MAX_PRICE_DEVIATION_BASIS_POINTS - 50)) {\r\n    // only set one of the values as there will be a spread between the index price and the Chainlink price\r\n    if (indexPriceBn.gt(token.minPrimaryPrice)) {\r\n      token.maxPrice = indexPriceBn;\r\n    } else {\r\n      token.minPrice = indexPriceBn;\r\n    }\r\n    return;\r\n  }\r\n\r\n  const halfSpreadBps = spreadBps.div(2).toNumber();\r\n  token.maxPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR + halfSpreadBps).div(BASIS_POINTS_DIVISOR);\r\n  token.minPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR - halfSpreadBps).div(BASIS_POINTS_DIVISOR);\r\n}\r\n\r\nexport function getInfoTokens(\r\n  tokens,\r\n  tokenBalances,\r\n  whitelistedTokens,\r\n  vaultTokenInfo,\r\n  fundingRateInfo,\r\n  vaultPropsLength,\r\n  indexPrices,\r\n  nativeTokenAddress\r\n) {\r\n  if (!vaultPropsLength) {\r\n    vaultPropsLength = 15;\r\n  }\r\n  const fundingRatePropsLength = 2;\r\n  const infoTokens = {};\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = JSON.parse(JSON.stringify(tokens[i]));\r\n    if (tokenBalances) {\r\n      token.balance = tokenBalances[i];\r\n    }\r\n    if (token.address === USDG_ADDRESS) {\r\n      token.minPrice = expandDecimals(1, USD_DECIMALS);\r\n      token.maxPrice = expandDecimals(1, USD_DECIMALS);\r\n    }\r\n    infoTokens[token.address] = token;\r\n  }\r\n\r\n  for (let i = 0; i < whitelistedTokens.length; i++) {\r\n    const token = JSON.parse(JSON.stringify(whitelistedTokens[i]));\r\n    if (vaultTokenInfo) {\r\n      token.poolAmount = vaultTokenInfo[i * vaultPropsLength];\r\n      token.reservedAmount = vaultTokenInfo[i * vaultPropsLength + 1];\r\n      token.availableAmount = token.poolAmount.sub(token.reservedAmount);\r\n      token.usdgAmount = vaultTokenInfo[i * vaultPropsLength + 2];\r\n      token.redemptionAmount = vaultTokenInfo[i * vaultPropsLength + 3];\r\n      token.weight = vaultTokenInfo[i * vaultPropsLength + 4];\r\n      token.bufferAmount = vaultTokenInfo[i * vaultPropsLength + 5];\r\n      token.maxUsdgAmount = vaultTokenInfo[i * vaultPropsLength + 6];\r\n      token.globalShortSize = vaultTokenInfo[i * vaultPropsLength + 7];\r\n      token.maxGlobalShortSize = vaultTokenInfo[i * vaultPropsLength + 8];\r\n      token.maxGlobalLongSize = vaultTokenInfo[i * vaultPropsLength + 9];\r\n      token.minPrice = vaultTokenInfo[i * vaultPropsLength + 10];\r\n      token.maxPrice = vaultTokenInfo[i * vaultPropsLength + 11];\r\n      token.guaranteedUsd = vaultTokenInfo[i * vaultPropsLength + 12];\r\n      token.maxPrimaryPrice = vaultTokenInfo[i * vaultPropsLength + 13];\r\n      token.minPrimaryPrice = vaultTokenInfo[i * vaultPropsLength + 14];\r\n\r\n      // save minPrice and maxPrice as setTokenUsingIndexPrices may override it\r\n      token.contractMinPrice = token.minPrice;\r\n      token.contractMaxPrice = token.maxPrice;\r\n\r\n      token.maxAvailableShort = bigNumberify(0);\r\n      token.hasMaxAvailableShort = false;\r\n      if (token.maxGlobalShortSize.gt(0)) {\r\n        token.hasMaxAvailableShort = true;\r\n        if (token.maxGlobalShortSize.gt(token.globalShortSize)) {\r\n          token.maxAvailableShort = token.maxGlobalShortSize.sub(token.globalShortSize);\r\n        }\r\n      }\r\n\r\n      if (token.maxUsdgAmount.eq(0)) {\r\n        token.maxUsdgAmount = DEFAULT_MAX_USDG_AMOUNT;\r\n      }\r\n\r\n      token.availableUsd = token.isStable\r\n        ? token.poolAmount.mul(token.minPrice).div(expandDecimals(1, token.decimals))\r\n        : token.availableAmount.mul(token.minPrice).div(expandDecimals(1, token.decimals));\r\n\r\n      token.maxAvailableLong = bigNumberify(0);\r\n      token.hasMaxAvailableLong = false;\r\n      if (token.maxGlobalLongSize.gt(0)) {\r\n        token.hasMaxAvailableLong = true;\r\n\r\n        if (token.maxGlobalLongSize.gt(token.guaranteedUsd)) {\r\n          const remainingLongSize = token.maxGlobalLongSize.sub(token.guaranteedUsd);\r\n          token.maxAvailableLong = remainingLongSize.lt(token.availableUsd) ? remainingLongSize : token.availableUsd;\r\n        }\r\n      } else {\r\n        token.maxAvailableLong = token.availableUsd;\r\n      }\r\n\r\n      token.maxLongCapacity =\r\n        token.maxGlobalLongSize.gt(0) && token.maxGlobalLongSize.lt(token.availableUsd.add(token.guaranteedUsd))\r\n          ? token.maxGlobalLongSize\r\n          : token.availableUsd.add(token.guaranteedUsd);\r\n\r\n      token.managedUsd = token.availableUsd.add(token.guaranteedUsd);\r\n      token.managedAmount = token.managedUsd.mul(expandDecimals(1, token.decimals)).div(token.minPrice);\r\n\r\n      setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress);\r\n    }\r\n\r\n    if (fundingRateInfo) {\r\n      token.fundingRate = fundingRateInfo[i * fundingRatePropsLength];\r\n      token.cumulativeFundingRate = fundingRateInfo[i * fundingRatePropsLength + 1];\r\n    }\r\n\r\n    if (infoTokens[token.address]) {\r\n      token.balance = infoTokens[token.address].balance;\r\n    }\r\n\r\n    infoTokens[token.address] = token;\r\n  }\r\n\r\n  return infoTokens;\r\n}\r\n\r\nexport const CHART_PERIODS = {\r\n  \"5m\": 60 * 5,\r\n  \"15m\": 60 * 15,\r\n  \"1h\": 60 * 60,\r\n  \"4h\": 60 * 60 * 4,\r\n  \"1d\": 60 * 60 * 24,\r\n};\r\n\r\nexport function getTotalVolumeSum(volumes) {\r\n  if (!volumes || volumes.length === 0) {\r\n    return;\r\n  }\r\n\r\n  let volume = bigNumberify(0);\r\n  for (let i = 0; i < volumes.length; i++) {\r\n    volume = volume.add(volumes[i].data.volume);\r\n  }\r\n\r\n  return volume;\r\n}\r\n\r\nexport function getBalanceAndSupplyData(balances) {\r\n  if (!balances || balances.length === 0) {\r\n    return {};\r\n  }\r\n\r\n  const keys = [\"gmx\", \"esGmx\", \"glp\", \"stakedGmxTracker\"];\r\n  const balanceData = {};\r\n  const supplyData = {};\r\n  const propsLength = 2;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    balanceData[key] = balances[i * propsLength];\r\n    supplyData[key] = balances[i * propsLength + 1];\r\n  }\r\n\r\n  return { balanceData, supplyData };\r\n}\r\n\r\nexport function getDepositBalanceData(depositBalances) {\r\n  if (!depositBalances || depositBalances.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\r\n    \"gmxInStakedGmx\",\r\n    \"esGmxInStakedGmx\",\r\n    \"stakedGmxInBonusGmx\",\r\n    \"bonusGmxInFeeGmx\",\r\n    \"bnGmxInFeeGmx\",\r\n    \"glpInStakedGlp\",\r\n  ];\r\n  const data = {};\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = depositBalances[i];\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getVestingData(vestingInfo) {\r\n  if (!vestingInfo || vestingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"gmxVester\", \"glpVester\"];\r\n  const data = {};\r\n  const propsLength = 7;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      pairAmount: vestingInfo[i * propsLength],\r\n      vestedAmount: vestingInfo[i * propsLength + 1],\r\n      escrowedBalance: vestingInfo[i * propsLength + 2],\r\n      claimedAmounts: vestingInfo[i * propsLength + 3],\r\n      claimable: vestingInfo[i * propsLength + 4],\r\n      maxVestableAmount: vestingInfo[i * propsLength + 5],\r\n      averageStakedAmount: vestingInfo[i * propsLength + 6],\r\n    };\r\n\r\n    data[key + \"PairAmount\"] = data[key].pairAmount;\r\n    data[key + \"VestedAmount\"] = data[key].vestedAmount;\r\n    data[key + \"EscrowedBalance\"] = data[key].escrowedBalance;\r\n    data[key + \"ClaimSum\"] = data[key].claimedAmounts.add(data[key].claimable);\r\n    data[key + \"Claimable\"] = data[key].claimable;\r\n    data[key + \"MaxVestableAmount\"] = data[key].maxVestableAmount;\r\n    data[key + \"AverageStakedAmount\"] = data[key].averageStakedAmount;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getStakingData(stakingInfo) {\r\n  if (!stakingInfo || stakingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"stakedGmxTracker\", \"bonusGmxTracker\", \"feeGmxTracker\", \"stakedGlpTracker\", \"feeGlpTracker\"];\r\n  const data = {};\r\n  const propsLength = 5;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      claimable: stakingInfo[i * propsLength],\r\n      tokensPerInterval: stakingInfo[i * propsLength + 1],\r\n      averageStakedAmounts: stakingInfo[i * propsLength + 2],\r\n      cumulativeRewards: stakingInfo[i * propsLength + 3],\r\n      totalSupply: stakingInfo[i * propsLength + 4],\r\n    };\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getProcessedData(\r\n  balanceData,\r\n  supplyData,\r\n  depositBalanceData,\r\n  stakingData,\r\n  vestingData,\r\n  aum,\r\n  nativeTokenPrice,\r\n  stakedGmxSupply,\r\n  gmxPrice,\r\n  gmxSupply\r\n) {\r\n  if (\r\n    !balanceData ||\r\n    !supplyData ||\r\n    !depositBalanceData ||\r\n    !stakingData ||\r\n    !vestingData ||\r\n    !aum ||\r\n    !nativeTokenPrice ||\r\n    !stakedGmxSupply ||\r\n    !gmxPrice ||\r\n    !gmxSupply\r\n  ) {\r\n    return {};\r\n  }\r\n\r\n  const data = {};\r\n\r\n  data.gmxBalance = balanceData.gmx;\r\n  data.gmxBalanceUsd = balanceData.gmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.gmxSupply = bigNumberify(gmxSupply);\r\n\r\n  data.gmxSupplyUsd = data.gmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.stakedGmxSupply = stakedGmxSupply;\r\n  data.stakedGmxSupplyUsd = stakedGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.gmxInStakedGmx = depositBalanceData.gmxInStakedGmx;\r\n  data.gmxInStakedGmxUsd = depositBalanceData.gmxInStakedGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.esGmxBalance = balanceData.esGmx;\r\n  data.esGmxBalanceUsd = balanceData.esGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGmxTrackerSupply = supplyData.stakedGmxTracker;\r\n  data.stakedGmxTrackerSupplyUsd = supplyData.stakedGmxTracker.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.stakedEsGmxSupply = data.stakedGmxTrackerSupply.sub(data.stakedGmxSupply);\r\n  data.stakedEsGmxSupplyUsd = data.stakedEsGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.esGmxInStakedGmx = depositBalanceData.esGmxInStakedGmx;\r\n  data.esGmxInStakedGmxUsd = depositBalanceData.esGmxInStakedGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.bnGmxInFeeGmx = depositBalanceData.bnGmxInFeeGmx;\r\n  data.bonusGmxInFeeGmx = depositBalanceData.bonusGmxInFeeGmx;\r\n  data.feeGmxSupply = stakingData.feeGmxTracker.totalSupply;\r\n  data.feeGmxSupplyUsd = data.feeGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGmxTrackerRewards = stakingData.stakedGmxTracker.claimable;\r\n  data.stakedGmxTrackerRewardsUsd = stakingData.stakedGmxTracker.claimable.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.bonusGmxTrackerRewards = stakingData.bonusGmxTracker.claimable;\r\n\r\n  data.feeGmxTrackerRewards = stakingData.feeGmxTracker.claimable;\r\n  data.feeGmxTrackerRewardsUsd = stakingData.feeGmxTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\r\n\r\n  data.boostBasisPoints = bigNumberify(0);\r\n  if (data && data.bnGmxInFeeGmx && data.bonusGmxInFeeGmx && data.bonusGmxInFeeGmx.gt(0)) {\r\n    data.boostBasisPoints = data.bnGmxInFeeGmx.mul(BASIS_POINTS_DIVISOR).div(data.bonusGmxInFeeGmx);\r\n  }\r\n\r\n  data.stakedGmxTrackerAnnualRewardsUsd = stakingData.stakedGmxTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(gmxPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.gmxAprForEsGmx =\r\n    data.stakedGmxTrackerSupplyUsd && data.stakedGmxTrackerSupplyUsd.gt(0)\r\n      ? data.stakedGmxTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.stakedGmxTrackerSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.feeGmxTrackerAnnualRewardsUsd = stakingData.feeGmxTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(nativeTokenPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.gmxAprForNativeToken =\r\n    data.feeGmxSupplyUsd && data.feeGmxSupplyUsd.gt(0)\r\n      ? data.feeGmxTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.feeGmxSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.gmxBoostAprForNativeToken = data.gmxAprForNativeToken.mul(data.boostBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n  data.gmxAprTotal = data.gmxAprForNativeToken.add(data.gmxAprForEsGmx);\r\n  data.gmxAprTotalWithBoost = data.gmxAprForNativeToken.add(data.gmxBoostAprForNativeToken).add(data.gmxAprForEsGmx);\r\n  data.gmxAprForNativeTokenWithBoost = data.gmxAprForNativeToken.add(data.gmxBoostAprForNativeToken);\r\n\r\n  data.totalGmxRewardsUsd = data.stakedGmxTrackerRewardsUsd.add(data.feeGmxTrackerRewardsUsd);\r\n\r\n  data.glpSupply = supplyData.glp;\r\n  data.glpPrice =\r\n    data.glpSupply && data.glpSupply.gt(0)\r\n      ? aum.mul(expandDecimals(1, GLP_DECIMALS)).div(data.glpSupply)\r\n      : bigNumberify(0);\r\n\r\n  data.glpSupplyUsd = supplyData.glp.mul(data.glpPrice).div(expandDecimals(1, 18));\r\n\r\n  data.glpBalance = depositBalanceData.glpInStakedGlp;\r\n  data.glpBalanceUsd = depositBalanceData.glpInStakedGlp.mul(data.glpPrice).div(expandDecimals(1, GLP_DECIMALS));\r\n\r\n  data.stakedGlpTrackerRewards = stakingData.stakedGlpTracker.claimable;\r\n  data.stakedGlpTrackerRewardsUsd = stakingData.stakedGlpTracker.claimable.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.feeGlpTrackerRewards = stakingData.feeGlpTracker.claimable;\r\n  data.feeGlpTrackerRewardsUsd = stakingData.feeGlpTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGlpTrackerAnnualRewardsUsd = stakingData.stakedGlpTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(gmxPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.glpAprForEsGmx =\r\n    data.glpSupplyUsd && data.glpSupplyUsd.gt(0)\r\n      ? data.stakedGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.glpSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.feeGlpTrackerAnnualRewardsUsd = stakingData.feeGlpTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(nativeTokenPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.glpAprForNativeToken =\r\n    data.glpSupplyUsd && data.glpSupplyUsd.gt(0)\r\n      ? data.feeGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.glpSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.glpAprTotal = data.glpAprForNativeToken.add(data.glpAprForEsGmx);\r\n\r\n  data.totalGlpRewardsUsd = data.stakedGlpTrackerRewardsUsd.add(data.feeGlpTrackerRewardsUsd);\r\n\r\n  data.totalEsGmxRewards = data.stakedGmxTrackerRewards.add(data.stakedGlpTrackerRewards);\r\n  data.totalEsGmxRewardsUsd = data.stakedGmxTrackerRewardsUsd.add(data.stakedGlpTrackerRewardsUsd);\r\n\r\n  data.gmxVesterRewards = vestingData.gmxVester.claimable;\r\n  data.glpVesterRewards = vestingData.glpVester.claimable;\r\n  data.totalVesterRewards = data.gmxVesterRewards.add(data.glpVesterRewards);\r\n  data.totalVesterRewardsUsd = data.totalVesterRewards.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.totalNativeTokenRewards = data.feeGmxTrackerRewards.add(data.feeGlpTrackerRewards);\r\n  data.totalNativeTokenRewardsUsd = data.feeGmxTrackerRewardsUsd.add(data.feeGlpTrackerRewardsUsd);\r\n\r\n  data.totalRewardsUsd = data.totalEsGmxRewardsUsd.add(data.totalNativeTokenRewardsUsd).add(data.totalVesterRewardsUsd);\r\n\r\n  return data;\r\n}\r\n\r\nexport async function addTokenToMetamask(token) {\r\n  try {\r\n    const wasAdded = await window.ethereum.request({\r\n      method: \"wallet_watchAsset\",\r\n      params: {\r\n        type: \"ERC20\",\r\n        options: {\r\n          address: token.address,\r\n          symbol: token.symbol,\r\n          decimals: token.decimals,\r\n          image: token.imageUrl,\r\n        },\r\n      },\r\n    });\r\n    if (wasAdded) {\r\n      // https://github.com/MetaMask/metamask-extension/issues/11377\r\n      // We can show a toast message when the token is added to metamask but because of the bug we can't. Once the bug is fixed we can show a toast message.\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\nexport function sleep(ms) {\r\n  return new Promise((resolve) => resolve(), ms);\r\n}\r\n\r\nexport function getPageTitle(data) {\r\n  return `${data} | DeDeLend`;\r\n}\r\n\r\nexport function isHashZero(value) {\r\n  return value === ethers.constants.HashZero;\r\n}\r\nexport function isAddressZero(value) {\r\n  return value === ethers.constants.AddressZero;\r\n}\r\n\r\nexport function useDebounce(value, delay) {\r\n  // State and setters for debounced value\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n  useEffect(\r\n    () => {\r\n      // Update debounced value after delay\r\n      const handler = setTimeout(() => {\r\n        setDebouncedValue(value);\r\n      }, delay);\r\n      // Cancel the timeout if value changes (also on delay change or unmount)\r\n      // This is how we prevent debounced value from updating if value is changed ...\r\n      // .. within the delay period. Timeout gets cleared and restarted.\r\n      return () => {\r\n        clearTimeout(handler);\r\n      };\r\n    },\r\n    [value, delay] // Only re-call effect if value or delay changes\r\n  );\r\n  return debouncedValue;\r\n}\r\n\r\nexport function isDevelopment() {\r\n  return !window.location.host?.includes(\"gmx.io\") && !window.location.host?.includes(\"ipfs.io\");\r\n}\r\n\r\nexport function isLocal() {\r\n  return window.location.host?.includes(\"localhost\");\r\n}\r\n\r\nexport function getHomeUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3010\";\r\n  }\r\n\r\n  return \"https://gmx.io\";\r\n}\r\n\r\nexport function getAppBaseUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3011/#\";\r\n  }\r\n\r\n  return \"https://app.gmx.io/#\";\r\n}\r\n\r\nexport function getRootShareApiUrl() {\r\n  if (isLocal()) {\r\n    return \"https://gmxs.vercel.app\";\r\n  }\r\n\r\n  return \"https://share.gmx.io\";\r\n}\r\n\r\nexport function getTradePageUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3011/#/trade\";\r\n  }\r\n\r\n  return \"https://app.gmx.io/#/trade\";\r\n}\r\n\r\nexport function importImage(name) {\r\n  let tokenImage = null;\r\n  try {\r\n    tokenImage = require(\"../img/\" + name);\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n  return tokenImage && tokenImage.default;\r\n}\r\n\r\nexport function getTwitterIntentURL(text, url = \"\", hashtag = \"\") {\r\n  let finalURL = \"https://twitter.com/intent/tweet?text=\";\r\n  if (text.length > 0) {\r\n    finalURL += encodeURIComponent(text.replace(/[\\r\\n]+/g, \" \"))\r\n      .replace(/\\*%7C/g, \"*|URL:\")\r\n      .replace(/%7C\\*/g, \"|*\");\r\n\r\n    if (hashtag.length > 0) {\r\n      finalURL += \"&hashtags=\" + encodeURIComponent(hashtag.replace(/#/g, \"\"));\r\n    }\r\n    if (url.length > 0) {\r\n      finalURL += \"&url=\" + encodeURIComponent(url);\r\n    }\r\n  }\r\n  return finalURL;\r\n}\r\n\r\nexport function isValidTimestamp(timestamp) {\r\n  return new Date(timestamp).getTime() > 0;\r\n}\r\n\r\nexport function getPositionForOrder(account, order, positionsMap) {\r\n  const key = getPositionKey(account, order.collateralToken, order.indexToken, order.isLong);\r\n  const position = positionsMap[key];\r\n  return position && position.size && position.size.gt(0) ? position : null;\r\n}\r\n\r\nexport function getOrderError(account, order, positionsMap, position) {\r\n  if (order.type !== DECREASE) {\r\n    return;\r\n  }\r\n\r\n  const positionForOrder = position ? position : getPositionForOrder(account, order, positionsMap);\r\n\r\n  if (!positionForOrder) {\r\n    return \"No open position, order cannot be executed unless a position is opened\";\r\n  }\r\n  if (positionForOrder.size.lt(order.sizeDelta)) {\r\n    return \"Order size is bigger than position, will only be executable if position increases\";\r\n  }\r\n\r\n  if (positionForOrder.size.gt(order.sizeDelta)) {\r\n    if (positionForOrder.size.sub(order.sizeDelta).lt(positionForOrder.collateral.sub(order.collateralDelta))) {\r\n      return \"Order cannot be executed as it would reduce the position's leverage below 1\";\r\n    }\r\n    if (positionForOrder.size.sub(order.sizeDelta).lt(expandDecimals(5, USD_DECIMALS))) {\r\n      return \"Order cannot be executed as the remaining position would be smaller than $5.00\";\r\n    }\r\n  }\r\n}\r\n\r\nexport function arrayURLFetcher(...urlArr) {\r\n  const fetcher = (url) => fetch(url).then((res) => res.json());\r\n  return Promise.all(urlArr.map(fetcher));\r\n}\r\n\r\nexport function shouldShowRedirectModal(timestamp) {\r\n  const thirtyDays = 1000 * 60 * 60 * 24 * 30;\r\n  const expiryTime = timestamp + thirtyDays;\r\n  return !isValidTimestamp(timestamp) || Date.now() > expiryTime;\r\n}\r\n","import { ethers } from \"ethers\";\r\n\r\nimport { MAINNET, TESTNET, ARBITRUM_TESTNET, ARBITRUM, AVALANCHE } from \"../lib/legacy\";\r\n\r\nconst { parseEther } = ethers.utils;\r\n\r\nconst constants = {\r\n  [MAINNET]: {\r\n    nativeTokenSymbol: \"BNB\",\r\n    defaultCollateralSymbol: \"BUSD\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 8,\r\n    v2: false,\r\n  },\r\n\r\n  [TESTNET]: {\r\n    nativeTokenSymbol: \"BNB\",\r\n    defaultCollateralSymbol: \"BUSD\",\r\n    defaultFlagOrdersEnabled: true,\r\n    positionReaderPropsLength: 8,\r\n    v2: false,\r\n  },\r\n\r\n  [ARBITRUM_TESTNET]: {\r\n    nativeTokenSymbol: \"ETH\",\r\n    defaultCollateralSymbol: \"USDC\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.000300001\"),\r\n  },\r\n\r\n  [ARBITRUM]: {\r\n    nativeTokenSymbol: \"ETH\",\r\n    wrappedTokenSymbol: \"WETH\",\r\n    defaultCollateralSymbol: \"USDC\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.000300001\"),\r\n  },\r\n\r\n  [AVALANCHE]: {\r\n    nativeTokenSymbol: \"AVAX\",\r\n    wrappedTokenSymbol: \"WAVAX\",\r\n    defaultCollateralSymbol: \"MIM\",\r\n    defaultFlagOrdersEnabled: true,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.01\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.01\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0100001\"),\r\n  },\r\n};\r\n\r\nexport const getConstant = (chainId, key) => {\r\n  if (!constants[chainId]) {\r\n    throw new Error(`Unsupported chainId ${chainId}`);\r\n  }\r\n  if (!(key in constants[chainId])) {\r\n    throw new Error(`Key ${key} does not exist for chainId ${chainId}`);\r\n  }\r\n  return constants[chainId][key];\r\n};\r\n","import { ApolloClient, InMemoryCache } from \"@apollo/client\";\r\n\r\nexport const chainlinkClient = createClient(\"https://api.thegraph.com/subgraphs/name/deividask/chainlink\");\r\nexport const arbitrumGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-stats\");\r\nexport const avalancheGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-avalanche-stats\");\r\nexport const nissohGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/nissoh/gmx-vault\");\r\nexport const arbitrumReferralsGraphClient = createClient(\r\n  \"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-arbitrum-referrals\"\r\n);\r\nexport const avalancheReferralsGraphClient = createClient(\r\n  \"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-avalanche-referrals\"\r\n);\r\n\r\nfunction createClient(uri) {\r\n  return new ApolloClient({\r\n    uri,\r\n    cache: new InMemoryCache(),\r\n  });\r\n}\r\n\r\nexport function get1InchSwapUrl(chainId, from, to) {\r\n  const rootUrl = `https://app.1inch.io/#/${chainId}/unified/swap`;\r\n  if (!from && !to) return rootUrl;\r\n  return `${rootUrl}/${from}/${to}`;\r\n}\r\n","// prettier-ignore\r\nimport {ethers} from \"ethers\";\r\nimport { Web3Provider } from \"@ethersproject/providers\";\r\nimport { getFallbackProvider, getProvider } from \"../legacy\";\r\n\r\nexport const fetcher =\r\n  (library: Web3Provider, contractInfo: any, additionalArgs: any[]) =>\r\n  (...args: any) => {\r\n    // eslint-disable-next-line\r\n    const [id, chainId, arg0, arg1, ...params] = args;\r\n    const provider = getProvider(library, chainId);\r\n\r\n    const method = ethers.utils.isAddress(arg0) ? arg1 : arg0;\r\n\r\n    const contractCall = getContractCall({\r\n      provider,\r\n      contractInfo,\r\n      arg0,\r\n      arg1,\r\n      method,\r\n      params,\r\n      additionalArgs,\r\n    });\r\n\r\n    let shouldCallFallback = true;\r\n\r\n    const handleFallback = async (resolve, reject, error) => {\r\n      if (!shouldCallFallback) {\r\n        return;\r\n      }\r\n      // prevent fallback from being called twice\r\n      shouldCallFallback = false;\r\n\r\n      const fallbackProvider = getFallbackProvider(chainId);\r\n      if (!fallbackProvider) {\r\n        reject(error);\r\n        return;\r\n      }\r\n\r\n      console.info(\"using fallbackProvider for\", method);\r\n      const fallbackContractCall = getContractCall({\r\n        provider: fallbackProvider,\r\n        contractInfo,\r\n        arg0,\r\n        arg1,\r\n        method,\r\n        params,\r\n        additionalArgs,\r\n      });\r\n\r\n      fallbackContractCall\r\n        .then((result) => resolve(result))\r\n        .catch((e) => {\r\n          console.error(\"fallback fetcher error\", id, contractInfo.contractName, method, e);\r\n          reject(e);\r\n        });\r\n    };\r\n\r\n    return new Promise(async (resolve, reject) => {\r\n      contractCall\r\n        .then((result) => {\r\n          shouldCallFallback = false;\r\n          resolve(result);\r\n        })\r\n        .catch((e) => {\r\n          console.error(\"fetcher error\", id, contractInfo.contractName, method, e);\r\n          handleFallback(resolve, reject, e);\r\n        });\r\n\r\n      setTimeout(() => {\r\n        handleFallback(resolve, reject, \"contractCall timeout\");\r\n      }, 2000);\r\n    });\r\n  };\r\n\r\nfunction getContractCall({ provider, contractInfo, arg0, arg1, method, params, additionalArgs }) {\r\n  if (ethers.utils.isAddress(arg0)) {\r\n    const address = arg0;\r\n    const contract = new ethers.Contract(address, contractInfo.abi, provider);\r\n\r\n    if (additionalArgs) {\r\n      return contract[method](...params.concat(additionalArgs));\r\n    }\r\n    return contract[method](...params);\r\n  }\r\n\r\n  if (!provider) {\r\n    return;\r\n  }\r\n\r\n  return provider[method](arg1, ...params);\r\n}\r\n","import { toast, ToastContent, ToastOptions } from \"react-toastify\";\r\n\r\nexport const helperToast = {\r\n  success: (content: ToastContent, opts?: ToastOptions) => {\r\n    toast.dismiss();\r\n    toast.success(content, opts);\r\n  },\r\n  error: (content: ToastContent, opts?: ToastOptions) => {\r\n    toast.dismiss();\r\n    toast.error(content, opts);\r\n  },\r\n};\r\n","import { useState } from \"react\";\r\n\r\nexport function ToastifyDebug(props) {\r\n  const [open, setOpen] = useState(false);\r\n  return (\r\n    <div className=\"Toastify-debug\">\r\n      <span className=\"Toastify-debug-button\" onClick={() => setOpen((old) => !old)}>\r\n        {open ? \"Hide error\" : \"Show error\"}\r\n      </span>\r\n      {open && <div className=\"Toastify-debug-content\">{props.children}</div>}\r\n    </div>\r\n  );\r\n}\r\n","export const NOT_ENOUGH_FUNDS = \"NOT_ENOUGH_FUNDS\";\r\nexport const USER_DENIED = \"USER_DENIED\";\r\nexport const SLIPPAGE = \"SLIPPAGE\";\r\nexport const RPC_ERROR = \"RPC_ERROR\";\r\n\r\ntype ErrorPattern = { msg?: string; code?: number };\r\n\r\nconst TX_ERROR_PATTERNS: { [key: string]: ErrorPattern[] } = {\r\n  [NOT_ENOUGH_FUNDS]: [\r\n    { msg: \"not enough funds for gas\" },\r\n    { msg: \"failed to execute call with revert code InsufficientGasFunds\" },\r\n  ],\r\n  [USER_DENIED]: [{ msg: \"User denied transaction signature\" }],\r\n  [SLIPPAGE]: [{ msg: \"Router: mark price lower than limit\" }, { msg: \"Router: mark price higher than limit\" }],\r\n  [RPC_ERROR]: [\r\n    // @see https://eips.ethereum.org/EIPS/eip-1474#error-codes\r\n    { code: -32005 },\r\n    { msg: \"Non-200 status code\" },\r\n    { msg: \"Request limit exceeded\" },\r\n    { msg: \"Internal JSON-RPC error\" },\r\n    { msg: \"Response has no error or result\" },\r\n    { msg: \"couldn't connect to the network\" },\r\n  ],\r\n};\r\n\r\ntype TxError = {\r\n  message?: string;\r\n  code?: number;\r\n  data?: any;\r\n};\r\n\r\nexport function extractError(ex: TxError) {\r\n  if (!ex) {\r\n    return [];\r\n  }\r\n\r\n  const message = ex.data?.message || ex.message;\r\n  const code = ex.code;\r\n\r\n  if (!message && !code) {\r\n    return [];\r\n  }\r\n\r\n  for (const [type, patterns] of Object.entries(TX_ERROR_PATTERNS)) {\r\n    for (const pattern of patterns) {\r\n      const matchCode = pattern.code && code === pattern.code;\r\n      const matchMessage = pattern.msg && message && message.includes(pattern.msg);\r\n\r\n      if (matchCode || matchMessage) {\r\n        return [message, type, ex.data];\r\n      }\r\n    }\r\n  }\r\n\r\n  return [message, null, ex.data];\r\n}\r\n","import { ARBITRUM, AVALANCHE } from \"../legacy\";\r\n\r\nexport const GAS_PRICE_ADJUSTMENT_MAP = {\r\n  [ARBITRUM]: \"0\",\r\n  [AVALANCHE]: \"3000000000\", // 3 gwei\r\n};\r\n\r\nexport const MAX_GAS_PRICE_MAP = {\r\n  [AVALANCHE]: \"200000000000\", // 200 gwei\r\n};","import { bigNumberify } from \"../legacy\";\r\nimport { GAS_PRICE_ADJUSTMENT_MAP, MAX_GAS_PRICE_MAP } from \"./constants\";\r\nimport { Provider } from \"@ethersproject/providers\";\r\nimport { Contract } from \"ethers\";\r\n\r\nexport async function setGasPrice(txnOpts: any, provider: Provider, chainId: number) {\r\n  let maxGasPrice = MAX_GAS_PRICE_MAP[chainId];\r\n  const premium = GAS_PRICE_ADJUSTMENT_MAP[chainId] || bigNumberify(0);\r\n\r\n  const gasPrice = await provider.getGasPrice();\r\n\r\n  if (maxGasPrice) {\r\n    if (gasPrice.gt(maxGasPrice)) {\r\n      maxGasPrice = gasPrice;\r\n    }\r\n\r\n    const feeData = await provider.getFeeData();\r\n\r\n    // the wallet provider might not return maxPriorityFeePerGas in feeData\r\n    // in which case we should fallback to the usual getGasPrice flow handled below\r\n    if (feeData && feeData.maxPriorityFeePerGas) {\r\n      txnOpts.maxFeePerGas = maxGasPrice;\r\n      txnOpts.maxPriorityFeePerGas = feeData.maxPriorityFeePerGas.add(premium);\r\n      return;\r\n    }\r\n  }\r\n\r\n  txnOpts.gasPrice = gasPrice.add(premium);\r\n  return;\r\n}\r\n\r\nexport async function getGasLimit(contract: Contract, method, params = [], value) {\r\n  const defaultValue = bigNumberify(0);\r\n\r\n  if (!value) {\r\n    value = defaultValue;\r\n  }\r\n  \r\n  let gasLimit = await contract.estimateGas[method](...params, { value });\r\n\r\n  if (gasLimit.lt(22000)) {\r\n    gasLimit = bigNumberify(22000)!;\r\n  }\r\n\r\n  return gasLimit.mul(11000).div(10000); // add a 10% buffer\r\n}\r\n","import { BigNumber, Contract } from \"ethers\";\r\nimport { helperToast } from \"../helperToast\";\r\nimport { ToastifyDebug } from \"../../components/ToastifyDebug/ToastifyDebug\";\r\nimport { extractError, NOT_ENOUGH_FUNDS, RPC_ERROR, SLIPPAGE, USER_DENIED } from \"./transactionErrors\";\r\nimport { getExplorerUrl } from \"../legacy\";\r\nimport { getGasLimit, setGasPrice } from \"./utils\";\r\n\r\nexport async function callContract(\r\n  chainId: number,\r\n  contract: Contract,\r\n  method: string,\r\n  params: any,\r\n  opts: {\r\n    value?: BigNumber | number;\r\n    gasLimit?: BigNumber | number;\r\n    sentMsg?: string;\r\n    successMsg?: string;\r\n    hideSuccessMsg?: boolean;\r\n    failMsg?: string;\r\n    setPendingTxns?: (txns: any) => void;\r\n  }\r\n) {\r\n  try {\r\n    if (!Array.isArray(params) && typeof params === \"object\" && opts === undefined) {\r\n      opts = params;\r\n      params = [];\r\n    }\r\n    \r\n    if (!opts) {\r\n      opts = {};\r\n    }\r\n    \r\n    const txnOpts: any = {};\r\n    \r\n    if (opts.value) {\r\n      txnOpts.value = opts.value;\r\n    }\r\n    \r\n    txnOpts.gasLimit = opts.gasLimit ? opts.gasLimit : await getGasLimit(contract, method, params, opts.value);\r\n    \r\n    await setGasPrice(txnOpts, contract.provider, chainId);\r\n\r\n    const res = await contract[method](...params, txnOpts);\r\n    \r\n    const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\r\n    const sentMsg = opts.sentMsg || \"Transaction sent.\";\r\n\r\n    helperToast.success(\r\n      <div>\r\n        {sentMsg}{\" \"}\r\n        <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n          View status.\r\n        </a>\r\n        <br />\r\n      </div>\r\n    );\r\n\r\n    if (opts.setPendingTxns) {\r\n      const message = opts.hideSuccessMsg ? undefined : opts.successMsg || \"Transaction completed!\";\r\n      const pendingTxn = {\r\n        hash: res.hash,\r\n        message,\r\n      };\r\n      opts.setPendingTxns((pendingTxns) => [...pendingTxns, pendingTxn]);\r\n    }\r\n    return res;\r\n  } catch (e) {\r\n    let failMsg;\r\n\r\n    let autoCloseToast: number | boolean = 5000;\r\n\r\n    const [message, type, errorData] = extractError(e);\r\n    switch (type) {\r\n      case NOT_ENOUGH_FUNDS:\r\n        failMsg = (\r\n          <div>\r\n            There is not enough ETH in your account on Arbitrum to send this transaction.\r\n            <br />\r\n            <br />\r\n            <a href={\"https://arbitrum.io/bridge-tutorial/\"} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              Bridge ETH to Arbitrum\r\n            </a>\r\n          </div>\r\n        );\r\n        break;\r\n      case USER_DENIED:\r\n        failMsg = \"Transaction was cancelled.\";\r\n        break;\r\n      case SLIPPAGE:\r\n        failMsg =\r\n          'The mark price has changed, consider increasing your Allowed Slippage by clicking on the \"...\" icon next to your address.';\r\n        break;\r\n      case RPC_ERROR:\r\n        autoCloseToast = false;\r\n\r\n        const originalError = errorData?.error?.message || errorData?.message || message;\r\n\r\n        failMsg = (\r\n          <div>\r\n            Transaction failed due to RPC error.\r\n            <br />\r\n            <br />\r\n            Please try changing the RPC url in your wallet settings.{\" \"}\r\n            <a href=\"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n              More info\r\n            </a>\r\n            <br />\r\n            {originalError && <ToastifyDebug>{originalError}</ToastifyDebug>}\r\n          </div>\r\n        );\r\n        break;\r\n      default:\r\n        autoCloseToast = false;\r\n\r\n        failMsg = (\r\n          <div>\r\n            {opts.failMsg || \"Transaction failed\"}\r\n            <br />\r\n            {message && <ToastifyDebug>{message}</ToastifyDebug>}\r\n          </div>\r\n        );\r\n    }\r\n\r\n    helperToast.error(failMsg, { autoClose: autoCloseToast });\r\n    throw e;\r\n  }\r\n}\r\n","import { useMemo } from \"react\";\r\nimport { gql } from \"@apollo/client\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport { USD_DECIMALS, CHART_PERIODS, formatAmount, sleep } from \"../lib/legacy\";\r\nimport { chainlinkClient } from \"./common\";\r\n\r\nconst BigNumber = ethers.BigNumber;\r\n\r\n// Ethereum network, Chainlink Aggregator contracts\r\nconst FEED_ID_MAP = {\r\n  BTC_USD: \"0xae74faa92cb67a95ebcab07358bc222e33a34da7\",\r\n  ETH_USD: \"0x37bc7498f4ff12c19678ee8fe19d713b87f6a9e6\",\r\n  BNB_USD: \"0xc45ebd0f901ba6b2b8c7e70b717778f055ef5e6d\",\r\n  LINK_USD: \"0xdfd03bfc3465107ce570a0397b247f546a42d0fa\",\r\n  UNI_USD: \"0x68577f915131087199fe48913d8b416b3984fd38\",\r\n  SUSHI_USD: \"0x7213536a36094cd8a768a5e45203ec286cba2d74\",\r\n  AVAX_USD: \"0x0fc3657899693648bba4dbd2d8b33b82e875105d\",\r\n  AAVE_USD: \"0xe3f0dede4b499c07e12475087ab1a084b5f93bc0\",\r\n  YFI_USD: \"0x8a4d74003870064d41d4f84940550911fbfccf04\",\r\n  SPELL_USD: \"0x8640b23468815902e011948f3ab173e1e83f9879\",\r\n};\r\nconst timezoneOffset = -new Date().getTimezoneOffset() * 60;\r\n\r\nfunction fillGaps(prices, periodSeconds) {\r\n  if (prices.length < 2) {\r\n    return prices;\r\n  }\r\n\r\n  const newPrices = [prices[0]];\r\n  let prevTime = prices[0].time;\r\n  for (let i = 1; i < prices.length; i++) {\r\n    const { time, open } = prices[i];\r\n    if (prevTime) {\r\n      let j = (time - prevTime) / periodSeconds - 1;\r\n      while (j > 0) {\r\n        newPrices.push({\r\n          time: time - j * periodSeconds,\r\n          open,\r\n          close: open,\r\n          high: open * 1.0003,\r\n          low: open * 0.9996,\r\n        });\r\n        j--;\r\n      }\r\n    }\r\n\r\n    prevTime = time;\r\n    newPrices.push(prices[i]);\r\n  }\r\n\r\n  return newPrices;\r\n}\r\n\r\nasync function getChartPricesFromStats(chainId, symbol, period) {\r\n  if ([\"WBTC\", \"WETH\", \"WAVAX\"].includes(symbol)) {\r\n    symbol = symbol.substr(1);\r\n  } else if (symbol === \"BTC.b\") {\r\n    symbol = \"BTC\";\r\n  }\r\n  const hostname = \"https://stats.gmx.io/\";\r\n  // const hostname = 'http://localhost:3113/'\r\n  const timeDiff = CHART_PERIODS[period] * 3000;\r\n  const from = Math.floor(Date.now() / 1000 - timeDiff);\r\n  const url = `${hostname}api/candles/${symbol}?preferableChainId=${chainId}&period=${period}&from=${from}&preferableSource=fast`;\r\n  const TIMEOUT = 5000;\r\n  const res = await new Promise(async (resolve, reject) => {\r\n    let done = false;\r\n    setTimeout(() => {\r\n      done = true;\r\n      reject(new Error(`request timeout ${url}`));\r\n    }, TIMEOUT);\r\n\r\n    let lastEx;\r\n    for (let i = 0; i < 3; i++) {\r\n      if (done) return;\r\n      try {\r\n        const res = await fetch(url);\r\n        resolve(res);\r\n        return;\r\n      } catch (ex) {\r\n        await sleep(300);\r\n        lastEx = ex;\r\n      }\r\n    }\r\n    reject(lastEx);\r\n  });\r\n  if (!res.ok) {\r\n    throw new Error(`request failed ${res.status} ${res.statusText}`);\r\n  }\r\n  const json = await res.json();\r\n  let prices = json?.prices;\r\n  if (!prices || prices.length < 10) {\r\n    throw new Error(`not enough prices data: ${prices?.length}`);\r\n  }\r\n\r\n  const OBSOLETE_THRESHOLD = Date.now() / 1000 - 60 * 30; // 30 min ago\r\n  const updatedAt = json?.updatedAt || 0;\r\n  if (updatedAt < OBSOLETE_THRESHOLD) {\r\n    throw new Error(\r\n      \"chart data is obsolete, last price record at \" +\r\n        new Date(updatedAt * 1000).toISOString() +\r\n        \" now: \" +\r\n        new Date().toISOString()\r\n    );\r\n  }\r\n\r\n  prices = prices.map(({ t, o: open, c: close, h: high, l: low }) => ({\r\n    time: t + timezoneOffset,\r\n    open,\r\n    close,\r\n    high,\r\n    low,\r\n  }));\r\n  return prices;\r\n}\r\n\r\nfunction getCandlesFromPrices(prices, period) {\r\n  const periodTime = CHART_PERIODS[period];\r\n\r\n  if (prices.length < 2) {\r\n    return [];\r\n  }\r\n\r\n  const candles = [];\r\n  const first = prices[0];\r\n  let prevTsGroup = Math.floor(first[0] / periodTime) * periodTime;\r\n  let prevPrice = first[1];\r\n  let o = prevPrice;\r\n  let h = prevPrice;\r\n  let l = prevPrice;\r\n  let c = prevPrice;\r\n  for (let i = 1; i < prices.length; i++) {\r\n    const [ts, price] = prices[i];\r\n    const tsGroup = Math.floor(ts / periodTime) * periodTime;\r\n    if (prevTsGroup !== tsGroup) {\r\n      candles.push({ t: prevTsGroup + timezoneOffset, o, h, l, c });\r\n      o = c;\r\n      h = Math.max(o, c);\r\n      l = Math.min(o, c);\r\n    }\r\n    c = price;\r\n    h = Math.max(h, price);\r\n    l = Math.min(l, price);\r\n    prevTsGroup = tsGroup;\r\n  }\r\n\r\n  return candles.map(({ t: time, o: open, c: close, h: high, l: low }) => ({\r\n    time,\r\n    open,\r\n    close,\r\n    high,\r\n    low,\r\n  }));\r\n}\r\n\r\nfunction getChainlinkChartPricesFromGraph(tokenSymbol, period) {\r\n  if ([\"WBTC\", \"WETH\", \"WAVAX\"].includes(tokenSymbol)) {\r\n    tokenSymbol = tokenSymbol.substr(1);\r\n  }\r\n  const marketName = tokenSymbol + \"_USD\";\r\n  const feedId = FEED_ID_MAP[marketName];\r\n  if (!feedId) {\r\n    throw new Error(`undefined marketName ${marketName}`);\r\n  }\r\n\r\n  const PER_CHUNK = 1000;\r\n  const CHUNKS_TOTAL = 6;\r\n  const requests = [];\r\n  for (let i = 0; i < CHUNKS_TOTAL; i++) {\r\n    const query = gql(`{\r\n      rounds(\r\n        first: ${PER_CHUNK},\r\n        skip: ${i * PER_CHUNK},\r\n        orderBy: unixTimestamp,\r\n        orderDirection: desc,\r\n        where: {feed: \"${feedId}\"}\r\n      ) {\r\n        unixTimestamp,\r\n        value\r\n      }\r\n    }`);\r\n    requests.push(chainlinkClient.query({ query }));\r\n  }\r\n\r\n  return Promise.all(requests)\r\n    .then((chunks) => {\r\n      let prices = [];\r\n      const uniqTs = new Set();\r\n      chunks.forEach((chunk) => {\r\n        chunk.data.rounds.forEach((item) => {\r\n          if (uniqTs.has(item.unixTimestamp)) {\r\n            return;\r\n          }\r\n\r\n          uniqTs.add(item.unixTimestamp);\r\n          prices.push([item.unixTimestamp, Number(item.value) / 1e8]);\r\n        });\r\n      });\r\n\r\n      prices.sort(([timeA], [timeB]) => timeA - timeB);\r\n      prices = getCandlesFromPrices(prices, period);\r\n      return prices;\r\n    })\r\n    .catch((err) => {\r\n      console.error(err);\r\n    });\r\n}\r\n\r\nexport function useChartPrices(chainId, symbol, isStable, period, currentAveragePrice) {\r\n  const swrKey = !isStable && symbol ? [\"getChartCandles\", chainId, symbol, period] : null;\r\n  let { data: prices, mutate: updatePrices } = useSWR(swrKey, {\r\n    fetcher: async (...args) => {\r\n      try {\r\n        return await getChartPricesFromStats(chainId, symbol, period);\r\n      } catch (ex) {\r\n        console.warn(ex);\r\n        console.warn(\"Switching to graph chainlink data\");\r\n        try {\r\n          return await getChainlinkChartPricesFromGraph(symbol, period);\r\n        } catch (ex2) {\r\n          console.warn(\"getChainlinkChartPricesFromGraph failed\");\r\n          console.warn(ex2);\r\n          return [];\r\n        }\r\n      }\r\n    },\r\n    dedupingInterval: 60000,\r\n    focusThrottleInterval: 60000 * 10,\r\n  });\r\n\r\n  const currentAveragePriceString = currentAveragePrice && currentAveragePrice.toString();\r\n  const retPrices = useMemo(() => {\r\n    if (isStable) {\r\n      return getStablePriceData(period);\r\n    }\r\n\r\n    if (!prices) {\r\n      return [];\r\n    }\r\n\r\n    let _prices = [...prices];\r\n    if (currentAveragePriceString && prices.length) {\r\n      _prices = appendCurrentAveragePrice(_prices, BigNumber.from(currentAveragePriceString), period);\r\n    }\r\n\r\n    return fillGaps(_prices, CHART_PERIODS[period]);\r\n  }, [prices, isStable, currentAveragePriceString, period]);\r\n\r\n  return [retPrices, updatePrices];\r\n}\r\n\r\nfunction appendCurrentAveragePrice(prices, currentAveragePrice, period) {\r\n  const periodSeconds = CHART_PERIODS[period];\r\n  const currentCandleTime = Math.floor(Date.now() / 1000 / periodSeconds) * periodSeconds + timezoneOffset;\r\n  const last = prices[prices.length - 1];\r\n  const averagePriceValue = parseFloat(formatAmount(currentAveragePrice, USD_DECIMALS, 2));\r\n  if (currentCandleTime === last.time) {\r\n    last.close = averagePriceValue;\r\n    last.high = Math.max(last.high, averagePriceValue);\r\n    last.low = Math.max(last.low, averagePriceValue);\r\n    return prices;\r\n  } else {\r\n    const newCandle = {\r\n      time: currentCandleTime,\r\n      open: last.close,\r\n      close: averagePriceValue,\r\n      high: averagePriceValue,\r\n      low: averagePriceValue,\r\n    };\r\n    return [...prices, newCandle];\r\n  }\r\n}\r\n\r\nfunction getStablePriceData(period) {\r\n  const periodSeconds = CHART_PERIODS[period];\r\n  const now = Math.floor(Date.now() / 1000 / periodSeconds) * periodSeconds;\r\n  let priceData = [];\r\n  for (let i = 100; i > 0; i--) {\r\n    priceData.push({\r\n      time: now - i * periodSeconds,\r\n      open: 1,\r\n      close: 1,\r\n      high: 1,\r\n      low: 1,\r\n    });\r\n  }\r\n  return priceData;\r\n}\r\n","import { ethers } from \"ethers\";\r\nimport { gql } from \"@apollo/client\";\r\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Token as UniToken } from \"@uniswap/sdk-core\";\r\nimport { Pool } from \"@uniswap/v3-sdk\";\r\nimport useSWR from \"swr\";\r\n\r\nimport OrderBook from \"../abis/OrderBook.json\";\r\nimport PositionManager from \"../abis/PositionManager.json\";\r\nimport Vault from \"../abis/Vault.json\";\r\nimport Router from \"../abis/Router.json\";\r\nimport UniPool from \"../abis/UniPool.json\";\r\nimport UniswapV2 from \"../abis/UniswapV2.json\";\r\nimport Token from \"../abis/Token.json\";\r\nimport VaultReader from \"../abis/VaultReader.json\";\r\nimport PositionRouter from \"../abis/PositionRouter.json\";\r\n\r\nimport { getContract } from \"../config/Addresses\";\r\nimport { getConstant } from \"../config/chains\";\r\nimport {\r\n  ARBITRUM,\r\n  ARBITRUM_TESTNET,\r\n  AVALANCHE,\r\n  bigNumberify,\r\n  DECREASE,\r\n  expandDecimals,\r\n  getHighExecutionFee,\r\n  getInfoTokens,\r\n  getOrderKey,\r\n  getProvider,\r\n  getServerBaseUrl,\r\n  getServerUrl,\r\n  getUsd,\r\n  INCREASE,\r\n  parseValue,\r\n  replaceNativeTokenAddress,\r\n  SWAP,\r\n  UI_VERSION,\r\n  USD_DECIMALS,\r\n} from \"../lib/legacy\";\r\nimport { getTokenBySymbol, getTokens, getWhitelistedTokens } from \"../config/Tokens\";\r\n\r\nimport { arbitrumGraphClient, avalancheGraphClient, nissohGraphClient } from \"./common\";\r\nimport { groupBy } from \"lodash\";\r\nimport { fetcher } from \"../lib/contracts/fetcher\";\r\nimport { callContract } from \"../lib/contracts/callContract\";\r\n\r\nexport * from \"./prices\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getGmxGraphClient(chainId) {\r\n  if (chainId === ARBITRUM) {\r\n    return arbitrumGraphClient;\r\n  } else if (chainId === AVALANCHE) {\r\n    return avalancheGraphClient;\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return null;\r\n  }\r\n  throw new Error(`Unsupported chain ${chainId}`);\r\n}\r\n\r\nexport function useAllOrdersStats(chainId) {\r\n  const query = gql(`{\r\n    orderStat(id: \"total\") {\r\n      openSwap\r\n      openIncrease\r\n      openDecrease\r\n      executedSwap\r\n      executedIncrease\r\n      executedDecrease\r\n      cancelledSwap\r\n      cancelledIncrease\r\n      cancelledDecrease\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    const graphClient = getGmxGraphClient(chainId);\r\n    if (graphClient) {\r\n      graphClient.query({ query }).then(setRes).catch(console.warn);\r\n    }\r\n  }, [setRes, query, chainId]);\r\n\r\n  return res ? res.data.orderStat : null;\r\n}\r\n\r\nexport function useInfoTokens(library, chainId, active, tokenBalances, fundingRateInfo, vaultPropsLength) {\r\n  const tokens = getTokens(chainId);\r\n  const vaultReaderAddress = getContract(chainId, \"VaultReader\");\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const whitelistedTokenAddresses = whitelistedTokens.map((token) => token.address);\r\n\r\n  const { data: vaultTokenInfo } = useSWR(\r\n    [`useInfoTokens:${active}`, chainId, vaultReaderAddress, \"getVaultTokenInfoV4\"],\r\n    {\r\n      fetcher: fetcher(library, VaultReader, [\r\n        vaultAddress,\r\n        positionRouterAddress,\r\n        nativeTokenAddress,\r\n        expandDecimals(1, 18),\r\n        whitelistedTokenAddresses,\r\n      ]),\r\n    }\r\n  );\r\n\r\n  const indexPricesUrl = getServerUrl(chainId, \"/prices\");\r\n  const { data: indexPrices } = useSWR([indexPricesUrl], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.json()),\r\n    refreshInterval: 500,\r\n    refreshWhenHidden: true,\r\n  });\r\n\r\n  return {\r\n    infoTokens: getInfoTokens(\r\n      tokens,\r\n      tokenBalances,\r\n      whitelistedTokens,\r\n      vaultTokenInfo,\r\n      fundingRateInfo,\r\n      vaultPropsLength,\r\n      indexPrices,\r\n      nativeTokenAddress\r\n    ),\r\n  };\r\n}\r\n\r\nexport function useUserStat(chainId) {\r\n  const query = gql(`{\r\n    userStat(id: \"total\") {\r\n      id\r\n      uniqueCount\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    getGmxGraphClient(chainId).query({ query }).then(setRes).catch(console.warn);\r\n  }, [setRes, query, chainId]);\r\n\r\n  return res ? res.data.userStat : null;\r\n}\r\n\r\nexport function useLiquidationsData(chainId, account) {\r\n  const [data, setData] = useState(null);\r\n  useEffect(() => {\r\n    if (account) {\r\n      const query = gql(`{\r\n         liquidatedPositions(\r\n           where: {account: \"${account.toLowerCase()}\"}\r\n           first: 100\r\n           orderBy: timestamp\r\n           orderDirection: desc\r\n         ) {\r\n           key\r\n           timestamp\r\n           borrowFee\r\n           loss\r\n           collateral\r\n           size\r\n           markPrice\r\n           type\r\n         }\r\n      }`);\r\n      const graphClient = getGmxGraphClient(chainId);\r\n      if (!graphClient) {\r\n        return;\r\n      }\r\n\r\n      graphClient\r\n        .query({ query })\r\n        .then((res) => {\r\n          const _data = res.data.liquidatedPositions.map((item) => {\r\n            return {\r\n              ...item,\r\n              size: bigNumberify(item.size),\r\n              collateral: bigNumberify(item.collateral),\r\n              markPrice: bigNumberify(item.markPrice),\r\n            };\r\n          });\r\n          setData(_data);\r\n        })\r\n        .catch(console.warn);\r\n    }\r\n  }, [setData, chainId, account]);\r\n\r\n  return data;\r\n}\r\n\r\nexport function useAllPositions(chainId, library) {\r\n  const count = 1000;\r\n  const query = gql(`{\r\n    aggregatedTradeOpens(\r\n      first: ${count}\r\n    ) {\r\n      account\r\n      initialPosition{\r\n        indexToken\r\n        collateralToken\r\n        isLong\r\n        sizeDelta\r\n      }\r\n      increaseList {\r\n        sizeDelta\r\n      }\r\n      decreaseList {\r\n        sizeDelta\r\n      }\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    nissohGraphClient.query({ query }).then(setRes).catch(console.warn);\r\n  }, [setRes, query]);\r\n\r\n  const key = res ? `allPositions${count}__` : false;\r\n  const { data: positions = [] } = useSWR(key, async () => {\r\n    const provider = getProvider(library, chainId);\r\n    const vaultAddress = getContract(chainId, \"Vault\");\r\n    const contract = new ethers.Contract(vaultAddress, Vault.abi, provider);\r\n    const ret = await Promise.all(\r\n      res.data.aggregatedTradeOpens.map(async (dataItem) => {\r\n        try {\r\n          const { indexToken, collateralToken, isLong } = dataItem.initialPosition;\r\n          const positionData = await contract.getPosition(dataItem.account, collateralToken, indexToken, isLong);\r\n          const position = {\r\n            size: bigNumberify(positionData[0]),\r\n            collateral: bigNumberify(positionData[1]),\r\n            entryFundingRate: bigNumberify(positionData[3]),\r\n            account: dataItem.account,\r\n          };\r\n          position.fundingFee = await contract.getFundingFee(collateralToken, position.size, position.entryFundingRate);\r\n          position.marginFee = position.size.div(1000);\r\n          position.fee = position.fundingFee.add(position.marginFee);\r\n\r\n          const THRESHOLD = 5000;\r\n          const collateralDiffPercent = position.fee.mul(10000).div(position.collateral);\r\n          position.danger = collateralDiffPercent.gt(THRESHOLD);\r\n\r\n          return position;\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n\r\n    return ret.filter(Boolean);\r\n  });\r\n\r\n  return positions;\r\n}\r\n\r\nexport function useAllOrders(chainId, library) {\r\n  const query = gql(`{\r\n    orders(\r\n      first: 1000,\r\n      orderBy: createdTimestamp,\r\n      orderDirection: desc,\r\n      where: {status: \"open\"}\r\n    ) {\r\n      type\r\n      account\r\n      index\r\n      status\r\n      createdTimestamp\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    getGmxGraphClient(chainId).query({ query }).then(setRes);\r\n  }, [setRes, query, chainId]);\r\n\r\n  const key = res ? res.data.orders.map((order) => `${order.type}-${order.account}-${order.index}`) : null;\r\n  const { data: orders = [] } = useSWR(key, () => {\r\n    const provider = getProvider(library, chainId);\r\n    const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n    const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\r\n    return Promise.all(\r\n      res.data.orders.map(async (order) => {\r\n        try {\r\n          const type = order.type.charAt(0).toUpperCase() + order.type.substring(1);\r\n          const method = `get${type}Order`;\r\n          const orderFromChain = await contract[method](order.account, order.index);\r\n          const ret = {};\r\n          for (const [key, val] of Object.entries(orderFromChain)) {\r\n            ret[key] = val;\r\n          }\r\n          if (order.type === \"swap\") {\r\n            ret.path = [ret.path0, ret.path1, ret.path2].filter((address) => address !== AddressZero);\r\n          }\r\n          ret.type = type;\r\n          ret.index = order.index;\r\n          ret.account = order.account;\r\n          ret.createdTimestamp = order.createdTimestamp;\r\n          return ret;\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n  });\r\n\r\n  return orders.filter(Boolean);\r\n}\r\n\r\nexport function usePositionsForOrders(chainId, library, orders) {\r\n  const key = orders ? orders.map((order) => getOrderKey(order) + \"____\") : null;\r\n  const { data: positions = {} } = useSWR(key, async () => {\r\n    const provider = getProvider(library, chainId);\r\n    const vaultAddress = getContract(chainId, \"Vault\");\r\n    const contract = new ethers.Contract(vaultAddress, Vault.abi, provider);\r\n    const data = await Promise.all(\r\n      orders.map(async (order) => {\r\n        try {\r\n          const position = await contract.getPosition(\r\n            order.account,\r\n            order.collateralToken,\r\n            order.indexToken,\r\n            order.isLong\r\n          );\r\n          if (position[0].eq(0)) {\r\n            return [null, order];\r\n          }\r\n          return [position, order];\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n    return data.reduce((memo, [position, order]) => {\r\n      memo[getOrderKey(order)] = position;\r\n      return memo;\r\n    }, {});\r\n  });\r\n\r\n  return positions;\r\n}\r\n\r\nfunction invariant(condition, errorMsg) {\r\n  if (!condition) {\r\n    throw new Error(errorMsg);\r\n  }\r\n}\r\n\r\nexport function useTrades(chainId, account, forSingleAccount, afterId) {\r\n  let url =\r\n    account && account.length > 0\r\n      ? `${getServerBaseUrl(chainId)}/actions?account=${account}`\r\n      : !forSingleAccount && `${getServerBaseUrl(chainId)}/actions`;\r\n\r\n  if (afterId && afterId.length > 0) {\r\n    const urlItem = new URL(url);\r\n    urlItem.searchParams.append(\"after\", afterId);\r\n    url = urlItem.toString();\r\n  }\r\n\r\n  const { data: trades, mutate: updateTrades } = useSWR(url && url, {\r\n    dedupingInterval: 10000,\r\n    fetcher: (...args) => fetch(...args).then((res) => res.json()),\r\n  });\r\n\r\n  if (trades) {\r\n    trades.sort((item0, item1) => {\r\n      const data0 = item0.data;\r\n      const data1 = item1.data;\r\n      const time0 = parseInt(data0.timestamp);\r\n      const time1 = parseInt(data1.timestamp);\r\n      if (time1 > time0) {\r\n        return 1;\r\n      }\r\n      if (time1 < time0) {\r\n        return -1;\r\n      }\r\n\r\n      const block0 = parseInt(data0.blockNumber);\r\n      const block1 = parseInt(data1.blockNumber);\r\n\r\n      if (isNaN(block0) && isNaN(block1)) {\r\n        return 0;\r\n      }\r\n\r\n      if (isNaN(block0)) {\r\n        return 1;\r\n      }\r\n\r\n      if (isNaN(block1)) {\r\n        return -1;\r\n      }\r\n\r\n      if (block1 > block0) {\r\n        return 1;\r\n      }\r\n\r\n      if (block1 < block0) {\r\n        return -1;\r\n      }\r\n\r\n      return 0;\r\n    });\r\n  }\r\n\r\n  return { trades, updateTrades };\r\n}\r\n\r\nexport function useMinExecutionFee(library, active, chainId, infoTokens) {\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const { data: minExecutionFee } = useSWR([active, chainId, positionRouterAddress, \"minExecutionFee\"], {\r\n    fetcher: fetcher(library, PositionRouter),\r\n  });\r\n\r\n  const { data: gasPrice } = useSWR([\"gasPrice\", chainId], {\r\n    fetcher: () => {\r\n      return new Promise(async (resolve, reject) => {\r\n        const provider = getProvider(library, chainId);\r\n        if (!provider) {\r\n          resolve(undefined);\r\n          return;\r\n        }\r\n\r\n        try {\r\n          const gasPrice = await provider.getGasPrice();\r\n          resolve(gasPrice);\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      });\r\n    },\r\n  });\r\n\r\n  let multiplier;\r\n\r\n  // if gas prices on Arbitrum are high, the main transaction costs would come from the L2 gas usage\r\n  // for executing positions this is around 65,000 gas\r\n  // if gas prices on Ethereum are high, than the gas usage might be higher, this calculation doesn't deal with that\r\n  // case yet\r\n  if (chainId === ARBITRUM || chainId === ARBITRUM_TESTNET) {\r\n    multiplier = 65000;\r\n  }\r\n\r\n  // multiplier for Avalanche is just the average gas usage\r\n  if (chainId === AVALANCHE) {\r\n    multiplier = 700000;\r\n  }\r\n\r\n  let finalExecutionFee = minExecutionFee;\r\n\r\n  if (gasPrice && minExecutionFee) {\r\n    const estimatedExecutionFee = gasPrice.mul(multiplier);\r\n    if (estimatedExecutionFee.gt(minExecutionFee)) {\r\n      finalExecutionFee = estimatedExecutionFee;\r\n    }\r\n  }\r\n\r\n  const finalExecutionFeeUSD = getUsd(finalExecutionFee, nativeTokenAddress, false, infoTokens);\r\n  const isFeeHigh = finalExecutionFeeUSD?.gt(expandDecimals(getHighExecutionFee(chainId), USD_DECIMALS));\r\n  const errorMessage =\r\n    isFeeHigh &&\r\n    `The network cost to send transactions is high at the moment, please check the \"Execution Fee\" value before proceeding.`;\r\n\r\n  return {\r\n    minExecutionFee: finalExecutionFee,\r\n    minExecutionFeeUSD: finalExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage: errorMessage,\r\n  };\r\n}\r\n\r\nexport function useStakedGmxSupply(library, active) {\r\n  const gmxAddressArb = getContract(ARBITRUM, \"GMX\");\r\n  const stakedGmxTrackerAddressArb = getContract(ARBITRUM, \"StakedGmxTracker\");\r\n\r\n  const { data: arbData, mutate: arbMutate } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, ARBITRUM, gmxAddressArb, \"balanceOf\", stakedGmxTrackerAddressArb],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  const gmxAddressAvax = getContract(AVALANCHE, \"GMX\");\r\n  const stakedGmxTrackerAddressAvax = getContract(AVALANCHE, \"StakedGmxTracker\");\r\n\r\n  const { data: avaxData, mutate: avaxMutate } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, AVALANCHE, gmxAddressAvax, \"balanceOf\", stakedGmxTrackerAddressAvax],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n\r\n  let data;\r\n  if (arbData && avaxData) {\r\n    data = arbData.add(avaxData);\r\n  }\r\n\r\n  const mutate = () => {\r\n    arbMutate();\r\n    avaxMutate();\r\n  };\r\n\r\n  return { data, mutate };\r\n}\r\n\r\nexport function useHasOutdatedUi() {\r\n  const url = getServerUrl(ARBITRUM, \"/ui_version\");\r\n  const { data, mutate } = useSWR([url], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  let hasOutdatedUi = false;\r\n\r\n  if (data && parseFloat(data) > parseFloat(UI_VERSION)) {\r\n    // hasOutdatedUi = true;\r\n    hasOutdatedUi = false;\r\n  }\r\n\r\n  return { data: hasOutdatedUi, mutate };\r\n}\r\n\r\nexport function useGmxPrice(chainId, libraries, active) {\r\n  const arbitrumLibrary = libraries && libraries.arbitrum ? libraries.arbitrum : undefined;\r\n  const { data: gmxPriceFromArbitrum, mutate: mutateFromArbitrum } = useGmxPriceFromArbitrum(arbitrumLibrary, active);\r\n  const { data: gmxPriceFromAvalanche, mutate: mutateFromAvalanche } = useGmxPriceFromAvalanche();\r\n\r\n  const gmxPrice = chainId === ARBITRUM ? gmxPriceFromArbitrum : gmxPriceFromAvalanche;\r\n  const mutate = useCallback(() => {\r\n    mutateFromAvalanche();\r\n    mutateFromArbitrum();\r\n  }, [mutateFromAvalanche, mutateFromArbitrum]);\r\n\r\n  return {\r\n    gmxPrice,\r\n    gmxPriceFromArbitrum,\r\n    gmxPriceFromAvalanche,\r\n    mutate,\r\n  };\r\n}\r\n\r\n// use only the supply endpoint on arbitrum, it includes the supply on avalanche\r\nexport function useTotalGmxSupply() {\r\n  const gmxSupplyUrlArbitrum = getServerUrl(ARBITRUM, \"/gmx_supply\");\r\n\r\n  const { data: gmxSupply, mutate: updateGmxSupply } = useSWR([gmxSupplyUrlArbitrum], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  return {\r\n    total: gmxSupply ? bigNumberify(gmxSupply) : undefined,\r\n    mutate: updateGmxSupply,\r\n  };\r\n}\r\n\r\nexport function useTotalGmxStaked() {\r\n  const stakedGmxTrackerAddressArbitrum = getContract(ARBITRUM, \"StakedGmxTracker\");\r\n  const stakedGmxTrackerAddressAvax = getContract(AVALANCHE, \"StakedGmxTracker\");\r\n  let totalStakedGmx = useRef(bigNumberify(0));\r\n  const { data: stakedGmxSupplyArbitrum, mutate: updateStakedGmxSupplyArbitrum } = useSWR(\r\n    [\r\n      `StakeV2:stakedGmxSupply:${ARBITRUM}`,\r\n      ARBITRUM,\r\n      getContract(ARBITRUM, \"GMX\"),\r\n      \"balanceOf\",\r\n      stakedGmxTrackerAddressArbitrum,\r\n    ],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const { data: stakedGmxSupplyAvax, mutate: updateStakedGmxSupplyAvax } = useSWR(\r\n    [\r\n      `StakeV2:stakedGmxSupply:${AVALANCHE}`,\r\n      AVALANCHE,\r\n      getContract(AVALANCHE, \"GMX\"),\r\n      \"balanceOf\",\r\n      stakedGmxTrackerAddressAvax,\r\n    ],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n\r\n  const mutate = useCallback(() => {\r\n    updateStakedGmxSupplyArbitrum();\r\n    updateStakedGmxSupplyAvax();\r\n  }, [updateStakedGmxSupplyArbitrum, updateStakedGmxSupplyAvax]);\r\n\r\n  if (stakedGmxSupplyArbitrum && stakedGmxSupplyAvax) {\r\n    let total = bigNumberify(stakedGmxSupplyArbitrum).add(stakedGmxSupplyAvax);\r\n    totalStakedGmx.current = total;\r\n  }\r\n\r\n  return {\r\n    avax: stakedGmxSupplyAvax,\r\n    arbitrum: stakedGmxSupplyArbitrum,\r\n    total: totalStakedGmx.current,\r\n    mutate,\r\n  };\r\n}\r\n\r\nexport function useTotalGmxInLiquidity() {\r\n  let poolAddressArbitrum = getContract(ARBITRUM, \"UniswapGmxEthPool\");\r\n  let poolAddressAvax = getContract(AVALANCHE, \"TraderJoeGmxAvaxPool\");\r\n  let totalGMX = useRef(bigNumberify(0));\r\n\r\n  const { data: gmxInLiquidityOnArbitrum, mutate: mutateGMXInLiquidityOnArbitrum } = useSWR(\r\n    [`StakeV2:gmxInLiquidity:${ARBITRUM}`, ARBITRUM, getContract(ARBITRUM, \"GMX\"), \"balanceOf\", poolAddressArbitrum],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const { data: gmxInLiquidityOnAvax, mutate: mutateGMXInLiquidityOnAvax } = useSWR(\r\n    [`StakeV2:gmxInLiquidity:${AVALANCHE}`, AVALANCHE, getContract(AVALANCHE, \"GMX\"), \"balanceOf\", poolAddressAvax],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const mutate = useCallback(() => {\r\n    mutateGMXInLiquidityOnArbitrum();\r\n    mutateGMXInLiquidityOnAvax();\r\n  }, [mutateGMXInLiquidityOnArbitrum, mutateGMXInLiquidityOnAvax]);\r\n\r\n  if (gmxInLiquidityOnAvax && gmxInLiquidityOnArbitrum) {\r\n    let total = bigNumberify(gmxInLiquidityOnArbitrum).add(gmxInLiquidityOnAvax);\r\n    totalGMX.current = total;\r\n  }\r\n  return {\r\n    avax: gmxInLiquidityOnAvax,\r\n    arbitrum: gmxInLiquidityOnArbitrum,\r\n    total: totalGMX.current,\r\n    mutate,\r\n  };\r\n}\r\n\r\nfunction useGmxPriceFromAvalanche() {\r\n  const poolAddress = getContract(AVALANCHE, \"TraderJoeGmxAvaxPool\");\r\n\r\n  const { data, mutate: updateReserves } = useSWR([\"TraderJoeGmxAvaxReserves\", AVALANCHE, poolAddress, \"getReserves\"], {\r\n    fetcher: fetcher(undefined, UniswapV2),\r\n  });\r\n  const { _reserve0: gmxReserve, _reserve1: avaxReserve } = data || {};\r\n\r\n  const vaultAddress = getContract(AVALANCHE, \"Vault\");\r\n  const avaxAddress = getTokenBySymbol(AVALANCHE, \"WAVAX\").address;\r\n  const { data: avaxPrice, mutate: updateAvaxPrice } = useSWR(\r\n    [`StakeV2:avaxPrice`, AVALANCHE, vaultAddress, \"getMinPrice\", avaxAddress],\r\n    {\r\n      fetcher: fetcher(undefined, Vault),\r\n    }\r\n  );\r\n\r\n  const PRECISION = bigNumberify(10).pow(18);\r\n  let gmxPrice;\r\n  if (avaxReserve && gmxReserve && avaxPrice) {\r\n    gmxPrice = avaxReserve.mul(PRECISION).div(gmxReserve).mul(avaxPrice).div(PRECISION);\r\n  }\r\n\r\n  const mutate = useCallback(() => {\r\n    updateReserves(undefined, true);\r\n    updateAvaxPrice(undefined, true);\r\n  }, [updateReserves, updateAvaxPrice]);\r\n\r\n  return { data: gmxPrice, mutate };\r\n}\r\n\r\nfunction useGmxPriceFromArbitrum(library, active) {\r\n  const poolAddress = getContract(ARBITRUM, \"UniswapGmxEthPool\");\r\n  const { data: uniPoolSlot0, mutate: updateUniPoolSlot0 } = useSWR(\r\n    [`StakeV2:uniPoolSlot0:${active}`, ARBITRUM, poolAddress, \"slot0\"],\r\n    {\r\n      fetcher: fetcher(library, UniPool),\r\n    }\r\n  );\r\n\r\n  const vaultAddress = getContract(ARBITRUM, \"Vault\");\r\n  const ethAddress = getTokenBySymbol(ARBITRUM, \"WETH\").address;\r\n  const { data: ethPrice, mutate: updateEthPrice } = useSWR(\r\n    [`StakeV2:ethPrice:${active}`, ARBITRUM, vaultAddress, \"getMinPrice\", ethAddress],\r\n    {\r\n      fetcher: fetcher(library, Vault),\r\n    }\r\n  );\r\n\r\n  const gmxPrice = useMemo(() => {\r\n    if (uniPoolSlot0 && ethPrice) {\r\n      const tokenA = new UniToken(ARBITRUM, ethAddress, 18, \"SYMBOL\", \"NAME\");\r\n\r\n      const gmxAddress = getContract(ARBITRUM, \"GMX\");\r\n      const tokenB = new UniToken(ARBITRUM, gmxAddress, 18, \"SYMBOL\", \"NAME\");\r\n\r\n      const pool = new Pool(\r\n        tokenA, // tokenA\r\n        tokenB, // tokenB\r\n        10000, // fee\r\n        uniPoolSlot0.sqrtPriceX96, // sqrtRatioX96\r\n        1, // liquidity\r\n        uniPoolSlot0.tick, // tickCurrent\r\n        []\r\n      );\r\n\r\n      const poolTokenPrice = pool.priceOf(tokenB).toSignificant(6);\r\n      const poolTokenPriceAmount = parseValue(poolTokenPrice, 18);\r\n      return poolTokenPriceAmount.mul(ethPrice).div(expandDecimals(1, 18));\r\n    }\r\n  }, [ethPrice, uniPoolSlot0, ethAddress]);\r\n\r\n  const mutate = useCallback(() => {\r\n    updateUniPoolSlot0(undefined, true);\r\n    updateEthPrice(undefined, true);\r\n  }, [updateEthPrice, updateUniPoolSlot0]);\r\n\r\n  return { data: gmxPrice, mutate };\r\n}\r\n\r\nexport async function approvePlugin(\r\n  chainId,\r\n  pluginAddress,\r\n  { library, pendingTxns, setPendingTxns, sentMsg, failMsg }\r\n) {\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const contract = new ethers.Contract(routerAddress, Router.abi, library.getSigner());\r\n  return callContract(chainId, contract, \"approvePlugin\", [pluginAddress], {\r\n    sentMsg,\r\n    failMsg,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n  });\r\n}\r\n\r\nexport async function createSwapOrder(\r\n  chainId,\r\n  library,\r\n  path,\r\n  amountIn,\r\n  minOut,\r\n  triggerRatio,\r\n  nativeTokenAddress,\r\n  opts = {}\r\n) {\r\n  const executionFee = getConstant(chainId, \"SWAP_ORDER_EXECUTION_GAS_FEE\");\r\n  const triggerAboveThreshold = false;\r\n  let shouldWrap = false;\r\n  let shouldUnwrap = false;\r\n  opts.value = executionFee;\r\n\r\n  if (path[0] === AddressZero) {\r\n    shouldWrap = true;\r\n    opts.value = opts.value.add(amountIn);\r\n  }\r\n  if (path[path.length - 1] === AddressZero) {\r\n    shouldUnwrap = true;\r\n  }\r\n  path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n\r\n  const params = [path, amountIn, minOut, triggerRatio, triggerAboveThreshold, executionFee, shouldWrap, shouldUnwrap];\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createSwapOrder\", params, opts);\r\n}\r\n\r\nexport async function createIncreaseOrder(\r\n  chainId,\r\n  library,\r\n  nativeTokenAddress,\r\n  path,\r\n  amountIn,\r\n  indexTokenAddress,\r\n  minOut,\r\n  sizeDelta,\r\n  collateralTokenAddress,\r\n  isLong,\r\n  triggerPrice,\r\n  opts = {}\r\n) {\r\n  invariant(!isLong || indexTokenAddress === collateralTokenAddress, \"invalid token addresses\");\r\n  invariant(indexTokenAddress !== AddressZero, \"indexToken is 0\");\r\n  invariant(collateralTokenAddress !== AddressZero, \"collateralToken is 0\");\r\n\r\n  const fromETH = path[0] === AddressZero;\r\n\r\n  path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n  const shouldWrap = fromETH;\r\n  const triggerAboveThreshold = !isLong;\r\n  const executionFee = getConstant(chainId, \"INCREASE_ORDER_EXECUTION_GAS_FEE\");\r\n\r\n  const params = [\r\n    path,\r\n    amountIn,\r\n    indexTokenAddress,\r\n    minOut,\r\n    sizeDelta,\r\n    collateralTokenAddress,\r\n    isLong,\r\n    triggerPrice,\r\n    triggerAboveThreshold,\r\n    executionFee,\r\n    shouldWrap,\r\n  ];\r\n\r\n  if (!opts.value) {\r\n    opts.value = fromETH ? amountIn.add(executionFee) : executionFee;\r\n  }\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createIncreaseOrder\", params, opts);\r\n}\r\n\r\nexport async function createDecreaseOrder(\r\n  chainId,\r\n  library,\r\n  indexTokenAddress,\r\n  sizeDelta,\r\n  collateralTokenAddress,\r\n  collateralDelta,\r\n  isLong,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts = {}\r\n) {\r\n  invariant(!isLong || indexTokenAddress === collateralTokenAddress, \"invalid token addresses\");\r\n  invariant(indexTokenAddress !== AddressZero, \"indexToken is 0\");\r\n  invariant(collateralTokenAddress !== AddressZero, \"collateralToken is 0\");\r\n\r\n  const executionFee = getConstant(chainId, \"DECREASE_ORDER_EXECUTION_GAS_FEE\");\r\n\r\n  const params = [\r\n    indexTokenAddress,\r\n    sizeDelta,\r\n    collateralTokenAddress,\r\n    collateralDelta,\r\n    isLong,\r\n    triggerPrice,\r\n    triggerAboveThreshold,\r\n  ];\r\n  opts.value = executionFee;\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createDecreaseOrder\", params, opts);\r\n}\r\n\r\nexport async function cancelSwapOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelSwapOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function cancelDecreaseOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelDecreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function cancelIncreaseOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelIncreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport function handleCancelOrder(chainId, library, order, opts) {\r\n  let func;\r\n  if (order.type === SWAP) {\r\n    func = cancelSwapOrder;\r\n  } else if (order.type === INCREASE) {\r\n    func = cancelIncreaseOrder;\r\n  } else if (order.type === DECREASE) {\r\n    func = cancelDecreaseOrder;\r\n  }\r\n\r\n  return func(chainId, library, order.index, {\r\n    successMsg: \"Order cancelled.\",\r\n    failMsg: \"Cancel failed.\",\r\n    sentMsg: \"Cancel submitted.\",\r\n    pendingTxns: opts.pendingTxns,\r\n    setPendingTxns: opts.setPendingTxns,\r\n  });\r\n}\r\n\r\nexport async function cancelMultipleOrders(chainId, library, allIndexes = [], opts) {\r\n  const ordersWithTypes = groupBy(allIndexes, (v) => v.split(\"-\")[0]);\r\n  function getIndexes(key) {\r\n    if (!ordersWithTypes[key]) return;\r\n    return ordersWithTypes[key].map((d) => d.split(\"-\")[1]);\r\n  }\r\n  // params order => swap, increase, decrease\r\n  const params = [\"Swap\", \"Increase\", \"Decrease\"].map((key) => getIndexes(key) || []);\r\n  const method = \"cancelMultiple\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateDecreaseOrder(\r\n  chainId,\r\n  library,\r\n  index,\r\n  collateralDelta,\r\n  sizeDelta,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts\r\n) {\r\n  const params = [index, collateralDelta, sizeDelta, triggerPrice, triggerAboveThreshold];\r\n  const method = \"updateDecreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateIncreaseOrder(\r\n  chainId,\r\n  library,\r\n  index,\r\n  sizeDelta,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts\r\n) {\r\n  const params = [index, sizeDelta, triggerPrice, triggerAboveThreshold];\r\n  const method = \"updateIncreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateSwapOrder(chainId, library, index, minOut, triggerRatio, triggerAboveThreshold, opts) {\r\n  const params = [index, minOut, triggerRatio, triggerAboveThreshold];\r\n  const method = \"updateSwapOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function _executeOrder(chainId, library, method, account, index, feeReceiver, opts) {\r\n  const params = [account, index, feeReceiver];\r\n  const positionManagerAddress = getContract(chainId, \"PositionManager\");\r\n  const contract = new ethers.Contract(positionManagerAddress, PositionManager.abi, library.getSigner());\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport function executeSwapOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeSwapOrder\", account, index, feeReceiver, opts);\r\n}\r\n\r\nexport function executeIncreaseOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeIncreaseOrder\", account, index, feeReceiver, opts);\r\n}\r\n\r\nexport function executeDecreaseOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeDecreaseOrder\", account, index, feeReceiver, opts);\r\n}","export const REDIRECT_POPUP_TIMESTAMP_KEY = \"redirect-popup-timestamp\";\r\n\r\nexport const IS_TOUCH = \"ontouchstart\" in window;\r\n","import cx from \"classnames\";\r\nimport { useCallback, useState, useRef } from \"react\";\r\nimport { IS_TOUCH } from \"../../config/ui\";\r\n\r\nconst OPEN_DELAY = 0;\r\nconst CLOSE_DELAY = 100;\r\n\r\nexport default function Tooltip(props) {\r\n  const { enabled } = props;\r\n  const [visible, setVisible] = useState(false);\r\n  const intervalCloseRef = useRef(null);\r\n  const intervalOpenRef = useRef(null);\r\n\r\n  const position = props.position ?? \"left-bottom\";\r\n  const trigger = props.trigger ?? \"hover\";\r\n\r\n  const onMouseEnter = useCallback(() => {\r\n    if (trigger !== \"hover\" || IS_TOUCH) return;\r\n\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (!intervalOpenRef.current) {\r\n      intervalOpenRef.current = setTimeout(() => {\r\n        if (enabled) {\r\n          setVisible(true)\r\n        }\r\n        intervalOpenRef.current = null;\r\n      }, OPEN_DELAY);\r\n    }\r\n  }, [setVisible, intervalCloseRef, intervalOpenRef, trigger]);\r\n\r\n  const onMouseClick = useCallback(() => {\r\n    if (trigger !== \"click\" && !IS_TOUCH) return;\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n\r\n    if (enabled) {\r\n      setVisible(true)\r\n    }\r\n  }, [setVisible, intervalCloseRef, trigger]);\r\n\r\n  const onMouseLeave = useCallback(() => {\r\n    intervalCloseRef.current = setTimeout(() => {\r\n      setVisible(false);\r\n      intervalCloseRef.current = null;\r\n    }, CLOSE_DELAY);\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n  }, [setVisible, intervalCloseRef]);\r\n\r\n  const className = cx(\"Tooltip\", props.className);\r\n\r\n  return (\r\n    <span className={className} style={props.style} onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} onClick={onMouseClick} id={props.id}>\r\n      <span\r\n        className={cx({ \"Tooltip-handle\": !props.disableHandleStyle }, [props.handleClassName], { active: visible })}\r\n      >\r\n        {props.handle}\r\n      </span>\r\n      {visible && <div className={cx([\"Tooltip-popup\", position])}>{props.renderContent()}</div>}\r\n    </span>\r\n  );\r\n}\r\n","import { getExplorerUrl, helperToast } from './../../views/gmx-test/lib/legacy';\r\n\r\n\r\nexport const notifySuccess = (text, hash) => {\r\n\tconst url = getExplorerUrl(42161) + \"tx/\" + hash;\r\n\t\r\n\thelperToast.success(\r\n\t\t<div>\r\n\t\t\t{text}\r\n\t\t\t<br />\r\n\t\t\t{hash &&\r\n\t\t\t\t<a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n\t\t\t\t\tView on Arbiscan\r\n\t\t\t\t</a>}\r\n\t\t\t<br />\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport const errAlert = (err, setIsLoading) => {\r\n\tlet msg = err.reason ?? err.message;\r\n\tif (err.message === 'Internal JSON-RPC error.') {\r\n\t\tmsg = err.data.message;\r\n\t}\r\n\t\r\n\tconsole.log(err);\r\n\t// alert(`Error code: ${err.code}\\nError message: ${msg}\\n\\nCheck the console for details.`)\r\n\thelperToast.error(\r\n\t\t<div>\r\n\t\t\tError: {err.code}\r\n\t\t\t<br />\r\n\t\t\t{msg}\r\n\t\t\t<br /><br />\r\n\t\t\tCheck the console for details.\r\n\t\t</div>\r\n\t)\r\n\r\n\tif (setIsLoading) {\r\n\t\tsetIsLoading(false);\r\n\t}\r\n}","import React, { useState, useEffect } from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Tab.css\";\r\n\r\nexport default function Tab(props) {\r\n  const { options, option, setOption, onChange, type = \"block\", className, optionLabels, icons, disabled, disabledTooltip } = props;\r\n  \r\n  const onClick = (opt) => {\r\n    if (disabled) {\r\n      return;\r\n    }\r\n    \r\n    if (setOption) {\r\n      setOption(opt);\r\n    }\r\n    if (onChange) {\r\n      onChange(opt);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={cx(\"Tab\", type, className, disabled && 'disabled')}>\r\n      {options.map((opt) => {\r\n        const label = optionLabels && optionLabels[opt] ? optionLabels[opt] : opt;\r\n        let disabledNode;\r\n        \r\n        if (props.disabledList) {\r\n          props.disabledList.forEach(el => {\r\n            if (el.label === label && el.disabled) {\r\n              disabledNode = (\r\n                <div className={cx(\"Tab-option\", \"tab-tooltip-container\")} onClick={() => {return}} key={opt}>\r\n                  {disabledTooltip}\r\n                  {icons && icons[opt] && <img className=\"Tab-option-icon\" src={opt === option ? icons[opt + '_active'] : icons[opt]} alt={option} />}\r\n                  {label}\r\n                </div>\r\n              );\r\n            }\r\n          })\r\n        }\r\n\r\n        if (disabledNode) {\r\n          return disabledNode;\r\n        }\r\n        \r\n        return (\r\n          <div className={cx(\"Tab-option\", \"muted\", { active: opt === option })} onClick={() => onClick(opt)} key={opt}>\r\n            {icons && icons[opt] && <img className=\"Tab-option-icon\" src={opt === option ? icons[opt + '_active'] : icons[opt]} alt={option} />}\r\n            {label}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import { disableBodyScroll, enableBodyScroll, clearAllBodyScrollLocks } from \"body-scroll-lock\";\r\nimport { RefObject, useEffect } from \"react\";\r\n\r\nexport const TOUCH_MOVE_CONTAINER_CLASS_NAME = \"DiableScroll-touch-move-container\";\r\n\r\n// @see https://github.com/willmcpo/body-scroll-lock#allowtouchmove\r\nconst allowTouchMoveFn = (el: HTMLElement) => {\r\n  while (el && el !== document.body) {\r\n    if (el.className?.includes?.(TOUCH_MOVE_CONTAINER_CLASS_NAME)) return true;\r\n\r\n    el = el.parentElement as HTMLElement;\r\n  }\r\n};\r\n\r\nexport default function useLockBodyScroll(\r\n  ref: RefObject<HTMLElement>,\r\n  isVisible: boolean,\r\n  opts: {\r\n    disableLock?: boolean;\r\n    allowTouchMove?: boolean;\r\n  } = {}\r\n) {\r\n  useEffect(() => {\r\n    if (opts.disableLock) {\r\n      return;\r\n    }\r\n\r\n    if (ref.current) {\r\n      if (isVisible) {\r\n        disableBodyScroll(ref.current, {\r\n          allowTouchMove: opts.allowTouchMove ? allowTouchMoveFn : undefined,\r\n        });\r\n      } else {\r\n        enableBodyScroll(ref.current);\r\n      }\r\n    }\r\n\r\n    return () => clearAllBodyScrollLocks();\r\n\r\n    // needs ref.current in deps, not just ref\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [ref.current, opts.allowTouchMove, opts.disableLock, isVisible]);\r\n}\r\n","import React, { useRef, useEffect, useState } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\n\r\nimport { MdClose } from \"react-icons/md\";\r\n\r\nimport \"./Modal.scss\";\r\nimport useLockBodyScroll, { TOUCH_MOVE_CONTAINER_CLASS_NAME } from \"../../lib/useLockBodyScroll\";\r\n\r\nexport default function Modal(props) {\r\n  const { isVisible, setIsVisible, className, zIndex, onAfterOpen, disableBodyScrollLock, allowContentTouchMove, isNifty } =\r\n    props;\r\n\r\n  const modalRef = useRef(null);\r\n\r\n  const [isActive, setIsActive] = useState(isVisible);\r\n\r\n  function closeModal() {\r\n    setIsVisible(false);\r\n  }\r\n\r\n  useLockBodyScroll(modalRef, isVisible, {\r\n    disableLock: false,\r\n    allowTouchMove: allowContentTouchMove,\r\n  });\r\n\r\n\r\n  useEffect(() => {\r\n    function close(e) {\r\n      if (e.keyCode === 27) {\r\n        setIsVisible(false);\r\n      }\r\n    }\r\n    window.addEventListener(\"keydown\", close);\r\n    return () => window.removeEventListener(\"keydown\", close);\r\n  }, [setIsVisible]);\r\n\r\n  useEffect(() => {\r\n    if (typeof onAfterOpen === \"function\") onAfterOpen();\r\n  }, [onAfterOpen]);\r\n\r\n  const fadeVariants = {\r\n    hidden: { opacity: 0, visibility: 'hidden' },\r\n    visible: { opacity: 1, visibility: 'visible' },\r\n  };\r\n  const niftyFadeVariants = {\r\n    hidden: {\r\n      transform: 'rotateX(-60deg)',\r\n      opacity: 0,\r\n    },\r\n    visible: {\r\n      transform: 'rotateX(0)',\r\n      opacity: 1,\r\n    }\r\n  }\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isVisible && (\r\n        <motion.div\r\n          className={cx(\"Modal\", isNifty && \"Modal_nifty\", isNifty && isActive && \"active\", className)}\r\n          style={{ zIndex }}\r\n          initial=\"hidden\"\r\n          animate=\"visible\"\r\n          exit=\"hidden\"\r\n          variants={fadeVariants}\r\n          transition={{ duration: 0 }}\r\n        >\r\n          <div\r\n            className=\"Modal-backdrop\"\r\n            style={{\r\n              overflow: isVisible ? \"hidden\" : \"visible\",\r\n              position: \"fixed\",\r\n            }}\r\n            onClick={closeModal}\r\n          ></div>\r\n\r\n          {isNifty && (\r\n            <div className=\"Modal-close-button\" onClick={closeModal}>\r\n              <MdClose fontSize={20} className=\"Modal-close-icon\" />\r\n            </div>\r\n          )}\r\n          \r\n\r\n          <div className={isNifty && \"Modal-content-wrapper\"}>\r\n            <motion.div\r\n              className={cx(\"Modal-content\")}\r\n              style={{ transformStyle: 'preserve-3d', transformOrigin: '50% 0' }}\r\n              initial=\"hidden\"\r\n              animate=\"visible\"\r\n              exit=\"hidden\"\r\n              variants={isNifty && niftyFadeVariants}\r\n              transition={{ duration: 0 }}\r\n            >\r\n              <div className=\"Modal-title-bar\">\r\n                <div className=\"Modal-title\">{props.label}</div>\r\n              </div>\r\n              <div className=\"divider\" />\r\n              <div className={cx(\"Modal-body\", TOUCH_MOVE_CONTAINER_CLASS_NAME)} ref={modalRef}>\r\n                {props.children}\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}\r\n","import { useEffect, useMemo } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\n\r\nexport default function Portal({ children }) {\r\n  const root = document.body;\r\n\r\n  const el = useMemo(() => document.createElement(\"div\"), []);\r\n\r\n  useEffect(() => {\r\n    root.appendChild(el);\r\n    return () => root.removeChild(el);\r\n  }, [root, el]);\r\n\r\n  return createPortal(children, el);\r\n}\r\n","import { useCallback, useRef, useState } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Tooltip.scss\";\r\nimport { IS_TOUCH } from \"../../config/ui\";\r\nimport Portal from \"../Common/Portal\";\r\n\r\nconst OPEN_DELAY = 0;\r\nconst CLOSE_DELAY = 100;\r\n\r\nexport default function TooltipWithPortal(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [coords, setCoords] = useState({});\r\n  const [tooltipWidth, setTooltipWidth] = useState();\r\n  const intervalCloseRef = useRef(null);\r\n  const intervalOpenRef = useRef(null);\r\n\r\n  const position = props.position ?? \"left-bottom\";\r\n  const trigger = props.trigger ?? \"hover\";\r\n  const handlerRef = useRef();\r\n\r\n  const updateTooltipCoords = useCallback(() => {\r\n    const rect = handlerRef.current.getBoundingClientRect();\r\n\r\n    setCoords({\r\n      height: rect.height,\r\n      width: rect.width,\r\n      left: rect.x,\r\n      top: rect.y + window.scrollY,\r\n    });\r\n\r\n    if (props.fitHandleWidth) {\r\n      setTooltipWidth(`${rect.width}px`);\r\n    }\r\n  }, [handlerRef, props.fitHandleWidth]);\r\n\r\n  const onMouseEnter = useCallback(() => {\r\n    if (trigger !== \"hover\" || IS_TOUCH) return;\r\n\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (!intervalOpenRef.current) {\r\n      intervalOpenRef.current = setTimeout(() => {\r\n        setVisible(true);\r\n        intervalOpenRef.current = null;\r\n      }, OPEN_DELAY);\r\n    }\r\n    updateTooltipCoords();\r\n  }, [setVisible, intervalCloseRef, intervalOpenRef, trigger, updateTooltipCoords]);\r\n\r\n  const onMouseClick = useCallback(() => {\r\n    if (trigger !== \"click\" && !IS_TOUCH) return;\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n    updateTooltipCoords();\r\n\r\n    if (props.closeOnDoubleClick) {\r\n      setVisible((old) => !old);\r\n    } else {\r\n      setVisible(true);\r\n    }\r\n  }, [setVisible, intervalCloseRef, trigger, updateTooltipCoords, props.closeOnDoubleClick]);\r\n\r\n  const onMouseLeave = useCallback(() => {\r\n    intervalCloseRef.current = setTimeout(() => {\r\n      setVisible(false);\r\n      intervalCloseRef.current = null;\r\n    }, CLOSE_DELAY);\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n    updateTooltipCoords();\r\n  }, [setVisible, intervalCloseRef, updateTooltipCoords]);\r\n\r\n  const className = cx(\"Tooltip\", props.className);\r\n\r\n  return (\r\n    <span className={className} onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} onClick={onMouseClick}>\r\n      <span\r\n        className={cx({ \"Tooltip-handle\": !props.disableHandleStyle }, [props.handleClassName], { active: visible })}\r\n        ref={handlerRef}\r\n      >\r\n        {props.handle}\r\n      </span>\r\n      {visible && coords.left && (\r\n        <Portal>\r\n          <div style={{ ...coords, position: \"absolute\" }}>\r\n            <div className={cx([\"Tooltip-popup\", position])} style={{ width: tooltipWidth }}>\r\n              {props.renderContent()}\r\n            </div>\r\n          </div>\r\n        </Portal>\r\n      )}\r\n    </span>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport { formatAmount, expandDecimals, bigNumberify } from \"../../lib/legacy\";\r\n\r\nimport { getToken } from \"../../config/Tokens\";\r\n\r\n// import { BiChevronDown } from \"react-icons/bi\";\r\n\r\nimport Modal from \"../Modal/Modal\";\r\n\r\nimport dropDownIcon from \"../../img/DROP_DOWN.svg\";\r\nimport \"./TokenSelector.scss\";\r\nimport TooltipWithPortal from \"../Tooltip/TooltipWithPortal\";\r\n\r\nexport default function TokenSelector(props) {\r\n  \r\n  const [isModalVisible, setIsModalVisible] = useState(false);\r\n  const [searchKeyword, setSearchKeyword] = useState(\"\");\r\n  const tokenInfo = getToken(props.chainId, props.tokenAddress);\r\n  const {\r\n    tokens,\r\n    mintingCap,\r\n    infoTokens,\r\n    showMintingCap,\r\n    disabled,\r\n    selectedTokenLabel,\r\n    showBalances = true,\r\n    showTokenImgInDropdown = false,\r\n    showSymbolImage = false,\r\n    showNewCaret = false,\r\n    getTokenState = () => ({ disabled: false, message: null }),\r\n    disableBodyScrollLock,\r\n  } = props;\r\n\r\n  const visibleTokens = tokens.filter((t) => !t.isTempHidden);\r\n\r\n  const onSelectToken = (token) => {\r\n    setIsModalVisible(false);\r\n    props.onSelectToken(token);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isModalVisible) {\r\n      setSearchKeyword(\"\");\r\n    }\r\n  }, [isModalVisible]);\r\n\r\n  if (!tokenInfo) {\r\n    return null;\r\n  }\r\n\r\n  var tokenImage = null;\r\n\r\n  try {\r\n    tokenImage = require(\"../../img/ic_\" + tokenInfo.symbol.toLowerCase() + \"_24.svg\");\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n\r\n  const onSearchKeywordChange = (e) => {\r\n    setSearchKeyword(e.target.value);\r\n  };\r\n\r\n  const filteredTokens = visibleTokens.filter((item) => {\r\n    return (\r\n      item.name.toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1 ||\r\n      item.symbol.toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1\r\n    );\r\n  });\r\n\r\n  const _handleKeyDown = (e) => {\r\n    if (e.key === \"Enter\" && filteredTokens.length > 0) {\r\n      onSelectToken(filteredTokens[0]);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={cx(\"TokenSelector\", { disabled }, props.className) + (isModalVisible ? ' opened' : '')}>\r\n      <Modal\r\n        disableBodyScrollLock={disableBodyScrollLock}\r\n        isVisible={isModalVisible}\r\n        setIsVisible={setIsModalVisible}\r\n        label={props.label}\r\n      >\r\n        <div className=\"TokenSelector-tokens\">\r\n          {/* <div className=\"TokenSelector-token-row TokenSelector-token-input-row\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search Token\"\r\n              value={searchKeyword}\r\n              onChange={(e) => onSearchKeywordChange(e)}\r\n              onKeyDown={_handleKeyDown}\r\n              autoFocus\r\n            />\r\n          </div> */}\r\n          {filteredTokens.map((token, tokenIndex) => {\r\n            let tokenPopupImage;\r\n            try {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_\" + token.symbol.toLowerCase() + \"_40.svg\");\r\n            } catch (error) {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_eth_40.svg\");\r\n            }\r\n            let info = infoTokens ? infoTokens[token.address] : {};\r\n            let mintAmount;\r\n            let balance = info.balance;\r\n            if (showMintingCap && mintingCap && info.usdgAmount) {\r\n              mintAmount = mintingCap.sub(info.usdgAmount);\r\n            }\r\n            if (mintAmount && mintAmount.lt(0)) {\r\n              mintAmount = bigNumberify(0);\r\n            }\r\n            let balanceUsd;\r\n            if (balance && info.maxPrice) {\r\n              balanceUsd = balance.mul(info.maxPrice).div(expandDecimals(1, token.decimals));\r\n            }\r\n\r\n            const tokenState = getTokenState(info) || {};\r\n\r\n            return (\r\n              <div\r\n                key={token.address}\r\n                className={cx(\"TokenSelector-token-row\", token.symbol === tokenInfo?.symbol ? 'chosen' : '' , { disabled: tokenState.disabled })}\r\n                onClick={() => !tokenState.disabled && onSelectToken(token)}\r\n              >\r\n                {tokenState.disabled && tokenState.message && (\r\n                  <TooltipWithPortal\r\n                    className=\"TokenSelector-tooltip\"\r\n                    portalClassName=\"TokenSelector-tooltip-portal\"\r\n                    handle={<div className=\"TokenSelector-tooltip-backing\" />}\r\n                    position={tokenIndex < filteredTokens.length / 2 ? \"center-bottom\" : \"center-top\"}\r\n                    disableHandleStyle\r\n                    closeOnDoubleClick\r\n                    fitHandleWidth\r\n                    renderContent={() => tokenState.message}\r\n                  />\r\n                )}\r\n                <div className=\"Token-info\">\r\n                  {showTokenImgInDropdown && (\r\n                    <img src={tokenPopupImage?.default} alt={token.name} className=\"token-logo\" />\r\n                  )}\r\n                  <div className=\"Token-symbol\">\r\n                    <div className=\"Token-text\">{token.symbol}</div>\r\n                    {/* <span className=\"text-accent\">{token.name}</span> */}\r\n                  </div>\r\n                </div>\r\n                {/* <div className=\"Token-balance\">\r\n                  {showBalances && balance && (\r\n                    <div className=\"Token-text\">\r\n                      {balance.gt(0) && formatAmount(balance, token.decimals, 4, true)}\r\n                      {balance.eq(0) && \"-\"}\r\n                    </div>\r\n                  )}\r\n                  <span className=\"text-accent\">\r\n                    {mintAmount && <div>Mintable: {formatAmount(mintAmount, token.decimals, 2, true)} USDG</div>}\r\n                    {showMintingCap && !mintAmount && <div>-</div>}\r\n                    {!showMintingCap && showBalances && balanceUsd && balanceUsd.gt(0) && (\r\n                      <div>${formatAmount(balanceUsd, 30, 2, true)}</div>\r\n                    )}\r\n                  </span>\r\n                </div> */}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </Modal>\r\n      {selectedTokenLabel ? (\r\n        <div className=\"TokenSelector-box\" onClick={(e) => {\r\n          setIsModalVisible(true)\r\n        }}>\r\n          {selectedTokenLabel}\r\n          {!showNewCaret && \r\n            <svg className=\"TokenSelector-caret\" xmlns=\"http://www.w3.org/2000/svg\" width=\"13\" height=\"13\" viewBox=\"0 0 13 13\" fill=\"none\">\r\n              <path d=\"M2.60001 4.76666L7.10001 8.76666L11.6 4.76666\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n          </svg>\r\n          }\r\n        </div>\r\n      ) : (\r\n        <div className=\"TokenSelector-box\" onClick={(e) => {\r\n          setIsModalVisible(true)\r\n        }}>\r\n          {tokenInfo.symbol}\r\n          {showSymbolImage && (\r\n            <img src={tokenImage && tokenImage.default} alt={tokenInfo.symbol} className=\"TokenSelector-box-symbol\" />\r\n          )}\r\n          {showNewCaret && <img src={dropDownIcon} alt=\"dropDownIcon\" className=\"TokenSelector-box-caret\" />}\r\n          {!showNewCaret &&\r\n            <svg className=\"TokenSelector-caret\" xmlns=\"http://www.w3.org/2000/svg\" width=\"13\" height=\"13\" viewBox=\"0 0 13 13\" fill=\"none\">\r\n              <path d=\"M2.60001 4.76666L7.10001 8.76666L11.6 4.76666\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n            </svg>\r\n          }\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import cx from \"classnames\";\r\n\r\nexport default function ExchangeInfoRow(props) {\r\n  const { label, children, value, isTop, isWarning } = props;\r\n\r\n  return (\r\n    <div className={cx(\"Exchange-info-row\", { \"top-line\": isTop }) + ' ' + props.className}>\r\n      <div className=\"Exchange-info-label\">{label}</div>\r\n      <div className={`align-right ${isWarning ? \"Exchange-info-value-warning\" : \"\"}`}>{children || value}</div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Checkbox.scss\";\r\nimport { ImCheckboxUnchecked, ImCheckboxChecked } from \"react-icons/im\";\r\n\r\nexport default function Checkbox(props) {\r\n  const { isChecked, setIsChecked, disabled, className } = props;\r\n\r\n  return (\r\n    <div\r\n      className={cx(\"Checkbox\", { disabled, selected: isChecked }, className)}\r\n      onClick={() => setIsChecked(!isChecked)}\r\n    >\r\n      <span className=\"Checkbox-icon-wrapper\">\r\n        {isChecked && <ImCheckboxChecked className=\"App-icon Checkbox-icon active\" />}\r\n        {!isChecked && <ImCheckboxUnchecked className=\"App-icon Checkbox-icon inactive\" />}\r\n      </span>\r\n      <span className=\"Checkbox-label\">{props.children}</span>\r\n    </div>\r\n  );\r\n}\r\n","import \"./StatsTooltip.css\";\r\ntype Props = {\r\n  label: string;\r\n  value: number | [number];\r\n  showDollar?: boolean;\r\n};\r\n\r\nexport default function StatsTooltipRow({ label, value, showDollar = true }: Props) {\r\n  function renderValue() {\r\n    if (Array.isArray(value)) {\r\n      return (\r\n        <ul className=\"Tooltip-row-values\">\r\n          {value.map((v, i) => (\r\n            <li key={i}>{v}</li>\r\n          ))}\r\n        </ul>\r\n      );\r\n    }\r\n    return (\r\n      <span className=\"Tooltip-row-value\">\r\n        {showDollar && \"$\"}\r\n        {value}\r\n      </span>\r\n    );\r\n  }\r\n  return (\r\n    <div className=\"Tooltip-row\">\r\n      <span className=\"label\">{label}:</span>\r\n      {renderValue()}\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport './Slippage.scss';\r\n\r\nconst SlippageInput = ({ value, setValue }) => {\r\n\treturn (\r\n\t\t<div className=\"Exchange-swap-section Slippage-input-container\">\r\n\t\t\t<div className=\"Exchange-swap-section-bottom\">\r\n\t\t\t\t<div className=\"Exchange-swap-input-container\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tplaceholder=\"Slippage (%)\"\r\n\t\t\t\t\t\tclassName=\"Exchange-swap-input Slippage-input\"\r\n\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tconst val = (e.target.value).replace(/[^0-9]/g, '').replace(/^0\\d/, '');\r\n\t\t\t\t\t\t\t// const valStr = convertInputNum(e.target.value)\r\n\t\t\t\t\t\t\t// const val = sepToNumber(valStr);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (val > 100) {\r\n\t\t\t\t\t\t\t\tsetValue(100);\r\n\t\t\t\t\t\t\t} else if (val < 0) {\r\n\t\t\t\t\t\t\t\tsetValue(0);\r\n\t\t\t\t\t\t\t} else if (val === 0) {\r\n\t\t\t\t\t\t\t\tsetValue(0.3);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tsetValue(val);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonFocus={(e) => {\r\n\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonBlur={(e) => {\r\n\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n};\r\n\r\nexport default SlippageInput;","import React, { useState } from 'react';\r\nimport cx from 'classnames';\r\nimport { convertInputNum } from '../../utils/sepThousands';\r\n\r\nconst NumberInput_v3 = (props) => {\r\n\tconst {\r\n\t\ttitle,\r\n\t\tdisplayValueTitle,\r\n\t\tdisplayValue,\r\n\t\tvalue,\r\n\t\tsetValue,\r\n\t\thasError,\r\n\t} = props;\r\n\r\n\tconst [hasFocus, setHasFocus] = useState(false);\r\n\r\n\tconst cls = cx(props.className, hasFocus && 'hlight', hasError && 'error');\r\n\t\r\n\treturn (\r\n\t\t<div className={\"Exchange-swap-section\" + (cls && ` ${cls}`)}>\r\n\t\t\t<div className=\"Exchange-swap-section-top\">\r\n\t\t\t\t<div className=\"muted\">\r\n\t\t\t\t\t<div className=\"Exchange-swap-usd\">\r\n\t\t\t\t\t\t{title}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{displayValue && (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName=\"muted align-right clickable\"\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetValue(displayValue);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{displayValueTitle}: {displayValue}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"Exchange-swap-section-bottom\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tplaceholder=\"0.0\"\r\n\t\t\t\t\t\tclassName=\"Exchange-swap-input\"\r\n\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tsetValue(convertInputNum(e.target.value));\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonFocus={(e) => {\r\n\t\t\t\t\t\t\tsetHasFocus(true);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonBlur={(e) => {\r\n\t\t\t\t\t\t\tsetHasFocus(false);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default NumberInput_v3;","import { formatUnits } from \"ethers/lib/utils\";\r\nimport { formatAmount } from \"../../views/gmx-test/lib/legacy\";\r\n\r\n\r\nexport const getSlTpFromPercentage = (isLong, isTP, percentage, openPriceNum, leverage, fees) => {\r\n\tif (!percentage) {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t// const feesDelta = formatAmount(fees, 30, 30, 0) / leverage;\r\n\t// const openPriceWithFees = isLong\r\n\t// \t? openPriceNum + feesDelta\r\n\t// \t: openPriceNum - feesDelta;\r\n\t\r\n\tif ((isTP && isLong) || (!isTP && !isLong)) {\r\n\t\treturn (\r\n\t\t\t(\r\n\t\t\t\topenPriceNum + (0.01 * openPriceNum * (percentage / leverage))\r\n\t\t\t) * 10**10\r\n\t\t).toFixed(0);\r\n\t} else {\r\n\t\treturn (\r\n\t\t\t(\r\n\t\t\t\topenPriceNum - (0.01 * openPriceNum * (percentage / leverage))\r\n\t\t\t) * 10**10\r\n\t\t).toFixed(0);\r\n\t}\r\n}\r\n\r\nexport const daysToMs = (days) => {\r\n\treturn days * 24 * 60**2 * 1000;\r\n}\r\n\r\nexport const msToTimeLeft = (ms) => {\r\n\tconst s = ms / 1000;\r\n\tconst m = s / 60;\r\n\tconst h = m / 60;\r\n\tconst hours = Math.floor(h % 24);\r\n\tconst days = Math.floor(h / 24);\r\n\t\r\n\treturn `${days}d${hours ? ` ${hours}h` : ''}`;\r\n}\r\n\r\nexport function fromBigNumber(number, decimals = 18) {\r\n  return parseFloat(formatUnits(number.toString(), decimals));\r\n}\r\n","import React, { useCallback, useState, useMemo, useEffect } from \"react\";\r\nimport \"./ConfirmationBox.css\";\r\nimport {\r\n  USD_DECIMALS,\r\n  PRECISION,\r\n  BASIS_POINTS_DIVISOR,\r\n  LIMIT,\r\n  MIN_PROFIT_TIME,\r\n  INCREASE,\r\n  expandDecimals,\r\n  getExchangeRate,\r\n  getProfitPrice,\r\n  getTimeRemaining,\r\n  formatAmount,\r\n  formatAmountFree,\r\n  useLocalStorageSerializeKey,\r\n  getExchangeRateDisplay,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  SLIPPAGE_BPS_KEY,\r\n  formatDateTime,\r\n  calculatePositionDelta,\r\n  DECREASE,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport { cancelDecreaseOrder, handleCancelOrder } from \"../../domain/legacy\";\r\nimport { getNativeToken, getToken, getWrappedToken } from \"../../config/Tokens\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport SlippageInput from './../SlippageInput/SlippageInput';\r\nimport NumberInput_v2 from './../../../../components/UI/input/NumberInput_v2';\r\nimport { formatForContract } from \"../../../../components/utils/math\";\r\nimport NumberInput_v3 from './../../../../components/UI/input/NumberInput_v3';\r\nimport { getSlTpFromPercentage } from './../../../../components/utils/utils';\r\n\r\nconst HIGH_SPREAD_THRESHOLD = expandDecimals(1, USD_DECIMALS).div(100); // 1%;\r\n\r\nfunction getSpread(fromTokenInfo, toTokenInfo, isLong, nativeTokenAddress) {\r\n  if (fromTokenInfo && fromTokenInfo.maxPrice && toTokenInfo && toTokenInfo.minPrice) {\r\n    const fromDiff = fromTokenInfo.maxPrice.sub(fromTokenInfo.minPrice).div(2);\r\n    const fromSpread = fromDiff.mul(PRECISION).div(fromTokenInfo.maxPrice.add(fromTokenInfo.minPrice).div(2));\r\n    const toDiff = toTokenInfo.maxPrice.sub(toTokenInfo.minPrice).div(2);\r\n    const toSpread = toDiff.mul(PRECISION).div(toTokenInfo.maxPrice.add(toTokenInfo.minPrice).div(2));\r\n\r\n    let value = fromSpread.add(toSpread);\r\n\r\n    const fromTokenAddress = fromTokenInfo.isNative ? nativeTokenAddress : fromTokenInfo.address;\r\n    const toTokenAddress = toTokenInfo.isNative ? nativeTokenAddress : toTokenInfo.address;\r\n\r\n    if (isLong && fromTokenAddress === toTokenAddress) {\r\n      value = fromSpread;\r\n    }\r\n\r\n    return {\r\n      value,\r\n      isHigh: value.gt(HIGH_SPREAD_THRESHOLD),\r\n    };\r\n  }\r\n}\r\n\r\nexport default function ConfirmationBox(props) {\r\n  const {\r\n    fromToken,\r\n    fromTokenInfo,\r\n    toToken,\r\n    toTokenInfo,\r\n    isSwap,\r\n    isLong,\r\n    isMarketOrder,\r\n    orderOption,\r\n    isShort,\r\n    toAmount,\r\n    fromAmount,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    onConfirmationClick,\r\n    setIsConfirming,\r\n    shortCollateralAddress,\r\n    hasExistingPosition,\r\n    leverage,\r\n    existingPosition,\r\n    existingLiquidationPrice,\r\n    displayLiquidationPrice,\r\n    shortCollateralToken,\r\n    isPendingConfirmation,\r\n    triggerPriceUsd,\r\n    triggerRatio,\r\n    fees,\r\n    feesUsd,\r\n    isSubmitting,\r\n    fromUsdMin,\r\n    toUsdMax,\r\n    nextAveragePrice,\r\n    collateralTokenAddress,\r\n    feeBps,\r\n    chainId,\r\n    orders,\r\n    library,\r\n    setPendingTxns,\r\n    pendingTxns,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n    savedSlippageAmount,\r\n    userSlippage,\r\n    setUserSlippage,\r\n    allowedSlippage,\r\n    market,\r\n    TPValue,\r\n    setTPValue,\r\n    SLValue,\r\n    setSLValue,\r\n    TPHasError,\r\n    setTPHasError,\r\n    SLHasError,\r\n    setSLHasError,\r\n    liquidity,\r\n  } = props;\r\n\r\n  useEffect(() => {\r\n    setTPValue('');\r\n    setSLValue('');\r\n  }, []);\r\n\r\n  \r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n  \r\n  const [isProfitWarningAccepted, setIsProfitWarningAccepted] = useState(false);\r\n  const [isTriggerWarningAccepted, setIsTriggerWarningAccepted] = useState(false);\r\n  const [isLimitOrdersVisible, setIsLimitOrdersVisible] = useState(false);\r\n\r\n  const onCancelOrderClick = useCallback(\r\n    (order) => {\r\n      handleCancelOrder(chainId, library, order, { pendingTxns, setPendingTxns });\r\n    },\r\n    [library, pendingTxns, setPendingTxns, chainId]\r\n  );\r\n\r\n  let minOut;\r\n  let fromTokenUsd;\r\n  let toTokenUsd;\r\n\r\n  let collateralAfterFees = fromUsdMin;\r\n  if (feesUsd) {\r\n    collateralAfterFees = fromUsdMin.sub(feesUsd);\r\n  }\r\n\r\n  if (isSwap) {\r\n    minOut = toAmount.mul(BASIS_POINTS_DIVISOR - savedSlippageAmount).div(BASIS_POINTS_DIVISOR);\r\n\r\n    fromTokenUsd = fromTokenInfo ? formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true) : 0;\r\n    toTokenUsd = toTokenInfo ? formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true) : 0;\r\n  }\r\n\r\n  const getTitle = () => {\r\n    if (!isMarketOrder) {\r\n      return \"Confirm Limit Order\";\r\n    }\r\n    if (isSwap) {\r\n      return \"Confirm Swap\";\r\n    }\r\n    return isLong ? \"Confirm Long\" : \"Confirm Short\";\r\n  };\r\n  const title = getTitle();\r\n\r\n  const existingOrder = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    for (const order of orders) {\r\n      if (order.type !== INCREASE) continue;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      if (order.isLong === isLong && sameToken) {\r\n        return order;\r\n      }\r\n    }\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const existingOrders = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    return orders.filter((order) => {\r\n      if (order.type !== INCREASE) return false;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      return order.isLong === isLong && sameToken;\r\n    });\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const existingTriggerOrders = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    return orders.filter((order) => {\r\n      if (order.type !== DECREASE) return false;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      return order.isLong === isLong && sameToken;\r\n    });\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const decreaseOrdersThatWillBeExecuted = useMemo(() => {\r\n    if (isSwap) return [];\r\n    return existingTriggerOrders.filter((order) => {\r\n      if (order.triggerAboveThreshold) {\r\n        return existingPosition?.markPrice.gte(order.triggerPrice);\r\n      } else {\r\n        return existingPosition?.markPrice.lte(order.triggerPrice);\r\n      }\r\n    });\r\n  }, [existingPosition, existingTriggerOrders, isSwap]);\r\n\r\n  const takeProfit = Number(formatForContract(TPValue, 10).toFixed(0));\r\n  const stopLoss = Number(formatForContract(SLValue, 10).toFixed(0));\r\n  const price = Number(formatAmount(isMarketOrder ? toTokenInfo.maxPrice : triggerPriceUsd, 20, 0, 0));\r\n  const getError = () => {\r\n    if (market === 'GNS') {\r\n      if (stopLoss) {\r\n        if ((isLong && stopLoss >= price) || (!isLong && stopLoss <= price)) {\r\n          setSLHasError(true);\r\n          return `${isLong ? 'Long' : 'Short'} SL can't be ${isLong ? 'greater' : 'less'} than entry price.`;\r\n        } else {\r\n          setSLHasError(false);\r\n        }\r\n      } else {\r\n        setSLHasError(false);\r\n      }\r\n      if (takeProfit) {\r\n        if ((isLong && takeProfit <= price) || (!isLong && takeProfit >= price)) {\r\n          setTPHasError(true);\r\n          return `${isLong ? 'Long' : 'Short'} TP can't be ${isLong ? 'less' : 'greater'} than entry price.`;\r\n        } else {\r\n          setTPHasError(false);\r\n        }\r\n  \r\n        const borderTakeProfit = Number(getSlTpFromPercentage(isLong, true, 900, price / 10**10, leverage / 10**4));\r\n        if (isLong ? takeProfit > borderTakeProfit : takeProfit < borderTakeProfit) {\r\n          setTPHasError(true);\r\n          return `${isLong ? 'Max' : 'Min'} Take Profit price: ${formatAmount(borderTakeProfit, 10, 2, true)}`;\r\n        } else {\r\n          setTPHasError(false);\r\n        }\r\n      } else {\r\n        setTPHasError(false);\r\n        return `Take Profit is required`;\r\n      }\r\n    }\r\n    \r\n    if (!isSwap && hasExistingPosition && !isMarketOrder) {\r\n      const { delta, hasProfit } = calculatePositionDelta(triggerPriceUsd, existingPosition);\r\n      if (hasProfit && delta.eq(0)) {\r\n        return \"Invalid price, see warning\";\r\n      }\r\n    }\r\n    if (isMarketOrder && hasPendingProfit && !isProfitWarningAccepted) {\r\n      return \"Forfeit profit not checked\";\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (decreaseOrdersThatWillBeExecuted.length > 0 && !isTriggerWarningAccepted) {\r\n      return `Accept confirmation of trigger orders`;\r\n    }\r\n\r\n\r\n    if (!isPendingConfirmation) {\r\n      const error = getError();\r\n      if (error) {\r\n        return error;\r\n      }\r\n\r\n      if (isSwap) {\r\n        return title;\r\n      }\r\n      const action = isMarketOrder ? (isLong ? \"Long\" : \"Short\") : \"Create Order\";\r\n\r\n      if (\r\n        isMarketOrder &&\r\n        MIN_PROFIT_TIME > 0 &&\r\n        hasExistingPosition &&\r\n        existingPosition.delta.eq(0) &&\r\n        existingPosition.pendingDelta.gt(0)\r\n      ) {\r\n        return isLong ? `Forfeit profit and ${action}` : `Forfeit profit and Short`;\r\n      }\r\n\r\n      return isMarketOrder && MIN_PROFIT_TIME > 0 ? `Accept minimum and ${action}` : action;\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      return \"Creating Order...\";\r\n    }\r\n    if (isSwap) {\r\n      return \"Swapping...\";\r\n    }\r\n    if (isLong) {\r\n      return \"Longing...\";\r\n    }\r\n    return \"Shorting...\";\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (getError()) {\r\n      return false;\r\n    }\r\n    if (decreaseOrdersThatWillBeExecuted.length > 0 && !isTriggerWarningAccepted) {\r\n      return false;\r\n    }\r\n    return !isPendingConfirmation && !isSubmitting;\r\n  };\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const spread = getSpread(fromTokenInfo, toTokenInfo, isLong, nativeTokenAddress);\r\n  // it's meaningless for limit/stop orders to show spread based on current prices\r\n  const showSpread = isMarketOrder && !!spread;\r\n\r\n  const renderSpreadWarning = useCallback(() => {\r\n    if (!isMarketOrder) {\r\n      return null;\r\n    }\r\n\r\n    if (spread && spread.isHigh) {\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          The spread is {`>`} 1%, please ensure the trade details are acceptable before comfirming\r\n        </div>\r\n      );\r\n    }\r\n  }, [isMarketOrder, spread]);\r\n\r\n  const renderFeeWarning = useCallback(() => {\r\n    if (orderOption === LIMIT || !feeBps || feeBps <= 60) {\r\n      return null;\r\n    }\r\n\r\n    if (isSwap) {\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          Fees are high to swap from {fromToken.symbol} to {toToken.symbol}.\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (!collateralTokenAddress) {\r\n      return null;\r\n    }\r\n\r\n    const collateralToken = getToken(chainId, collateralTokenAddress);\r\n    return (\r\n      <div className=\"Confirmation-box-warning\">\r\n        Fees are high to swap from {fromToken.symbol} to {collateralToken.symbol}. <br />\r\n        {collateralToken.symbol} is needed for collateral.\r\n      </div>\r\n    );\r\n  }, [feeBps, isSwap, collateralTokenAddress, chainId, fromToken.symbol, toToken.symbol, orderOption]);\r\n\r\n  const hasPendingProfit =\r\n    MIN_PROFIT_TIME > 0 && existingPosition && existingPosition.delta.eq(0) && existingPosition.pendingDelta.gt(0);\r\n\r\n  const renderMinProfitWarning = useCallback(() => {\r\n    if (MIN_PROFIT_TIME === 0) {\r\n      return null;\r\n    }\r\n    if (!isSwap) {\r\n      if (hasExistingPosition) {\r\n        const minProfitExpiration = existingPosition.lastIncreasedTime + MIN_PROFIT_TIME;\r\n        if (isMarketOrder && existingPosition.delta.eq(0) && existingPosition.pendingDelta.gt(0)) {\r\n          const profitPrice = getProfitPrice(existingPosition.markPrice, existingPosition);\r\n          return (\r\n            <div className=\"Confirmation-box-warning\">\r\n              Increasing this position at the current price will forfeit a&nbsp;\r\n              <a\r\n                href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                pending profit\r\n              </a>{\" \"}\r\n              of {existingPosition.deltaStr}.<br />\r\n              <br />\r\n              Profit price: {existingPosition.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}.\r\n              This rule only applies for the next {getTimeRemaining(minProfitExpiration)}, until{\" \"}\r\n              {formatDateTime(minProfitExpiration)}.\r\n            </div>\r\n          );\r\n        }\r\n        if (!isMarketOrder) {\r\n          const { delta, hasProfit } = calculatePositionDelta(triggerPriceUsd, existingPosition);\r\n          if (hasProfit && delta.eq(0)) {\r\n            const profitPrice = getProfitPrice(existingPosition.markPrice, existingPosition);\r\n            return (\r\n              <div className=\"Confirmation-box-warning\">\r\n                This order will forfeit a&nbsp;\r\n                <a\r\n                  href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                >\r\n                  profit\r\n                </a>{\" \"}\r\n                of {existingPosition.deltaStr}.<br />\r\n                Profit price: {existingPosition.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}.\r\n                This rule only applies for the next {getTimeRemaining(minProfitExpiration)}, until{\" \"}\r\n                {formatDateTime(minProfitExpiration)}.\r\n              </div>\r\n            );\r\n          }\r\n        }\r\n      }\r\n\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          A minimum price change of&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            1.5%\r\n          </a>{\" \"}\r\n          is required for a position to be in profit. This only applies for the first {MIN_PROFIT_TIME / 60 / 60} hours\r\n          after increasing a position.\r\n        </div>\r\n      );\r\n    }\r\n  }, [isSwap, hasExistingPosition, existingPosition, isMarketOrder, triggerPriceUsd]);\r\n\r\n  const renderExistingOrderWarning = useCallback(() => {\r\n    if (isSwap || !existingOrder) {\r\n      return;\r\n    }\r\n    const indexToken = getToken(chainId, existingOrder.indexToken);\r\n    const sizeInToken = formatAmount(\r\n      existingOrder.sizeDelta.mul(PRECISION).div(existingOrder.triggerPrice),\r\n      USD_DECIMALS,\r\n      4,\r\n      true\r\n    );\r\n    if (existingOrders?.length > 1) {\r\n      return (\r\n        <div>\r\n          <div className=\"Confirmation-box-info\">\r\n            <span>\r\n              You have multiple existing Increase {existingOrder.isLong ? \"Long\" : \"Short\"} {indexToken.symbol} limit\r\n              orders{\" \"}\r\n            </span>\r\n            <span onClick={() => setIsLimitOrdersVisible((p) => !p)} className=\"view-orders\">\r\n              ({isLimitOrdersVisible ? \"hide\" : \"view\"})\r\n            </span>\r\n          </div>\r\n          {isLimitOrdersVisible && (\r\n            <ul className=\"order-list\">\r\n              {existingOrders.map((order) => {\r\n                const { account, index, type, triggerAboveThreshold, triggerPrice } = order;\r\n                const id = `${account}-${index}`;\r\n                const triggerPricePrefix = triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n                const indexToken = getToken(chainId, order.indexToken);\r\n\r\n                return (\r\n                  <li key={id} className=\"font-sm\">\r\n                    <p>\r\n                      {type === INCREASE ? \"Increase\" : \"Decrease\"} {indexToken.symbol} {isLong ? \"Long\" : \"Short\"}{\" \"}\r\n                      &nbsp;{triggerPricePrefix} ${formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n                    </p>\r\n                    <button onClick={() => onCancelOrderClick(order)}>Cancel</button>\r\n                  </li>\r\n                );\r\n              })}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"Confirmation-box-info\">\r\n        You have an active Limit Order to Increase {existingOrder.isLong ? \"Long\" : \"Short\"} {sizeInToken}{\" \"}\r\n        {indexToken.symbol} (${formatAmount(existingOrder.sizeDelta, USD_DECIMALS, 2, true)}) at price $\r\n        {formatAmount(existingOrder.triggerPrice, USD_DECIMALS, 2, true)}\r\n      </div>\r\n    );\r\n  }, [existingOrder, isSwap, chainId, existingOrders, isLong, isLimitOrdersVisible, onCancelOrderClick]);\r\n\r\n  const renderExistingTriggerErrors = useCallback(() => {\r\n    if (isSwap || decreaseOrdersThatWillBeExecuted?.length < 1) {\r\n      return;\r\n    }\r\n    const existingTriggerOrderLength = decreaseOrdersThatWillBeExecuted.length;\r\n    const orderText = existingTriggerOrderLength > 1 ? \"orders\" : \"order\";\r\n    return (\r\n      <>\r\n        <div className=\"Confirmation-box-warning\">\r\n          You have {existingTriggerOrderLength > 1 ? `${existingTriggerOrderLength}` : \"an\"} active trigger {orderText}{\" \"}\r\n          that might execute immediately after you open this position. Please cancel the {orderText} or accept the\r\n          confirmation to continue.\r\n        </div>\r\n        <ul className=\"order-list\">\r\n          {decreaseOrdersThatWillBeExecuted.map((order) => {\r\n            const { account, index, type, triggerAboveThreshold, triggerPrice } = order;\r\n            const id = `${account}-${index}`;\r\n            const triggerPricePrefix = triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n            const indexToken = getToken(chainId, order.indexToken);\r\n            return (\r\n              <li key={id} className=\"font-sm\">\r\n                <p>\r\n                  {type === INCREASE ? \"Increase\" : \"Decrease\"} {indexToken.symbol} {isLong ? \"Long\" : \"Short\"}\r\n                  &nbsp;{triggerPricePrefix} ${formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n                </p>\r\n                <button\r\n                  onClick={() =>\r\n                    cancelDecreaseOrder(chainId, library, index, {\r\n                      successMsg: \"Order cancelled\",\r\n                      failMsg: \"Cancel failed\",\r\n                      sentMsg: \"Cancel submitted\",\r\n                      pendingTxns,\r\n                      setPendingTxns,\r\n                    })\r\n                  }\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n      </>\r\n    );\r\n  }, [decreaseOrdersThatWillBeExecuted, isSwap, chainId, library, pendingTxns, setPendingTxns, isLong]);\r\n\r\n  const renderExistingTriggerWarning = useCallback(() => {\r\n    if (\r\n      isSwap ||\r\n      existingTriggerOrders.length < 1 ||\r\n      decreaseOrdersThatWillBeExecuted.length > 0 ||\r\n      renderExistingOrderWarning()\r\n    ) {\r\n      return;\r\n    }\r\n    const existingTriggerOrderLength = existingTriggerOrders.length;\r\n    return (\r\n      <div className=\"Confirmation-box-info\">\r\n        You have {existingTriggerOrderLength > 1 ? `${existingTriggerOrderLength}` : \"an\"} active trigger{\" \"}\r\n        {existingTriggerOrderLength > 1 ? \"orders\" : \"order\"} that could impact this position.\r\n      </div>\r\n    );\r\n  }, [existingTriggerOrders, isSwap, decreaseOrdersThatWillBeExecuted, renderExistingOrderWarning]);\r\n\r\n  // TODO handle unaprproved order plugin (very unlikely case)\r\n  const renderMain = useCallback(() => {\r\n    if (isSwap) {\r\n      return (\r\n        <div className=\"Confirmation-box-main\">\r\n          <div className=\"Confirmation-box-main-label\">\r\n            <div className=\"label-title\">Pay</div>&nbsp;{formatAmount(fromAmount, fromToken.decimals, 4, true)} {fromToken.symbol} ($\r\n            {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)})\r\n          </div>\r\n          <div className=\"Confirmation-box-main-icon\"></div>\r\n          <div className=\"Confirmation-box-main-label\">\r\n            <div className=\"label-title\">Recieve</div>&nbsp;{formatAmount(toAmount, toToken.decimals, 4, true)} {toToken.symbol} ($\r\n            {formatAmount(toUsdMax, USD_DECIMALS, 2, true)})\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"Confirmation-box-main\">\r\n        <div className=\"Confirmation-box-main-label\">\r\n          <div className=\"label-title\">Pay</div>&nbsp;{formatAmount(fromAmount, fromToken.decimals, 4, true)} {fromToken.symbol} ($\r\n          {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)})\r\n        </div>\r\n        <div className=\"Confirmation-box-main-icon\"></div>\r\n        <div className=\"Confirmation-box-main-label\">\r\n          <div className=\"label-title\">{isLong ? \"Long\" : \"Short\"}</div>&nbsp;\r\n          {formatAmount(toAmount, toToken.decimals, 4, true)} {toToken.symbol} ($\r\n          {formatAmount(toUsdMax, USD_DECIMALS, 2, true)})\r\n        </div>\r\n      </div>\r\n    );\r\n  }, [isSwap, fromAmount, fromToken, toToken, fromUsdMin, toUsdMax, isLong, toAmount]);\r\n\r\n  const SWAP_ORDER_EXECUTION_GAS_FEE = getConstant(chainId, \"SWAP_ORDER_EXECUTION_GAS_FEE\");\r\n  const INCREASE_ORDER_EXECUTION_GAS_FEE = getConstant(chainId, \"INCREASE_ORDER_EXECUTION_GAS_FEE\");\r\n  const executionFee = isSwap ? SWAP_ORDER_EXECUTION_GAS_FEE : INCREASE_ORDER_EXECUTION_GAS_FEE;\r\n  const renderExecutionFee = useCallback(() => {\r\n    if (isMarketOrder) {\r\n      return null;\r\n    }\r\n    return (\r\n      <ExchangeInfoRow label=\"Execution Fee\">\r\n        {formatAmount(executionFee, 18, 4)} {getNativeToken(chainId).symbol}\r\n      </ExchangeInfoRow>\r\n    );\r\n  }, [isMarketOrder, executionFee, chainId]);\r\n\r\n  const renderAvailableLiquidity = useCallback(() => {\r\n    let availableLiquidity;\r\n\r\n    if (market === 'GNS') {\r\n      availableLiquidity = liquidity[market]?.formattedValue;\r\n      return (\r\n        <ExchangeInfoRow label=\"Available Liquidity\">\r\n          ${availableLiquidity}\r\n        </ExchangeInfoRow>\r\n      );\r\n    }\r\n    \r\n    const riskThresholdBps = 5000;\r\n    let isLiquidityRisk;\r\n    const token = isSwap || isLong ? toTokenInfo : shortCollateralToken;\r\n\r\n    if (!token || !token.poolAmount || !token.availableAmount) {\r\n      return null;\r\n    }\r\n\r\n    if (isSwap) {\r\n      const poolWithoutBuffer = token.poolAmount.sub(token.bufferAmount);\r\n      availableLiquidity = token.availableAmount.gt(poolWithoutBuffer) ? poolWithoutBuffer : token.availableAmount;\r\n      isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(toAmount);\r\n    } else {\r\n      if (isShort) {\r\n        availableLiquidity = token.availableAmount;\r\n\r\n        let adjustedMaxGlobalShortSize;\r\n\r\n        if (toTokenInfo.maxAvailableShort && toTokenInfo.maxAvailableShort.gt(0)) {\r\n          adjustedMaxGlobalShortSize = toTokenInfo.maxAvailableShort\r\n            .mul(expandDecimals(1, token.decimals))\r\n            .div(expandDecimals(1, USD_DECIMALS));\r\n        }\r\n\r\n        if (adjustedMaxGlobalShortSize && adjustedMaxGlobalShortSize.lt(token.availableAmount)) {\r\n          availableLiquidity = adjustedMaxGlobalShortSize;\r\n        }\r\n\r\n        const sizeTokens = toUsdMax.mul(expandDecimals(1, token.decimals)).div(token.minPrice);\r\n        isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(sizeTokens);\r\n      } else {\r\n        availableLiquidity = token.availableAmount;\r\n        isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(toAmount);\r\n      }\r\n    }\r\n\r\n    if (!availableLiquidity) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <ExchangeInfoRow label=\"Available Liquidity\">\r\n        <Tooltip\r\n          position=\"right-bottom\"\r\n          handleClassName={isLiquidityRisk ? \"negative\" : null}\r\n          handle={\r\n            <>\r\n              {formatAmount(availableLiquidity, token.decimals, token.isStable ? 0 : 2, true)} {token.symbol}\r\n            </>\r\n          }\r\n          renderContent={() =>\r\n            isLiquidityRisk\r\n              ? \"There may not be sufficient liquidity to execute your order when the price conditions are met\"\r\n              : \"The order will only execute if the price conditions are met and there is sufficient liquidity\"\r\n          }\r\n        />\r\n      </ExchangeInfoRow>\r\n    );\r\n  }, [toTokenInfo, shortCollateralToken, isShort, isLong, isSwap, toAmount, toUsdMax]);\r\n\r\n  const renderMarginSection = useCallback(() => {\r\n    return (\r\n      <>\r\n        <div>\r\n          {renderMain()}\r\n          {renderFeeWarning()}\r\n          {renderMinProfitWarning()}\r\n          {renderExistingOrderWarning()}\r\n          {renderExistingTriggerErrors()}\r\n          {renderExistingTriggerWarning()}\r\n          {minExecutionFeeErrorMessage && <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>}\r\n          {hasPendingProfit && isMarketOrder && (\r\n            <div className=\"PositionEditor-accept-profit-warning\">\r\n              <Checkbox isChecked={isProfitWarningAccepted} setIsChecked={setIsProfitWarningAccepted}>\r\n                <span className=\"muted\">Forfeit profit</span>\r\n              </Checkbox>\r\n            </div>\r\n          )}\r\n          {orderOption === LIMIT && renderAvailableLiquidity()}\r\n\r\n          {market === 'GNS' && <div className=\"row-divider\" />}\r\n          \r\n          {market === 'GMX' && isShort && (\r\n            <ExchangeInfoRow label=\"Collateral In\" isTop={true}>{getToken(chainId, shortCollateralAddress).symbol}</ExchangeInfoRow>\r\n          )}\r\n          {market === 'GMX' && isLong && <ExchangeInfoRow label=\"Collateral In\" isTop={true} value={toTokenInfo.symbol} />}\r\n          {\r\n            market === 'GMX' &&\r\n            <ExchangeInfoRow label=\"Leverage\">\r\n              {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                <div className=\"inline-block muted\">\r\n                  {formatAmount(existingPosition.leverage, 4, 2)}x\r\n                  <BsArrowRight className=\"transition-arrow\" />\r\n                </div>\r\n              )}\r\n              {toAmount && leverage && leverage.gt(0) && `${formatAmount(leverage, 4, 2)}x`}\r\n              {!toAmount && leverage && leverage.gt(0) && `-`}\r\n              {leverage && leverage.eq(0) && `-`}\r\n            </ExchangeInfoRow>\r\n          }\r\n          {\r\n            market === 'GMX' &&\r\n            <ExchangeInfoRow label=\"Liq. Price\">\r\n              {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                <div className=\"inline-block muted\">\r\n                  ${formatAmount(existingLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                  <BsArrowRight className=\"transition-arrow\" />\r\n                </div>\r\n              )}\r\n              {toAmount && displayLiquidationPrice && `$${formatAmount(displayLiquidationPrice, USD_DECIMALS, 2, true)}`}\r\n              {!toAmount && displayLiquidationPrice && `-`}\r\n              {!displayLiquidationPrice && `-`}\r\n            </ExchangeInfoRow>\r\n          }\r\n          \r\n          <ExchangeInfoRow label=\"Fees\">${formatAmount(feesUsd, USD_DECIMALS, 2, true)}</ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Collateral\">\r\n            <Tooltip\r\n              handle={`$${formatAmount(collateralAfterFees, USD_DECIMALS, 2, true)}`}\r\n              position=\"right-bottom\"\r\n              renderContent={() => {\r\n                return (\r\n                  <>\r\n                    Your position's collateral after deducting fees.\r\n                    <br />\r\n                    <br />\r\n                    <StatsTooltipRow label=\"Pay Amount\" value={formatAmount(fromUsdMin, USD_DECIMALS, 2, true)} />\r\n                    <StatsTooltipRow label=\"Fees\" value={formatAmount(feesUsd, USD_DECIMALS, 2, true)} />\r\n                    <div className=\"Tooltip-divider\" />\r\n                    <StatsTooltipRow\r\n                      label=\"Collateral\"\r\n                      value={formatAmount(collateralAfterFees, USD_DECIMALS, 2, true)}\r\n                    />\r\n                  </>\r\n                );\r\n              }}\r\n            />\r\n          </ExchangeInfoRow>\r\n          {/* {\r\n            market === 'GMX' &&\r\n            showSpread && (\r\n              <ExchangeInfoRow label=\"Spread\" isWarning={spread.isHigh} isTop={true}>\r\n                {formatAmount(spread.value.mul(100), USD_DECIMALS, 2, true)}%\r\n              </ExchangeInfoRow>\r\n            )\r\n          } */}\r\n          {\r\n            market === 'GNS' &&\r\n            <>\r\n              <NumberInput_v3\r\n                value={TPValue}\r\n                setValue={setTPValue}\r\n                title={\"Take Profit\"}\r\n                hasError={TPHasError}\r\n              />\r\n              <NumberInput_v3 \r\n                value={SLValue}\r\n                setValue={setSLValue}\r\n                title={\"Stop Loss\"}\r\n                hasError={SLHasError}\r\n              />\r\n            </>\r\n          }\r\n          {market === 'GNS' && <div className=\"row-divider\" />}\r\n          {isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Entry Price\">\r\n              {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                <div className=\"inline-block muted\">\r\n                  ${formatAmount(existingPosition.averagePrice, USD_DECIMALS, 2, true)}\r\n                  <BsArrowRight className=\"transition-arrow\" />\r\n                </div>\r\n              )}\r\n              {nextAveragePrice && `$${formatAmount(nextAveragePrice, USD_DECIMALS, 2, true)}`}\r\n              {!nextAveragePrice && `-`}\r\n            </ExchangeInfoRow>\r\n          )}\r\n          {!isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Limit Price\">\r\n              ${formatAmount(triggerPriceUsd, USD_DECIMALS, 2, true)}\r\n            </ExchangeInfoRow>\r\n          )}\r\n          {\r\n            market === 'GMX' &&\r\n            <ExchangeInfoRow label=\"Borrow Fee\">\r\n              {isLong && toTokenInfo && formatAmount(toTokenInfo.fundingRate, 4, 4)}\r\n              {isShort && shortCollateralToken && formatAmount(shortCollateralToken.fundingRate, 4, 4)}\r\n              {((isLong && toTokenInfo && toTokenInfo.fundingRate) ||\r\n                (isShort && shortCollateralToken && shortCollateralToken.fundingRate)) &&\r\n                \"% / 1h\"}\r\n            </ExchangeInfoRow>\r\n          }\r\n          \r\n          {isMarketOrder && (\r\n            <div className=\"PositionEditor-allow-higher-slippage\">\r\n              <ExchangeInfoRow label=\"Execution Fee\">\r\n                <Tooltip\r\n                  handle={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol}`}\r\n                  position=\"right-top\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <>\r\n                        <StatsTooltipRow\r\n                          label=\"Network fee\"\r\n                          value={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol} ($${formatAmount(\r\n                            minExecutionFeeUSD,\r\n                            USD_DECIMALS,\r\n                            2\r\n                          )})`}\r\n                        />\r\n                        <br />\r\n                        This is the network cost required to execute the postion.{\" \"}\r\n                        <a\r\n                          href=\"https://gmxio.gitbook.io/gmx/trading#execution-fee\"\r\n                          target=\"_blank\"\r\n                          rel=\"noopener noreferrer\"\r\n                        >\r\n                          More Info\r\n                        </a>\r\n                      </>\r\n                    );\r\n                  }}\r\n                />\r\n              </ExchangeInfoRow>\r\n            </div>\r\n          )}\r\n          {decreaseOrdersThatWillBeExecuted.length > 0 && (\r\n            <div className=\"PositionEditor-allow-higher-slippage\">\r\n              <Checkbox isChecked={isTriggerWarningAccepted} setIsChecked={setIsTriggerWarningAccepted}>\r\n                <span className=\"muted font-sm\">I am aware of the trigger orders</span>\r\n              </Checkbox>\r\n            </div>\r\n          )}\r\n          {renderExecutionFee()}\r\n          <SlippageInput\r\n            value={userSlippage}\r\n            setValue={setUserSlippage}\r\n            />\r\n          <ExchangeInfoRow label=\"Allowed Slippage\" className=\"Slippage-row\">\r\n            <Tooltip\r\n              handle={`${formatAmount(allowedSlippage, 2, 2)}%`}\r\n              position=\"right-top\"\r\n              renderContent={() => {\r\n                return (\r\n                  <>\r\n                    You can change this in the settings menu on the top right of the page.\r\n                    <br />\r\n                    <br />\r\n                    Note that a low allowed slippage, e.g. less than 0.5%, may result in failed orders if prices are\r\n                    volatile.\r\n                  </>\r\n                );\r\n              }}\r\n            />\r\n          </ExchangeInfoRow>\r\n        </div>\r\n      </>\r\n    );\r\n  }, [\r\n    renderMain,\r\n    renderMinProfitWarning,\r\n    shortCollateralAddress,\r\n    isShort,\r\n    isLong,\r\n    toTokenInfo,\r\n    nextAveragePrice,\r\n    toAmount,\r\n    hasExistingPosition,\r\n    existingPosition,\r\n    isMarketOrder,\r\n    triggerPriceUsd,\r\n    showSpread,\r\n    spread,\r\n    displayLiquidationPrice,\r\n    existingLiquidationPrice,\r\n    feesUsd,\r\n    leverage,\r\n    renderExecutionFee,\r\n    shortCollateralToken,\r\n    chainId,\r\n    renderFeeWarning,\r\n    hasPendingProfit,\r\n    isProfitWarningAccepted,\r\n    renderAvailableLiquidity,\r\n    orderOption,\r\n    fromUsdMin,\r\n    collateralAfterFees,\r\n    renderExistingOrderWarning,\r\n    renderExistingTriggerWarning,\r\n    renderExistingTriggerErrors,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    allowedSlippage,\r\n    isTriggerWarningAccepted,\r\n    decreaseOrdersThatWillBeExecuted,\r\n    minExecutionFee,\r\n    nativeTokenSymbol,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  ]);\r\n\r\n  const renderSwapSection = useCallback(() => {\r\n    return (\r\n      <>\r\n        <div>\r\n          {renderMain()}\r\n          {renderFeeWarning()}\r\n          {renderSpreadWarning()}\r\n          {orderOption === LIMIT && renderAvailableLiquidity()}\r\n          <ExchangeInfoRow label=\"Min. Receive\">\r\n            {formatAmount(minOut, toTokenInfo.decimals, 4, true)} {toTokenInfo.symbol}\r\n          </ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Price\">\r\n            {getExchangeRateDisplay(getExchangeRate(fromTokenInfo, toTokenInfo), fromTokenInfo, toTokenInfo)}\r\n          </ExchangeInfoRow>\r\n          {!isMarketOrder && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">Limit Price</div>\r\n              <div className=\"align-right\">{getExchangeRateDisplay(triggerRatio, fromTokenInfo, toTokenInfo)}</div>\r\n            </div>\r\n          )}\r\n          {showSpread && (\r\n            <ExchangeInfoRow label=\"Spread\" isWarning={spread.isHigh}>\r\n              {formatAmount(spread.value.mul(100), USD_DECIMALS, 2, true)}%\r\n            </ExchangeInfoRow>\r\n          )}\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">Fees</div>\r\n            <div className=\"align-right\">\r\n              {formatAmount(feeBps, 2, 2, true)}% ({formatAmount(fees, fromTokenInfo.decimals, 4, true)}{\" \"}\r\n              {fromTokenInfo.symbol}: ${formatAmount(feesUsd, USD_DECIMALS, 2, true)})\r\n            </div>\r\n          </div>\r\n          {renderExecutionFee()}\r\n          {fromTokenUsd && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">{fromTokenInfo.symbol} Price</div>\r\n              <div className=\"align-right\">{fromTokenUsd} USD</div>\r\n            </div>\r\n          )}\r\n          {toTokenUsd && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">{toTokenInfo.symbol} Price</div>\r\n              <div className=\"align-right\">{toTokenUsd} USD</div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </>\r\n    );\r\n  }, [\r\n    renderMain,\r\n    renderSpreadWarning,\r\n    fromTokenInfo,\r\n    toTokenInfo,\r\n    orderOption,\r\n    showSpread,\r\n    spread,\r\n    feesUsd,\r\n    feeBps,\r\n    renderExecutionFee,\r\n    fromTokenUsd,\r\n    toTokenUsd,\r\n    triggerRatio,\r\n    fees,\r\n    isMarketOrder,\r\n    minOut,\r\n    renderFeeWarning,\r\n    renderAvailableLiquidity,\r\n  ]);\r\n\r\n  return (\r\n    <div className=\"Confirmation-box\">\r\n      <Modal isVisible={true} setIsVisible={() => setIsConfirming(false)} label={title} allowContentTouchMove isNifty={true}>\r\n        {isSwap && renderSwapSection()}\r\n        {!isSwap && renderMarginSection()}\r\n        <div className=\"Confirmation-box-row\">\r\n          <button\r\n            onClick={onConfirmationClick}\r\n            className=\"App-cta Confirmation-box-button hlight\"\r\n            disabled={!isPrimaryEnabled()}\r\n          >\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n","import {\r\n  formatAmount,\r\n  bigNumberify,\r\n  isAddressZero,\r\n  USD_DECIMALS,\r\n  MAX_REFERRAL_CODE_LENGTH,\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n} from \"../../lib/legacy\";\r\nimport { encodeReferralCode, getReferralCodeOwner } from \"../../domain/referrals\";\r\n\r\nexport const REFERRAL_CODE_REGEX = /^\\w+$/; // only number, string and underscore is allowed\r\nexport const REGEX_VERIFY_BYTES32 = /^0x[0-9a-f]{64}$/;\r\n\r\nexport function isRecentReferralCodeNotExpired(referralCodeInfo) {\r\n  const REFERRAL_DATA_MAX_TIME = 60000 * 5; // 5 minutes\r\n  if (referralCodeInfo.time) {\r\n    return referralCodeInfo.time + REFERRAL_DATA_MAX_TIME > Date.now();\r\n  }\r\n}\r\n\r\nexport async function getReferralCodeTakenStatus(account, referralCode, chainId) {\r\n  const referralCodeBytes32 = encodeReferralCode(referralCode);\r\n  const [ownerArbitrum, ownerAvax] = await Promise.all([\r\n    getReferralCodeOwner(ARBITRUM, referralCodeBytes32),\r\n    getReferralCodeOwner(AVALANCHE, referralCodeBytes32),\r\n  ]);\r\n\r\n  const takenOnArb =\r\n    !isAddressZero(ownerArbitrum) && (ownerArbitrum !== account || (ownerArbitrum === account && chainId === ARBITRUM));\r\n  const takenOnAvax =\r\n    !isAddressZero(ownerAvax) && (ownerAvax !== account || (ownerAvax === account && chainId === AVALANCHE));\r\n\r\n  const referralCodeTakenInfo = {\r\n    [ARBITRUM]: takenOnArb,\r\n    [AVALANCHE]: takenOnAvax,\r\n    both: takenOnArb && takenOnAvax,\r\n    ownerArbitrum,\r\n    ownerAvax,\r\n  };\r\n\r\n  if (referralCodeTakenInfo.both) {\r\n    return { status: \"all\", info: referralCodeTakenInfo };\r\n  }\r\n  if (referralCodeTakenInfo[chainId]) {\r\n    return { status: \"current\", info: referralCodeTakenInfo };\r\n  }\r\n  if (chainId === AVALANCHE ? referralCodeTakenInfo[ARBITRUM] : referralCodeTakenInfo[AVALANCHE]) {\r\n    return { status: \"other\", info: referralCodeTakenInfo };\r\n  }\r\n  return { status: \"none\", info: referralCodeTakenInfo };\r\n}\r\n\r\nexport function getTierIdDisplay(tierId) {\r\n  return Number(tierId) + 1;\r\n}\r\n\r\nexport const tierRebateInfo = {\r\n  0: 5,\r\n  1: 10,\r\n  2: 15,\r\n};\r\n\r\nexport const tierDiscountInfo = {\r\n  0: 5,\r\n  1: 10,\r\n  2: 10,\r\n};\r\n\r\nfunction areObjectsWithSameKeys(obj1, obj2) {\r\n  return Object.keys(obj1).every((key) => key in obj2);\r\n}\r\n\r\nexport function deserializeSampleStats(input) {\r\n  const parsedData = JSON.parse(input);\r\n  if (!Array.isArray(parsedData)) return [];\r\n  return parsedData\r\n    .map((data) => {\r\n      if (!areObjectsWithSameKeys(getSampleReferrarStat(), data)) return null;\r\n      return Object.keys(data).reduce((acc, cv) => {\r\n        const currentValue = data[cv];\r\n        if (currentValue?.type === \"BigNumber\") {\r\n          acc[cv] = bigNumberify(currentValue.hex || 0);\r\n        } else {\r\n          acc[cv] = currentValue;\r\n        }\r\n        return acc;\r\n      }, {});\r\n    })\r\n    .filter(Boolean);\r\n}\r\n\r\nexport const getSampleReferrarStat = (code = \"\", ownerOnOtherNetwork = \"\", account = \"\") => {\r\n  return {\r\n    discountUsd: bigNumberify(0),\r\n    referralCode: code,\r\n    totalRebateUsd: bigNumberify(0),\r\n    tradedReferralsCount: 0,\r\n    registeredReferralsCount: 0,\r\n    trades: 0,\r\n    volume: bigNumberify(0),\r\n    time: Date.now(),\r\n    ownerOnOtherChain: {\r\n      code: encodeReferralCode(code),\r\n      codeString: code,\r\n      owner: undefined,\r\n      isTaken: !isAddressZero(ownerOnOtherNetwork),\r\n      isTakenByCurrentUser:\r\n        !isAddressZero(ownerOnOtherNetwork) && ownerOnOtherNetwork.toLowerCase() === account.toLowerCase(),\r\n    },\r\n  };\r\n};\r\n\r\nexport function getUSDValue(value, decimals = 2) {\r\n  return `$${formatAmount(value, USD_DECIMALS, decimals, true, \"0.00\")}`;\r\n}\r\n\r\nexport function getCodeError(value) {\r\n  const trimmedValue = value.trim();\r\n  if (!trimmedValue) return \"\";\r\n\r\n  if (trimmedValue.length > MAX_REFERRAL_CODE_LENGTH) {\r\n    return `The referral code can't be more than ${MAX_REFERRAL_CODE_LENGTH} characters.`;\r\n  }\r\n\r\n  if (!REFERRAL_CODE_REGEX.test(trimmedValue)) {\r\n    return \"Only letters, numbers and underscores are allowed.\";\r\n  }\r\n  return \"\";\r\n}\r\n\r\nexport function getTwitterShareUrl(referralCode) {\r\n  const message = \"Trying out trading on @GMX_IO, up to 30x leverage on $BTC, $ETH %0a%0aFor fee discounts use:\";\r\n\r\n  return `http://twitter.com/intent/tweet?text=${message}&url=https://gmx.io?ref=${referralCode}`;\r\n}\r\n","import { ethers } from \"ethers\";\r\nimport { gql } from \"@apollo/client\";\r\nimport { useState, useEffect, useMemo } from \"react\";\r\nimport useSWR from \"swr\";\r\n\r\nimport ReferralStorage from \"../abis/ReferralStorage.json\";\r\nimport {\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  MAX_REFERRAL_CODE_LENGTH,\r\n  bigNumberify,\r\n  isAddressZero,\r\n  helperToast,\r\n  getProvider,\r\n  isHashZero,\r\n  REFERRAL_CODE_KEY,\r\n} from \"../lib/legacy\";\r\nimport { arbitrumReferralsGraphClient, avalancheReferralsGraphClient } from \"./common\";\r\nimport { getContract } from \"../config/Addresses\";\r\nimport { REGEX_VERIFY_BYTES32 } from \"../components/Referrals/referralsHelper\";\r\nimport { fetcher } from \"../lib/contracts/fetcher\";\r\nimport { callContract } from \"../lib/contracts/callContract\";\r\n\r\nconst ACTIVE_CHAINS = [ARBITRUM, AVALANCHE];\r\nconst DISTRIBUTION_TYPE_REBATES = \"1\";\r\nconst DISTRIBUTION_TYPE_DISCOUNT = \"2\";\r\n\r\nfunction getGraphClient(chainId) {\r\n  if (chainId === ARBITRUM) {\r\n    return arbitrumReferralsGraphClient;\r\n  } else if (chainId === AVALANCHE) {\r\n    return avalancheReferralsGraphClient;\r\n  }\r\n  throw new Error(`Unsupported chain ${chainId}`);\r\n}\r\n\r\nexport function decodeReferralCode(hexCode) {\r\n  try {\r\n    return ethers.utils.parseBytes32String(hexCode);\r\n  } catch (ex) {\r\n    let code = \"\";\r\n    hexCode = hexCode.substring(2);\r\n    for (let i = 0; i < 32; i++) {\r\n      code += String.fromCharCode(parseInt(hexCode.substring(i * 2, i * 2 + 2), 16));\r\n    }\r\n    return code.trim();\r\n  }\r\n}\r\n\r\nexport function encodeReferralCode(code) {\r\n  let final = code.replace(/[^\\w_]/g, \"\"); // replace everything other than numbers, string  and underscor to ''\r\n  if (final.length > MAX_REFERRAL_CODE_LENGTH) {\r\n    return ethers.constants.HashZero;\r\n  }\r\n  return ethers.utils.formatBytes32String(final);\r\n}\r\n\r\nasync function getCodeOwnersData(network, account, codes = []) {\r\n  if (codes.length === 0 || !account || !network) {\r\n    return undefined;\r\n  }\r\n  const query = gql`\r\n    query allCodes($codes: [String!]!) {\r\n      referralCodes(where: { code_in: $codes }) {\r\n        owner\r\n        id\r\n      }\r\n    }\r\n  `;\r\n  return getGraphClient(network)\r\n    .query({ query, variables: { codes } })\r\n    .then(({ data }) => {\r\n      const { referralCodes } = data;\r\n      const codeOwners = referralCodes.reduce((acc, cv) => {\r\n        acc[cv.id] = cv.owner;\r\n        return acc;\r\n      }, {});\r\n      return codes.map((code) => {\r\n        const owner = codeOwners[code];\r\n        return {\r\n          code,\r\n          codeString: decodeReferralCode(code),\r\n          owner,\r\n          isTaken: Boolean(owner),\r\n          isTakenByCurrentUser: owner && owner.toLowerCase() === account.toLowerCase(),\r\n        };\r\n      });\r\n    });\r\n}\r\n\r\nexport function useUserCodesOnAllChain(account) {\r\n  const [data, setData] = useState(null);\r\n  const query = gql`\r\n    query referralCodesOnAllChain($account: String!) {\r\n      referralCodes(first: 1000, where: { owner: $account }) {\r\n        code\r\n      }\r\n    }\r\n  `;\r\n  useEffect(() => {\r\n    async function main() {\r\n      const [arbitrumCodes, avalancheCodes] = await Promise.all(\r\n        ACTIVE_CHAINS.map((chainId) => {\r\n          return getGraphClient(chainId)\r\n            .query({ query, variables: { account: (account || \"\").toLowerCase() } })\r\n            .then(({ data }) => {\r\n              return data.referralCodes.map((c) => c.code);\r\n            });\r\n        })\r\n      );\r\n      const [codeOwnersOnAvax = [], codeOwnersOnArbitrum = []] = await Promise.all([\r\n        getCodeOwnersData(AVALANCHE, account, arbitrumCodes),\r\n        getCodeOwnersData(ARBITRUM, account, avalancheCodes),\r\n      ]);\r\n\r\n      setData({\r\n        [ARBITRUM]: codeOwnersOnAvax.reduce((acc, cv) => {\r\n          acc[cv.code] = cv;\r\n          return acc;\r\n        }, {}),\r\n        [AVALANCHE]: codeOwnersOnArbitrum.reduce((acc, cv) => {\r\n          acc[cv.code] = cv;\r\n          return acc;\r\n        }, {}),\r\n      });\r\n    }\r\n\r\n    main();\r\n  }, [account, query]);\r\n  return data;\r\n}\r\n\r\nexport function useReferralsData(chainId, account) {\r\n  const [data, setData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const ownerOnOtherChain = useUserCodesOnAllChain(account);\r\n  useEffect(() => {\r\n    if (!chainId || !account) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    const startOfDayTimestamp = Math.floor(parseInt(Date.now() / 1000) / 86400) * 86400;\r\n    const query = gql`\r\n      query referralData($typeIds: [String!]!, $account: String!, $timestamp: Int!, $referralTotalStatsId: String!) {\r\n        distributions(\r\n          first: 1000\r\n          orderBy: timestamp\r\n          orderDirection: desc\r\n          where: { receiver: $account, typeId_in: $typeIds }\r\n        ) {\r\n          receiver\r\n          amount\r\n          typeId\r\n          token\r\n          transactionHash\r\n          timestamp\r\n        }\r\n        referrerTotalStats: referrerStats(\r\n          first: 1000\r\n          orderBy: volume\r\n          orderDirection: desc\r\n          where: { period: total, referrer: $account }\r\n        ) {\r\n          referralCode\r\n          volume\r\n          trades\r\n          tradedReferralsCount\r\n          registeredReferralsCount\r\n          totalRebateUsd\r\n          discountUsd\r\n        }\r\n        referrerLastDayStats: referrerStats(\r\n          first: 1000\r\n          where: { period: daily, referrer: $account, timestamp: $timestamp }\r\n        ) {\r\n          referralCode\r\n          volume\r\n          trades\r\n          tradedReferralsCount\r\n          registeredReferralsCount\r\n          totalRebateUsd\r\n          discountUsd\r\n        }\r\n        referralCodes(first: 1000, where: { owner: $account }) {\r\n          code\r\n        }\r\n        referralTotalStats: referralStat(id: $referralTotalStatsId) {\r\n          volume\r\n          discountUsd\r\n        }\r\n        referrerTierInfo: referrer(id: $account) {\r\n          tierId\r\n          id\r\n          discountShare\r\n        }\r\n      }\r\n    `;\r\n    setLoading(true);\r\n\r\n    getGraphClient(chainId)\r\n      .query({\r\n        query,\r\n        variables: {\r\n          typeIds: [DISTRIBUTION_TYPE_REBATES, DISTRIBUTION_TYPE_DISCOUNT],\r\n          account: (account || \"\").toLowerCase(),\r\n          timestamp: startOfDayTimestamp,\r\n          referralTotalStatsId: account && `total:0:${account.toLowerCase()}`,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        const rebateDistributions = [];\r\n        const discountDistributions = [];\r\n        res.data.distributions.forEach((d) => {\r\n          const item = {\r\n            timestamp: parseInt(d.timestamp),\r\n            transactionHash: d.transactionHash,\r\n            receiver: ethers.utils.getAddress(d.receiver),\r\n            amount: bigNumberify(d.amount),\r\n            typeId: d.typeId,\r\n            token: ethers.utils.getAddress(d.token),\r\n          };\r\n          if (d.typeId === DISTRIBUTION_TYPE_REBATES) {\r\n            rebateDistributions.push(item);\r\n          } else {\r\n            discountDistributions.push(item);\r\n          }\r\n        });\r\n\r\n        function prepareStatsItem(e) {\r\n          return {\r\n            volume: bigNumberify(e.volume),\r\n            trades: parseInt(e.trades),\r\n            tradedReferralsCount: parseInt(e.tradedReferralsCount),\r\n            registeredReferralsCount: parseInt(e.registeredReferralsCount),\r\n            totalRebateUsd: bigNumberify(e.totalRebateUsd),\r\n            discountUsd: bigNumberify(e.discountUsd),\r\n            referralCode: decodeReferralCode(e.referralCode),\r\n            ownerOnOtherChain: ownerOnOtherChain?.[chainId][e.referralCode],\r\n          };\r\n        }\r\n\r\n        function getCumulativeStats(data = []) {\r\n          return data.reduce(\r\n            (acc, cv) => {\r\n              acc.totalRebateUsd = acc.totalRebateUsd.add(cv.totalRebateUsd);\r\n              acc.volume = acc.volume.add(cv.volume);\r\n              acc.discountUsd = acc.discountUsd.add(cv.discountUsd);\r\n              acc.trades = acc.trades + cv.trades;\r\n              acc.tradedReferralsCount = acc.tradedReferralsCount + cv.tradedReferralsCount;\r\n              acc.registeredReferralsCount = acc.registeredReferralsCount + cv.registeredReferralsCount;\r\n              return acc;\r\n            },\r\n            {\r\n              totalRebateUsd: bigNumberify(0),\r\n              volume: bigNumberify(0),\r\n              discountUsd: bigNumberify(0),\r\n              trades: 0,\r\n              tradedReferralsCount: 0,\r\n              registeredReferralsCount: 0,\r\n            }\r\n          );\r\n        }\r\n\r\n        let referrerTotalStats = res.data.referrerTotalStats.map(prepareStatsItem);\r\n        setData({\r\n          rebateDistributions,\r\n          discountDistributions,\r\n          referrerTotalStats,\r\n          referrerTierInfo: res.data.referrerTierInfo,\r\n          referrerLastDayStats: res.data.referrerLastDayStats.map(prepareStatsItem),\r\n          cumulativeStats: getCumulativeStats(referrerTotalStats),\r\n          codes: res.data.referralCodes.map((e) => decodeReferralCode(e.code)),\r\n          referralTotalStats: res.data.referralTotalStats\r\n            ? {\r\n                volume: bigNumberify(res.data.referralTotalStats.volume),\r\n                discountUsd: bigNumberify(res.data.referralTotalStats.discountUsd),\r\n              }\r\n            : {\r\n                volume: bigNumberify(0),\r\n                discountUsd: bigNumberify(0),\r\n              },\r\n        });\r\n      })\r\n      .catch(console.warn)\r\n      .finally(() => {\r\n        setLoading(false);\r\n      });\r\n  }, [setData, chainId, account, ownerOnOtherChain]);\r\n\r\n  return {\r\n    data: data || null,\r\n    loading,\r\n  };\r\n}\r\n\r\nexport async function registerReferralCode(chainId, referralCode, library, opts) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const referralCodeHex = encodeReferralCode(referralCode);\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, library.getSigner());\r\n  return callContract(chainId, contract, \"registerCode\", [referralCodeHex], opts);\r\n}\r\n\r\nexport async function setTraderReferralCodeByUser(chainId, referralCode, library, opts) {\r\n  const referralCodeHex = encodeReferralCode(referralCode);\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, library.getSigner());\r\n  const codeOwner = await contract.codeOwners(referralCodeHex);\r\n  if (isAddressZero(codeOwner)) {\r\n    const errorMsg = \"Referral code does not exist\";\r\n    helperToast.error(errorMsg);\r\n    return Promise.reject(errorMsg);\r\n  }\r\n  return callContract(chainId, contract, \"setTraderReferralCodeByUser\", [referralCodeHex], opts);\r\n}\r\n\r\nexport async function getReferralCodeOwner(chainId, referralCode) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const provider = getProvider(null, chainId);\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, provider);\r\n  const codeOwner = await contract.codeOwners(referralCode);\r\n  return codeOwner;\r\n}\r\n\r\nexport function useUserReferralCode(library, chainId, account) {\r\n  const localStorageCode = window.localStorage.getItem(REFERRAL_CODE_KEY);\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: onChainCode } = useSWR(\r\n    account && [\"ReferralStorage\", chainId, referralStorageAddress, \"traderReferralCodes\", account],\r\n    { fetcher: fetcher(library, ReferralStorage) }\r\n  );\r\n  const { data: localStorageCodeOwner } = useSWR(\r\n    localStorageCode &&\r\n      REGEX_VERIFY_BYTES32.test(localStorageCode) && [\r\n        \"ReferralStorage\",\r\n        chainId,\r\n        referralStorageAddress,\r\n        \"codeOwners\",\r\n        localStorageCode,\r\n      ],\r\n    { fetcher: fetcher(library, ReferralStorage) }\r\n  );\r\n  const [attachedOnChain, userReferralCode, userReferralCodeString] = useMemo(() => {\r\n    if (onChainCode && !isHashZero(onChainCode)) {\r\n      return [true, onChainCode, decodeReferralCode(onChainCode)];\r\n    } else if (localStorageCodeOwner && !isAddressZero(localStorageCodeOwner)) {\r\n      return [false, localStorageCode, decodeReferralCode(localStorageCode)];\r\n    }\r\n    return [false];\r\n  }, [localStorageCode, localStorageCodeOwner, onChainCode]);\r\n\r\n  return {\r\n    userReferralCode,\r\n    userReferralCodeString,\r\n    attachedOnChain,\r\n  };\r\n}\r\n\r\nexport function useReferrerTier(library, chainId, account) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: referrerTier, mutate: mutateReferrerTier } = useSWR(\r\n    account && [`ReferralStorage:referrerTiers`, chainId, referralStorageAddress, \"referrerTiers\", account],\r\n    {\r\n      fetcher: fetcher(library, ReferralStorage),\r\n    }\r\n  );\r\n  return {\r\n    referrerTier,\r\n    mutateReferrerTier,\r\n  };\r\n}\r\n\r\nexport function useCodeOwner(library, chainId, account, code) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: codeOwner, mutate: mutateCodeOwner } = useSWR(\r\n    account && code && [`ReferralStorage:codeOwners`, chainId, referralStorageAddress, \"codeOwners\", code],\r\n    {\r\n      fetcher: fetcher(library, ReferralStorage),\r\n    }\r\n  );\r\n  return {\r\n    codeOwner,\r\n    mutateCodeOwner,\r\n  };\r\n}\r\n\r\nexport async function validateReferralCodeExists(referralCode, chainId) {\r\n  const referralCodeBytes32 = encodeReferralCode(referralCode);\r\n  const referralCodeOwner = await getReferralCodeOwner(chainId, referralCodeBytes32);\r\n  return !isAddressZero(referralCodeOwner);\r\n}\r\n\r\nexport function useAffiliateCodes(chainId, account) {\r\n  const [affiliateCodes, setAffiliateCodes] = useState({ code: null, success: false });\r\n  const query = gql`\r\n    query userReferralCodes($account: String!) {\r\n      referrerTotalStats: referrerStats(\r\n        first: 1000\r\n        orderBy: volume\r\n        orderDirection: desc\r\n        where: { period: total, referrer: $account }\r\n      ) {\r\n        referralCode\r\n      }\r\n    }\r\n  `;\r\n  useEffect(() => {\r\n    if (!chainId) return;\r\n    getGraphClient(chainId)\r\n      .query({ query, variables: { account: account?.toLowerCase() } })\r\n      .then((res) => {\r\n        const parsedAffiliateCodes = res?.data?.referrerTotalStats.map((c) => decodeReferralCode(c?.referralCode));\r\n        setAffiliateCodes({ code: parsedAffiliateCodes[0], success: true });\r\n      });\r\n    return () => {\r\n      setAffiliateCodes({ code: null, success: false });\r\n    };\r\n  }, [chainId, query, account]);\r\n  return affiliateCodes;\r\n}\r\n","import { getNativeToken } from \"../../config/Tokens\";\r\nimport { ethers } from \"ethers\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport { TokenInfo, Token } from \"../../domain/tokens/types\";\r\nimport { get1InchSwapUrl } from \"../../domain/common\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\ntype Props = {\r\n  chainId: number;\r\n  modalError: string;\r\n  isShort: boolean;\r\n  isLong: boolean;\r\n  fromToken: Token;\r\n  toToken: Token;\r\n  shortCollateralToken: TokenInfo;\r\n  setModalError: () => void;\r\n};\r\n\r\nexport default function NoLiquidityErrorModal({\r\n  chainId,\r\n  fromToken,\r\n  toToken,\r\n  shortCollateralToken,\r\n  isLong,\r\n  isShort,\r\n  modalError,\r\n  setModalError,\r\n}: Props) {\r\n  const nativeToken = getNativeToken(chainId);\r\n  const inputCurrency = fromToken.address === AddressZero ? nativeToken.symbol : fromToken.address;\r\n  let outputCurrency;\r\n  if (isLong) {\r\n    outputCurrency = toToken.address === AddressZero ? nativeToken.symbol : toToken.address;\r\n  } else {\r\n    outputCurrency = shortCollateralToken.address;\r\n  }\r\n  const swapTokenSymbol = isLong ? toToken.symbol : shortCollateralToken.symbol;\r\n  const oneInchSwapUrl = get1InchSwapUrl(chainId, inputCurrency, outputCurrency);\r\n  const label =\r\n    modalError === \"BUFFER\" ? `${shortCollateralToken.symbol} Required` : `${fromToken.symbol} Pool Capacity Reached`;\r\n\r\n  return (\r\n    <Modal isVisible={Boolean(modalError)} setIsVisible={setModalError} label={label} isNifty={true} className=\"Error-modal font-base\">\r\n      <div className=\"Modal__text\">\r\n        <div>\r\n          You need to select {swapTokenSymbol} as the \"Pay\" token to use it for collateral to initiate this trade.\r\n        </div>\r\n        <br />\r\n        <div>\r\n          As there is not enough liquidity in GLP to swap {fromToken.symbol} to {swapTokenSymbol}, you can use the option\r\n          below to do so:\r\n        </div>\r\n        <br />\r\n\r\n        <a className=\"Modal__link\" href={oneInchSwapUrl} target=\"_blank\" rel=\"noreferrer\">\r\n          Buy {swapTokenSymbol} on 1inch\r\n        </a>\r\n\r\n        {isShort && (\r\n          <div>\r\n            Alternatively you can select a different \"Collateral In\" token.\r\n            <br />\r\n            <br />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport cx from 'classnames';\r\n\r\nconst Modal = (props) => {\r\n\tconst {\r\n\t\tchildren, \r\n\t\tclassName, \r\n\t\tvisible, \r\n\t\tsetVisible, \r\n\t\tresetModal, \r\n\t\tisObligatory\r\n\t} = props;\r\n\t\r\n\tconst classes = cx('modal', className, visible && 'active');\r\n\r\n\tuseEffect(() => {\r\n\t\tif (resetModal) {\r\n\t\t\tresetModal();\r\n\t\t}\r\n\t}, [visible]);\r\n\r\n\tconst closeModal = () => {\r\n\t\tif (isObligatory) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tsetVisible(false);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<div className={classes} onMouseDown={closeModal}>\r\n\t\t\t<div className=\"modal__content-wrapper\">\r\n\t\t\t\t<div className=\"modal__content\" onMouseDown={e => e.stopPropagation()}>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{!isObligatory && \r\n\t\t\t\t<button className=\"close-btn\" onClick={closeModal}></button>}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Modal;","export const HOMEPAGE_HREF = \"/perpetuals\";\r\n\r\nexport const BORDER_COEF = 0.01;\r\nexport const APY = '10.00%';\r\n\r\nexport const marketsList = [\r\n  {\r\n    name: 'GMX',\r\n  },\r\n  {\r\n    name: 'GNS',\r\n  },\r\n];\r\n\r\nexport const GNS_FEES_MULTIPLIER = 0.0008;\r\n\r\n\r\n// Options constants\r\nexport const OPTIONS_DECIMALS = 18;\r\nexport const OPTION_LIST_FRONTIER = 30;\r\nexport const marketsOptions = ['Hegic', 'Lyra', 'Premia'];\r\n\r\nexport const PremiaStrikeRangeMultiplier = {\r\n  Call: [0.8, 2],\r\n  Put: [0.5, 1.2],\r\n}\r\n\r\nexport const tokenDecimals = {\r\n  ETH: 18,\r\n  BTC: 8\r\n}","import React, { useState } from 'react';\r\nimport Modal from './Modal';\r\nimport './ChooseMarketModal.scss';\r\nimport { marketsList } from '../../utils/constants';\r\n\r\nconst ChooseMarketModal = (props) => {\r\n\tconst {\r\n\t\tvisible,\r\n\t\tsetVisible,\r\n\t\tsetMarkets,\r\n\t\tmarkets,\r\n\t\tliqs,\r\n\t} = props;\r\n\r\n\r\n\tconst [draftMarkets, setDraftMarkets] = useState(markets);\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\tclassName=\"ChooseMarket\"\r\n\t\t\tvisible={visible}\r\n\t\t\tsetVisible={setVisible}\r\n\t\t\tresetModal={() => {\r\n\t\t\t\tif (draftMarkets.length) {\r\n\t\t\t\t\tsetMarkets(draftMarkets.slice());\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetMarkets(marketsList.slice());\r\n\t\t\t\t}\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<h1 className=\"ChooseMarket__title modal__title\">\r\n\t\t\t\tChoose Markets\r\n\t\t\t</h1>\r\n\t\t\t<div className=\"ChooseMarket__items\">\r\n\t\t\t\t{\r\n\t\t\t\t\tmarketsList.map(market => {\r\n\t\t\t\t\t\tconst icon = require(`../../../img/icon-${market.name}.svg`).default;\r\n\t\t\t\t\t\tif (!liqs) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst liqInfo = liqs[market.name];\r\n\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName=\"ChooseMarket__item App-box\"\r\n\t\t\t\t\t\t\t\tkey={market.name}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<div className=\"ChooseMarket__item-header\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"ChooseMarket__item-name\">\r\n\t\t\t\t\t\t\t\t\t\t<img src={icon ?? ''} alt={market.name + \" Icon\"} />\r\n\t\t\t\t\t\t\t\t\t\t{market.name}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"ChooseMarket__item-checkbox input-container\">\r\n\t\t\t\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\" \r\n\t\t\t\t\t\t\t\t\t\t\tdefaultChecked={!!draftMarkets?.find((el) => el.name === market.name)}\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (e.target.checked) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdraftMarkets.push(market);\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst index = draftMarkets.findIndex(el => el.name === market.name);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdraftMarkets.splice(index, 1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<label />\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"ChooseMarket__item-info text-table\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__row\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-table__left\">\r\n\t\t\t\t\t\t\t\t\t\t\tAvailable Liquidity\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-table__right\">\r\n\t\t\t\t\t\t\t\t\t\t\t${liqInfo?.formattedValue}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t\t<button \r\n\t\t\t\tclassName=\"ChooseMarket__btn btn btn_hlight\"\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tif (draftMarkets.length) {\r\n\t\t\t\t\t\tsetMarkets(draftMarkets.slice());\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetMarkets(marketsList.slice());\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetVisible(false);\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\tConfirm market\r\n\t\t\t</button>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default ChooseMarketModal;","export const GNS_PAIRS = {\r\n\tBTC: 0,\r\n\tETH: 1,\r\n\tLINK: 2,\r\n\tUNI: 17,\r\n};\r\nexport const WEI_DECIMALS = 18;","import React, { useState } from 'react';\r\nimport { formatForContract } from '../../utils/math';\r\nimport Modal from './Modal';\r\nimport { formatAmount, USD_DECIMALS } from './../../../views/gmx-test/lib/legacy';\r\nimport NumberInput_v3 from './../input/NumberInput_v3';\r\n\r\nconst SLTPModal = (props) => {\r\n\tconst {\r\n\t\tvisible,\r\n\t\tsetVisible,\r\n\t\tisTP,\r\n\t\tonApply,\r\n\t\ttitle,\r\n\t\tbtnText,\r\n\t\tposition,\r\n\t} = props;\r\n\r\n\tconst [value, setValue] = useState('');\r\n\tconst [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n\tconst getError = () => {\r\n\t\tif (!position) {\r\n\t\t\treturn btnText;\r\n\t\t}\r\n\r\n\t\tif (!value) {\r\n\t\t\treturn btnText;\r\n\t\t}\r\n\r\n\t\tif (isSubmitting) {\r\n\t\t\treturn btnText;\r\n\t\t}\r\n\t\t\r\n\t\tconst isLong = position.isLong;\r\n\t\tconst price = Number(formatAmount(position.markPrice, 20, 0, 0));\r\n\t\tconst val = formatForContract(value, 10);\r\n\r\n\t\tif (val === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!isTP) {\r\n      if ((isLong && val > price) || (!isLong && val < price)) {\r\n        return `${isLong ? 'Long' : 'Short'} SL can't be ${isLong ? 'greater' : 'less'} than mark price.`;\r\n      }\r\n    }\r\n    if (isTP) {\r\n      if ((isLong && val < price) || (!isLong && val > price)) {\r\n        return `${isLong ? 'Long' : 'Short'} TP can't be ${isLong ? 'less' : 'greater'} than mark price.`;\r\n      }\r\n    }\r\n\t}\r\n\r\n\tconst getBtnText = () => {\r\n\t\tconst error = getError();\r\n\t\tif (error) {\r\n\t\t\treturn error;\r\n\t\t}\r\n\r\n\t\treturn btnText;\r\n\t}\r\n\tconst isBtnEnabled = () => {\r\n\t\tconst hasError = Boolean(getError());\r\n\t\t\r\n\t\tif (hasError) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\tclassName=\"SLTP\"\r\n\t\t\tvisible={visible}\r\n\t\t\tsetVisible={setVisible}\r\n\t\t\tresetModal={() => setValue('')}\r\n\t\t>\r\n\t\t\t<h1 className=\"modal__title\">{title}</h1>\r\n\t\t\t<div className=\"modal__body\">\r\n\t\t\t\t<NumberInput_v3\r\n\t\t\t\t\ttitle='Price'\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tsetValue={setValue}\r\n\t\t\t\t\tdisplayValue={formatAmount(position?.markPrice, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\tdisplayValueTitle={'Mark'}\r\n\t\t\t\t/>\r\n\t\t\t\t<div className=\"text-inline\">\r\n\t\t\t\t\t<p style={{fontSize: 15, lineHeight: 19.5/15}}>\r\n\t\t\t\t\t\tTo remove, set the value to 0\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button \r\n\t\t\t\t\tclassName=\"SLTP__btn modal__btn btn btn_hlight\"\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetIsSubmitting(true);\r\n\t\t\t\t\t\tonApply(value, setIsSubmitting);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tdisabled={!isBtnEnabled()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{getBtnText()}\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default SLTPModal;","import React, { useState } from 'react';\r\nimport './Selector.scss';\r\nimport cx from 'classnames';\r\n\r\nconst Selector = (props) => {\r\n\tconst {\r\n\t\titems,\r\n\t\tchosenItem,\r\n\t\tonSelect,\r\n\t} = props;\r\n\r\n\r\n\tconst [isOpen, setIsOpen] = useState(false);\r\n\tconst cls = cx(\"Selector\", isOpen && 'open');\r\n\r\n\tconst openSelector = (e) => {\r\n\t\tif (isOpen) {\r\n\t\t\tcloseSelector();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\te.stopPropagation();\r\n\t\tdocument.addEventListener('click', closeSelector);\r\n\t\tsetIsOpen(true);\r\n\t}\r\n\tconst closeSelector = () => {\r\n\t\tdocument.removeEventListener('click', closeSelector);\r\n\t\tsetIsOpen(false);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className={cls}>\r\n\t\t\t<button\r\n\t\t\t\tclassName=\"Selector__chosen-item\"\r\n\t\t\t\tonClick={openSelector}\r\n\t\t\t>\r\n\t\t\t\t<div className=\"Selector__chosen-item-info icon-container\">\r\n\t\t\t\t\t<img\r\n\t\t\t\t\t\tsrc={\r\n\t\t\t\t\t\t\tchosenItem &&\r\n\t\t\t\t\t\t\t\trequire(`../../../img/icon-${chosenItem}.svg`).default\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\talt={`${chosenItem} icon`}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{chosenItem}\r\n\t\t\t\t</div>\r\n\t\t\t\t<img className=\"icon-down\" src={\r\n\t\t\t\t\trequire(`../../../img/icon-down-small-white.svg`).default\r\n\t\t\t\t} alt=\"chevron down\" />\r\n\t\t\t</button>\r\n\t\t\t<div className=\"Selector__items\">\r\n\t\t\t\t{items.map(item => {\r\n\t\t\t\t\tif (item === chosenItem) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"Selector__item icon-container\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tonSelect(item);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tsrc={\r\n\t\t\t\t\t\t\t\t\titem &&\r\n\t\t\t\t\t\t\t\t\t\trequire(`../../../img/icon-${item}.svg`).default\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\talt={`${item} icon`}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{item}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Selector;","import React, { useEffect, useMemo, useState } from \"react\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport { t, Trans } from \"@lingui/macro\";\r\nimport Slider, { SliderTooltip } from \"rc-slider\";\r\nimport \"rc-slider/assets/index.css\";\r\nimport \"./SwapBox.scss\";\r\n\r\nimport cx from \"classnames\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport { IoMdSwap } from \"react-icons/io\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\nimport { BigNumber } from \"ethers\";\r\nimport { notifySuccess, errAlert } from '../../../../components/utils/notifications';\r\n\r\nimport {\r\n  adjustForDecimals,\r\n  approveTokens,\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  BASIS_POINTS_DIVISOR,\r\n  bigNumberify,\r\n  calculatePositionDelta,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  DUST_BNB,\r\n  expandDecimals,\r\n  formatAmount,\r\n  formatAmountFree,\r\n  getChainName,\r\n  getExchangeRate,\r\n  getExchangeRateDisplay,\r\n  getLeverage,\r\n  getLiquidationPrice,\r\n  getMostAbundantStableToken,\r\n  getNextFromAmount,\r\n  getNextToAmount,\r\n  getPositionKey,\r\n  getTokenInfo,\r\n  getUsd,\r\n  helperToast,\r\n  IS_NETWORK_DISABLED,\r\n  isSupportedChain,\r\n  isTriggerRatioInverted,\r\n  LEVERAGE_ORDER_OPTIONS,\r\n  LIMIT,\r\n  LONG,\r\n  MARGIN_FEE_BASIS_POINTS,\r\n  MARKET,\r\n  parseValue,\r\n  PRECISION,\r\n  replaceNativeTokenAddress,\r\n  SHORT,\r\n  shouldRaiseGasError,\r\n  STOP,\r\n  SWAP,\r\n  SWAP_OPTIONS,\r\n  SWAP_ORDER_OPTIONS,\r\n  USD_DECIMALS,\r\n  USDG_ADDRESS,\r\n  USDG_DECIMALS,\r\n  useLocalStorageByChainId,\r\n  useLocalStorageSerializeKey,\r\n  usePrevious,\r\n  MAX_ALLOWED_LEVERAGE,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport * as Api from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport Tab from \"../Tab/Tab\";\r\nimport TokenSelector from \"./TokenSelector\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport ConfirmationBox from \"./ConfirmationBox\";\r\n\r\nimport { getToken, getTokenBySymbol, getTokens, getWhitelistedTokens } from \"../../config/Tokens\";\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Router from \"../../abis/Router.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport WETH from \"../../abis/WETH.json\";\r\n\r\nimport longImg from \"../../img/ddl/long.svg\";\r\nimport shortImg from \"../../img/ddl/short.svg\";\r\nimport swapImg from \"../../img/swap.svg\";\r\nimport longActiveImg from \"../../img/ddl/long_active.svg\";\r\nimport shortActiveImg from \"../../img/ddl/short_active.svg\";\r\n\r\nimport { useUserReferralCode } from \"../../domain/referrals\";\r\nimport NoLiquidityErrorModal from \"./NoLiquidityErrorModal\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\nimport icon_settings from '../../../../img/icon-settings.svg';\r\nimport ChooseMarketModal from './../../../../components/UI/modal/ChooseMarketModal';\r\nimport { separateThousands } from './../../../../components/utils/sepThousands';\r\nimport { floor, formatForContract } from './../../../../components/utils/math';\r\nimport GNS_Storage from '../../abis/GNS/GNS_Storage.json';\r\nimport GNS_Trading from '../../abis/GNS/GNS_Trading.json';\r\nimport { GNS_PAIRS, WEI_DECIMALS } from './../../lib/GNS_legacy';\r\nimport { DEFAULT_SLIPPAGE_AMOUNT } from './../../lib/legacy';\r\nimport SLTPModal from './../../../../components/UI/modal/SLTPModal';\r\nimport { signer } from './../../../../components/utils/providers';\r\nimport { USDC } from '../../../../components/utils/contracts';\r\nimport { marketsList } from \"../../../../components/utils/constants\";\r\nimport Selector from './../../../../components/UI/Selector/Selector';\r\n\r\nconst SWAP_ICONS = {\r\n  [LONG]: longImg,\r\n  [SHORT]: shortImg,\r\n  [SWAP]: swapImg,\r\n  Long_active: longActiveImg,\r\n  Short_active: shortActiveImg,\r\n};\r\nconst { AddressZero } = ethers.constants;\r\n\r\nconst leverageSliderHandle = (props) => {\r\n  const { value, dragging, index, ...restProps } = props;\r\n  return (\r\n    <SliderTooltip\r\n      prefixCls=\"rc-slider-tooltip\"\r\n      overlay={`${value}`}\r\n      visible={dragging}\r\n      placement=\"top\"\r\n      key={index}\r\n    >\r\n      <Slider.Handle value={value} {...restProps} />\r\n    </SliderTooltip>\r\n  );\r\n};\r\n\r\nfunction getNextAveragePrice({ size, sizeDelta, hasProfit, delta, nextPrice, isLong }) {\r\n  if (!size || !sizeDelta || !delta || !nextPrice) {\r\n    return;\r\n  }\r\n  const nextSize = size.add(sizeDelta);\r\n  let divisor;\r\n  if (isLong) {\r\n    divisor = hasProfit ? nextSize.add(delta) : nextSize.sub(delta);\r\n  } else {\r\n    divisor = hasProfit ? nextSize.sub(delta) : nextSize.add(delta);\r\n  }\r\n  if (!divisor || divisor.eq(0)) {\r\n    return;\r\n  }\r\n  const nextAveragePrice = nextPrice.mul(nextSize).div(divisor);\r\n  return nextAveragePrice;\r\n}\r\n\r\nexport default function SwapBox(props) {\r\n  const {\r\n    positions,\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    infoTokens,\r\n    active,\r\n    library,\r\n    account,\r\n    fromTokenAddress,\r\n    setFromTokenAddress,\r\n    toTokenAddress,\r\n    setToTokenAddress,\r\n    swapOption,\r\n    setSwapOption,\r\n    positionsMap,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    tokenSelection,\r\n    setTokenSelection,\r\n    setIsConfirming,\r\n    isConfirming,\r\n    isPendingConfirmation,\r\n    setIsPendingConfirmation,\r\n    flagOrdersEnabled,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    savedSlippageAmount,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    orders,\r\n    savedIsPnlInLeverage,\r\n    orderBookApproved,\r\n    positionRouterApproved,\r\n    isWaitingForPluginApproval,\r\n    approveOrderBook,\r\n    approvePositionRouter,\r\n    setIsWaitingForPluginApproval,\r\n    isWaitingForPositionRouterApproval,\r\n    setIsWaitingForPositionRouterApproval,\r\n    isPluginApproving,\r\n    isPositionRouterApproving,\r\n    savedShouldDisableValidationForTesting,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n    pendingPositionsGNS,\r\n    setPendingPositionsGNS,\r\n  } = props;\r\n\r\n  \r\n\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n  const [toValue, setToValue] = useState(\"\");\r\n  const [anchorOnFromAmount, setAnchorOnFromAmount] = useState(true);\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isWaitingForApproval, setIsWaitingForApproval] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [modalError, setModalError] = useState(false);\r\n  const [isHigherSlippageAllowed, setIsHigherSlippageAllowed] = useState(false);\r\n  const { attachedOnChain, userReferralCode } = useUserReferralCode(library, chainId, account);\r\n\r\n  const [userSlippage, setUserSlippage] = useState(DEFAULT_SLIPPAGE_AMOUNT / 100);\r\n  const allowedSlippage = userSlippage ? userSlippage * 100 : DEFAULT_SLIPPAGE_AMOUNT;\r\n\r\n  const defaultCollateralSymbol = getConstant(chainId, \"defaultCollateralSymbol\");\r\n  // TODO hack with useLocalStorageSerializeKey\r\n  const [shortCollateralAddress, setShortCollateralAddress] = useLocalStorageByChainId(\r\n    chainId,\r\n    \"Short-Collateral-Address\",\r\n    getTokenBySymbol(chainId, defaultCollateralSymbol).address\r\n  );\r\n  \r\n  const isLong = swapOption === LONG;\r\n  const isShort = swapOption === SHORT;\r\n  const isSwap = swapOption === SWAP;\r\n\r\n  const getLeaderboardLink = () => {\r\n    if (chainId === ARBITRUM) {\r\n      return \"https://www.gmx.house/arbitrum/leaderboard\";\r\n    }\r\n    if (chainId === AVALANCHE) {\r\n      return \"https://www.gmx.house/avalanche/leaderboard\";\r\n    }\r\n    return \"https://www.gmx.house\";\r\n  };\r\n\r\n  function getTokenLabel() {\r\n    switch (true) {\r\n      case isLong:\r\n        return t`Long`;\r\n      case isShort:\r\n        return t`Short`;\r\n      case isSwap:\r\n        return t`Receive`;\r\n      default:\r\n        return \"\";\r\n    }\r\n  }\r\n  const [leverageOption, setLeverageOption] = useLocalStorageSerializeKey(\r\n    [chainId, \"Exchange-swap-leverage-option\"],\r\n    \"2\"\r\n  );\r\n  const [isLeverageSliderEnabled, setIsLeverageSliderEnabled] = useLocalStorageSerializeKey(\r\n    [chainId, \"Exchange-swap-leverage-slider-enabled\"],\r\n    true\r\n  );\r\n\r\n\r\n  const hasLeverageOption = isLeverageSliderEnabled && !isNaN(parseFloat(leverageOption));\r\n\r\n  const [ordersToaOpen, setOrdersToaOpen] = useState(false);\r\n\r\n  // Market/Limit orders disabling\r\n  let [orderOption, setOrderOption] = useLocalStorageSerializeKey([chainId, \"Order-option\"], MARKET);\r\n  \r\n  if (!flagOrdersEnabled) {\r\n    orderOption = MARKET;\r\n  }\r\n\r\n  const onOrderOptionChange = (option) => {\r\n    setOrderOption(option);\r\n  };\r\n\r\n  const isMarketOrder = orderOption === MARKET;\r\n\r\n  \r\n  const orderOptions = isSwap ? SWAP_ORDER_OPTIONS : LEVERAGE_ORDER_OPTIONS;\r\n  const orderOptionLabels = { [STOP]: \"Trigger\" };\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(\"\");\r\n  const triggerPriceUsd = isMarketOrder ? 0 : parseValue(triggerPriceValue, USD_DECIMALS);\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const onTriggerRatioChange = (evt) => {\r\n    setTriggerRatioValue(evt.target.value || \"\");\r\n  };\r\n\r\n  let positionKey;\r\n  if (isLong) {\r\n    positionKey = getPositionKey(account, toTokenAddress, toTokenAddress, true, nativeTokenAddress);\r\n  }\r\n  if (isShort) {\r\n    positionKey = getPositionKey(account, shortCollateralAddress, toTokenAddress, false, nativeTokenAddress);\r\n  }\r\n\r\n  const existingPosition = positionKey ? positionsMap[positionKey] : undefined;\r\n  const hasExistingPosition = existingPosition && existingPosition.size && existingPosition.size.gt(0);\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  \r\n  // Tokens control\r\n  const tokens = getTokens(chainId);\r\n  const fromTokens = tokens;\r\n\r\n  const stableTokens = tokens.filter((token) => token.isStable);\r\n  const indexTokens = whitelistedTokens.filter((token) => !token.isStable && !token.isWrapped);\r\n  const shortableTokens = indexTokens.filter((token) => token.isShortable);\r\n\r\n  let toTokens = tokens;\r\n  if (isLong) {\r\n    toTokens = indexTokens;\r\n  }\r\n  if (isShort) {\r\n    toTokens = shortableTokens;\r\n  }\r\n\r\n  const needOrderBookApproval = !isMarketOrder && !orderBookApproved;\r\n  const prevNeedOrderBookApproval = usePrevious(needOrderBookApproval);\r\n\r\n  const needPositionRouterApproval = (isLong || isShort) && isMarketOrder && !positionRouterApproved;\r\n  const prevNeedPositionRouterApproval = usePrevious(needPositionRouterApproval);\r\n\r\n  useEffect(() => {\r\n    if (!needOrderBookApproval && prevNeedOrderBookApproval && isWaitingForPluginApproval) {\r\n      setIsWaitingForPluginApproval(false);\r\n      helperToast.success(<div>Orders enabled!</div>);\r\n    }\r\n  }, [needOrderBookApproval, prevNeedOrderBookApproval, setIsWaitingForPluginApproval, isWaitingForPluginApproval]);\r\n\r\n  useEffect(() => {\r\n    if (!needPositionRouterApproval && prevNeedPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      setIsWaitingForPositionRouterApproval(false);\r\n      helperToast.success(<div>Leverage enabled!</div>);\r\n    }\r\n  }, [\r\n    needPositionRouterApproval,\r\n    prevNeedPositionRouterApproval,\r\n    setIsWaitingForPositionRouterApproval,\r\n    isWaitingForPositionRouterApproval,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (!needOrderBookApproval && prevNeedOrderBookApproval && isWaitingForPluginApproval) {\r\n      setIsWaitingForPluginApproval(false);\r\n      helperToast.success(<div>Orders enabled!</div>);\r\n    }\r\n  }, [needOrderBookApproval, prevNeedOrderBookApproval, setIsWaitingForPluginApproval, isWaitingForPluginApproval]);\r\n\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const tokenAllowanceAddress = fromTokenAddress === AddressZero ? nativeTokenAddress : fromTokenAddress;\r\n  const { data: tokenAllowance } = useSWR(\r\n    active && [active, chainId, tokenAllowanceAddress, \"allowance\", account, routerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n  const { data: tokenAllowanceGNS } = useSWR(\r\n    active && [active, chainId, tokenAllowanceAddress, \"allowance\", account, GNS_Storage.address],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  \r\n  const { data: hasOutdatedUi } = Api.useHasOutdatedUi();\r\n  \r\n  const fromToken = getToken(chainId, fromTokenAddress);\r\n  const toToken = getToken(chainId, toTokenAddress);\r\n  const shortCollateralToken = getTokenInfo(infoTokens, shortCollateralAddress);\r\n\r\n  const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  const renderAvailableLongLiquidity = () => {\r\n    if (!isLong) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div className=\"Exchange-info-row\">\r\n        <div className=\"Exchange-info-label\">\r\n          <Trans>Available Liquidity</Trans>\r\n        </div>\r\n        <div className=\"align-right\">\r\n          <Tooltip\r\n            handle={`$${formatAmount(toTokenInfo.maxAvailableLong, USD_DECIMALS, 2, true)}`}\r\n            position=\"right-bottom\"\r\n            renderContent={() => {\r\n              return (\r\n                <>\r\n                  <StatsTooltipRow\r\n                    label={`Max ${toTokenInfo.symbol} long capacity`}\r\n                    value={formatAmount(toTokenInfo.maxLongCapacity, USD_DECIMALS, 0, true)}\r\n                  />\r\n                  <StatsTooltipRow\r\n                    label={`Current ${toTokenInfo.symbol} long`}\r\n                    value={formatAmount(toTokenInfo.guaranteedUsd, USD_DECIMALS, 0, true)}\r\n                  />\r\n                </>\r\n              );\r\n            }}\r\n          ></Tooltip>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const { data: liquidityData, error: liquidityDataError } = useSWR(\r\n    active && [active, chainId, GNS_Storage.address, toTokenInfo, \"getLiquidityGNS\", account],\r\n    async () => {\r\n      const liqs = {};\r\n      const curPairSymbol = toTokenInfo.symbol;\r\n      \r\n      const GNS_contract = new ethers.Contract(GNS_Storage.address, GNS_Storage.abi, signer);\r\n      const GNS_PairIndex = GNS_PAIRS[toToken.symbol];\r\n      const GNS_Info = {\r\n        openInterest: await GNS_contract.openInterestDai(GNS_PairIndex, 0),\r\n        maxOpenInterest: await GNS_contract.openInterestDai(GNS_PairIndex, 2),\r\n      }\r\n      \r\n      marketsList.forEach(async (market) => {\r\n        let liq;\r\n        let symbol = curPairSymbol;\r\n\r\n        switch(market.name) {\r\n          case 'GMX':\r\n            if (isLong) {\r\n              liq = toTokenInfo.maxAvailableLong / 10**USD_DECIMALS;\r\n            } else {\r\n              liq = toTokenInfo.maxAvailableShort / 10**USD_DECIMALS;\r\n            }\r\n\r\n            symbol = '';\r\n            break;\r\n          case 'GNS':\r\n            liq = Number(\r\n              (GNS_Info.maxOpenInterest?.sub(GNS_Info.openInterest) + '0'.repeat(12)) / 10**USD_DECIMALS\r\n            );\r\n            \r\n            break;\r\n          default:\r\n            return;\r\n        }\r\n\r\n        liqs[market.name] = {\r\n          value: liq,\r\n          formattedValue: separateThousands(floor(liq)),\r\n          symbol,\r\n        }\r\n      })\r\n      \r\n      return liqs;\r\n    }\r\n  );\r\n  const [liquidity, setLiquidity] = useState(null);\r\n  useEffect(() => {\r\n    if (!liquidityData) {\r\n      return;\r\n    }\r\n    \r\n    setLiquidity(liquidityData);\r\n  }, [liquidityData]);\r\n\r\n  const [markets, setMarkets] = useLocalStorageSerializeKey([chainId, \"Terminal-Markets\"], marketsList.slice());\r\n  \r\n  \r\n  // Modal functionality\r\n  const [modal, setModal] = useState('');\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n\r\n  const openModal = (name) => {\r\n    setModal(name);\r\n    setModalVisible(true);\r\n  }\r\n  \r\n  const renderModal = (position) => {\r\n    switch(modal) {\r\n      case 'Choose-Market':\r\n        return (\r\n          <ChooseMarketModal\r\n            visible={modalVisible}\r\n            setVisible={setModalVisible}\r\n            marketsList={marketsList}\r\n            markets={markets}\r\n            setMarkets={setMarkets}\r\n            liqs={liquidity}\r\n          />\r\n        )\r\n          \r\n      default:\r\n        return (\r\n          <></>\r\n        );\r\n    }\r\n  }\r\n\r\n  // Choosing Liquidity Source\r\n  const [suitableMarket, setSuitableMarket] = useState(null);\r\n  useEffect(() => {\r\n    if (!markets.length) {\r\n      setSuitableMarket(null);\r\n      return;\r\n    }\r\n    setSuitableMarket(markets.reduce((result, market) => {\r\n      if (!liquidity) {\r\n        return market;\r\n      }\r\n      if (liquidity[result.name]?.value > liquidity[market.name]?.value) {\r\n        return result;\r\n      }\r\n      return market;\r\n    }))\r\n  }, [markets]);\r\n\r\n  useEffect(() => {\r\n    if (suitableMarket?.name === 'GNS') {\r\n      setFromTokenAddress(isLong ? LONG : SHORT, getTokenBySymbol(chainId, 'DAI').address);\r\n    }\r\n  }, [suitableMarket]);\r\n\r\n  const onMarketSelect = (marketName) => {\r\n    setSuitableMarket(marketsList.find(market => market.name === marketName));\r\n  }\r\n\r\n  const fromBalance = fromTokenInfo ? fromTokenInfo.balance : bigNumberify(0);\r\n  const toBalance = toTokenInfo ? toTokenInfo.balance : bigNumberify(0);\r\n\r\n  const fromAmount = parseValue(fromValue, fromToken && fromToken.decimals);\r\n  const toAmount = parseValue(toValue, toToken && toToken.decimals);\r\n\r\n  const isPotentialWrap = (fromToken.isNative && toToken.isWrapped) || (fromToken.isWrapped && toToken.isNative);\r\n  const isWrapOrUnwrap = isSwap && isPotentialWrap;\r\n  const needApproval =\r\n    suitableMarket?.name === 'GMX' ?\r\n      (fromTokenAddress !== AddressZero &&\r\n      tokenAllowance &&\r\n      fromAmount &&\r\n      fromAmount.gt(tokenAllowance) &&\r\n      !isWrapOrUnwrap)\r\n    : (suitableMarket?.name === 'GNS' &&\r\n        (fromTokenAddress !== AddressZero &&\r\n          tokenAllowanceGNS &&\r\n          fromAmount &&\r\n          fromAmount.gt(tokenAllowanceGNS) &&\r\n          !isWrapOrUnwrap));\r\n\r\n  \r\n  const prevFromTokenAddress = usePrevious(fromTokenAddress);\r\n  const prevNeedApproval = usePrevious(needApproval);\r\n  const prevToTokenAddress = usePrevious(toTokenAddress);\r\n\r\n  const fromUsdMin = getUsd(fromAmount, fromTokenAddress, false, infoTokens);\r\n  const toUsdMax = getUsd(toAmount, toTokenAddress, true, infoTokens, orderOption, triggerPriceUsd);\r\n\r\n  const indexTokenAddress = toTokenAddress === AddressZero ? nativeTokenAddress : toTokenAddress;\r\n  const collateralTokenAddress = isLong ? indexTokenAddress : shortCollateralAddress;\r\n  const collateralToken = getToken(chainId, collateralTokenAddress);\r\n\r\n  const [triggerRatioValue, setTriggerRatioValue] = useState(\"\");\r\n\r\n  const triggerRatioInverted = useMemo(() => {\r\n    return isTriggerRatioInverted(fromTokenInfo, toTokenInfo);\r\n  }, [toTokenInfo, fromTokenInfo]);\r\n\r\n  const maxToTokenOut = useMemo(() => {\r\n    const value = toTokenInfo.availableAmount?.gt(toTokenInfo.poolAmount?.sub(toTokenInfo.bufferAmount))\r\n      ? toTokenInfo.poolAmount?.sub(toTokenInfo.bufferAmount)\r\n      : toTokenInfo.availableAmount;\r\n\r\n    if (!value) {\r\n      return bigNumberify(0);\r\n    }\r\n\r\n    return value.gt(0) ? value : bigNumberify(0);\r\n  }, [toTokenInfo]);\r\n\r\n  const maxToTokenOutUSD = useMemo(() => {\r\n    return getUsd(maxToTokenOut, toTokenAddress, false, infoTokens);\r\n  }, [maxToTokenOut, toTokenAddress, infoTokens]);\r\n\r\n  const maxFromTokenInUSD = useMemo(() => {\r\n    const value = fromTokenInfo.maxUsdgAmount\r\n      ?.sub(fromTokenInfo.usdgAmount)\r\n      .mul(expandDecimals(1, USD_DECIMALS))\r\n      .div(expandDecimals(1, USDG_DECIMALS));\r\n\r\n    if (!value) {\r\n      return bigNumberify(0);\r\n    }\r\n\r\n    return value.gt(0) ? value : bigNumberify(0);\r\n  }, [fromTokenInfo]);\r\n\r\n  const maxFromTokenIn = useMemo(() => {\r\n    if (!fromTokenInfo.maxPrice) {\r\n      return bigNumberify(0);\r\n    }\r\n    return maxFromTokenInUSD?.mul(expandDecimals(1, fromTokenInfo.decimals)).div(fromTokenInfo.maxPrice).toString();\r\n  }, [maxFromTokenInUSD, fromTokenInfo]);\r\n\r\n  let maxSwapAmountUsd = bigNumberify(0);\r\n\r\n  if (maxToTokenOutUSD && maxFromTokenInUSD) {\r\n    maxSwapAmountUsd = maxToTokenOutUSD.lt(maxFromTokenInUSD) ? maxToTokenOutUSD : maxFromTokenInUSD;\r\n  }\r\n\r\n  const triggerRatio = useMemo(() => {\r\n    if (!triggerRatioValue) {\r\n      return bigNumberify(0);\r\n    }\r\n    let ratio = parseValue(triggerRatioValue, USD_DECIMALS);\r\n    if (ratio.eq(0)) {\r\n      return bigNumberify(0);\r\n    }\r\n    if (triggerRatioInverted) {\r\n      ratio = PRECISION.mul(PRECISION).div(ratio);\r\n    }\r\n    return ratio;\r\n  }, [triggerRatioValue, triggerRatioInverted]);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      fromToken &&\r\n      fromTokenAddress === prevFromTokenAddress &&\r\n      !needApproval &&\r\n      prevNeedApproval &&\r\n      isWaitingForApproval\r\n    ) {\r\n      setIsWaitingForApproval(false);\r\n      helperToast.success(<div>{fromToken.symbol} approved!</div>);\r\n    }\r\n  }, [\r\n    fromTokenAddress,\r\n    prevFromTokenAddress,\r\n    needApproval,\r\n    prevNeedApproval,\r\n    setIsWaitingForApproval,\r\n    fromToken.symbol,\r\n    isWaitingForApproval,\r\n    fromToken,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (!toTokens.find((token) => token.address === toTokenAddress)) {\r\n      setToTokenAddress(swapOption, toTokens[0].address);\r\n    }\r\n  }, [swapOption, toTokens, toTokenAddress, setToTokenAddress]);\r\n\r\n  useEffect(() => {\r\n    if (swapOption !== SHORT) {\r\n      return;\r\n    }\r\n    if (toTokenAddress === prevToTokenAddress) {\r\n      return;\r\n    }\r\n    for (let i = 0; i < stableTokens.length; i++) {\r\n      const stableToken = stableTokens[i];\r\n      const key = getPositionKey(account, stableToken.address, toTokenAddress, false, nativeTokenAddress);\r\n      const position = positionsMap[key];\r\n      if (position && position.size && position.size.gt(0)) {\r\n        setShortCollateralAddress(position.collateralToken.address);\r\n        return;\r\n      }\r\n    }\r\n  }, [\r\n    account,\r\n    toTokenAddress,\r\n    prevToTokenAddress,\r\n    swapOption,\r\n    positionsMap,\r\n    stableTokens,\r\n    nativeTokenAddress,\r\n    shortCollateralAddress,\r\n    setShortCollateralAddress,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const updateSwapAmounts = () => {\r\n      if (anchorOnFromAmount) {\r\n        if (!fromAmount) {\r\n          setToValue(\"\");\r\n          return;\r\n        }\r\n        if (toToken) {\r\n          const { amount: nextToAmount } = getNextToAmount(\r\n            chainId,\r\n            fromAmount,\r\n            fromTokenAddress,\r\n            toTokenAddress,\r\n            infoTokens,\r\n            undefined,\r\n            !isMarketOrder && triggerRatio,\r\n            usdgSupply,\r\n            totalTokenWeights,\r\n            isSwap\r\n          );\r\n\r\n          const nextToValue = formatAmountFree(nextToAmount, toToken.decimals, toToken.decimals);\r\n          setToValue(nextToValue);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (!toAmount) {\r\n        setFromValue(\"\");\r\n        return;\r\n      }\r\n      if (fromToken) {\r\n        const { amount: nextFromAmount } = getNextFromAmount(\r\n          chainId,\r\n          toAmount,\r\n          fromTokenAddress,\r\n          toTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          !isMarketOrder && triggerRatio,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        const nextFromValue = formatAmountFree(nextFromAmount, fromToken.decimals, fromToken.decimals);\r\n        setFromValue(nextFromValue);\r\n      }\r\n    };\r\n\r\n    const updateLeverageAmounts = () => {\r\n      if (!hasLeverageOption) {\r\n        return;\r\n      }\r\n      if (anchorOnFromAmount) {\r\n        if (!fromAmount) {\r\n          setToValue(\"\");\r\n          return;\r\n        }\r\n\r\n        const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n        if (toTokenInfo && toTokenInfo.maxPrice && fromUsdMin && fromUsdMin.gt(0)) {\r\n          const leverageMultiplier = parseInt(leverageOption * BASIS_POINTS_DIVISOR);\r\n          const toTokenPriceUsd =\r\n            !isMarketOrder && triggerPriceUsd && triggerPriceUsd.gt(0) ? triggerPriceUsd : toTokenInfo.maxPrice;\r\n\r\n          const { feeBasisPoints } = getNextToAmount(\r\n            chainId,\r\n            fromAmount,\r\n            fromTokenAddress,\r\n            collateralTokenAddress,\r\n            infoTokens,\r\n            undefined,\r\n            undefined,\r\n            usdgSupply,\r\n            totalTokenWeights,\r\n            isSwap\r\n          );\r\n\r\n          let fromUsdMinAfterFee = fromUsdMin;\r\n          if (feeBasisPoints) {\r\n            fromUsdMinAfterFee = fromUsdMin.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n          }\r\n\r\n          const toNumerator = fromUsdMinAfterFee.mul(leverageMultiplier).mul(BASIS_POINTS_DIVISOR);\r\n          const toDenominator = bigNumberify(MARGIN_FEE_BASIS_POINTS)\r\n            .mul(leverageMultiplier)\r\n            .add(bigNumberify(BASIS_POINTS_DIVISOR).mul(BASIS_POINTS_DIVISOR));\r\n\r\n          const nextToUsd = toNumerator.div(toDenominator);\r\n\r\n          const nextToAmount = nextToUsd.mul(expandDecimals(1, toToken.decimals)).div(toTokenPriceUsd);\r\n\r\n          const nextToValue = formatAmountFree(nextToAmount, toToken.decimals, toToken.decimals);\r\n\r\n          setToValue(nextToValue);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (!toAmount) {\r\n        setFromValue(\"\");\r\n        return;\r\n      }\r\n\r\n      const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n      if (fromTokenInfo && fromTokenInfo.minPrice && toUsdMax && toUsdMax.gt(0)) {\r\n        const leverageMultiplier = parseInt(leverageOption * BASIS_POINTS_DIVISOR);\r\n\r\n        const baseFromAmountUsd = toUsdMax.mul(BASIS_POINTS_DIVISOR).div(leverageMultiplier);\r\n\r\n        let fees = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n\r\n        const { feeBasisPoints } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          collateralTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n\r\n        if (feeBasisPoints) {\r\n          const swapFees = baseFromAmountUsd.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n          fees = fees.add(swapFees);\r\n        }\r\n\r\n        const nextFromUsd = baseFromAmountUsd.add(fees);\r\n\r\n        const nextFromAmount = nextFromUsd.mul(expandDecimals(1, fromToken.decimals)).div(fromTokenInfo.minPrice);\r\n\r\n        const nextFromValue = formatAmountFree(nextFromAmount, fromToken.decimals, fromToken.decimals);\r\n\r\n        setFromValue(nextFromValue);\r\n      }\r\n    };\r\n\r\n    if (isSwap) {\r\n      updateSwapAmounts();\r\n    }\r\n\r\n    if (isLong || isShort) {\r\n      updateLeverageAmounts();\r\n    }\r\n  }, [\r\n    anchorOnFromAmount,\r\n    fromAmount,\r\n    toAmount,\r\n    fromToken,\r\n    toToken,\r\n    fromTokenAddress,\r\n    toTokenAddress,\r\n    infoTokens,\r\n    isSwap,\r\n    isLong,\r\n    isShort,\r\n    leverageOption,\r\n    fromUsdMin,\r\n    toUsdMax,\r\n    isMarketOrder,\r\n    triggerPriceUsd,\r\n    triggerRatio,\r\n    hasLeverageOption,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n    chainId,\r\n    collateralTokenAddress,\r\n    indexTokenAddress,\r\n  ]);\r\n\r\n  let entryMarkPrice;\r\n  let exitMarkPrice;\r\n  if (toTokenInfo) {\r\n    entryMarkPrice = swapOption === LONG ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n    exitMarkPrice = swapOption === LONG ? toTokenInfo.minPrice : toTokenInfo.maxPrice;\r\n  }\r\n\r\n  let leverage = bigNumberify(0);\r\n  if (fromUsdMin && toUsdMax && fromUsdMin.gt(0)) {\r\n    const fees = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    if (fromUsdMin.sub(fees).gt(0)) {\r\n      leverage = toUsdMax.mul(BASIS_POINTS_DIVISOR).div(fromUsdMin.sub(fees));\r\n    }\r\n  }\r\n\r\n  let nextAveragePrice = isMarketOrder ? entryMarkPrice : triggerPriceUsd;\r\n  if (suitableMarket?.name === 'GNS') {\r\n    if (toTokenInfo.maxPrice) {\r\n      nextAveragePrice = isLong ?\r\n        BigNumber.from(formatAmount(toTokenInfo.maxPrice, 4, 0, 0)).mul(10004)\r\n        : BigNumber.from(formatAmount(toTokenInfo.maxPrice, 4, 0, 0)).mul(9996);\r\n    }\r\n  }\r\n  \r\n  if (suitableMarket?.name === 'GMX') {\r\n    if (hasExistingPosition) {\r\n      let nextDelta, nextHasProfit;\r\n  \r\n      if (isMarketOrder) {\r\n        nextDelta = existingPosition.delta;\r\n        nextHasProfit = existingPosition.hasProfit;\r\n      } else {\r\n        const data = calculatePositionDelta(triggerPriceUsd || bigNumberify(0), existingPosition);\r\n        nextDelta = data.delta;\r\n        nextHasProfit = data.hasProfit;\r\n      }\r\n  \r\n      nextAveragePrice = getNextAveragePrice({\r\n        size: existingPosition.size,\r\n        sizeDelta: toUsdMax,\r\n        hasProfit: nextHasProfit,\r\n        delta: nextDelta,\r\n        nextPrice: isMarketOrder ? entryMarkPrice : triggerPriceUsd,\r\n        isLong,\r\n      });\r\n    }\r\n  }\r\n\r\n  if (suitableMarket?.name === 'GMX') {\r\n    if (hasExistingPosition) {\r\n      const collateralDelta = fromUsdMin ? fromUsdMin : bigNumberify(0);\r\n      const sizeDelta = toUsdMax ? toUsdMax : bigNumberify(0);\r\n      leverage = getLeverage({\r\n        size: existingPosition.size,\r\n        sizeDelta,\r\n        collateral: existingPosition.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: true,\r\n        entryFundingRate: existingPosition.entryFundingRate,\r\n        cumulativeFundingRate: existingPosition.cumulativeFundingRate,\r\n        increaseSize: true,\r\n        hasProfit: existingPosition.hasProfit,\r\n        delta: existingPosition.delta,\r\n        includeDelta: savedIsPnlInLeverage,\r\n      });\r\n    } else if (hasLeverageOption) {\r\n      leverage = bigNumberify(parseInt(leverageOption * BASIS_POINTS_DIVISOR));\r\n    }\r\n  } else if (suitableMarket?.name === 'GNS') {\r\n    leverage = bigNumberify(parseInt(leverageOption * BASIS_POINTS_DIVISOR));\r\n  }\r\n  \r\n  let liquidationPrice;\r\n  if (suitableMarket?.name === 'GMX') {\r\n    liquidationPrice = getLiquidationPrice({\r\n      isLong,\r\n      size: hasExistingPosition ? existingPosition.size : bigNumberify(0),\r\n      collateral: hasExistingPosition ? existingPosition.collateral : bigNumberify(0),\r\n      averagePrice: nextAveragePrice,\r\n      entryFundingRate: hasExistingPosition ? existingPosition.entryFundingRate : bigNumberify(0),\r\n      cumulativeFundingRate: hasExistingPosition ? existingPosition.cumulativeFundingRate : bigNumberify(0),\r\n      sizeDelta: toUsdMax,\r\n      collateralDelta: fromUsdMin,\r\n      increaseCollateral: true,\r\n      increaseSize: true,\r\n    });\r\n  } else if (suitableMarket?.name === 'GNS') {\r\n    if (fromAmount && toTokenInfo.maxPrice && leverage) {\r\n      if (!fromAmount.eq(0) && !leverage.eq(0)) {\r\n        const markPrice = toTokenInfo.maxPrice;\r\n        const collateral = fromAmount.mul(leverage);\r\n        \r\n        const liqPriceDistance = (markPrice.mul(collateral.mul(9).div(10)).div(collateral).div(formatAmount(leverage, 4, 0, 0)));\r\n\r\n        liquidationPrice = (isLong ?\r\n            markPrice.sub(liqPriceDistance)\r\n            : markPrice.add(liqPriceDistance));\r\n      }\r\n    }\r\n  }\r\n\r\n  const existingLiquidationPrice = existingPosition ? getLiquidationPrice(existingPosition) : undefined;\r\n  let displayLiquidationPrice = liquidationPrice ? liquidationPrice : existingLiquidationPrice;\r\n  \r\n  \r\n\r\n  const getSwapError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return [`Swaps disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n\r\n    if (fromTokenAddress === toTokenAddress) {\r\n      return [t`Select different tokens`];\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      if ((toToken.isStable || toToken.isUsdg) && (fromToken.isStable || fromToken.isUsdg)) {\r\n        return [t`Select different tokens`];\r\n      }\r\n\r\n      if (fromToken.isNative && toToken.isWrapped) {\r\n        return [t`Select different tokens`];\r\n      }\r\n\r\n      if (toToken.isNative && fromToken.isWrapped) {\r\n        return [t`Select different tokens`];\r\n      }\r\n    }\r\n\r\n    if (!fromAmount || fromAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n    if (!toAmount || toAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n\r\n    const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n    if (!fromTokenInfo || !fromTokenInfo.minPrice) {\r\n      return [t`Incorrect network`];\r\n    }\r\n    if (\r\n      !savedShouldDisableValidationForTesting &&\r\n      fromTokenInfo &&\r\n      fromTokenInfo.balance &&\r\n      fromAmount &&\r\n      fromAmount.gt(fromTokenInfo.balance)\r\n    ) {\r\n      return [`Insufficient ${fromTokenInfo.symbol} balance`];\r\n    }\r\n\r\n    const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n    if (!isMarketOrder) {\r\n      if (!triggerRatioValue || triggerRatio.eq(0)) {\r\n        return [t`Enter a price`];\r\n      }\r\n\r\n      const currentRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n      if (currentRate && currentRate.lt(triggerRatio)) {\r\n        return triggerRatioInverted ? [t`Price below Mark Price`] : [t`Price above Mark Price`];\r\n      }\r\n    }\r\n\r\n    if (\r\n      !isWrapOrUnwrap &&\r\n      toToken &&\r\n      toTokenAddress !== USDG_ADDRESS &&\r\n      toTokenInfo &&\r\n      toTokenInfo.availableAmount &&\r\n      toAmount.gt(toTokenInfo.availableAmount)\r\n    ) {\r\n      return [t`Insufficient liquidity`];\r\n    }\r\n    if (\r\n      !isWrapOrUnwrap &&\r\n      toAmount &&\r\n      toTokenInfo.bufferAmount &&\r\n      toTokenInfo.poolAmount &&\r\n      toTokenInfo.bufferAmount.gt(toTokenInfo.poolAmount.sub(toAmount))\r\n    ) {\r\n      return [t`Insufficient liquidity`];\r\n    }\r\n\r\n    if (\r\n      fromUsdMin &&\r\n      fromTokenInfo.maxUsdgAmount &&\r\n      fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n      fromTokenInfo.usdgAmount &&\r\n      fromTokenInfo.maxPrice\r\n    ) {\r\n      const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n      const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n      if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n        return [`${fromTokenInfo.symbol} pool exceeded`];\r\n      }\r\n    }\r\n\r\n    return [false];\r\n  };\r\n\r\n  const getLeverageError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return [`Leverage disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (hasOutdatedUi) {\r\n      return [t`Page outdated, please refresh`];\r\n    }\r\n\r\n    if (!toAmount || toAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n\r\n    let toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n    if (toTokenInfo && toTokenInfo.isStable) {\r\n      return [`${swapOption === LONG ? \"Longing\" : \"Shorting\"} ${toTokenInfo.symbol} not supported`];\r\n    }\r\n\r\n    const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n    if (\r\n      !savedShouldDisableValidationForTesting &&\r\n      fromTokenInfo &&\r\n      fromTokenInfo.balance &&\r\n      fromAmount &&\r\n      fromAmount.gt(fromTokenInfo.balance)\r\n    ) {\r\n      return [`Insufficient ${fromTokenInfo.symbol} balance`];\r\n    }\r\n\r\n    if (leverage && leverage.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n    if (!isMarketOrder && (!triggerPriceValue || triggerPriceUsd.eq(0))) {\r\n      return [t`Enter a price`];\r\n    }\r\n\r\n    if (suitableMarket?.name === 'GMX') {\r\n      if (!hasExistingPosition && fromUsdMin && fromUsdMin.lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return [t`Min order: 10 USD`];\r\n      }\r\n    } else if (suitableMarket?.name === 'GNS') {\r\n      if (fromUsdMin && (fromUsdMin.mul(leverage ?? 1)).lt(expandDecimals(7500, USD_DECIMALS + 4))) {\r\n        return [t`Min order: 7,500 DAI`];\r\n      }\r\n    }\r\n\r\n\r\n    if (leverage) {\r\n      if (suitableMarket?.name === 'GMX') {\r\n        if (leverage.gt(MAX_ALLOWED_LEVERAGE)) {\r\n          return [`Max leverage: ${(MAX_ALLOWED_LEVERAGE / BASIS_POINTS_DIVISOR).toFixed(1)}x`];\r\n        } else if (leverage.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n          return [t`Min leverage: 1.1x`];\r\n        }\r\n        \r\n      } else if (suitableMarket?.name === 'GNS') {\r\n        if (leverage.gt(150 * BASIS_POINTS_DIVISOR)) {\r\n          return [t`Max leverage: 150x`];\r\n        } else if (leverage.lt(2 * BASIS_POINTS_DIVISOR)) {\r\n          return [t`Min leverage: 2x`];\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!isMarketOrder && entryMarkPrice && triggerPriceUsd && !savedShouldDisableValidationForTesting) {\r\n      if (isLong && entryMarkPrice.lt(triggerPriceUsd)) {\r\n        return [t`Price above Mark Price`];\r\n      }\r\n      if (!isLong && entryMarkPrice.gt(triggerPriceUsd)) {\r\n        return [t`Price below Mark Price`];\r\n      }\r\n    }\r\n\r\n    if (isLong) {\r\n      let requiredAmount = toAmount;\r\n      if (fromTokenAddress !== toTokenAddress) {\r\n        const { amount: swapAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          toTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        requiredAmount = requiredAmount.add(swapAmount);\r\n\r\n        if (toToken && toTokenAddress !== USDG_ADDRESS) {\r\n          if (!toTokenInfo.availableAmount) {\r\n            return [t`Liquidity data not loaded`];\r\n          }\r\n          if (toTokenInfo.availableAmount && requiredAmount.gt(toTokenInfo.availableAmount)) {\r\n            // return [t`Insufficient liquidity`];\r\n          }\r\n        }\r\n\r\n        if (\r\n          toTokenInfo.poolAmount &&\r\n          toTokenInfo.bufferAmount &&\r\n          toTokenInfo.bufferAmount.gt(toTokenInfo.poolAmount.sub(swapAmount))\r\n        ) {\r\n          // return [t`Insufficient liquidity`, true, \"BUFFER\"];\r\n        }\r\n\r\n        \r\n        if (\r\n          fromUsdMin &&\r\n          fromTokenInfo.maxUsdgAmount &&\r\n          fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n          fromTokenInfo.minPrice &&\r\n          fromTokenInfo.usdgAmount\r\n        ) {\r\n          const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n          const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n          if (suitableMarket?.name === 'GNS') {\r\n            if (\r\n              liquidity &&\r\n              liquidity[suitableMarket?.name].value &&\r\n              formatAmount(nextUsdgAmount, 30, 0) > liquidity[suitableMarket?.name].value\r\n            ) {\r\n              return [`${fromTokenInfo.symbol} pool exceeded, try different token`, true, \"MAX_USDG\"];\r\n            }\r\n          } else if (suitableMarket?.name === 'GMX') {\r\n            if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n              return [`${fromTokenInfo.symbol} pool exceeded, try different token`, true, \"MAX_USDG\"];\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      if (suitableMarket?.name === 'GMX') {\r\n        if (toTokenInfo && toTokenInfo.maxPrice) {\r\n          const sizeUsd = toAmount.mul(toTokenInfo.maxPrice).div(expandDecimals(1, toTokenInfo.decimals));\r\n          if (\r\n            toTokenInfo.maxGlobalLongSize &&\r\n            toTokenInfo.maxGlobalLongSize.gt(0) &&\r\n            toTokenInfo.maxAvailableLong &&\r\n            sizeUsd.gt(toTokenInfo.maxAvailableLong)\r\n          ) {\r\n            return [`Max ${toTokenInfo.symbol} long exceeded`];\r\n          }\r\n        }\r\n      } else if (suitableMarket?.name === 'GNS') {\r\n        const sizeUsd = toAmount.mul(toTokenInfo.maxPrice).div(expandDecimals(1, toTokenInfo.decimals));\r\n        if (\r\n          liquidity &&\r\n          ((sizeUsd / 10**USD_DECIMALS) > (liquidity[suitableMarket?.name].value))\r\n        ) {\r\n          return [`Max ${toTokenInfo.symbol} long exceeded`];\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isShort) {\r\n      let stableTokenAmount = bigNumberify(0);\r\n      if (fromTokenAddress !== shortCollateralAddress && fromAmount && fromAmount.gt(0)) {\r\n        const { amount: nextToAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          shortCollateralAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        stableTokenAmount = nextToAmount;\r\n        if (stableTokenAmount.gt(shortCollateralToken.availableAmount)) {\r\n          // return [t`Insufficient liquidity, change \"Profits In\"`];\r\n        }\r\n\r\n        if (\r\n          shortCollateralToken.bufferAmount &&\r\n          shortCollateralToken.poolAmount &&\r\n          shortCollateralToken.bufferAmount.gt(shortCollateralToken.poolAmount.sub(stableTokenAmount))\r\n        ) {\r\n          // suggest swapping to collateralToken\r\n          // return [t`Insufficient liquidity, change \"Profits In\"`, true, \"BUFFER\"];\r\n        }\r\n\r\n        if (\r\n          fromTokenInfo.maxUsdgAmount &&\r\n          fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n          fromTokenInfo.minPrice &&\r\n          fromTokenInfo.usdgAmount\r\n        ) {\r\n          const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n          const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n          \r\n          if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n            // return [t`${fromTokenInfo.symbol} pool exceeded, try different token`, true, \"MAX_USDG\"];\r\n          }\r\n        }\r\n      }\r\n      if (\r\n        !shortCollateralToken ||\r\n        !fromTokenInfo ||\r\n        !toTokenInfo ||\r\n        !toTokenInfo.maxPrice ||\r\n        !shortCollateralToken.availableAmount\r\n      ) {\r\n        return [t`Fetching token info...`];\r\n      }\r\n\r\n      const sizeUsd = toAmount.mul(toTokenInfo.maxPrice).div(expandDecimals(1, toTokenInfo.decimals));\r\n      const sizeTokens = sizeUsd\r\n        .mul(expandDecimals(1, shortCollateralToken.decimals))\r\n        .div(shortCollateralToken.minPrice);\r\n\r\n      if (!toTokenInfo.maxAvailableShort) {\r\n        return [t`Liquidity data not loaded`];\r\n      }\r\n\r\n      if (suitableMarket?.name === 'GMX') {\r\n        if (\r\n          toTokenInfo.maxGlobalShortSize &&\r\n          toTokenInfo.maxGlobalShortSize.gt(0) &&\r\n          toTokenInfo.maxAvailableShort &&\r\n          sizeUsd.gt(toTokenInfo.maxAvailableShort)\r\n        ) {\r\n          return [`Max ${toTokenInfo.symbol} short exceeded`];\r\n        }\r\n      } else if (suitableMarket?.name === 'GNS') {\r\n        if (\r\n          liquidity &&\r\n          ((sizeUsd / 10**USD_DECIMALS) > (liquidity[suitableMarket?.name].value))\r\n        ) {\r\n          return [`Max ${toTokenInfo.symbol} short exceeded`];\r\n        }\r\n      }\r\n      \r\n\r\n      stableTokenAmount = stableTokenAmount.add(sizeTokens);\r\n      if (stableTokenAmount.gt(shortCollateralToken.availableAmount)) {\r\n        // return [t`Insufficient liquidity, change \"Profits In\"`];\r\n      }\r\n    }\r\n\r\n    return [false];\r\n  };\r\n\r\n  const getToLabel = () => {\r\n    if (isSwap) {\r\n      return t`Receive`;\r\n    }\r\n    if (isLong) {\r\n      return t`Long`;\r\n    }\r\n    return t`Short`;\r\n  };\r\n\r\n  const getError = () => {\r\n    if (isSwap) {\r\n      return getSwapError();\r\n    }\r\n    return getLeverageError();\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return false;\r\n    }\r\n    if (isStopOrder) {\r\n      return true;\r\n    }\r\n    if (!active) {\r\n      return true;\r\n    }\r\n    const [error, modal] = getError();\r\n    if (error && !modal) {\r\n      return false;\r\n    }\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return false;\r\n    }\r\n    if ((needApproval && isWaitingForApproval) || isApproving) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n    if (isApproving || isPluginApproving) {\r\n      return false;\r\n    }\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n\r\n  const getPrimaryText = () => {\r\n    if (isStopOrder) {\r\n      return t`Open a position`;\r\n    }\r\n    if (!active) {\r\n      return t`Connect Wallet`;\r\n    }\r\n    if (!isSupportedChain(chainId)) {\r\n      return t`Incorrect Network`;\r\n    }\r\n    const [error, modal] = getError();\r\n    if (error && !modal) {\r\n      return error;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (needApproval && isWaitingForApproval) {\r\n      return t`Waiting for Approval`;\r\n    }\r\n    if (isApproving) {\r\n      return `Approving ${fromToken.symbol}...`;\r\n    }\r\n    /* if (needApproval) {\r\n      return `Approve ${fromToken.symbol}`;\r\n    } */\r\n\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (isPluginApproving) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (needOrderBookApproval && suitableMarket?.name === 'GMX') {\r\n      return t`Enable Orders`;\r\n    }\r\n    \r\n    if (!isMarketOrder) return `Create ${orderOption.charAt(0) + orderOption.substring(1).toLowerCase()} Order`;\r\n\r\n    if (isSwap) {\r\n      if (toUsdMax && toUsdMax.lt(fromUsdMin.mul(95).div(100))) {\r\n        return t`High Slippage, Swap Anyway`;\r\n      }\r\n      return \"Swap\";\r\n    }\r\n\r\n    if (isLong) {\r\n      const indexTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n      if (indexTokenInfo && indexTokenInfo.minPrice) {\r\n        const { amount: nextToAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          indexTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        const nextToAmountUsd = nextToAmount\r\n          .mul(indexTokenInfo.minPrice)\r\n          .div(expandDecimals(1, indexTokenInfo.decimals));\r\n        if (fromTokenAddress === USDG_ADDRESS && nextToAmountUsd.lt(fromUsdMin.mul(98).div(100))) {\r\n          return t`High USDG Slippage, Long Anyway`;\r\n        }\r\n      }\r\n      return `Long ${toToken.symbol}`;\r\n    }\r\n\r\n    return `Short ${toToken.symbol}`;\r\n  };\r\n\r\n  const onSelectFromToken = (token) => {\r\n    setFromTokenAddress(swapOption, token.address);\r\n    setIsWaitingForApproval(false);\r\n\r\n    if (isShort && token.isStable) {\r\n      setShortCollateralAddress(token.address);\r\n    }\r\n  };\r\n\r\n  const onSelectShortCollateralAddress = (token) => {\r\n    setShortCollateralAddress(token.address);\r\n  };\r\n\r\n  const onSelectToToken = (token) => {\r\n    setToTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  const [hasInputFocus, setHasInputFocus] = useState(false);\r\n  const [hasInputError, setHasInputError] = useState(false);\r\n  const checkInputError = (inputVal) => {\r\n    if (!isPrimaryEnabled() && inputVal !== '') {\r\n      setHasInputError(true);\r\n    } else {\r\n      setHasInputError(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkInputError(fromValue);\r\n  }, [fromValue, toValue])\r\n  \r\n  const onFromValueChange = (e) => {\r\n    setAnchorOnFromAmount(true);\r\n    setFromValue(e.target.value);\r\n  };\r\n\r\n  const onToValueChange = (e) => {\r\n    setAnchorOnFromAmount(false);\r\n    setToValue(e.target.value);\r\n  };\r\n\r\n  const switchTokens = () => {\r\n    if (fromAmount && toAmount) {\r\n      if (anchorOnFromAmount) {\r\n        setToValue(formatAmountFree(fromAmount, fromToken.decimals, 8));\r\n      } else {\r\n        setFromValue(formatAmountFree(toAmount, toToken.decimals, 8));\r\n      }\r\n      setAnchorOnFromAmount(!anchorOnFromAmount);\r\n    }\r\n    setIsWaitingForApproval(false);\r\n\r\n    const updatedTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n    updatedTokenSelection[swapOption] = {\r\n      from: toTokenAddress,\r\n      to: fromTokenAddress,\r\n    };\r\n    setTokenSelection(updatedTokenSelection);\r\n  };\r\n\r\n  const wrap = async () => {\r\n    setIsSubmitting(true);\r\n\r\n    const contract = new ethers.Contract(nativeTokenAddress, WETH.abi, library.getSigner());\r\n    callContract(chainId, contract, \"deposit\", {\r\n      value: fromAmount,\r\n      sentMsg: \"Swap submitted.\",\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      failMsg: \"Swap failed.\",\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {})\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const unwrap = async () => {\r\n    setIsSubmitting(true);\r\n\r\n    const contract = new ethers.Contract(nativeTokenAddress, WETH.abi, library.getSigner());\r\n    callContract(chainId, contract, \"withdraw\", [fromAmount], {\r\n      sentMsg: t`Swap submitted!`,\r\n      failMsg: t`Swap failed.`,\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {})\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const swap = async () => {\r\n    if (fromToken.isNative && toToken.isWrapped) {\r\n      wrap();\r\n      return;\r\n    }\r\n\r\n    if (fromTokenAddress.isWrapped && toToken.isNative) {\r\n      unwrap();\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    let path = [fromTokenAddress, toTokenAddress];\r\n    if (anchorOnFromAmount) {\r\n      const { path: multiPath } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (multiPath) {\r\n        path = multiPath;\r\n      }\r\n    } else {\r\n      const { path: multiPath } = getNextFromAmount(\r\n        chainId,\r\n        toAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (multiPath) {\r\n        path = multiPath;\r\n      }\r\n    }\r\n\r\n    let method;\r\n    let contract;\r\n    let value;\r\n    let params;\r\n    let minOut;\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, fromTokenAddress), fromAmount)) {\r\n      setIsSubmitting(false);\r\n      setIsPendingConfirmation(true);\r\n      helperToast.error(\r\n        `Leave at least ${formatAmount(DUST_BNB, 18, 3)} ${getConstant(chainId, \"nativeTokenSymbol\")} for gas`\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      minOut = toAmount;\r\n      Api.createSwapOrder(chainId, library, path, fromAmount, minOut, triggerRatio, nativeTokenAddress, {\r\n        sentMsg: t`Swap Order submitted!`,\r\n        successMsg: t`Swap Order created!`,\r\n        failMsg: t`Swap Order creation failed.`,\r\n        pendingTxns,\r\n        setPendingTxns,\r\n      })\r\n        .then(() => {\r\n          setIsConfirming(false);\r\n        })\r\n        .finally(() => {\r\n          setIsSubmitting(false);\r\n          setIsPendingConfirmation(false);\r\n        });\r\n      return;\r\n    }\r\n\r\n    path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n    method = \"swap\";\r\n    value = bigNumberify(0);\r\n    if (toTokenAddress === AddressZero) {\r\n      method = \"swapTokensToETH\";\r\n    }\r\n\r\n    minOut = toAmount.mul(BASIS_POINTS_DIVISOR - allowedSlippage).div(BASIS_POINTS_DIVISOR);\r\n    params = [path, fromAmount, minOut, account];\r\n    if (fromTokenAddress === AddressZero) {\r\n      method = \"swapETHToTokens\";\r\n      value = fromAmount;\r\n      params = [path, minOut, account];\r\n    }\r\n    contract = new ethers.Contract(routerAddress, Router.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      sentMsg: `Swap ${!isMarketOrder ? \" order \" : \"\"} submitted!`,\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      failMsg: t`Swap failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async () => {\r\n        setIsConfirming(false);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  const createIncreaseOrder = () => {\r\n    let path = [fromTokenAddress];\r\n\r\n    if (path[0] === USDG_ADDRESS) {\r\n      if (isLong) {\r\n        const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n        path.push(stableToken.address);\r\n      } else {\r\n        path.push(shortCollateralAddress);\r\n      }\r\n    }\r\n\r\n    const minOut = 0;\r\n    const indexToken = getToken(chainId, indexTokenAddress);\r\n    const successMsg = t`\r\n      Created limit order for ${indexToken.symbol} ${isLong ? \"Long\" : \"Short\"}: ${formatAmount(\r\n      toUsdMax,\r\n      USD_DECIMALS,\r\n      2\r\n    )} USD!\r\n    `;\r\n    return Api.createIncreaseOrder(\r\n      chainId,\r\n      library,\r\n      nativeTokenAddress,\r\n      path,\r\n      fromAmount,\r\n      indexTokenAddress,\r\n      minOut,\r\n      toUsdMax,\r\n      collateralTokenAddress,\r\n      isLong,\r\n      triggerPriceUsd,\r\n      {\r\n        pendingTxns,\r\n        setPendingTxns,\r\n        sentMsg: t`Limit order submitted!`,\r\n        successMsg,\r\n        failMsg: t`Limit order creation failed.`,\r\n      }\r\n    )\r\n      .then(() => {\r\n        setIsConfirming(false);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  let referralCode = ethers.constants.HashZero;\r\n  if (!attachedOnChain && userReferralCode) {\r\n    referralCode = userReferralCode;\r\n  }\r\n\r\n  const increasePosition = async () => {\r\n    setIsSubmitting(true);\r\n    const tokenAddress0 = fromTokenAddress === AddressZero ? nativeTokenAddress : fromTokenAddress;\r\n    const indexTokenAddress = toTokenAddress === AddressZero ? nativeTokenAddress : toTokenAddress;\r\n    let path = [indexTokenAddress]; // assume long\r\n    if (toTokenAddress !== fromTokenAddress) {\r\n      path = [tokenAddress0, indexTokenAddress];\r\n    }\r\n\r\n    if (fromTokenAddress === AddressZero && toTokenAddress === nativeTokenAddress) {\r\n      path = [nativeTokenAddress];\r\n    }\r\n\r\n    if (fromTokenAddress === nativeTokenAddress && toTokenAddress === AddressZero) {\r\n      path = [nativeTokenAddress];\r\n    }\r\n\r\n    if (isShort) {\r\n      path = [shortCollateralAddress];\r\n      if (tokenAddress0 !== shortCollateralAddress) {\r\n        path = [tokenAddress0, shortCollateralAddress];\r\n      }\r\n    }\r\n\r\n    const refPrice = isLong ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n    const priceBasisPoints = isLong ? BASIS_POINTS_DIVISOR + allowedSlippage : BASIS_POINTS_DIVISOR - allowedSlippage;\r\n    const priceLimit = refPrice.mul(priceBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n    const boundedFromAmount = fromAmount ? fromAmount : bigNumberify(0);\r\n\r\n\r\n    if (fromAmount && fromAmount.gt(0) && fromTokenAddress === USDG_ADDRESS && isLong) {\r\n      const { amount: nextToAmount, path: multiPath } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        indexTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (nextToAmount.eq(0)) {\r\n        helperToast.error(t`Insufficient liquidity`);\r\n        return;\r\n      }\r\n      if (multiPath) {\r\n        path = replaceNativeTokenAddress(multiPath);\r\n      }\r\n    }\r\n\r\n    let params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      boundedFromAmount, // _amountIn\r\n      0, // _minOut\r\n      toUsdMax, // _sizeDelta\r\n      isLong, // _isLong\r\n      priceLimit, // _acceptablePrice\r\n      minExecutionFee, // _executionFee\r\n      referralCode, // _referralCode\r\n      AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    let method = \"createIncreasePosition\";\r\n    let value = minExecutionFee;\r\n    if (fromTokenAddress === AddressZero) {\r\n      method = \"createIncreasePositionETH\";\r\n      value = boundedFromAmount.add(minExecutionFee);\r\n      params = [\r\n        path, // _path\r\n        indexTokenAddress, // _indexToken\r\n        0, // _minOut\r\n        toUsdMax, // _sizeDelta\r\n        isLong, // _isLong\r\n        priceLimit, // _acceptablePrice\r\n        minExecutionFee, // _executionFee\r\n        referralCode, // _referralCode\r\n        AddressZero, // _callbackTarget\r\n      ];\r\n    }\r\n\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, fromTokenAddress), fromAmount)) {\r\n      setIsSubmitting(false);\r\n      setIsPendingConfirmation(false);\r\n      helperToast.error(\r\n        t`Leave at least ${formatAmount(DUST_BNB, 18, 3)} ${getConstant(chainId, \"nativeTokenSymbol\")} for gas`\r\n      );\r\n      return;\r\n    }\r\n\r\n    const contractAddress = getContract(chainId, \"PositionRouter\");\r\n    const contract = new ethers.Contract(contractAddress, PositionRouter.abi, library.getSigner());\r\n    \r\n    const indexToken = getTokenInfo(infoTokens, indexTokenAddress);\r\n    const tokenSymbol = indexToken.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexToken.symbol;\r\n    const successMsg = t`Requested increase of ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"} by ${formatAmount(\r\n      toUsdMax,\r\n      USD_DECIMALS,\r\n      2\r\n    )} USD.`;\r\n\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      setPendingTxns,\r\n      sentMsg: `${isLong ? \"Long\" : \"Short\"} submitted.`,\r\n      failMsg: `${isLong ? \"Long\" : \"Short\"} failed.`,\r\n      successMsg,\r\n      // for Arbitrum, sometimes the successMsg shows after the position has already been executed\r\n      // hide the success message for Arbitrum as a workaround\r\n      hideSuccessMsg: chainId === ARBITRUM,\r\n    })\r\n      .then(async () => {\r\n        setIsConfirming(false);\r\n\r\n        const key = getPositionKey(account, path[path.length - 1], indexTokenAddress, isLong);\r\n        let nextSize = toUsdMax;\r\n        if (hasExistingPosition) {\r\n          nextSize = existingPosition.size.add(toUsdMax);\r\n        }\r\n\r\n        pendingPositions[key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            size: nextSize,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  const onSwapOptionChange = (opt) => {\r\n    setSwapOption(opt);\r\n    if (orderOption === STOP) {\r\n      setOrderOption(MARKET);\r\n    }\r\n    setAnchorOnFromAmount(true);\r\n    setFromValue(\"\");\r\n    setToValue(\"\");\r\n    setTriggerPriceValue(\"\");\r\n    setTriggerRatioValue(\"\");\r\n\r\n    if (opt === SHORT && infoTokens) {\r\n      const fromToken = getToken(chainId, tokenSelection[opt].from);\r\n      if (fromToken && fromToken.isStable) {\r\n        setShortCollateralAddress(fromToken.address);\r\n      } else {\r\n        const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n        setShortCollateralAddress(stableToken.address);\r\n      }\r\n    }\r\n  };\r\n\r\n  const onConfirmationClick = () => {\r\n    if (!active) {\r\n      props.connectWallet();\r\n      return;\r\n    }\r\n\r\n    if (needOrderBookApproval && suitableMarket?.name === 'GMX') {\r\n      approveOrderBook();\r\n      return;\r\n    }\r\n\r\n    if (isSwap) {\r\n      swap();\r\n      return;\r\n    }\r\n\r\n    switch(suitableMarket.name) {\r\n      case 'GMX':\r\n        if (orderOption === LIMIT) {\r\n          createIncreaseOrder();\r\n          return;\r\n        }\r\n        increasePosition();\r\n        return;\r\n      case 'GNS':\r\n        if (orderOption === LIMIT) {\r\n          openTrade(triggerPriceUsd);\r\n          return;\r\n        }\r\n        openTrade();\r\n        return;\r\n      default:\r\n        return;\r\n    }\r\n\r\n  };\r\n\r\n\r\n  function approveFromToken() {\r\n    const address = suitableMarket?.name === 'GMX'\r\n      ? routerAddress\r\n      : GNS_Storage.address;\r\n\r\n    approveTokens({\r\n      setIsApproving,\r\n      library,\r\n      tokenAddress: fromToken.address,\r\n      spender: address,\r\n      chainId: chainId,\r\n      onApproveSubmitted: () => {\r\n        setIsWaitingForApproval(true);\r\n      },\r\n      infoTokens,\r\n      getTokenInfo,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n    });\r\n  }\r\n\r\n  const onClickPrimary = () => {\r\n    if (isStopOrder) {\r\n      setOrderOption(MARKET);\r\n      return;\r\n    }\r\n\r\n    if (!active) {\r\n      props.connectWallet();\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval && suitableMarket?.name === 'GMX') {\r\n      approvePositionRouter({\r\n        sentMsg: t`Enable leverage sent.`,\r\n        failMsg: t`Enable leverage failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (needApproval) {\r\n      approveFromToken();\r\n      return;\r\n    }\r\n\r\n    if (needOrderBookApproval && suitableMarket?.name === 'GMX') {\r\n      approveOrderBook();\r\n      return;\r\n    }\r\n\r\n    const [error, modal, errorCode] = getError();\r\n\r\n    if (modal) {\r\n      setModalError(errorCode);\r\n      return;\r\n    }\r\n\r\n    if (isSwap) {\r\n      if (fromTokenAddress === AddressZero && toTokenAddress === nativeTokenAddress) {\r\n        wrap();\r\n        return;\r\n      }\r\n\r\n      if (fromTokenAddress === nativeTokenAddress && toTokenAddress === AddressZero) {\r\n        unwrap();\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsConfirming(true);\r\n    setIsHigherSlippageAllowed(false);\r\n  };\r\n\r\n  const isStopOrder = orderOption === STOP;\r\n  const showFromAndToSection = !isStopOrder;\r\n  const showTriggerPriceSection = !isSwap && !isMarketOrder && !isStopOrder;\r\n  const showTriggerRatioSection = isSwap && !isMarketOrder && !isStopOrder;\r\n\r\n\r\n  let fees;\r\n  let feesUsd;\r\n  let feeBps;\r\n  let swapFees;\r\n  let positionFee;\r\n  if (isSwap) {\r\n    if (fromAmount) {\r\n      const { feeBasisPoints } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (feeBasisPoints !== undefined) {\r\n        fees = fromAmount.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n        const feeTokenPrice =\r\n          fromTokenInfo.address === USDG_ADDRESS ? expandDecimals(1, USD_DECIMALS) : fromTokenInfo.maxPrice;\r\n        feesUsd = fees.mul(feeTokenPrice).div(expandDecimals(1, fromTokenInfo.decimals));\r\n      }\r\n      feeBps = feeBasisPoints;\r\n    }\r\n  } else if (toUsdMax && fromAmount) {\r\n    positionFee = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    if (suitableMarket?.name === 'GMX') {\r\n      feesUsd = positionFee;\r\n    } else if (suitableMarket?.name === 'GNS') {\r\n      feesUsd = expandDecimals(BigNumber.from(formatAmount(fromAmount.mul(leverage / 10**4), 4, 0, 0)).mul(8), 12);\r\n    }\r\n    \r\n\r\n    const { feeBasisPoints } = getNextToAmount(\r\n      chainId,\r\n      fromAmount,\r\n      fromTokenAddress,\r\n      collateralTokenAddress,\r\n      infoTokens,\r\n      undefined,\r\n      undefined,\r\n      usdgSupply,\r\n      totalTokenWeights,\r\n      isSwap\r\n    );\r\n    if (feeBasisPoints) {\r\n      swapFees = fromUsdMin.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n      feesUsd = feesUsd.add(swapFees);\r\n    }\r\n    feeBps = feeBasisPoints;\r\n  }\r\n\r\n  const [TPValue, setTPValue] = useState('');\r\n  const [SLValue, setSLValue] = useState('');\r\n  const [TPHasError, setTPHasError] = useState(false);\r\n  const [SLHasError, setSLHasError] = useState(false);\r\n  \r\n  const openTrade = async (price) => {\r\n    setIsSubmitting(true);\r\n    \r\n    const pairIndex = GNS_PAIRS[toToken.symbol];\r\n    const posSize = ethers.utils.parseEther(fromValue);\r\n    const openPrice = formatAmount(price ?? toTokenInfo.maxPrice, 20, 0, 0);\r\n    const roundLeverage = leverage / 10**4;\r\n    const typeOfOrder = isMarketOrder ? 0 : 1;\r\n    const slippage = userSlippage * 10**10;\r\n\r\n    const takeProfit = TPValue ? (formatForContract(TPValue, 10)).toFixed(0) : '0';\r\n    const stopLoss = SLValue ? (formatForContract(SLValue, 10)).toFixed(0) : '0';\r\n    \r\n    const fees = BigNumber.from(formatAmount(feesUsd, 12, 0, 0));\r\n    \r\n    const key = `${pairIndex}${roundLeverage}`;\r\n    \r\n    const contract = new ethers.Contract(GNS_Trading.address, GNS_Trading.abi, library.getSigner());\r\n    contract.openTrade(\r\n      [account, pairIndex, 0, 0, posSize, openPrice, isLong, roundLeverage, takeProfit, stopLoss],\r\n      typeOfOrder,\r\n      0,\r\n      slippage,\r\n      account\r\n    ).then(tsc => {\r\n      if (isMarketOrder) {\r\n        pendingPositionsGNS[key] = {\r\n          pairIndex,\r\n          isLong,\r\n          leverage,\r\n          positionSizeDai: posSize.sub(fees),\r\n        };\r\n        setPendingPositionsGNS(pendingPositionsGNS);\r\n      }\r\n      \r\n      setIsConfirming(false);\r\n      console.log(tsc);\r\n      \r\n      tsc.wait()\r\n        .then(() => {\r\n          notifySuccess(`${isMarketOrder ? 'Position' : 'Limit Order'} submitted!`, tsc.hash);\r\n        })\r\n    }, errAlert)\r\n    .finally(() => {\r\n      setIsSubmitting(false);\r\n      setIsPendingConfirmation(false);\r\n      setTPValue('');\r\n      setSLValue('');\r\n    });\r\n  };\r\n\r\n  const leverageStorage = {\r\n    GMX: {\r\n      marks: {\r\n        2: \"2x\",\r\n        5: \"5x\",\r\n        10: \"10x\",\r\n        15: \"15x\",\r\n        20: \"20x\",\r\n        25: \"25x\",\r\n        30: \"30x\",\r\n        35: \"35x\",\r\n        40: \"40x\",\r\n        45: \"45x\",\r\n        50: \"50x\",\r\n      },\r\n      min: 2,\r\n      max: 50,\r\n    },\r\n    GNS: {\r\n      marks: {\r\n        2: \"2x\",\r\n        25: \"25x\",\r\n        50: \"50x\",\r\n        75: \"75x\",\r\n        100: \"100x\",\r\n        125: \"125x\",\r\n        150: \"150x\",\r\n      },\r\n      min: 2,\r\n      max: 150,\r\n    }\r\n  };\r\n  const curLeverage = leverageStorage[suitableMarket?.name];\r\n\r\n  if (!fromToken || !toToken) {\r\n    return null;\r\n  }\r\n\r\n  let hasZeroBorrowFee = false;\r\n  let borrowFeeText;\r\n  if (isLong && toTokenInfo && toTokenInfo.fundingRate) {\r\n    borrowFeeText = formatAmount(toTokenInfo.fundingRate, 4, 4) + \"% / 1h\";\r\n    if (toTokenInfo.fundingRate.eq(0)) {\r\n      // hasZeroBorrowFee = true\r\n    }\r\n  }\r\n  if (isShort && shortCollateralToken && shortCollateralToken.fundingRate) {\r\n    borrowFeeText = formatAmount(shortCollateralToken.fundingRate, 4, 4) + \"% / 1h\";\r\n    if (shortCollateralToken.fundingRate.eq(0)) {\r\n      // hasZeroBorrowFee = true\r\n    }\r\n  }\r\n\r\n  function setFromValueToMaximumAvailable() {\r\n    if (!fromToken || !fromBalance) {\r\n      return;\r\n    }\r\n\r\n    const maxAvailableAmount = fromToken.isNative ? fromBalance.sub(bigNumberify(DUST_BNB).mul(2)) : fromBalance;\r\n    setFromValue(formatAmountFree(maxAvailableAmount, fromToken.decimals, fromToken.decimals));\r\n    setAnchorOnFromAmount(true);\r\n  }\r\n\r\n  function shouldShowMaxButton() {\r\n    if (!fromToken || !fromBalance) {\r\n      return false;\r\n    }\r\n    const maxAvailableAmount = fromToken.isNative ? fromBalance.sub(bigNumberify(DUST_BNB).mul(2)) : fromBalance;\r\n    return fromValue !== formatAmountFree(maxAvailableAmount, fromToken.decimals, fromToken.decimals);\r\n  }\r\n\r\n\r\n  return (\r\n    <div className=\"Exchange-swap-box\">\r\n      {/* <div className=\"Exchange-swap-wallet-box App-box\">\r\n        {active && <div className=\"Exchange-swap-account\" >\r\n        </div>}\r\n      </div> */}\r\n      <div className=\"Exchange-swap-box-inner App-box\">\r\n        <div>\r\n          <div className=\"Exchange-swap-box__settings\">\r\n            <Tab\r\n              icons={SWAP_ICONS}\r\n              options={SWAP_OPTIONS}\r\n              option={swapOption}\r\n              onChange={onSwapOptionChange}\r\n              className={\"Exchange-swap-option-tabs\"}\r\n            />\r\n            <button className=\"btn Exchange-swap-box__settings-btn\"\r\n              onClick={() => {\r\n                openModal('Choose-Market');\r\n              }}>\r\n              <img src={icon_settings} alt=\"Settings icon\" />\r\n            </button>\r\n          </div>\r\n          \r\n          {flagOrdersEnabled && (\r\n            <div className=\"Tab-inline-container\">\r\n              <Tab\r\n                options={orderOptions}\r\n                optionLabels={orderOptionLabels}\r\n                className=\"Exchange-swap-order-type-tabs\"\r\n                type=\"inline\"\r\n                option={orderOption}\r\n                onChange={onOrderOptionChange}\r\n              />\r\n            </div>\r\n            \r\n          )}\r\n        </div>\r\n        {showFromAndToSection && (\r\n          <React.Fragment>\r\n            <div className={\"Exchange-swap-section\"\r\n               + (hasInputError ? \" error\" : \"\") + (hasInputFocus ? \" hlight\" : \"\")}>\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  {fromUsdMin && (\r\n                    <div className=\"Exchange-swap-usd\">Pay: {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)} {suitableMarket?.name === 'GMX' && 'USD'}{suitableMarket?.name === 'GNS' && 'DAI'}</div>\r\n                  )}\r\n                  {!fromUsdMin && \"Pay\"}\r\n                </div>\r\n                {fromBalance && (\r\n                  <div className=\"muted align-right clickable\" onClick={setFromValueToMaximumAvailable}>\r\n                    Balance: {formatAmount(fromBalance, fromToken.decimals, 4, true)}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div className=\"Exchange-swap-input-container\">\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={fromValue}\r\n                    onChange={onFromValueChange}\r\n                    onFocus={(e) => {\r\n                      setHasInputFocus(true);\r\n                    }}\r\n                    onBlur={(e) => {\r\n                      setHasInputFocus(false);\r\n                    }}\r\n                  />\r\n                  {shouldShowMaxButton() && (\r\n                    <div className=\"Exchange-swap-max\" onClick={setFromValueToMaximumAvailable}>\r\n                      Max\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div>\r\n                  {/* Tokens control */}\r\n                  {suitableMarket?.name === 'GMX' &&\r\n                    <TokenSelector\r\n                      label=\"Pay\"\r\n                      chainId={chainId}\r\n                      tokenAddress={fromTokenAddress}\r\n                      onSelectToken={onSelectFromToken}\r\n                      tokens={fromTokens}\r\n                      infoTokens={infoTokens}\r\n                      showMintingCap={false}\r\n                      showTokenImgInDropdown={true}\r\n                    />}\r\n                  {suitableMarket?.name === 'GNS' &&\r\n                    <div className=\"TokenSelector-dummy\">DAI</div>\r\n                  }\r\n                  \r\n                </div>\r\n              </div>\r\n            </div>\r\n            {/* <div className=\"Exchange-swap-ball-container\">\r\n              <div className=\"Exchange-swap-ball\" onClick={switchTokens}>\r\n                <IoMdSwap className=\"Exchange-swap-ball-icon\" />\r\n              </div>\r\n            </div> */}\r\n            <div className=\"Exchange-swap-section\">\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  {toUsdMax && suitableMarket?.name === 'GMX' && (\r\n                    <div className=\"Exchange-swap-usd\">\r\n                      {getToLabel()}: {formatAmount(toUsdMax, USD_DECIMALS, 2, true)} USD\r\n                    </div>\r\n                  )}\r\n                  {toUsdMax && fromAmount && suitableMarket?.name === 'GNS' && (\r\n                    <div className=\"Exchange-swap-usd\">\r\n                      {getToLabel()}: {formatAmount(fromAmount.mul(leverage / 10**4), USDG_DECIMALS, 2, true)} USD\r\n                    </div>\r\n                  )}\r\n                  {!toUsdMax && getToLabel()}\r\n                </div>\r\n                {toBalance && isSwap && (\r\n                  <div className=\"muted align-right\">\r\n                    <Trans>Balance</Trans>: {formatAmount(toBalance, toToken.decimals, 4, true)}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div>\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={toValue}\r\n                    onChange={onToValueChange}\r\n                    onFocus={(e) => {\r\n                      e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                    }}\r\n                    onBlur={(e) => {\r\n                      e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <TokenSelector\r\n                    label={getTokenLabel()}\r\n                    chainId={chainId}\r\n                    tokenAddress={toTokenAddress}\r\n                    onSelectToken={onSelectToToken}\r\n                    tokens={toTokens}\r\n                    infoTokens={infoTokens}\r\n                    showTokenImgInDropdown={true}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </React.Fragment>\r\n        )}\r\n        {showTriggerRatioSection && (\r\n          <div className=\"Exchange-swap-section\">\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              {fromTokenInfo && toTokenInfo && (\r\n                <div\r\n                  className=\"muted align-right clickable\"\r\n                  onClick={() => {\r\n                    setTriggerRatioValue(\r\n                      formatAmountFree(\r\n                        getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted),\r\n                        USD_DECIMALS,\r\n                        10\r\n                      )\r\n                    );\r\n                  }}\r\n                >\r\n                  {formatAmount(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 4)}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input small\"\r\n                  value={triggerRatioValue}\r\n                  onChange={onTriggerRatioChange}\r\n                  onFocus={(e) => {\r\n                    e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                  }}\r\n                />\r\n              </div>\r\n              {(() => {\r\n                if (!toTokenInfo) return;\r\n                if (!fromTokenInfo) return;\r\n                const [tokenA, tokenB] = triggerRatioInverted\r\n                  ? [toTokenInfo, fromTokenInfo]\r\n                  : [fromTokenInfo, toTokenInfo];\r\n                return (\r\n                  <div className=\"PositionEditor-token-symbol\">\r\n                    {tokenA.symbol}&nbsp;per&nbsp;{tokenB.symbol}\r\n                  </div>\r\n                );\r\n              })()}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {showTriggerPriceSection && (\r\n          <div className=\"Exchange-swap-section\">\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              <div\r\n                className=\"muted align-right clickable\"\r\n                onClick={() => {\r\n                  setTriggerPriceValue(formatAmountFree(entryMarkPrice, USD_DECIMALS, 2));\r\n                }}\r\n              >\r\n                Mark: {formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input\"\r\n                  value={triggerPriceValue}\r\n                  onChange={onTriggerPriceChange}\r\n                  onFocus={(e) => {\r\n                    e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                  }}\r\n                />\r\n              </div>\r\n              <div className=\"PositionEditor-token-symbol\">USD</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {isSwap && (\r\n          <div className=\"Exchange-swap-box-info\">\r\n            <ExchangeInfoRow label=\"Fees\">\r\n              <div>\r\n                {!fees && \"-\"}\r\n                {fees && (\r\n                  <div>\r\n                    {formatAmount(feeBps, 2, 2, false)}%&nbsp; ({formatAmount(fees, fromToken.decimals, 4, true)}{\" \"}\r\n                    {fromToken.symbol}: ${formatAmount(feesUsd, USD_DECIMALS, 2, true)})\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </ExchangeInfoRow>\r\n          </div>\r\n        )}\r\n        {(isLong || isShort) && !isStopOrder && (\r\n          <div className=\"Exchange-leverage-box\">\r\n            <div className=\"Exchange-leverage-slider-settings\">\r\n              <div>Leverage</div>\r\n              {(isLong || isShort) && hasLeverageOption && (\r\n                <div className=\"Exchange-leverage-value\">\r\n                  {parseFloat(leverageOption).toFixed(2)}x\r\n                </div>\r\n              )}\r\n            </div>\r\n            {isLeverageSliderEnabled && (\r\n              <div\r\n                className={cx(\"Exchange-leverage-slider\", \"App-slider\", {\r\n                  positive: isLong,\r\n                  negative: isShort,\r\n                })}\r\n              >\r\n                <Slider\r\n                  min={curLeverage?.min}\r\n                  max={curLeverage?.max}\r\n                  step={1}\r\n                  marks={curLeverage?.marks}\r\n                  handle={leverageSliderHandle}\r\n                  onChange={(value) => setLeverageOption(value)}\r\n                  value={leverageOption}\r\n                  defaultValue={leverageOption}\r\n                />\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Tooltip\r\n                  className=\"has-hint-tooltip nowrap\"\r\n                  handle=\"Liquidity Source\"\r\n                  position=\"left-bottom\"\r\n                  enabled={true}\r\n                  renderContent={() => {\r\n                    return (\r\n                      <div className=\"Tooltip__text\">\r\n                        DeDeLend will automatically <br />choose an appropriate <br />liquidity source\r\n                      </div>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Selector\r\n                  items={marketsList.map(market => market.name)}\r\n                  chosenItem={suitableMarket?.name}\r\n                  onSelect={onMarketSelect}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                Available Liquidity\r\n              </div>\r\n              <div className=\"align-right icon-container\">\r\n                ${suitableMarket && liquidity && (\r\n                  liquidity[suitableMarket?.name]?.formattedValue\r\n                )}\r\n              </div>\r\n            </div>\r\n            {isShort && (\r\n              <div className=\"Exchange-info-row Exchange-info-row_relative\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Collateral In</Trans>\r\n                </div>\r\n\r\n                <div className=\"align-right\">\r\n                  {\r\n                    suitableMarket?.name === 'GMX' &&\r\n                      <TokenSelector\r\n                        label=\"Collateral In\"\r\n                        chainId={chainId}\r\n                        tokenAddress={shortCollateralAddress}\r\n                        onSelectToken={onSelectShortCollateralAddress}\r\n                        tokens={stableTokens}\r\n                        showTokenImgInDropdown={true}\r\n                        disabled={false}\r\n                      />\r\n                  }\r\n                  {\r\n                    suitableMarket?.name === 'GNS' &&\r\n                      'DAI'\r\n                  }\r\n                </div>\r\n              </div>\r\n            )}\r\n            {isLong && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Collateral In</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {\r\n                    suitableMarket?.name === 'GMX' &&\r\n                      'USD'\r\n                  }\r\n                  {\r\n                    suitableMarket?.name === 'GNS' &&\r\n                      'DAI'\r\n                  }\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Entry Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                  {\r\n                    suitableMarket?.name === 'GMX' &&\r\n                    hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                      <div className=\"inline-block muted\">\r\n                        ${formatAmount(existingPosition.averagePrice, USD_DECIMALS, 2, true)}\r\n                        <BsArrowRight className=\"transition-arrow\" />\r\n                      </div>\r\n                    )\r\n                  }\r\n                {nextAveragePrice && `$${formatAmount(nextAveragePrice, USD_DECIMALS, 2, true)}`}\r\n                {!nextAveragePrice && `-`}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Liq. Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {\r\n                  suitableMarket?.name === 'GMX' &&\r\n                  hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(existingLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                  )\r\n                }\r\n                {toAmount &&\r\n                  displayLiquidationPrice &&\r\n                  `$${formatAmount(displayLiquidationPrice, USD_DECIMALS, 2, true)}`}\r\n                {!toAmount && displayLiquidationPrice && `-`}\r\n                {!displayLiquidationPrice && `-`}\r\n              </div>\r\n            </div>\r\n            <ExchangeInfoRow label=\"Fees\">\r\n              <div>\r\n                {!feesUsd && \"-\"}\r\n                {feesUsd && (\r\n                  <Tooltip\r\n                    handle={`${suitableMarket?.name === 'GMX' ? '$' : ''}${formatAmount(feesUsd, USD_DECIMALS, 2, true)}${suitableMarket?.name === 'GNS' ? ' DAI' : ''}`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <div>\r\n                          {swapFees && (\r\n                            <div>\r\n                              {collateralToken.symbol} is required for collateral. <br />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Swap ${fromToken.symbol} to ${collateralToken.symbol} Fee`}\r\n                                value={formatAmount(swapFees, USD_DECIMALS, 2, true)}\r\n                              />\r\n                              <br />\r\n                            </div>\r\n                          )}\r\n                          <div>\r\n                            <StatsTooltipRow\r\n                              label={`Position Fee (0.1% of position size)`}\r\n                              value={formatAmount(positionFee, USD_DECIMALS, 2, true)}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    }}\r\n                  />\r\n                )}\r\n              </div>\r\n            </ExchangeInfoRow>\r\n          </div>\r\n        )}\r\n        {isStopOrder && (\r\n          <div className=\"Exchange-swap-section Exchange-trigger-order-info\">\r\n            Take-profit and stop-loss orders can be set after opening a position. <br />\r\n            <br />\r\n            There will be a \"Close\" button on each position row, clicking this will display the option to set trigger\r\n            orders. <br />\r\n            <br />\r\n            For screenshots and more information, please see the{\" \"}\r\n            <a\r\n              href=\"https://gmxio.gitbook.io/gmx/trading#stop-loss-take-profit-orders\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              docs\r\n            </a>\r\n            .\r\n          </div>\r\n        )}\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className={cx(\"Exchange-swap-button btn\", isPrimaryEnabled() && \" btn_hlight\")} onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </div>\r\n      {/* {isSwap && (\r\n        <div className=\"Exchange-swap-market-box App-box App-box-border\">\r\n          <div className=\"Exchange-swap-market-box-title\">\r\n            <Trans>Swap</Trans>\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">{fromToken.symbol} Price</div>\r\n            <div className=\"align-right\">\r\n              ${fromTokenInfo && formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">{toToken.symbol} Price</div>\r\n            <div className=\"align-right\">\r\n              ${toTokenInfo && formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Available Liquidity</Trans>\r\n            </div>\r\n\r\n            <div className=\"align-right al-swap\">\r\n              <Tooltip\r\n                handle={`$${formatAmount(maxSwapAmountUsd, USD_DECIMALS, 2, true)}`}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      <StatsTooltipRow\r\n                        label={`Max ${fromTokenInfo.symbol} in`}\r\n                        value={[\r\n                          `${formatAmount(maxFromTokenIn, fromTokenInfo.decimals, 0, true)} ${fromTokenInfo.symbol}`,\r\n                          `($${formatAmount(maxFromTokenInUSD, USD_DECIMALS, 0, true)})`,\r\n                        ]}\r\n                      />\r\n                      <StatsTooltipRow\r\n                        label={`Max ${toTokenInfo.symbol} out`}\r\n                        value={[\r\n                          `${formatAmount(maxToTokenOut, toTokenInfo.decimals, 0, true)} ${toTokenInfo.symbol}`,\r\n                          `($${formatAmount(maxToTokenOutUSD, USD_DECIMALS, 0, true)})`,\r\n                        ]}\r\n                      />\r\n                    </div>\r\n                  );\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          {!isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Price\">\r\n              {getExchangeRateDisplay(getExchangeRate(fromTokenInfo, toTokenInfo), fromToken, toToken)}\r\n            </ExchangeInfoRow>\r\n          )}\r\n        </div>\r\n      )}\r\n      {(isLong || isShort) && (\r\n        <div className=\"Exchange-swap-market-box App-box App-box-border\">\r\n          <div className=\"Exchange-swap-market-box-title\">\r\n            {isLong ? \"Long\" : \"Short\"}&nbsp;{toToken.symbol}\r\n          </div>\r\n          {renderAvailableLongLiquidity()}\r\n          {isShort && toTokenInfo.hasMaxAvailableShort && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Available Liquidity</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  handle={`$${formatAmount(toTokenInfo.maxAvailableShort, USD_DECIMALS, 2, true)}`}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <>\r\n                        <StatsTooltipRow\r\n                          label={`Max ${toTokenInfo.symbol} short capacity`}\r\n                          value={formatAmount(toTokenInfo.maxGlobalShortSize, USD_DECIMALS, 0, true)}\r\n                        />\r\n                        <StatsTooltipRow\r\n                          label={`Current ${toTokenInfo.symbol} shorts`}\r\n                          value={formatAmount(toTokenInfo.globalShortSize, USD_DECIMALS, 0, true)}\r\n                        />\r\n                      </>\r\n                    );\r\n                  }}\r\n                ></Tooltip>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )} */}\r\n      <NoLiquidityErrorModal\r\n        chainId={chainId}\r\n        fromToken={fromToken}\r\n        toToken={toToken}\r\n        shortCollateralToken={shortCollateralToken}\r\n        isLong={isLong}\r\n        isShort={isShort}\r\n        modalError={modalError}\r\n        setModalError={setModalError}\r\n      />\r\n      {isConfirming && (\r\n        <ConfirmationBox\r\n          library={library}\r\n          isHigherSlippageAllowed={isHigherSlippageAllowed}\r\n          setIsHigherSlippageAllowed={setIsHigherSlippageAllowed}\r\n          orders={orders}\r\n          isSwap={isSwap}\r\n          isLong={isLong}\r\n          isMarketOrder={isMarketOrder}\r\n          orderOption={orderOption}\r\n          isShort={isShort}\r\n          fromToken={fromToken}\r\n          fromTokenInfo={fromTokenInfo}\r\n          toToken={toToken}\r\n          toTokenInfo={toTokenInfo}\r\n          toAmount={toAmount}\r\n          fromAmount={fromAmount}\r\n          feeBps={feeBps}\r\n          onConfirmationClick={onConfirmationClick}\r\n          setIsConfirming={setIsConfirming}\r\n          hasExistingPosition={hasExistingPosition}\r\n          shortCollateralAddress={USDC.address}\r\n          shortCollateralToken={shortCollateralToken}\r\n          leverage={leverage}\r\n          existingPosition={existingPosition}\r\n          existingLiquidationPrice={existingLiquidationPrice}\r\n          displayLiquidationPrice={displayLiquidationPrice}\r\n          nextAveragePrice={nextAveragePrice}\r\n          triggerPriceUsd={triggerPriceUsd}\r\n          triggerRatio={triggerRatio}\r\n          fees={fees}\r\n          feesUsd={feesUsd}\r\n          isSubmitting={isSubmitting}\r\n          isPendingConfirmation={isPendingConfirmation}\r\n          fromUsdMin={fromUsdMin}\r\n          toUsdMax={toUsdMax}\r\n          collateralTokenAddress={collateralTokenAddress}\r\n          infoTokens={infoTokens}\r\n          chainId={chainId}\r\n          setPendingTxns={setPendingTxns}\r\n          pendingTxns={pendingTxns}\r\n          minExecutionFee={minExecutionFee}\r\n          minExecutionFeeUSD={minExecutionFeeUSD}\r\n          minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n          savedSlippageAmount={savedSlippageAmount}\r\n          userSlippage={userSlippage}\r\n          setUserSlippage={setUserSlippage}\r\n          allowedSlippage={allowedSlippage}\r\n          market={suitableMarket?.name}\r\n          TPValue={TPValue}\r\n          setTPValue={setTPValue}\r\n          SLValue={SLValue}\r\n          setSLValue={setSLValue}\r\n          SLHasError={SLHasError}\r\n          setSLHasError={setSLHasError}\r\n          TPHasError={TPHasError}\r\n          setTPHasError={setTPHasError}\r\n          liquidity={liquidity}\r\n        />\r\n      )}\r\n      {renderModal()}\r\n    </div>\r\n  );\r\n}","import React from \"react\";\r\nimport { Menu } from \"@headlessui/react\";\r\nimport { FaChevronDown } from \"react-icons/fa\";\r\nimport cx from \"classnames\";\r\nimport \"./ChartTokenSelector.scss\";\r\nimport \"../AddressDropdown/AddressDropdown.css\";\r\nimport { getTokens, getWhitelistedTokens } from \"../../config/Tokens\";\r\nimport { LONG, SHORT, SWAP } from \"../../lib/legacy\";\r\nimport { ethers } from 'ethers';\r\n\r\nexport default function ChartTokenSelector(props) {\r\n  const { chainId, selectedToken, onSelectToken, swapOption } = props;\r\n\r\n  const isLong = swapOption === LONG;\r\n  const isShort = swapOption === SHORT;\r\n  const isSwap = swapOption === SWAP;\r\n\r\n  let options = getTokens(chainId);\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n\r\n  const indexTokens = whitelistedTokens.filter((token) => !token.isStable && !token.isWrapped);\r\n  const shortableTokens = indexTokens.filter((token) => token.isShortable);\r\n\r\n  if (isLong) {\r\n    options = indexTokens;\r\n  }\r\n  if (isShort) {\r\n    options = shortableTokens;\r\n  }\r\n\r\n  const onSelect = async (token) => {\r\n    onSelectToken(token);\r\n  };\r\n\r\n  const value = selectedToken;\r\n  let icon;\r\n  if (value.symbol) {\r\n    icon = require(\"../../img/ddl/ic_\" + value.symbol?.toLowerCase() + \"_40.svg\")?.default;\r\n  }\r\n\r\n  return (\r\n    <Menu>\r\n      <Menu.Button as=\"div\" disabled={isSwap}>\r\n        <button className={cx(\"App-cta small transparent chart-token-selector\", { \"default-cursor\": isSwap /* \"default-cursor\": \"default\" */ })}>\r\n          <div className=\"chart-token-selector--name\">\r\n            <img src={icon} className=\"chart-token-selector--icon\" alt={value.symbol + ' icon'} />\r\n            <span className=\"chart-token-selector--current\">{value.symbol}/USD</span>\r\n          </div>\r\n          \r\n          {!isSwap && (\r\n            <svg className=\"chevron-down\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"21\" viewBox=\"0 0 20 21\" fill=\"none\">\r\n              <path d=\"M4 8L10 13L16 8\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n            </svg>\r\n          )}\r\n        </button>\r\n      </Menu.Button>\r\n      <div className=\"chart-token-menu\">\r\n        <Menu.Items as=\"div\" className=\"menu-items chart-token-menu-items divided\">\r\n          {options.map((option, index) => {\r\n            let tokenPopupImage;\r\n            try {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_\" + option.symbol.toLowerCase() + \"_40.svg\");\r\n            } catch (error) {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_eth_40.svg\");\r\n            }\r\n            \r\n            return (<Menu.Item key={index}>\r\n              <div\r\n                className={\"menu-item\" + (option.symbol === value.symbol ? ' chosen' : '')}\r\n                onClick={() => {\r\n                  onSelect(option);\r\n                }}\r\n              >\r\n                <img src={tokenPopupImage?.default} alt={option.symbol + ' icon'} className=\"token-icon\" />\r\n                <span style={{ marginLeft: 7, marginRight: 35 }} className=\"token-label\">\r\n                  {option.symbol} / USD\r\n                </span>\r\n              </div>\r\n            </Menu.Item>)\r\n          })}\r\n        </Menu.Items>\r\n      </div>\r\n    </Menu>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useRef, useCallback, useMemo } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport { createChart } from \"krasulya-lightweight-charts\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  SWAP,\r\n  INCREASE,\r\n  CHART_PERIODS,\r\n  getTokenInfo,\r\n  formatAmount,\r\n  formatDateTime,\r\n  usePrevious,\r\n  getLiquidationPrice,\r\n  useLocalStorageSerializeKey,\r\n  numberWithCommas,\r\n} from \"../../lib/legacy\";\r\nimport { useChartPrices } from \"../../domain/legacy\";\r\nimport Tab from \"../Tab/Tab\";\r\n\r\nimport { getTokens, getToken } from \"../../config/Tokens\";\r\nimport ChartTokenSelector from \"./ChartTokenSelector\";\r\nimport Tooltip from './../Tooltip/Tooltip';\r\n\r\nconst PRICE_LINE_TEXT_WIDTH = 15;\r\n\r\nconst timezoneOffset = -new Date().getTimezoneOffset() * 60;\r\n\r\nexport function getChartToken(swapOption, fromToken, toToken, chainId) {\r\n  if (!fromToken || !toToken) {\r\n    return;\r\n  }\r\n\r\n  if (swapOption !== SWAP) {\r\n    return toToken;\r\n  }\r\n\r\n  if (fromToken.isUsdg && toToken.isUsdg) {\r\n    return getTokens(chainId).find((t) => t.isStable);\r\n  }\r\n  if (fromToken.isUsdg) {\r\n    return toToken;\r\n  }\r\n  if (toToken.isUsdg) {\r\n    return fromToken;\r\n  }\r\n\r\n  if (fromToken.isStable && toToken.isStable) {\r\n    return toToken;\r\n  }\r\n  if (fromToken.isStable) {\r\n    return toToken;\r\n  }\r\n  if (toToken.isStable) {\r\n    return fromToken;\r\n  }\r\n\r\n  return toToken;\r\n}\r\n\r\nconst DEFAULT_PERIOD = \"4h\";\r\n\r\nconst RED_COLOR = \"#C75E4B\";\r\nconst GREEN_COLOR = \"#46956A\";\r\n\r\nconst getSeriesOptions = () => ({\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/area-series.md\r\n  lineColor: \"#5472cc\",\r\n  topColor: \"rgba(49, 69, 131, 0.4)\",\r\n  bottomColor: \"rgba(42, 64, 103, 0.0)\",\r\n  lineWidth: 2,\r\n  priceLineColor: \"#384263\",\r\n  downColor: RED_COLOR,\r\n  wickDownColor: RED_COLOR,\r\n  upColor: GREEN_COLOR,\r\n  wickUpColor: GREEN_COLOR,\r\n  borderVisible: false,\r\n});\r\n\r\nconst getChartOptions = (width, height) => ({\r\n  width,\r\n  height,\r\n  layout: {\r\n    backgroundColor: \"rgba(255, 255, 255, 0)\",\r\n    textColor: \"#747FA6\",\r\n    fontFamily: \"Gantari\",\r\n  },\r\n  localization: {\r\n    // https://github.com/tradingview/lightweight-charts/blob/master/docs/customization.md#time-format\r\n    timeFormatter: (businessDayOrTimestamp) => {\r\n      return formatDateTime(businessDayOrTimestamp - timezoneOffset);\r\n    },\r\n  },\r\n  grid: {\r\n    vertLines: {\r\n      visible: true,\r\n      color: \"rgba(35, 38, 59, 1)\",\r\n      style: 2,\r\n    },\r\n    horzLines: {\r\n      visible: true,\r\n      color: \"rgba(35, 38, 59, 1)\",\r\n      style: 2,\r\n    },\r\n  },\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/time-scale.md#time-scale\r\n  timeScale: {\r\n    rightOffset: 5,\r\n    borderVisible: false,\r\n    barSpacing: 5,\r\n    timeVisible: true,\r\n    fixLeftEdge: true,\r\n  },\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/customization.md#price-axis\r\n  priceScale: {\r\n    borderVisible: false,\r\n  },\r\n  crosshair: {\r\n    horzLine: {\r\n      color: \"#aaa\",\r\n    },\r\n    vertLine: {\r\n      color: \"#aaa\",\r\n    },\r\n    mode: 0,\r\n  },\r\n});\r\n\r\nexport default function ExchangeTVChart(props) {\r\n  const {\r\n    swapOption,\r\n    fromTokenAddress,\r\n    toTokenAddress,\r\n    infoTokens,\r\n    chainId,\r\n    positions,\r\n    savedShouldShowPositionLines,\r\n    orders,\r\n    setToTokenAddress,\r\n  } = props;\r\n  const [currentChart, setCurrentChart] = useState();\r\n  const [currentSeries, setCurrentSeries] = useState();\r\n\r\n  let [period, setPeriod] = useLocalStorageSerializeKey([chainId, \"Chart-period\"], DEFAULT_PERIOD);\r\n  if (!(period in CHART_PERIODS)) {\r\n    period = DEFAULT_PERIOD;\r\n  }\r\n\r\n  const [hoveredCandlestick, setHoveredCandlestick] = useState();\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  const [chartToken, setChartToken] = useState({\r\n    maxPrice: null,\r\n    minPrice: null,\r\n  });\r\n  useEffect(() => {\r\n    const tmp = getChartToken(swapOption, fromToken, toToken, chainId);\r\n    setChartToken(tmp);\r\n  }, [swapOption, fromToken, toToken, chainId]);\r\n\r\n  const symbol = chartToken ? (chartToken.isWrapped ? chartToken.baseSymbol : chartToken.symbol) : undefined;\r\n  const marketName = chartToken ? symbol + \"_USD\" : undefined;\r\n  const previousMarketName = usePrevious(marketName);\r\n\r\n  const currentOrders = useMemo(() => {\r\n    if (swapOption === SWAP || !chartToken) {\r\n      return [];\r\n    }\r\n\r\n    return orders.filter((order) => {\r\n      if (order.type === SWAP) {\r\n        // we can't show non-stable to non-stable swap orders with existing charts\r\n        // so to avoid users confusion we'll show only long/short orders\r\n        return false;\r\n      }\r\n\r\n      const indexToken = getToken(chainId, order.indexToken);\r\n      return order.indexToken === chartToken.address || (chartToken.isNative && indexToken.isWrapped);\r\n    });\r\n  }, [orders, chartToken, swapOption, chainId]);\r\n\r\n  const ref = useRef(null);\r\n  const chartRef = useRef(null);\r\n\r\n  const currentAveragePrice =\r\n    chartToken.maxPrice && chartToken.minPrice ? chartToken.maxPrice.add(chartToken.minPrice).div(2) : null;\r\n  const [priceData, updatePriceData] = useChartPrices(\r\n    chainId,\r\n    chartToken.symbol,\r\n    chartToken.isStable,\r\n    period,\r\n    currentAveragePrice\r\n  );\r\n\r\n  const [chartInited, setChartInited] = useState(false);\r\n  useEffect(() => {\r\n    if (marketName !== previousMarketName) {\r\n      setChartInited(false);\r\n    }\r\n  }, [marketName, previousMarketName]);\r\n\r\n  const scaleChart = useCallback(() => {\r\n    const from = Date.now() / 1000 - (7 * 24 * CHART_PERIODS[period]) / 2 + timezoneOffset;\r\n    const to = Date.now() / 1000 + timezoneOffset;\r\n    currentChart.timeScale().setVisibleRange({ from, to });\r\n  }, [currentChart, period]);\r\n\r\n  const onCrosshairMove = useCallback(\r\n    (evt) => {\r\n      if (!evt.time) {\r\n        setHoveredCandlestick(null);\r\n        return;\r\n      }\r\n\r\n      for (const point of evt.seriesPrices.values()) {\r\n        setHoveredCandlestick((hoveredCandlestick) => {\r\n          if (hoveredCandlestick && hoveredCandlestick.time === evt.time) {\r\n            // rerender optimisations\r\n            return hoveredCandlestick;\r\n          }\r\n          return {\r\n            time: evt.time,\r\n            ...point,\r\n          };\r\n        });\r\n        break;\r\n      }\r\n    },\r\n    [setHoveredCandlestick]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!ref.current || !priceData || !priceData.length || currentChart) {\r\n      return;\r\n    }\r\n\r\n    const chart = createChart(\r\n      chartRef.current,\r\n      getChartOptions(chartRef.current.offsetWidth, chartRef.current.offsetHeight)\r\n    );\r\n\r\n    chart.subscribeCrosshairMove(onCrosshairMove);\r\n\r\n    const series = chart.addCandlestickSeries(getSeriesOptions());\r\n\r\n    setCurrentChart(chart);\r\n    setCurrentSeries(series);\r\n  }, [ref, priceData, currentChart, onCrosshairMove]);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      updatePriceData(undefined, true);\r\n    }, 10 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [updatePriceData]);\r\n\r\n  useEffect(() => {\r\n    if (!currentChart) {\r\n      return;\r\n    }\r\n    const resizeChart = () => {\r\n      currentChart.resize(chartRef.current.offsetWidth, chartRef.current.offsetHeight);\r\n    };\r\n    window.addEventListener(\"resize\", resizeChart);\r\n    return () => window.removeEventListener(\"resize\", resizeChart);\r\n  }, [currentChart]);\r\n\r\n  useEffect(() => {\r\n    if (currentSeries && priceData && priceData.length) {\r\n      currentSeries.setData(priceData);\r\n\r\n      if (!chartInited) {\r\n        scaleChart();\r\n        setChartInited(true);\r\n      }\r\n    }\r\n  }, [priceData, currentSeries, chartInited, scaleChart]);\r\n\r\n  useEffect(() => {\r\n    const lines = [];\r\n    if (currentSeries && savedShouldShowPositionLines) {\r\n      if (currentOrders && currentOrders.length > 0) {\r\n        currentOrders.forEach((order) => {\r\n          const indexToken = getToken(chainId, order.indexToken);\r\n          let tokenSymbol;\r\n          if (indexToken && indexToken.symbol) {\r\n            tokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n          }\r\n          const title = `${order.type === INCREASE ? \"Inc.\" : \"Dec.\"} ${tokenSymbol} ${\r\n            order.isLong ? \"Long\" : \"Short\"\r\n          }`;\r\n          const color = \"#3a3e5e\";\r\n          /* lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(order.triggerPrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: title.padEnd(PRICE_LINE_TEXT_WIDTH, \" \"),\r\n            })\r\n          ); */\r\n        });\r\n      }\r\n      if (positions && positions.length > 0) {\r\n        const color = \"#3a3e5e\";\r\n\r\n        positions.forEach((position) => {\r\n          /* lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(position.averagePrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: `Open ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}`.padEnd(\r\n                PRICE_LINE_TEXT_WIDTH,\r\n                \" \"\r\n              ),\r\n            })\r\n          ); */\r\n\r\n          const liquidationPrice = getLiquidationPrice(position);\r\n          /* lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(liquidationPrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: `Liq. ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}`.padEnd(\r\n                PRICE_LINE_TEXT_WIDTH,\r\n                \" \"\r\n              ),\r\n            })\r\n          ); */\r\n        });\r\n      }\r\n    }\r\n    return () => {\r\n      lines.forEach((line) => currentSeries.removePriceLine(line));\r\n    };\r\n  }, [currentOrders, positions, currentSeries, chainId, savedShouldShowPositionLines]);\r\n\r\n  const candleStatsHtml = useMemo(() => {\r\n    if (!priceData) {\r\n      return null;\r\n    }\r\n    const candlestick = hoveredCandlestick || priceData[priceData.length - 1];\r\n    if (!candlestick) {\r\n      return null;\r\n    }\r\n\r\n    const className = cx({\r\n      \"ExchangeChart-bottom-stats\": true,\r\n      positive: candlestick.open <= candlestick.close,\r\n      negative: candlestick.open > candlestick.close,\r\n      [`length-${String(parseInt(candlestick.close)).length}`]: true,\r\n    });\r\n\r\n    const toFixedNumbers = 2;\r\n\r\n    return (\r\n      <div className={className}>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">O</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.open.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">H</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.high.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">L</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.low.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">C</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.close.toFixed(toFixedNumbers)}</span>\r\n      </div>\r\n    );\r\n  }, [hoveredCandlestick, priceData]);\r\n\r\n  let high;\r\n  let low;\r\n  let deltaPrice;\r\n  let delta;\r\n  let deltaPercentage;\r\n  let deltaPercentageStr;\r\n\r\n  const now = parseInt(Date.now() / 1000);\r\n  const timeThreshold = now - 24 * 60 * 60;\r\n\r\n  if (priceData) {\r\n    for (let i = priceData.length - 1; i > 0; i--) {\r\n      const price = priceData[i];\r\n      if (price.time < timeThreshold) {\r\n        break;\r\n      }\r\n      if (!low) {\r\n        low = price.low;\r\n      }\r\n      if (!high) {\r\n        high = price.high;\r\n      }\r\n\r\n      if (price.high > high) {\r\n        high = price.high;\r\n      }\r\n      if (price.low < low) {\r\n        low = price.low;\r\n      }\r\n\r\n      deltaPrice = price.open;\r\n    }\r\n  }\r\n\r\n  if (deltaPrice && currentAveragePrice) {\r\n    const average = parseFloat(formatAmount(currentAveragePrice, USD_DECIMALS, 2));\r\n    delta = average - deltaPrice;\r\n    deltaPercentage = (delta * 100) / average;\r\n    if (deltaPercentage > 0) {\r\n      deltaPercentageStr = `+${deltaPercentage.toFixed(2)}%`;\r\n    } else {\r\n      deltaPercentageStr = `${deltaPercentage.toFixed(2)}%`;\r\n    }\r\n    if (deltaPercentage === 0) {\r\n      deltaPercentageStr = \"0.00\";\r\n    }\r\n  }\r\n\r\n  if (!chartToken) {\r\n    return null;\r\n  }\r\n\r\n  const onSelectToken = (token) => {\r\n    const tmp = getTokenInfo(infoTokens, token.address);\r\n    setChartToken(tmp);\r\n    setToTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"ExchangeChart tv\" ref={ref}>\r\n      <div className=\"ExchangeChart-top App-box App-box-border\">\r\n        <div className=\"ExchangeChart-top-inner\">\r\n          <div>\r\n            <div className=\"ExchangeChart-title\">\r\n              <ChartTokenSelector\r\n                chainId={chainId}\r\n                selectedToken={chartToken}\r\n                swapOption={swapOption}\r\n                infoTokens={infoTokens}\r\n                onSelectToken={onSelectToken}\r\n                className=\"chart-token-selector pos-relative\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"ExchangeChart-stats-container\">\r\n            <div>\r\n              <div className=\"ExchangeChart-info-label\">\r\n                <Tooltip\r\n                  className=\"has-hint-tooltip nowrap cur-price-tooltip\"\r\n                  handle=\"Current Price\"\r\n                  position=\"left-bottom\"\r\n                  enabled={true}\r\n                  renderContent={() => {\r\n                    return (\r\n                      <div className=\"Tooltip__text\">\r\n                        Asset price is taken from GMX\r\n                      </div>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n              \r\n              {/* <div className=\"ExchangeChart-info-label\">\r\n                Current Price\r\n              </div> */}\r\n              <div className=\"ExchangeChart-main-price\">\r\n                ${chartToken.maxPrice && formatAmount(chartToken.maxPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"ExchangeChart-info-label\">24h Change</div>\r\n              <div className={cx({ positive: deltaPercentage > 0, negative: deltaPercentage < 0 })}>\r\n                {!deltaPercentageStr && \"-\"}\r\n                {deltaPercentageStr && deltaPercentageStr}\r\n              </div>\r\n            </div>\r\n            <div className=\"ExchangeChart-additional-info\">\r\n              <div className=\"ExchangeChart-info-label\">24h High</div>\r\n              <div>\r\n                {!high && \"-\"}\r\n                {high && numberWithCommas(high.toFixed(2))}\r\n              </div>\r\n            </div>\r\n            <div className=\"ExchangeChart-additional-info\">\r\n              <div className=\"ExchangeChart-info-label\">24h Low</div>\r\n              <div>\r\n                {!low && \"-\"}\r\n                {low && numberWithCommas(low.toFixed(2))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"ExchangeChart-bottom App-box App-box-border\">\r\n        <div className=\"ExchangeChart-bottom-header\">\r\n          <div className=\"ExchangeChart-bottom-controls\">\r\n            <Tab options={Object.keys(CHART_PERIODS)} option={period} setOption={setPeriod} />\r\n          </div>\r\n          {candleStatsHtml}\r\n        </div>\r\n        <div className=\"ExchangeChart-bottom-content\" ref={chartRef}></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useCallback, useEffect, useMemo } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  formatAmount,\r\n  bigNumberify,\r\n  ARBITRUM,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  USD_DECIMALS,\r\n  DUST_USD,\r\n  BASIS_POINTS_DIVISOR,\r\n  USDG_ADDRESS,\r\n  SLIPPAGE_BPS_KEY,\r\n  TRIGGER_PREFIX_BELOW,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  MIN_PROFIT_TIME,\r\n  usePrevious,\r\n  formatAmountFree,\r\n  parseValue,\r\n  expandDecimals,\r\n  getTokenInfo,\r\n  getLiquidationPrice,\r\n  getLeverage,\r\n  getMarginFee,\r\n  PRECISION,\r\n  MARKET,\r\n  STOP,\r\n  DECREASE,\r\n  useLocalStorageSerializeKey,\r\n  calculatePositionDelta,\r\n  getDeltaStr,\r\n  getProfitPrice,\r\n  formatDateTime,\r\n  getTimeRemaining,\r\n  getNextToAmount,\r\n  getUsd,\r\n  USDG_DECIMALS,\r\n  CLOSE_POSITION_RECEIVE_TOKEN_KEY,\r\n  useLocalStorageByChainId,\r\n  adjustForDecimals,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n  MAX_ALLOWED_LEVERAGE,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { createDecreaseOrder, useHasOutdatedUi } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport TokenSelector from \"./TokenSelector\";\r\nimport { getTokens } from \"../../config/Tokens\";\r\nimport \"./PositionSeller.css\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nimport marketImg from '../../img/ddl/icon_market.svg'\r\nimport marketActiveImg from '../../img/ddl/icon_market_active.svg'\r\nimport triggerImg from '../../img/ddl/icon_trigger.svg'\r\nimport triggerActiveImg from '../../img/ddl/icon_trigger_active.svg'\r\nimport SlippageInput from './../SlippageInput/SlippageInput';\r\n\r\nconst CLOSE_ICONS = {\r\n  Market: marketImg,\r\n  Market_active: marketActiveImg,\r\n  Stop: triggerImg,\r\n  Stop_active: triggerActiveImg,\r\n}\r\n\r\nconst { AddressZero } = ethers.constants;\r\nconst ORDER_SIZE_DUST_USD = expandDecimals(1, USD_DECIMALS - 1); // $0.10\r\n\r\nconst orderOptionLabels = {\r\n  [MARKET]: \"Market\",\r\n  [STOP]: \"Trigger\",\r\n};\r\n\r\nfunction getTokenAmount(usdAmount, tokenAddress, max, infoTokens) {\r\n  if (!usdAmount) {\r\n    return;\r\n  }\r\n  if (tokenAddress === USDG_ADDRESS) {\r\n    return usdAmount.mul(expandDecimals(1, 18)).div(PRECISION);\r\n  }\r\n  const info = getTokenInfo(infoTokens, tokenAddress);\r\n  if (!info) {\r\n    return;\r\n  }\r\n  if (max && !info.maxPrice) {\r\n    return;\r\n  }\r\n  if (!max && !info.minPrice) {\r\n    return;\r\n  }\r\n\r\n  return usdAmount.mul(expandDecimals(1, info.decimals)).div(max ? info.minPrice : info.maxPrice);\r\n}\r\n\r\nfunction shouldSwap(collateralToken, receiveToken) {\r\n  // If position collateral is WETH in contract, then position.collateralToken is { symbol: ETH, isNative: true,  }\r\n  // @see https://github.com/gmx-io/gmx-interface/blob/master/src/pages/Exchange/Exchange.js#L162\r\n  // meaning if collateralToken.isNative === true in reality position has WETH as a collateral\r\n  // and if collateralToken.isNative === true and receiveToken.isNative === true then positions WETH will be unwrapped and user will receive native ETH\r\n  const isCollateralWrapped = collateralToken.isNative;\r\n\r\n  const isSameToken =\r\n    collateralToken.address === receiveToken.address || (isCollateralWrapped && receiveToken.isWrapped);\r\n\r\n  const isUnwrap = isCollateralWrapped && receiveToken.isNative;\r\n\r\n  return !isSameToken && !isUnwrap;\r\n}\r\n\r\nfunction getSwapLimits(infoTokens, fromTokenAddress, toTokenAddress) {\r\n  const fromInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  let maxInUsd;\r\n  let maxIn;\r\n  let maxOut;\r\n  let maxOutUsd;\r\n\r\n  if (!fromInfo?.maxUsdgAmount) {\r\n    maxInUsd = bigNumberify(0);\r\n    maxIn = bigNumberify(0);\r\n  } else {\r\n    maxInUsd = fromInfo.maxUsdgAmount\r\n      .sub(fromInfo.usdgAmount)\r\n      .mul(expandDecimals(1, USD_DECIMALS))\r\n      .div(expandDecimals(1, USDG_DECIMALS));\r\n\r\n    maxIn = maxInUsd.mul(expandDecimals(1, fromInfo.decimals)).div(fromInfo.maxPrice).toString();\r\n  }\r\n\r\n  if (!toInfo?.poolAmount || !toInfo?.bufferAmount) {\r\n    maxOut = bigNumberify(0);\r\n    maxOutUsd = bigNumberify(0);\r\n  } else {\r\n    maxOut = toInfo.availableAmount.gt(toInfo.poolAmount.sub(toInfo.bufferAmount))\r\n      ? toInfo.poolAmount.sub(toInfo.bufferAmount)\r\n      : toInfo.availableAmount;\r\n\r\n    maxOutUsd = getUsd(maxOut, toInfo.address, false, infoTokens);\r\n  }\r\n\r\n  return {\r\n    maxIn,\r\n    maxInUsd,\r\n    maxOut,\r\n    maxOutUsd,\r\n  };\r\n}\r\n\r\nexport default function PositionSeller(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsMap,\r\n    positionKey,\r\n    isVisible,\r\n    setIsVisible,\r\n    account,\r\n    library,\r\n    infoTokens,\r\n    setPendingTxns,\r\n    flagOrdersEnabled,\r\n    savedIsPnlInLeverage,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    orders,\r\n    isWaitingForPluginApproval,\r\n    isPluginApproving,\r\n    orderBookApproved,\r\n    setOrdersToaOpen,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    minExecutionFee,\r\n    minExecutionFeeErrorMessage,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n    initTab,\r\n  } = props;\r\n\r\n  const [savedSlippageAmount] = useLocalStorageSerializeKey([chainId, SLIPPAGE_BPS_KEY], DEFAULT_SLIPPAGE_AMOUNT);\r\n\r\n  const [keepLeverage, setKeepLeverage] = useLocalStorageSerializeKey([chainId, \"Exchange-keep-leverage\"], true);\r\n  const position = positionsMap && positionKey ? positionsMap[positionKey] : undefined;\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n\r\n  const [userSlippage, setUserSlippage] = useState('')\r\n  \r\n  const [isProfitWarningAccepted, setIsProfitWarningAccepted] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const prevIsVisible = usePrevious(isVisible);\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n  const toTokens = getTokens(chainId);\r\n\r\n  const [savedRecieveTokenAddress, setSavedRecieveTokenAddress] = useLocalStorageByChainId(\r\n    chainId,\r\n    `${CLOSE_POSITION_RECEIVE_TOKEN_KEY}-${position.indexToken.symbol}-${position?.isLong ? \"long\" : \"short\"}`\r\n  );\r\n\r\n  const [swapToToken, setSwapToToken] = useState(() =>\r\n    savedRecieveTokenAddress ? toTokens.find((token) => token.address === savedRecieveTokenAddress) : undefined\r\n  );\r\n\r\n  // Slippage Edit\r\n  // let allowedSlippage = savedSlippageAmount;\r\n  let allowedSlippage = DEFAULT_SLIPPAGE_AMOUNT;\r\n  // if (isHigherSlippageAllowed) {\r\n  //   allowedSlippage = DEFAULT_HIGHER_SLIPPAGE_AMOUNT;\r\n  // }\r\n  if (userSlippage !== '') {\r\n    allowedSlippage = userSlippage * 100;\r\n  }\r\n\r\n  const orderOptions = [MARKET, STOP];\r\n  let [orderOption, setOrderOption] = useState(initTab ?? MARKET);\r\n\r\n  if (!flagOrdersEnabled) {\r\n    orderOption = MARKET;\r\n  }\r\n\r\n  const needPositionRouterApproval = !positionRouterApproved && orderOption === MARKET;\r\n\r\n  const onOrderOptionChange = (option) => {\r\n    setOrderOption(option);\r\n  };\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(\"\");\r\n  const triggerPriceUsd = orderOption === MARKET ? 0 : parseValue(triggerPriceValue, USD_DECIMALS);\r\n\r\n  const [nextDelta, nextHasProfit = bigNumberify(0)] = useMemo(() => {\r\n    if (!position) {\r\n      return [bigNumberify(0), false];\r\n    }\r\n\r\n    if (orderOption !== STOP) {\r\n      return [position.delta, position.hasProfit, position.deltaPercentage];\r\n    }\r\n\r\n    if (!triggerPriceUsd) {\r\n      return [bigNumberify(0), false];\r\n    }\r\n\r\n    const { delta, hasProfit, deltaPercentage } = calculatePositionDelta(triggerPriceUsd, position);\r\n    return [delta, hasProfit, deltaPercentage];\r\n  }, [position, orderOption, triggerPriceUsd]);\r\n\r\n  const existingOrders = useMemo(() => {\r\n    if (orderOption === STOP && (!triggerPriceUsd || triggerPriceUsd.eq(0))) {\r\n      return [];\r\n    }\r\n    if (!orders || !position) {\r\n      return [];\r\n    }\r\n\r\n    const ret = [];\r\n    for (const order of orders) {\r\n      // only Stop orders can't be executed without corresponding opened position\r\n      if (order.type !== DECREASE) continue;\r\n\r\n      // if user creates Stop-Loss we need only Stop-Loss orders and vice versa\r\n      if (orderOption === STOP) {\r\n        const triggerAboveThreshold = triggerPriceUsd.gt(position.markPrice);\r\n        if (triggerAboveThreshold !== order.triggerAboveThreshold) continue;\r\n      }\r\n\r\n      const sameToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      if (order.isLong === position.isLong && sameToken) {\r\n        ret.push(order);\r\n      }\r\n    }\r\n    return ret;\r\n  }, [position, orders, triggerPriceUsd, orderOption, nativeTokenAddress]);\r\n\r\n  const existingOrder = existingOrders[0];\r\n\r\n  const needOrderBookApproval = orderOption === STOP && !orderBookApproved;\r\n\r\n  const isSwapAllowed = orderOption === MARKET;\r\n\r\n  const { data: hasOutdatedUi } = useHasOutdatedUi();\r\n\r\n  let collateralToken;\r\n  let receiveToken;\r\n  let maxAmount;\r\n  let maxAmountFormatted;\r\n  let maxAmountFormattedFree;\r\n  let fromAmount;\r\n\r\n  let convertedAmount;\r\n  let convertedAmountFormatted;\r\n\r\n  let nextLeverage;\r\n  let liquidationPrice;\r\n  let nextLiquidationPrice;\r\n  let isClosing;\r\n  let sizeDelta;\r\n\r\n  let nextCollateral;\r\n  let collateralDelta = bigNumberify(0);\r\n  let receiveAmount = bigNumberify(0);\r\n  let convertedReceiveAmount = bigNumberify(0);\r\n  let adjustedDelta = bigNumberify(0);\r\n\r\n  let isNotEnoughReceiveTokenLiquidity;\r\n  let isCollateralPoolCapacityExceeded;\r\n\r\n  let title;\r\n  let fundingFee;\r\n  let positionFee;\r\n  let swapFeeToken;\r\n  let swapFee;\r\n  let totalFees = bigNumberify(0);\r\n\r\n  let executionFee = orderOption === STOP ? getConstant(chainId, \"DECREASE_ORDER_EXECUTION_GAS_FEE\") : minExecutionFee;\r\n\r\n  let executionFeeUsd = getUsd(executionFee, nativeTokenAddress, false, infoTokens) || bigNumberify(0);\r\n\r\n  if (position) {\r\n    fundingFee = position.fundingFee;\r\n    fromAmount = parseValue(fromValue, USD_DECIMALS);\r\n    sizeDelta = fromAmount;\r\n\r\n    title = `Close ${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol}`;\r\n    collateralToken = position.collateralToken;\r\n    liquidationPrice = getLiquidationPrice(position);\r\n\r\n    if (fromAmount) {\r\n      isClosing = position.size.sub(fromAmount).lt(DUST_USD);\r\n      positionFee = getMarginFee(fromAmount);\r\n    }\r\n\r\n    if (isClosing) {\r\n      sizeDelta = position.size;\r\n      receiveAmount = position.collateral;\r\n    } else if (orderOption === STOP && sizeDelta && existingOrders.length > 0) {\r\n      let residualSize = position.size;\r\n      for (const order of existingOrders) {\r\n        residualSize = residualSize.sub(order.sizeDelta);\r\n      }\r\n      if (residualSize.sub(sizeDelta).abs().lt(ORDER_SIZE_DUST_USD)) {\r\n        sizeDelta = residualSize;\r\n      }\r\n    }\r\n\r\n    if (sizeDelta) {\r\n      adjustedDelta = nextDelta.mul(sizeDelta).div(position.size);\r\n    }\r\n\r\n    if (nextHasProfit) {\r\n      receiveAmount = receiveAmount.add(adjustedDelta);\r\n    } else {\r\n      if (receiveAmount.gt(adjustedDelta)) {\r\n        receiveAmount = receiveAmount.sub(adjustedDelta);\r\n      } else {\r\n        receiveAmount = bigNumberify(0);\r\n      }\r\n    }\r\n\r\n    if (keepLeverage && sizeDelta && !isClosing) {\r\n      collateralDelta = sizeDelta.mul(position.collateral).div(position.size);\r\n      // if the position will be realising a loss then reduce collateralDelta by the realised loss\r\n      if (!nextHasProfit) {\r\n        const deductions = adjustedDelta.add(positionFee).add(fundingFee);\r\n        if (collateralDelta.gt(deductions)) {\r\n          collateralDelta = collateralDelta = collateralDelta.sub(deductions);\r\n        } else {\r\n          collateralDelta = bigNumberify(0);\r\n        }\r\n      }\r\n    }\r\n\r\n    maxAmount = position.size;\r\n    maxAmountFormatted = formatAmount(maxAmount, USD_DECIMALS, 2, true);\r\n    maxAmountFormattedFree = formatAmountFree(maxAmount, USD_DECIMALS, 2);\r\n\r\n    if (fromAmount && collateralToken.maxPrice) {\r\n      convertedAmount = fromAmount.mul(expandDecimals(1, collateralToken.decimals)).div(collateralToken.maxPrice);\r\n      convertedAmountFormatted = formatAmount(convertedAmount, collateralToken.decimals, 4, true);\r\n    }\r\n\r\n    totalFees = totalFees.add(positionFee || bigNumberify(0)).add(fundingFee || bigNumberify(0));\r\n\r\n    receiveAmount = receiveAmount.add(collateralDelta);\r\n\r\n    if (sizeDelta) {\r\n      if (receiveAmount.gt(totalFees)) {\r\n        receiveAmount = receiveAmount.sub(totalFees);\r\n      } else {\r\n        receiveAmount = bigNumberify(0);\r\n      }\r\n    }\r\n\r\n    receiveToken = isSwapAllowed && swapToToken ? swapToToken : collateralToken;\r\n\r\n    // Calculate swap fees\r\n    if (isSwapAllowed && swapToToken) {\r\n      const { feeBasisPoints } = getNextToAmount(\r\n        chainId,\r\n        convertedAmount,\r\n        collateralToken.address,\r\n        receiveToken.address,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        true\r\n      );\r\n\r\n      if (feeBasisPoints) {\r\n        swapFee = receiveAmount.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n        swapFeeToken = getTokenAmount(swapFee, collateralToken.address, false, infoTokens);\r\n        totalFees = totalFees.add(swapFee || bigNumberify(0));\r\n        receiveAmount = receiveAmount.sub(swapFee);\r\n      }\r\n    }\r\n\r\n    convertedReceiveAmount = getTokenAmount(receiveAmount, receiveToken.address, false, infoTokens);\r\n\r\n    // Check swap limits (max in / max out)\r\n    if (isSwapAllowed && shouldSwap(collateralToken, receiveToken)) {\r\n      const collateralInfo = getTokenInfo(infoTokens, collateralToken.address);\r\n      const receiveTokenInfo = getTokenInfo(infoTokens, receiveToken.address);\r\n\r\n      isNotEnoughReceiveTokenLiquidity =\r\n        receiveTokenInfo.availableAmount.lt(convertedReceiveAmount) ||\r\n        receiveTokenInfo.bufferAmount.gt(receiveTokenInfo.poolAmount.sub(convertedReceiveAmount));\r\n\r\n      if (\r\n        collateralInfo.maxUsdgAmount &&\r\n        collateralInfo.maxUsdgAmount.gt(0) &&\r\n        collateralInfo.usdgAmount &&\r\n        collateralInfo.maxPrice\r\n      ) {\r\n        const usdgFromAmount = adjustForDecimals(receiveAmount, USD_DECIMALS, USDG_DECIMALS);\r\n        const nextUsdgAmount = collateralInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n        if (nextUsdgAmount.gt(collateralInfo.maxUsdgAmount)) {\r\n          isCollateralPoolCapacityExceeded = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isClosing) {\r\n      nextCollateral = bigNumberify(0);\r\n    } else {\r\n      if (position.collateral) {\r\n        nextCollateral = position.collateral;\r\n        if (collateralDelta && collateralDelta.gt(0)) {\r\n          nextCollateral = position.collateral.sub(collateralDelta);\r\n        } else if (position.delta && position.delta.gt(0) && sizeDelta) {\r\n          if (!position.hasProfit) {\r\n            nextCollateral = nextCollateral.sub(adjustedDelta);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (fromAmount) {\r\n      if (!isClosing && !keepLeverage) {\r\n        nextLeverage = getLeverage({\r\n          size: position.size,\r\n          sizeDelta,\r\n          collateral: position.collateral,\r\n          entryFundingRate: position.entryFundingRate,\r\n          cumulativeFundingRate: position.cumulativeFundingRate,\r\n          hasProfit: nextHasProfit,\r\n          delta: nextDelta,\r\n          includeDelta: savedIsPnlInLeverage,\r\n        });\r\n        nextLiquidationPrice = getLiquidationPrice({\r\n          isLong: position.isLong,\r\n          size: position.size,\r\n          sizeDelta,\r\n          collateral: position.collateral,\r\n          averagePrice: position.averagePrice,\r\n          entryFundingRate: position.entryFundingRate,\r\n          cumulativeFundingRate: position.cumulativeFundingRate,\r\n          delta: nextDelta,\r\n          hasProfit: nextHasProfit,\r\n          includeDelta: true,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  const [deltaStr, deltaPercentageStr] = useMemo(() => {\r\n    if (!position || !position.markPrice) {\r\n      return [\"-\", \"-\"];\r\n    }\r\n    if (orderOption !== STOP) {\r\n      const { pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(\r\n        position.markPrice,\r\n        position,\r\n        fromAmount\r\n      );\r\n      const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n        delta: pendingDelta,\r\n        deltaPercentage: pendingDeltaPercentage,\r\n        hasProfit,\r\n      });\r\n      return [deltaStr, deltaPercentageStr];\r\n    }\r\n    if (!triggerPriceUsd || triggerPriceUsd.eq(0)) {\r\n      return [\"-\", \"-\"];\r\n    }\r\n\r\n    const { pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(\r\n      triggerPriceUsd,\r\n      position,\r\n      fromAmount\r\n    );\r\n\r\n    const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n      delta: pendingDelta,\r\n      deltaPercentage: pendingDeltaPercentage,\r\n      hasProfit,\r\n    });\r\n    return [deltaStr, deltaPercentageStr];\r\n  }, [position, triggerPriceUsd, orderOption, fromAmount]);\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (orderOption === STOP) return [t`Trigger order disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`Position close disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (hasOutdatedUi) {\r\n      return t`Page outdated, please refresh`;\r\n    }\r\n    if (!fromAmount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (nextLeverage && nextLeverage.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (orderOption === STOP) {\r\n      if (!triggerPriceUsd || triggerPriceUsd.eq(0)) {\r\n        return t`Enter Price`;\r\n      }\r\n      if (position.isLong && triggerPriceUsd.lte(liquidationPrice)) {\r\n        return t`Price below Liq. Price`;\r\n      }\r\n      if (!position.isLong && triggerPriceUsd.gte(liquidationPrice)) {\r\n        return t`Price above Liq. Price`;\r\n      }\r\n\r\n      if (profitPrice && nextDelta.eq(0) && nextHasProfit) {\r\n        return t`Invalid price, see warning`;\r\n      }\r\n    }\r\n\r\n    if (isNotEnoughReceiveTokenLiquidity) {\r\n      return \"Insufficient receive token liquidity\";\r\n    }\r\n\r\n    if (isCollateralPoolCapacityExceeded) {\r\n      return `${collateralToken.symbol} pool exceeded, can only Receive ${collateralToken.symbol}`;\r\n    }\r\n\r\n    if (!isClosing && position && position.size && fromAmount) {\r\n      if (position.size.sub(fromAmount).lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return t`Leftover position below 10 USD`;\r\n      }\r\n      if (nextCollateral && nextCollateral.lt(expandDecimals(5, USD_DECIMALS))) {\r\n        return t`Leftover collateral below 5 USD`;\r\n      }\r\n    }\r\n\r\n    if (position && position.size && position.size.lt(fromAmount)) {\r\n      return t`Max close amount exceeded`;\r\n    }\r\n\r\n    if (nextLeverage && nextLeverage.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Min leverage: 1.1x`;\r\n    }\r\n\r\n    if (nextLeverage && nextLeverage.gt(MAX_ALLOWED_LEVERAGE)) {\r\n      return t`Max leverage: ${(MAX_ALLOWED_LEVERAGE / BASIS_POINTS_DIVISOR).toFixed(1)}x`;\r\n    }\r\n\r\n    if (hasPendingProfit && orderOption !== STOP && !isProfitWarningAccepted) {\r\n      return t`Forfeit profit not checked`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return false;\r\n    }\r\n    if (isPluginApproving) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const hasPendingProfit = MIN_PROFIT_TIME > 0 && position.delta.eq(0) && position.pendingDelta.gt(0);\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n\r\n    if (orderOption === STOP) {\r\n      if (isSubmitting) return t`Creating Order...`;\r\n\r\n      if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n        return t`Enabling Orders...`;\r\n      }\r\n      if (isPluginApproving) {\r\n        return t`Enabling Orders...`;\r\n      }\r\n      if (needOrderBookApproval) {\r\n        return t`Enable Orders`;\r\n      }\r\n\r\n      return t`Create Order`;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (hasPendingProfit) {\r\n      return t`Close without profit`;\r\n    }\r\n    return isSubmitting ? t`Closing...` : t`Close`;\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFromValue(\"\");\r\n    setIsProfitWarningAccepted(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevIsVisible !== isVisible) {\r\n      resetForm();\r\n    }\r\n  }, [prevIsVisible, isVisible]);\r\n\r\n  const onClickPrimary = async () => {\r\n    if (needOrderBookApproval) {\r\n      setOrdersToaOpen(true);\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: t`Enable leverage sent.`,\r\n        failMsg: t`Enable leverage failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    const collateralTokenAddress = position.collateralToken.isNative\r\n      ? nativeTokenAddress\r\n      : position.collateralToken.address;\r\n    const indexTokenAddress = position.indexToken.isNative ? nativeTokenAddress : position.indexToken.address;\r\n\r\n    if (orderOption === STOP) {\r\n      const triggerAboveThreshold = triggerPriceUsd.gt(position.markPrice);\r\n\r\n      createDecreaseOrder(\r\n        chainId,\r\n        library,\r\n        indexTokenAddress,\r\n        sizeDelta,\r\n        collateralTokenAddress,\r\n        collateralDelta,\r\n        position.isLong,\r\n        triggerPriceUsd,\r\n        triggerAboveThreshold,\r\n        {\r\n          sentMsg: t`Order submitted!`,\r\n          successMsg: t`Order created!`,\r\n          failMsg: t`Order creation failed.`,\r\n          setPendingTxns,\r\n        }\r\n      )\r\n        .then(() => {\r\n          setFromValue(\"\");\r\n          setIsVisible(false);\r\n        })\r\n        .finally(() => {\r\n          setIsSubmitting(false);\r\n        });\r\n      return;\r\n    }\r\n\r\n    const priceBasisPoints = position.isLong\r\n      ? BASIS_POINTS_DIVISOR - allowedSlippage\r\n      : BASIS_POINTS_DIVISOR + allowedSlippage;\r\n    const refPrice = position.isLong ? position.indexToken.minPrice : position.indexToken.maxPrice;\r\n    let priceLimit = refPrice.mul(priceBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n    const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n    const minProfitTimeExpired = parseInt(Date.now() / 1000) > minProfitExpiration;\r\n\r\n    if (nextHasProfit && !minProfitTimeExpired && !isProfitWarningAccepted) {\r\n      if ((position.isLong && priceLimit.lt(profitPrice)) || (!position.isLong && priceLimit.gt(profitPrice))) {\r\n        priceLimit = profitPrice;\r\n      }\r\n    }\r\n\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n\r\n    const path = [tokenAddress0];\r\n\r\n    const isUnwrap = receiveToken.address === AddressZero;\r\n    const isSwap = receiveToken.address !== tokenAddress0;\r\n\r\n    if (isSwap) {\r\n      if (isUnwrap && tokenAddress0 !== nativeTokenAddress) {\r\n        path.push(nativeTokenAddress);\r\n      } else if (!isUnwrap) {\r\n        path.push(receiveToken.address);\r\n      }\r\n    }\r\n\r\n    const withdrawETH = isUnwrap;\r\n\r\n    const params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      collateralDelta, // _collateralDelta\r\n      sizeDelta, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      account, // _receiver\r\n      priceLimit, // _acceptablePrice\r\n      0, // _minOut\r\n      minExecutionFee, // _executionFee\r\n      withdrawETH, // _withdrawETH\r\n      AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    const successMsg = t`Requested decrease of ${position.indexToken.symbol} ${\r\n      position.isLong ? \"Long\" : \"Short\"\r\n    } by ${formatAmount(sizeDelta, USD_DECIMALS, 2)} USD.`;\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, \"createDecreasePosition\", params, {\r\n      value: minExecutionFee,\r\n      sentMsg: t`Close submitted!`,\r\n      successMsg,\r\n      failMsg: t`Close failed.`,\r\n      setPendingTxns,\r\n      // for Arbitrum, sometimes the successMsg shows after the position has already been executed\r\n      // hide the success message for Arbitrum as a workaround\r\n      hideSuccessMsg: chainId === ARBITRUM,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        let nextSize = position.size.sub(sizeDelta);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            size: nextSize,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const renderExistingOrderWarning = useCallback(() => {\r\n    if (!existingOrder) {\r\n      return;\r\n    }\r\n    const indexToken = getTokenInfo(infoTokens, existingOrder.indexToken);\r\n    const sizeInToken = formatAmount(\r\n      existingOrder.sizeDelta.mul(PRECISION).div(existingOrder.triggerPrice),\r\n      USD_DECIMALS,\r\n      4,\r\n      true\r\n    );\r\n    const prefix = existingOrder.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n    return (\r\n      <div className=\"Confirmation-box-warning\">\r\n        You have an active order to decrease {existingOrder.isLong ? \"Long\" : \"Short\"} {sizeInToken} {indexToken.symbol}{\" \"}\r\n        ($\r\n        {formatAmount(existingOrder.sizeDelta, USD_DECIMALS, 2, true)}) at {prefix}{\" \"}\r\n        {formatAmount(existingOrder.triggerPrice, USD_DECIMALS, 2, true)}\r\n      </div>\r\n    );\r\n  }, [existingOrder, infoTokens]);\r\n\r\n  function renderMinProfitWarning() {\r\n    if (MIN_PROFIT_TIME === 0) {\r\n      return null;\r\n    }\r\n\r\n    if (profitPrice && nextDelta.eq(0) && nextHasProfit) {\r\n      const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n\r\n      if (orderOption === MARKET) {\r\n        return (\r\n          <div className=\"Confirmation-box-warning\">\r\n            Reducing the position at the current price will forfeit a&nbsp;\r\n            <a\r\n              href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              pending profit\r\n            </a>{\" \"}\r\n            of {deltaStr}. <br />\r\n            <br />\r\n            Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n            applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}.\r\n          </div>\r\n        );\r\n      }\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          This order will forfeit a&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            profit\r\n          </a>{\" \"}\r\n          of {deltaStr}. <br />\r\n          Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n          applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}.\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  const profitPrice = getProfitPrice(orderOption === MARKET ? position.markPrice : triggerPriceUsd, position);\r\n\r\n  let triggerPricePrefix;\r\n  if (triggerPriceUsd) {\r\n    triggerPricePrefix = triggerPriceUsd.gt(position.markPrice) ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n  }\r\n\r\n  const shouldShowExistingOrderWarning = false;\r\n\r\n  const [hasInputFocus, setHasInputFocus] = useState(false);\r\n  const [hasInputError, setHasInputError] = useState(false);\r\n  const checkInputError = (inputVal) => {\r\n    if (!isPrimaryEnabled() && inputVal !== '') {\r\n      setHasInputError(true);\r\n    } else {\r\n      setHasInputError(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkInputError(fromValue);\r\n  }, [fromValue])\r\n\r\n  return (\r\n    <div className=\"PositionEditor\">\r\n      {position && (\r\n        <Modal\r\n          className=\"PositionSeller-modal\"\r\n          isVisible={isVisible}\r\n          setIsVisible={setIsVisible}\r\n          label={title}\r\n          allowContentTouchMove\r\n          isNifty={true}\r\n        >\r\n          {flagOrdersEnabled && (\r\n            <Tab\r\n              options={orderOptions}\r\n              option={orderOption}\r\n              optionLabels={orderOptionLabels}\r\n              onChange={onOrderOptionChange}\r\n              icons={CLOSE_ICONS}\r\n            />\r\n          )}\r\n          <div className={\"Exchange-swap-section\"\r\n            + (hasInputError ? \" error\" : \"\") + (hasInputFocus ? \" hlight\" : \"\")}>\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                {convertedAmountFormatted && (\r\n                  <div className=\"Exchange-swap-usd\">\r\n                    Close: {convertedAmountFormatted} {position.collateralToken.symbol}\r\n                  </div>\r\n                )}\r\n                {!convertedAmountFormatted && \"Close\"}\r\n              </div>\r\n              {maxAmount && (\r\n                <div className=\"muted align-right clickable\" onClick={() => setFromValue(maxAmountFormattedFree)}>\r\n                  Max: {maxAmountFormatted}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input\"\r\n                  value={fromValue}\r\n                  onChange={(e) => setFromValue(e.target.value)}\r\n                  onFocus={(e) => {\r\n                    setHasInputFocus(true);\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    setHasInputFocus(false);\r\n                  }}\r\n                />\r\n                {fromValue !== maxAmountFormattedFree && (\r\n                  <div\r\n                    className=\"Exchange-swap-max\"\r\n                    onClick={() => {\r\n                      setFromValue(maxAmountFormattedFree);\r\n                    }}\r\n                  >\r\n                    MAX\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"PositionEditor-token-symbol\">USD</div>\r\n            </div>\r\n          </div>\r\n          {orderOption === MARKET && (\r\n            <SlippageInput \r\n              value={userSlippage}\r\n              setValue={setUserSlippage} \r\n            />\r\n          )}\r\n          {orderOption === STOP && (\r\n            <div className=\"Exchange-swap-section\">\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  <Trans>Price</Trans>\r\n                </div>\r\n                <div\r\n                  className=\"muted align-right clickable\"\r\n                  onClick={() => {\r\n                    setTriggerPriceValue(formatAmountFree(position.markPrice, USD_DECIMALS, 2));\r\n                  }}\r\n                >\r\n                  Mark: {formatAmount(position.markPrice, USD_DECIMALS, 2, true)}\r\n                </div>\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div className=\"Exchange-swap-input-container\">\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={triggerPriceValue}\r\n                    onChange={onTriggerPriceChange}\r\n                    onFocus={(e) => {\r\n                      e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                    }}\r\n                    onBlur={(e) => {\r\n                      e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div className=\"PositionEditor-token-symbol\">USD</div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {renderMinProfitWarning()}\r\n          {shouldShowExistingOrderWarning && renderExistingOrderWarning()}\r\n          <div className=\"PositionEditor-info-box\">\r\n            {minExecutionFeeErrorMessage && (\r\n              <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>\r\n            )}\r\n            {hasPendingProfit && orderOption !== STOP && (\r\n              <div className=\"PositionEditor-accept-profit-warning\">\r\n                <Checkbox isChecked={isProfitWarningAccepted} setIsChecked={setIsProfitWarningAccepted}>\r\n                  <span className=\"muted\">Forfeit profit</span>\r\n                </Checkbox>\r\n              </div>\r\n            )}\r\n            {/* <div className=\"PositionEditor-keep-leverage-settings\">\r\n              <Checkbox isChecked={keepLeverage} setIsChecked={setKeepLeverage}>\r\n                <span className=\"muted font-sm\">Keep leverage at {formatAmount(position.leverage, 4, 2)}x</span>\r\n              </Checkbox>\r\n            </div> */}\r\n            {/* {orderOption === MARKET && (\r\n              <div className=\"PositionEditor-allow-higher-slippage\">\r\n                <Checkbox isChecked={isHigherSlippageAllowed} setIsChecked={setIsHigherSlippageAllowed}>\r\n                  <span className=\"muted font-sm\">Allow up to 1% slippage</span>\r\n                </Checkbox>\r\n              </div>\r\n            )} */}\r\n            {orderOption === MARKET && (\r\n              <div>\r\n                <ExchangeInfoRow label=\"Allowed Slippage\" className=\"Slippage-row\">\r\n                  <Tooltip\r\n                    handle={`${formatAmount(allowedSlippage, 2, 2)}%`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          You can change this in the settings menu on the top right of the page.\r\n                          <br />\r\n                          <br />\r\n                          Note that a low allowed slippage, e.g. less than 0.5%, may result in failed orders if prices\r\n                          are volatile.\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </ExchangeInfoRow>\r\n              </div>\r\n            )}\r\n            {orderOption === STOP && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Trigger Price</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {!triggerPriceUsd && \"-\"}\r\n                  {triggerPriceUsd && `${triggerPricePrefix} ${formatAmount(triggerPriceUsd, USD_DECIMALS, 2, true)}`}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Mark Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Entry Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Liq. Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {isClosing && orderOption !== STOP && \"-\"}\r\n                {(!isClosing || orderOption === STOP) && (\r\n                  <div>\r\n                    {(!nextLiquidationPrice || nextLiquidationPrice.eq(liquidationPrice)) && (\r\n                      <div>{`$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}</div>\r\n                    )}\r\n                    {nextLiquidationPrice && !nextLiquidationPrice.eq(liquidationPrice) && (\r\n                      <div>\r\n                        <div className=\"inline-block muted\">\r\n                          ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                          <BsArrowRight className=\"transition-arrow\" />\r\n                        </div>\r\n                        ${formatAmount(nextLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Size</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {position && position.size && fromAmount && (\r\n                  <div>\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(position.size, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                    ${formatAmount(position.size.sub(fromAmount), USD_DECIMALS, 2, true)}\r\n                  </div>\r\n                )}\r\n                {position && position.size && !fromAmount && (\r\n                  <div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Collateral ({collateralToken.symbol})</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {nextCollateral && !nextCollateral.eq(position.collateral) ? (\r\n                  <div>\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                    ${formatAmount(nextCollateral, USD_DECIMALS, 2, true)}\r\n                  </div>\r\n                ) : (\r\n                  `$${formatAmount(position.collateral, USD_DECIMALS, 4, true)}`\r\n                )}\r\n              </div>\r\n            </div>\r\n            {!keepLeverage && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Leverage</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {isClosing && \"-\"}\r\n                  {!isClosing && (\r\n                    <div>\r\n                      {!nextLeverage && <div>{formatAmount(position.leverage, 4, 2)}x</div>}\r\n                      {nextLeverage && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            {formatAmount(position.leverage, 4, 2)}x\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          {formatAmount(nextLeverage, 4, 2)}x\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>PnL</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {deltaStr} ({deltaPercentageStr})\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Fees</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  position=\"right-top\"\r\n                  className=\"PositionSeller-fees-tooltip\"\r\n                  handle={\r\n                    <div>\r\n                      {totalFees ? `$${formatAmount(totalFees.add(executionFeeUsd), USD_DECIMALS, 2, true)}` : \"-\"}\r\n                    </div>\r\n                  }\r\n                  renderContent={() => (\r\n                    <div>\r\n                      {fundingFee && (\r\n                        <StatsTooltipRow label=\"Borrow fee\" value={formatAmount(fundingFee, USD_DECIMALS, 2, true)} />\r\n                      )}\r\n\r\n                      {positionFee && (\r\n                        <StatsTooltipRow label=\"Closing fee\" value={formatAmount(positionFee, USD_DECIMALS, 2, true)} />\r\n                      )}\r\n\r\n                      {swapFee && (\r\n                        <StatsTooltipRow\r\n                          label=\"Swap fee\"\r\n                          showDollar={false}\r\n                          value={`${formatAmount(swapFeeToken, collateralToken.decimals, 5)}${collateralToken.symbol}\r\n                          ($${formatAmount(swapFee, USD_DECIMALS, 2, true)})`}\r\n                        />\r\n                      )}\r\n\r\n                      <StatsTooltipRow\r\n                        label=\"Execution fee\"\r\n                        showDollar={false}\r\n                        value={`${formatAmount(executionFee, 18, 5, true)}${nativeTokenSymbol}($${formatAmount(\r\n                          executionFeeUsd,\r\n                          USD_DECIMALS,\r\n                          2\r\n                        )})`}\r\n                      />\r\n\r\n                      <br />\r\n\r\n                      <div className=\"PositionSeller-fee-item\">\r\n                        <a href=\"https://gmxio.gitbook.io/gmx/trading#fees\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          More Info\r\n                        </a>{\" \"}\r\n                        about fees.\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row PositionSeller-receive-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Receive</Trans>\r\n              </div>\r\n\r\n              {!isSwapAllowed && receiveToken && (\r\n                <div className=\"align-right PositionSelector-selected-receive-token\">\r\n                  {formatAmount(convertedReceiveAmount, receiveToken.decimals, 4, true)}&nbsp;{receiveToken.symbol} ($\r\n                  {formatAmount(receiveAmount, USD_DECIMALS, 2, true)})\r\n                </div>\r\n              )}\r\n\r\n              {isSwapAllowed && receiveToken && (\r\n                <div className=\"align-right\">\r\n                  <TokenSelector\r\n                    // Scroll lock lead to side effects\r\n                    // if it applied on modal inside another modal\r\n                    disableBodyScrollLock={true}\r\n                    className={cx(\"PositionSeller-token-selector\", {\r\n                      warning: isNotEnoughReceiveTokenLiquidity || isCollateralPoolCapacityExceeded,\r\n                    })}\r\n                    label={\"Receive\"}\r\n                    showBalances={false}\r\n                    chainId={chainId}\r\n                    tokenAddress={receiveToken.address}\r\n                    onSelectToken={(token) => {\r\n                      setSwapToToken(token);\r\n                      setSavedRecieveTokenAddress(token.address);\r\n                    }}\r\n                    tokens={toTokens}\r\n                    getTokenState={(tokenOptionInfo) => {\r\n                      if (!shouldSwap(collateralToken, tokenOptionInfo)) {\r\n                        return;\r\n                      }\r\n\r\n                      const convertedTokenAmount = getTokenAmount(\r\n                        receiveAmount,\r\n                        tokenOptionInfo.address,\r\n                        false,\r\n                        infoTokens\r\n                      );\r\n\r\n                      const isNotEnoughLiquidity =\r\n                        tokenOptionInfo.availableAmount.lt(convertedTokenAmount) ||\r\n                        tokenOptionInfo.bufferAmount.gt(tokenOptionInfo.poolAmount.sub(convertedTokenAmount));\r\n\r\n                      if (isNotEnoughLiquidity) {\r\n                        const { maxIn, maxOut, maxInUsd, maxOutUsd } = getSwapLimits(\r\n                          infoTokens,\r\n                          collateralToken.address,\r\n                          tokenOptionInfo.address\r\n                        );\r\n\r\n                        const collateralInfo = getTokenInfo(infoTokens, collateralToken.address);\r\n\r\n                        return {\r\n                          disabled: true,\r\n                          message: (\r\n                            <div>\r\n                              Insufficient Available Liquidity to swap to {tokenOptionInfo.symbol}:\r\n                              <br />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Max ${collateralInfo.symbol} in`}\r\n                                value={[\r\n                                  `${formatAmount(maxIn, collateralInfo.decimals, 0, true)} ${collateralInfo.symbol}`,\r\n                                  `($${formatAmount(maxInUsd, USD_DECIMALS, 0, true)})`,\r\n                                ]}\r\n                              />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Max ${tokenOptionInfo.symbol} out`}\r\n                                value={[\r\n                                  `${formatAmount(maxOut, tokenOptionInfo.decimals, 0, true)} ${\r\n                                    tokenOptionInfo.symbol\r\n                                  }`,\r\n                                  `($${formatAmount(maxOutUsd, USD_DECIMALS, 0, true)})`,\r\n                                ]}\r\n                              />\r\n                            </div>\r\n                          ),\r\n                        };\r\n                      }\r\n                    }}\r\n                    infoTokens={infoTokens}\r\n                    showTokenImgInDropdown={true}\r\n                    selectedTokenLabel={\r\n                      <span className=\"PositionSelector-selected-receive-token\">\r\n                        {formatAmount(convertedReceiveAmount, receiveToken.decimals, 4, true)}&nbsp;\r\n                        {receiveToken.symbol} (${formatAmount(receiveAmount, USD_DECIMALS, 2, true)})\r\n                      </span>\r\n                    }\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-button-container\">\r\n            <button className={\"App-cta Exchange-swap-button\" + (isPrimaryEnabled() ? \" hlight\" : \"\")} onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n              {getPrimaryText()}\r\n            </button>\r\n          </div>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport useSWR from \"swr\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { ethers } from \"ethers\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  BASIS_POINTS_DIVISOR,\r\n  DEPOSIT_FEE,\r\n  DUST_BNB,\r\n  helperToast,\r\n  formatAmount,\r\n  bigNumberify,\r\n  usePrevious,\r\n  formatAmountFree,\r\n  parseValue,\r\n  expandDecimals,\r\n  shouldRaiseGasError,\r\n  getTokenInfo,\r\n  getLiquidationPrice,\r\n  approveTokens,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n  MAX_ALLOWED_LEVERAGE,\r\n} from \"../../lib/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport Modal from \"../Modal/Modal\";\r\n\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\n\r\nimport { getConstant } from \"../../config/chains\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nimport depositImg from '../../img/ddl/icon_dollar.svg'\r\nimport depositActiveImg from '../../img/ddl/icon_dollar_active.svg'\r\nimport withdrawImg from '../../img/ddl/icon_withdraw.svg'\r\nimport withdrawActiveImg from '../../img/ddl/icon_withdraw_active.svg'\r\n\r\nconst DEPOSIT = t`Deposit`;\r\nconst WITHDRAW = t`Withdraw`;\r\nconst EDIT_OPTIONS = [DEPOSIT, WITHDRAW];\r\nconst EDIT_ICONS = {\r\n  [DEPOSIT]: depositImg,\r\n  [WITHDRAW]: withdrawImg,\r\n  [DEPOSIT + '_active']: depositActiveImg,\r\n  [WITHDRAW + '_active']: withdrawActiveImg,\r\n\r\n}\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport default function PositionEditor(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsMap,\r\n    positionKey,\r\n    isVisible,\r\n    setIsVisible,\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    collateralTokenAddress,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    getUsd,\r\n    getLeverage,\r\n    savedIsPnlInLeverage,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    chainId,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  } = props;\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const position = positionsMap && positionKey ? positionsMap[positionKey] : undefined;\r\n  const [option, setOption] = useState(DEPOSIT);\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isSwapping, setIsSwapping] = useState(false);\r\n  const prevIsVisible = usePrevious(isVisible);\r\n\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n\r\n  const { data: tokenAllowance } = useSWR(\r\n    [active, chainId, collateralTokenAddress, \"allowance\", account, routerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  // const { data: minExecutionFee } = useSWR([active, chainId, positionRouterAddress, \"minExecutionFee\"], {\r\n  //   fetcher: fetcher(library, PositionRouter),\r\n  // });\r\n\r\n  const isDeposit = option === DEPOSIT;\r\n  const isWithdrawal = option === WITHDRAW;\r\n\r\n  const needPositionRouterApproval = !positionRouterApproved;\r\n\r\n  let collateralToken;\r\n  let maxAmount;\r\n  let maxAmountFormatted;\r\n  let maxAmountFormattedFree;\r\n  let fromAmount;\r\n  let needApproval;\r\n\r\n  let convertedAmount;\r\n  let convertedAmountFormatted;\r\n\r\n  let nextLeverage;\r\n  let nextLeverageExcludingPnl;\r\n  let liquidationPrice;\r\n  let nextLiquidationPrice;\r\n  let nextCollateral;\r\n\r\n  let title;\r\n  let collateralDelta;\r\n  if (position) {\r\n    title = `Edit ${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol}`;\r\n    collateralToken = position.collateralToken;\r\n    liquidationPrice = getLiquidationPrice(position);\r\n\r\n    if (isDeposit) {\r\n      fromAmount = parseValue(fromValue, collateralToken.decimals);\r\n      maxAmount = collateralToken ? collateralToken.balance : bigNumberify(0);\r\n      maxAmountFormatted = formatAmount(maxAmount, collateralToken.decimals, 4, true);\r\n      maxAmountFormattedFree = formatAmountFree(maxAmount, collateralToken.decimals, 8);\r\n      if (fromAmount) {\r\n        convertedAmount = getUsd(fromAmount, position.collateralToken.address, false, infoTokens);\r\n        convertedAmountFormatted = formatAmount(convertedAmount, USD_DECIMALS, 2);\r\n      }\r\n    } else {\r\n      fromAmount = parseValue(fromValue, USD_DECIMALS);\r\n      maxAmount = position.collateral;\r\n      maxAmountFormatted = formatAmount(maxAmount, USD_DECIMALS, 2, true);\r\n      maxAmountFormattedFree = formatAmountFree(maxAmount, USD_DECIMALS, 2);\r\n      if (fromAmount) {\r\n        convertedAmount = fromAmount.mul(expandDecimals(1, collateralToken.decimals)).div(collateralToken.maxPrice);\r\n        convertedAmountFormatted = formatAmount(convertedAmount, collateralToken.decimals, 4, true);\r\n      }\r\n    }\r\n    needApproval = isDeposit && tokenAllowance && fromAmount && fromAmount.gt(tokenAllowance);\r\n\r\n    if (fromAmount) {\r\n      collateralDelta = isDeposit ? convertedAmount : fromAmount;\r\n      if (position.isLong) {\r\n        collateralDelta = collateralDelta.mul(BASIS_POINTS_DIVISOR - DEPOSIT_FEE).div(BASIS_POINTS_DIVISOR);\r\n      }\r\n      nextLeverage = getLeverage({\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        hasProfit: position.hasProfit,\r\n        delta: position.delta,\r\n        includeDelta: savedIsPnlInLeverage,\r\n      });\r\n      nextLeverageExcludingPnl = getLeverage({\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        hasProfit: position.hasProfit,\r\n        delta: position.delta,\r\n        includeDelta: false,\r\n      });\r\n\r\n      nextLiquidationPrice = getLiquidationPrice({\r\n        isLong: position.isLong,\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        averagePrice: position.averagePrice,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n      });\r\n\r\n      nextCollateral = isDeposit ? position.collateral.add(collateralDelta) : position.collateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (isDeposit) return [t`Deposit disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`Withdraw disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (!fromAmount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (nextLeverage && nextLeverage.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n\r\n    if (!isDeposit && fromAmount) {\r\n      if (fromAmount.gte(position.collateral)) {\r\n        return t`Min order: 10 USD`;\r\n      }\r\n      if (position.collateral.sub(fromAmount).lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return t`Min order: 10 USD`;\r\n      }\r\n    }\r\n\r\n    if (!isDeposit && fromAmount && nextLiquidationPrice) {\r\n      if (position.isLong && position.markPrice.lt(nextLiquidationPrice)) {\r\n        return t`Invalid liq. price`;\r\n      }\r\n      if (!position.isLong && position.markPrice.gt(nextLiquidationPrice)) {\r\n        return t`Invalid liq. price`;\r\n      }\r\n    }\r\n\r\n    if (nextLeverageExcludingPnl && nextLeverageExcludingPnl.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Min leverage: 1.1x`;\r\n    }\r\n\r\n    if (nextLeverageExcludingPnl && nextLeverageExcludingPnl.gt(MAX_ALLOWED_LEVERAGE)) {\r\n      return t`Max leverage: ${(MAX_ALLOWED_LEVERAGE / BASIS_POINTS_DIVISOR).toFixed(1)}x`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isSwapping) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isSwapping) {\r\n      if (isDeposit) {\r\n        return t`Depositing...`;\r\n      }\r\n      return t`Withdrawing...`;\r\n    }\r\n\r\n    if (isApproving) {\r\n      return t`Approving ${position.collateralToken.symbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve ${position.collateralToken.symbol}`;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage`;\r\n    }\r\n\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (isDeposit) {\r\n      return t`Deposit`;\r\n    }\r\n\r\n    return t`Withdraw`;\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFromValue(\"\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevIsVisible !== isVisible) {\r\n      resetForm();\r\n    }\r\n  }, [prevIsVisible, isVisible]);\r\n\r\n  const depositCollateral = async () => {\r\n    setIsSwapping(true);\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n    const path = [tokenAddress0];\r\n    const indexTokenAddress =\r\n      position.indexToken.address === AddressZero ? nativeTokenAddress : position.indexToken.address;\r\n\r\n    const priceBasisPoints = position.isLong ? 11000 : 9000;\r\n    const priceLimit = position.indexToken.maxPrice.mul(priceBasisPoints).div(10000);\r\n\r\n    const referralCode = ethers.constants.HashZero;\r\n    let params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      fromAmount, // _amountIn\r\n      0, // _minOut\r\n      0, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      priceLimit, // _acceptablePrice\r\n      minExecutionFee, // _executionFee\r\n      referralCode, // _referralCode\r\n      AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    let method = \"createIncreasePosition\";\r\n    let value = minExecutionFee;\r\n    if (collateralTokenAddress === AddressZero) {\r\n      method = \"createIncreasePositionETH\";\r\n      value = fromAmount.add(minExecutionFee);\r\n      params = [\r\n        path, // _path\r\n        indexTokenAddress, // _indexToken\r\n        0, // _minOut\r\n        0, // _sizeDelta\r\n        position.isLong, // _isLong\r\n        priceLimit, // _acceptablePrice\r\n        minExecutionFee, // _executionFee\r\n        referralCode, // _referralCode\r\n        AddressZero, // _callbackTarget\r\n      ];\r\n    }\r\n\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, collateralTokenAddress), fromAmount)) {\r\n      setIsSwapping(false);\r\n      helperToast.error(`Leave at least ${formatAmount(DUST_BNB, 18, 3)} ETH for gas`);\r\n      return;\r\n    }\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      sentMsg: t`Deposit submitted.`,\r\n      successMsg: t`Requested deposit of ${formatAmount(fromAmount, position.collateralToken.decimals, 4)} ${\r\n        position.collateralToken.symbol\r\n      } into ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}.`,\r\n      failMsg: t`Deposit failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            collateralSnapshot: position.collateral,\r\n            expectingCollateralChange: true,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSwapping(false);\r\n      });\r\n  };\r\n\r\n  const withdrawCollateral = async () => {\r\n    setIsSwapping(true);\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n    const indexTokenAddress =\r\n      position.indexToken.address === AddressZero ? nativeTokenAddress : position.indexToken.address;\r\n    const priceBasisPoints = position.isLong ? 9000 : 11000;\r\n    const priceLimit = position.indexToken.maxPrice.mul(priceBasisPoints).div(10000);\r\n\r\n    const withdrawETH = collateralTokenAddress === AddressZero || collateralTokenAddress === nativeTokenAddress;\r\n    const params = [\r\n      [tokenAddress0], // _path\r\n      indexTokenAddress, // _indexToken\r\n      fromAmount, // _collateralDelta\r\n      0, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      account, // _receiver\r\n      priceLimit, // _acceptablePrice\r\n      0, // _minOut\r\n      minExecutionFee, // _executionFee\r\n      withdrawETH, // _withdrawETH\r\n      AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    const method = \"createDecreasePosition\";\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    callContract(chainId, contract, method, params, {\r\n      value: minExecutionFee,\r\n      sentMsg: t`Withdrawal submitted.`,\r\n      successMsg: t`Requested withdrawal of ${formatAmount(fromAmount, USD_DECIMALS, 2)} USD from ${\r\n        position.indexToken.symbol\r\n      } ${position.isLong ? \"Long\" : \"Short\"}.`,\r\n      failMsg: t`Withdrawal failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            collateralSnapshot: position.collateral,\r\n            expectingCollateralChange: true,\r\n          },\r\n        };\r\n      })\r\n      .finally(() => {\r\n        setIsSwapping(false);\r\n      });\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    if (needApproval) {\r\n      approveTokens({\r\n        setIsApproving,\r\n        library,\r\n        tokenAddress: collateralTokenAddress,\r\n        spender: routerAddress,\r\n        chainId: chainId,\r\n        infoTokens,\r\n        getTokenInfo,\r\n        pendingTxns,\r\n        setPendingTxns,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: isDeposit ? t`Enable deposit sent.` : t`Enable withdraw sent.`,\r\n        failMsg: isDeposit ? t`Enable deposit failed.` : t`Enable withdraw failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (isDeposit) {\r\n      depositCollateral();\r\n      return;\r\n    }\r\n\r\n    withdrawCollateral();\r\n  };\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n\r\n\r\n  const [hasInputFocus, setHasInputFocus] = useState(false);\r\n  const [hasInputError, setHasInputError] = useState(false);\r\n  const checkInputError = (inputVal) => {\r\n    if (!isPrimaryEnabled() && inputVal !== '') {\r\n      setHasInputError(true);\r\n    } else {\r\n      setHasInputError(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkInputError(fromValue);\r\n  }, [fromValue])\r\n\r\n  return (\r\n    <div className=\"PositionEditor\">\r\n      {position && (\r\n        <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title} isNifty={true}>\r\n          <div>\r\n            <Tab options={EDIT_OPTIONS} option={option} setOption={setOption} onChange={resetForm}\r\n              icons={EDIT_ICONS} />\r\n            {(isDeposit || isWithdrawal) && (\r\n              <div>\r\n                <div className={\"Exchange-swap-section\"\r\n                  + (hasInputError ? \" error\" : \"\") + (hasInputFocus ? \" hlight\" : \"\")}>\r\n                  <div className=\"Exchange-swap-section-top\">\r\n                    <div className=\"muted\">\r\n                      {convertedAmountFormatted && (\r\n                        <div className=\"Exchange-swap-usd\">\r\n                          {isDeposit ? t`Deposit` : t`Withdraw`}: {convertedAmountFormatted}{\" \"}\r\n                          {isDeposit ? \"USD\" : position.collateralToken.symbol}\r\n                        </div>\r\n                      )}\r\n                      {!convertedAmountFormatted && `${isDeposit ? t`Deposit` : t`Withdraw`}`}\r\n                    </div>\r\n                    {maxAmount && (\r\n                      <div className=\"muted align-right clickable\" onClick={() => setFromValue(maxAmountFormattedFree)}>\r\n                        Max: {maxAmountFormatted}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"Exchange-swap-section-bottom\">\r\n                    <div className=\"Exchange-swap-input-container\">\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"0\"\r\n                        placeholder=\"0.0\"\r\n                        className=\"Exchange-swap-input\"\r\n                        value={fromValue}\r\n                        onChange={(e) => setFromValue(e.target.value)}\r\n                        onFocus={(e) => {\r\n                          setHasInputFocus(true);\r\n                        }}\r\n                        onBlur={(e) => {\r\n                          setHasInputFocus(false);\r\n                        }}\r\n                      />\r\n                      {fromValue !== maxAmountFormattedFree && (\r\n                        <div\r\n                          className=\"Exchange-swap-max\"\r\n                          onClick={() => {\r\n                            setFromValue(maxAmountFormattedFree);\r\n                          }}\r\n                        >\r\n                          MAX\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"PositionEditor-token-symbol\">\r\n                      {isDeposit ? position.collateralToken.symbol : \"USD\"}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"PositionEditor-info-box\">\r\n                  {minExecutionFeeErrorMessage && (\r\n                    <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>\r\n                  )}\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Size</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">{formatAmount(position.size, USD_DECIMALS, 2, true)} USD</div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Collateral</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextCollateral && <div>${formatAmount(position.collateral, USD_DECIMALS, 2, true)}</div>}\r\n                      {nextCollateral && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            ${formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          ${formatAmount(nextCollateral, USD_DECIMALS, 2, true)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Leverage</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextLeverage && <div>{formatAmount(position.leverage, 4, 2, true)}x</div>}\r\n                      {nextLeverage && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            {formatAmount(position.leverage, 4, 2, true)}x\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          {formatAmount(nextLeverage, 4, 2, true)}x\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Mark Price</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Liq. Price</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextLiquidationPrice && (\r\n                        <div>\r\n                          {!fromAmount && `$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}\r\n                          {fromAmount && \"-\"}\r\n                        </div>\r\n                      )}\r\n                      {nextLiquidationPrice && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          ${formatAmount(nextLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Execution Fee</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      <Tooltip\r\n                        handle={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol}`}\r\n                        position=\"right-top\"\r\n                        renderContent={() => {\r\n                          return (\r\n                            <>\r\n                              <StatsTooltipRow\r\n                                label=\"Network fee\"\r\n                                showDollar={false}\r\n                                value={`${formatAmountFree(\r\n                                  minExecutionFee,\r\n                                  18,\r\n                                  5\r\n                                )} ${nativeTokenSymbol} ($${formatAmount(minExecutionFeeUSD, USD_DECIMALS, 2)})`}\r\n                              />\r\n                              <br />\r\n                              This is the network cost required to execute the {isDeposit\r\n                                ? \"deposit\"\r\n                                : \"withdrawal\"}.{\" \"}\r\n                              <a\r\n                                href=\"https://gmxio.gitbook.io/gmx/trading#execution-fee\"\r\n                                target=\"_blank\"\r\n                                rel=\"noopener noreferrer\"\r\n                              >\r\n                                More Info\r\n                              </a>\r\n                            </>\r\n                          );\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"Exchange-swap-button-container\">\r\n                  <button\r\n                    className={\"App-cta Exchange-swap-button\" + (isPrimaryEnabled() ? \" hlight\" : \"\")}\r\n                    onClick={onClickPrimary}\r\n                    disabled={!isPrimaryEnabled()}\r\n                  >\r\n                    {getPrimaryText()}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\n\r\nimport \"./OrdersToa.css\";\r\n\r\nexport default function OrdersToa(props) {\r\n  const { setIsVisible, isPluginApproving, approveOrderBook } = props;\r\n\r\n  const [isChecked, setIsChecked] = useState(false);\r\n\r\n  const onConfirmationClick = () => {\r\n    approveOrderBook().then(() => {\r\n      setIsVisible(false);\r\n    });\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (isPluginApproving) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (!isChecked) {\r\n      return t`Accept terms to enable orders`;\r\n    }\r\n    return t`Enable Orders`;\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (isPluginApproving) {\r\n      return false;\r\n    }\r\n    return isChecked;\r\n  };\r\n\r\n  return null;\r\n}\r\n","import \"./SpinningLoader.css\";\r\n\r\nimport { ImSpinner2 } from \"react-icons/im\";\r\n\r\nfunction SpinningLoader({ size = \"1.25rem\" }) {\r\n  return <ImSpinner2 className=\"spin spinning-loader\" style={{ fontSize: size }} />;\r\n}\r\n\r\nexport default SpinningLoader;\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport { Trans } from \"@lingui/macro\";\r\nimport { toJpeg } from \"html-to-image\";\r\nimport cx from \"classnames\";\r\nimport { BiCopy } from \"react-icons/bi\";\r\nimport { RiFileDownloadLine } from \"react-icons/ri\";\r\nimport { FiTwitter } from \"react-icons/fi\";\r\nimport { useCopyToClipboard } from \"react-use\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport gmxLogo from \"../../img/gmx-logo-with-name.svg\";\r\nimport \"./PositionShare.css\";\r\nimport { QRCodeSVG } from \"qrcode.react\";\r\nimport {\r\n  formatAmount,\r\n  getHomeUrl,\r\n  getRootShareApiUrl,\r\n  getTwitterIntentURL,\r\n  helperToast,\r\n  USD_DECIMALS,\r\n} from \"../../lib/legacy\";\r\nimport { useAffiliateCodes } from \"../../domain/referrals\";\r\nimport SpinningLoader from \"../Common/SpinningLoader\";\r\nimport useLoadImage from \"../../lib/useLoadImage\";\r\nimport shareBgImg from \"../../img/position-share-bg.png\";\r\n\r\nconst ROOT_SHARE_URL = getRootShareApiUrl();\r\nconst UPLOAD_URL = ROOT_SHARE_URL + \"/api/upload\";\r\nconst UPLOAD_SHARE = ROOT_SHARE_URL + \"/api/s\";\r\nconst config = { quality: 0.95, canvasWidth: 1036, canvasHeight: 584 };\r\n\r\nfunction getShareURL(imageInfo, ref) {\r\n  if (!imageInfo) return;\r\n  let url = `${UPLOAD_SHARE}?id=${imageInfo.id}`;\r\n  if (ref.success) {\r\n    url = url + `&ref=${ref.code}`;\r\n  }\r\n  return url;\r\n}\r\n\r\nfunction PositionShare({ setIsPositionShareModalOpen, isPositionShareModalOpen, positionToShare, account, chainId }) {\r\n  const userAffiliateCode = useAffiliateCodes(chainId, account);\r\n  const [uploadedImageInfo, setUploadedImageInfo] = useState();\r\n  const [uploadedImageError, setUploadedImageError] = useState();\r\n  const [, copyToClipboard] = useCopyToClipboard();\r\n  const sharePositionBgImg = useLoadImage(shareBgImg);\r\n  const positionRef = useRef();\r\n  const tweetLink = getTwitterIntentURL(\r\n    `Latest $${positionToShare?.indexToken?.symbol} trade on @GMX_IO`,\r\n    getShareURL(uploadedImageInfo, userAffiliateCode)\r\n  );\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      const element = positionRef.current;\r\n      if (element && userAffiliateCode.success && sharePositionBgImg && positionToShare) {\r\n        const image = await toJpeg(element, config);\r\n        try {\r\n          const imageInfo = await fetch(UPLOAD_URL, { method: \"POST\", body: image }).then((res) => res.json());\r\n          setUploadedImageInfo(imageInfo);\r\n        } catch {\r\n          setUploadedImageInfo(null);\r\n          setUploadedImageError(\"Image generation error, please refresh and try again.\");\r\n        }\r\n      }\r\n    })();\r\n  }, [userAffiliateCode, sharePositionBgImg, positionToShare]);\r\n\r\n  async function handleDownload() {\r\n    const { indexToken, isLong } = positionToShare;\r\n    const element = positionRef.current;\r\n    if (!element) return;\r\n    const dataUrl = await toJpeg(element, config);\r\n    const link = document.createElement(\"a\");\r\n    link.download = `${indexToken.symbol}-${isLong ? \"long\" : \"short\"}.jpeg`;\r\n    link.href = dataUrl;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n  }\r\n\r\n  function handleCopy() {\r\n    if (!uploadedImageInfo) return;\r\n    const url = getShareURL(uploadedImageInfo, userAffiliateCode);\r\n    copyToClipboard(url);\r\n    helperToast.success(\"Link copied to clipboard.\");\r\n  }\r\n  return (\r\n    <Modal\r\n      className=\"position-share-modal\"\r\n      isVisible={isPositionShareModalOpen}\r\n      setIsVisible={setIsPositionShareModalOpen}\r\n      label=\"Share Position\"\r\n    >\r\n      <PositionShareCard\r\n        userAffiliateCode={userAffiliateCode}\r\n        positionRef={positionRef}\r\n        position={positionToShare}\r\n        chainId={chainId}\r\n        account={account}\r\n        uploadedImageInfo={uploadedImageInfo}\r\n        uploadedImageError={uploadedImageError}\r\n        sharePositionBgImg={sharePositionBgImg}\r\n      />\r\n      {uploadedImageError && <span className=\"error\">{uploadedImageError}</span>}\r\n\r\n      <div className=\"actions\">\r\n        <button disabled={!uploadedImageInfo} className=\"mr-base App-button-option\" onClick={handleCopy}>\r\n          <BiCopy className=\"icon\" />\r\n          <Trans>Copy</Trans>\r\n        </button>\r\n        <button className=\"mr-base App-button-option\" onClick={handleDownload}>\r\n          <RiFileDownloadLine className=\"icon\" />\r\n          <Trans>Download</Trans>\r\n        </button>\r\n        <div className={cx(\"tweet-link-container\", { disabled: !uploadedImageInfo })}>\r\n          <a\r\n            target=\"_blank\"\r\n            className={cx(\"tweet-link App-button-option\", { disabled: !uploadedImageInfo })}\r\n            rel=\"noreferrer\"\r\n            href={tweetLink}\r\n          >\r\n            <FiTwitter className=\"icon\" />\r\n            <Trans>Tweet</Trans>\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nfunction PositionShareCard({\r\n  positionRef,\r\n  position,\r\n  userAffiliateCode,\r\n  uploadedImageInfo,\r\n  uploadedImageError,\r\n  sharePositionBgImg,\r\n}) {\r\n  const { code, success } = userAffiliateCode;\r\n  const { deltaAfterFeesPercentageStr, isLong, leverage, indexToken, averagePrice, markPrice } = position;\r\n  const homeURL = getHomeUrl();\r\n  return (\r\n    <div className=\"relative\">\r\n      <div ref={positionRef} className=\"position-share\" style={{ backgroundImage: `url(${sharePositionBgImg})` }}>\r\n        <img className=\"logo\" src={gmxLogo} alt=\"GMX Logo\" />\r\n        <ul className=\"info\">\r\n          <li className=\"side\">{isLong ? \"LONG\" : \"SHORT\"}</li>\r\n          <li>{formatAmount(leverage, 4, 2, true)}x&nbsp;</li>\r\n          <li>{indexToken.symbol} USD</li>\r\n        </ul>\r\n        <h3 className=\"pnl\">{deltaAfterFeesPercentageStr}</h3>\r\n        <div className=\"prices\">\r\n          <div>\r\n            <p>Entry Price</p>\r\n            <p className=\"price\">${formatAmount(averagePrice, USD_DECIMALS, 2, true)}</p>\r\n          </div>\r\n          <div>\r\n            <p>Index Price</p>\r\n            <p className=\"price\">${formatAmount(markPrice, USD_DECIMALS, 2, true)}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"referral-code\">\r\n          <div>\r\n            <QRCodeSVG size={32} value={success ? `${homeURL}/#/?ref=${code}` : `${homeURL}`} />\r\n          </div>\r\n          <div className=\"referral-code-info\">\r\n            {success ? (\r\n              <>\r\n                <p className=\"label\">Referral Code:</p>\r\n                <p className=\"code\">{code}</p>\r\n              </>\r\n            ) : (\r\n              <p className=\"code\">https://gmx.io</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {!uploadedImageInfo && !uploadedImageError && (\r\n        <div className=\"image-overlay-wrapper\">\r\n          <div className=\"image-overlay\">\r\n            <SpinningLoader />\r\n            <p className=\"loading-text\">Generating shareable image...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PositionShare;\r\n","import { useEffect, useState } from \"react\";\r\n\r\nexport default function useLoadImage(src) {\r\n  const [sourceLoaded, setSourceLoaded] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const img = new Image();\r\n    img.src = src;\r\n    img.onload = () => setSourceLoaded(src);\r\n  }, [src]);\r\n\r\n  return sourceLoaded;\r\n}\r\n","import React, { useState } from 'react';\r\nimport Tooltip from './../Tooltip/Tooltip';\r\nimport { formatAmount } from '../../lib/legacy';\r\nimport { ImSpinner2 } from 'react-icons/im';\r\nimport { t } from '@lingui/macro';\r\nimport { USD_DECIMALS, INCREASE, STOP } from './../../lib/legacy';\r\nimport StatsTooltipRow from '../StatsTooltip/StatsTooltipRow';\r\nimport { Trans } from '@lingui/macro';\r\nimport './PositionsItem.scss';\r\nimport icon_edit from '../../../../img/icon-edit.svg';\r\n\r\nconst PositionsItem = (props) => {\r\n\tconst {\r\n\t\tposition,\r\n\t\tonPositionClick,\r\n\t\tsetListSection,\r\n\t\tpositionOrders,\r\n\t\tshowPnlAfterFees,\r\n\t\thasPositionProfit,\r\n\t\tpositionDelta,\r\n\t\thasOrderError,\r\n\t\tliquidationPrice,\r\n\t\tcx,\r\n\t\tborrowFeeUSD,\r\n\t\teditPosition,\r\n\t\tsellPosition,\r\n\t\tisLarge,\r\n\t\tisPending,\r\n\t\topenSLTPModal,\r\n\t} = props;\r\n\r\n\tconst [isCloseLoading, setIsCloseLoading] = useState(false);\r\n\r\n\tconst marketImg = require(`../../../../img/icon-${position.market}.svg`).default;\r\n\r\n\tif (position.market === 'GNS') {\r\n\t\tposition.hasPendingChanges = isPending;\r\n\t}\r\n\r\n\tconst openOrderModal = (market, isTP, position) => {\r\n\t\tif (market === 'GNS') {\r\n\t\t\topenSLTPModal(isTP, position);\r\n\t\t}\r\n\t\tif (market === 'GMX') {\r\n\t\t\tconst orderName = isTP ? 'TP' : 'SL';\r\n\t\t\tif (triggerPricesGMX[orderName]) {\r\n\t\t\t\tsetListSection && setListSection(\"Orders\");\r\n\t\t\t} else {\r\n\t\t\t\tsellPosition(position, setIsCloseLoading, STOP);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tconst triggerOrdersGMX = positionOrders?.filter(order => {\r\n\t\treturn order.type === 'Decrease';\r\n\t});\r\n\tconst triggerPricesGMX = {\r\n\t\tSL: undefined,\r\n\t\tTP: undefined,\r\n\t}\r\n\ttriggerOrdersGMX.map(order => {\r\n\t\tconst price = order.triggerPrice;\r\n\r\n\t\tif (position.isLong) {\r\n\t\t\tif (price.gt(position.averagePrice)) {\r\n\t\t\t\ttriggerPricesGMX.TP = price;\r\n\t\t\t} else if (price.lt(position.averagePrice)) {\r\n\t\t\t\ttriggerPricesGMX.SL = price;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (price.gt(position.averagePrice)) {\r\n\t\t\t\ttriggerPricesGMX.SL = price;\r\n\t\t\t} else if (price.lt(position.averagePrice)) {\r\n\t\t\t\ttriggerPricesGMX.TP = price;\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{isLarge ?\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td className=\"clickable\" onClick={() => onPositionClick(position)}>\r\n\t\t\t\t\t\t<div className=\"Exchange-list-title\">\r\n\t\t\t\t\t\t\t{position.indexToken.symbol}\r\n\t\t\t\t\t\t\t{position.hasPendingChanges && <ImSpinner2 className=\"spin position-loading-icon\" />}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"Exchange-list-info-label\">\r\n\t\t\t\t\t\t\t<img className='market-logo' src={marketImg} alt={`${position.market} icon`} />\r\n\t\t\t\t\t\t\t{position.leverage && (\r\n\t\t\t\t\t\t\t\t<span className=\"muted\">{formatAmount(position.leverage, 4, 2, true)}x&nbsp;</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<span className={cx({ positive: position.isLong, negative: !position.isLong })}>\r\n\t\t\t\t\t\t\t\t{position.isLong ? \"Long\" : \"Short\"}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t\t{positionOrders?.length > 0 && (\r\n\t\t\t\t\t\t\t<div onClick={() => setListSection && setListSection(\"Orders\")}>\r\n\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\thandle={`Orders (${positionOrders.length})`}\r\n\t\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\t\thandleClassName={cx(\r\n\t\t\t\t\t\t\t\t\t\t[\"Exchange-list-info-label\", \"Exchange-position-list-orders\", \"plain\", \"clickable\"],\r\n\t\t\t\t\t\t\t\t\t\t{ muted: !hasOrderError, negative: hasOrderError }\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<strong>Active Orders</strong>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{positionOrders.map((order) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`${order.isLong}-${order.type}-${order.index}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"Position-list-order\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.triggerAboveThreshold ? \">\" : \"<\"}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatAmount(order.triggerPrice, 30, 2, true)}:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.type === INCREASE ? \" +\" : \" -\"}${formatAmount(order.sizeDelta, 30, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.error && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t, <span className=\"negative\">{order.error}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\thandle={`$${formatAmount(position.collateral, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\thandleClassName={cx(\"plain\", { negative: position.hasLowCollateral })}\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{position.hasLowCollateral && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Trans>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tWARNING: This position has a low amount of collateral after deducting borrowing fees,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdeposit more collateral to reduce the position's liquidation risk.\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Trans>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\tlabel={t`Initial Collateral`}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\tlabel={t`Borrow Fee`}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow label={t`Borrow Fee / Day`} value={borrowFeeUSD} />\r\n\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t<Trans>Use the \"Edit\" button to deposit or withdraw collateral.</Trans>\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{position.market === 'GMX' && (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName='edit-btn'\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\teditPosition(position);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<img src={icon_edit} alt=\"Edit position button\" />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td onClick={() => {\r\n\t\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}} style={{width: 135}}>\r\n\t\t\t\t\t\t{`$${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td className=\"\" onClick={() => {\r\n\t\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t\t{`$${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td className=\"\" onClick={() => {\r\n\t\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t\t{`$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<div style={{ width: 100, display: 'block' }}>\r\n\t\t\t\t\t\t\t{position.deltaStr && (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName={cx(\"Exchange-list-info-label\", {\r\n\t\t\t\t\t\t\t\t\t\tpositive: hasPositionProfit && positionDelta.gt(0),\r\n\t\t\t\t\t\t\t\t\t\tnegative: !hasPositionProfit && positionDelta.gt(0),\r\n\t\t\t\t\t\t\t\t\t\tmuted: positionDelta.eq(0),\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{position.deltaAfterFeesStr ?? position.deltaStr} ({position.deltaAfterFeesPercentageStr ?? position.deltaPercentageStr})\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t{position.market === 'GNS' && position.sl &&\r\n\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t!position.sl?.eq(0) &&\r\n\t\t\t\t\t\t\t\t\t('$' + formatAmount(position.sl, 10, 2, true))\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{position.market === 'GMX' && (triggerPricesGMX.SL \r\n\t\t\t\t\t\t\t? ('$' + formatAmount(triggerPricesGMX.SL, USD_DECIMALS, 2, true))\r\n\t\t\t\t\t\t\t: '')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\t\tonClick={() => openOrderModal(position.market, false, position)}\r\n\t\t\t\t\t\t\tdisabled={!position.size || isPending}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{((!position.sl || position.sl?.eq(0)) && !triggerPricesGMX.SL)\r\n\t\t\t\t\t\t\t\t? 'Set SL'\r\n\t\t\t\t\t\t\t\t: <img src={icon_edit} alt=\"Edit Stop Loss button\" />}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t{position.market === 'GNS' && position.tp &&\r\n\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t!position.tp?.eq(0) &&\r\n\t\t\t\t\t\t\t\t\t('$' + formatAmount(position.tp, 10, 2, true))\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{position.market === 'GMX' && (triggerPricesGMX.TP \r\n\t\t\t\t\t\t\t? ('$' + formatAmount(triggerPricesGMX.TP, USD_DECIMALS, 2, true))\r\n\t\t\t\t\t\t\t: '')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\t\tonClick={() => openOrderModal(position.market, true, position)}\r\n\t\t\t\t\t\t\tdisabled={!position.size || isPending}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{((!position.tp || position.tp?.eq(0)) && !triggerPricesGMX.TP)\r\n\t\t\t\t\t\t\t\t? 'Set TP'\r\n\t\t\t\t\t\t\t\t: <img src={icon_edit} alt=\"Edit Take Profit button\" />}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td className=\"td-btn pos-relative\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tisCloseLoading ?\r\n\t\t\t\t\t\t\t\t<ImSpinner2 className=\"spin position-loading-icon\" />\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t!isPending &&\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetIsCloseLoading(true);\r\n\t\t\t\t\t\t\t\t\t\t\tsellPosition(position, setIsCloseLoading);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={position.size.eq(0)}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tClose\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t:\r\n\t\t\t<div className=\"App-card\">\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-content\">\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Position</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div className=\"Exchange-list-token\">\r\n\t\t\t\t\t\t\t\t{position.hasPendingChanges && <ImSpinner2 className=\"spin position-loading-icon\" style={{marginRight: 10}} />}\r\n\t\t\t\t\t\t\t\t{position.indexToken.symbol}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<img className='market-logo' src={marketImg} alt={`${position.market} icon`} />\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tclassName={cx(\"Exchange-list-side\", {\r\n\t\t\t\t\t\t\t\t\tpositive: position.isLong,\r\n\t\t\t\t\t\t\t\t\tnegative: !position.isLong,\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t><span className=\"Exchange-list-leverage\">{formatAmount(position.leverage, 4, 2, true)}x&nbsp;</span>\r\n\t\t\t\t\t\t\t\t{position.isLong ? t`Long` : t`Short`}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\tSize\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-content\">\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Mark Price</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Entry Price</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Liq. Price</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\tPNL (ROE %)\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{position.deltaStr && (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName={cx(\"Exchange-list-info-label\", {\r\n\t\t\t\t\t\t\t\t\t\tpositive: hasPositionProfit && positionDelta.gt(0),\r\n\t\t\t\t\t\t\t\t\t\tnegative: !hasPositionProfit && positionDelta.gt(0),\r\n\t\t\t\t\t\t\t\t\t\tmuted: positionDelta.eq(0),\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{position.deltaAfterFeesStr ?? position.deltaStr} ({position.deltaAfterFeesPercentageStr ?? position.deltaPercentageStr})\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row App-card-row_edit-btn\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\tStop Loss\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{position.market === 'GNS' && position.sl &&\r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t!position.sl?.eq(0) &&\r\n\t\t\t\t\t\t\t\t\t\t('$' + formatAmount(position.sl, 10, 2, true))\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{position.market === 'GMX' && (triggerPricesGMX.SL \r\n\t\t\t\t\t\t\t\t? ('$' + formatAmount(triggerPricesGMX.SL, USD_DECIMALS, 2, true))\r\n\t\t\t\t\t\t\t\t: '')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\t\tonClick={() => openOrderModal(position.market, false, position)}\r\n\t\t\t\t\t\t\tdisabled={!position.size || isPending}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{((!position.sl || position.sl?.eq(0)) && !triggerPricesGMX.SL)\r\n\t\t\t\t\t\t\t\t? 'Set SL'\r\n\t\t\t\t\t\t\t\t: <img src={icon_edit} alt=\"Edit Stop Loss button\" />}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row App-card-row_edit-btn\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\tTake Profit\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{position.market === 'GNS' && position.tp &&\r\n\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t!position.tp?.eq(0) &&\r\n\t\t\t\t\t\t\t\t\t\t('$' + formatAmount(position.tp, 10, 2, true))\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{position.market === 'GMX' && (triggerPricesGMX.TP \r\n\t\t\t\t\t\t\t\t? ('$' + formatAmount(triggerPricesGMX.TP, USD_DECIMALS, 2, true))\r\n\t\t\t\t\t\t\t\t: '')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\t\tonClick={() => openOrderModal(position.market, true, position)}\r\n\t\t\t\t\t\t\tdisabled={!position.size || isPending}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{((!position.tp || position.tp?.eq(0)) && !triggerPricesGMX.TP)\r\n\t\t\t\t\t\t\t\t? 'Set TP'\r\n\t\t\t\t\t\t\t\t: <img src={icon_edit} alt=\"Edit Take Profit button\" />}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-options\">\r\n\t\t\t\t\t<div className=\"App-button-option pos-relative\">\r\n\t\t\t\t\t\t{!isPending &&\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName=\"App-button-option App-card-option\"\r\n\t\t\t\t\t\t\t\tdisabled={position.size.eq(0)}\r\n\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\tsellPosition(position, setIsCloseLoading);\r\n\t\t\t\t\t\t\t\t\tsetIsCloseLoading(true);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tClose\r\n\t\t\t\t\t\t\t</button>}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>}\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default PositionsItem;","import React, { useState } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport PositionSeller from \"./PositionSeller\";\r\nimport PositionEditor from \"./PositionEditor\";\r\nimport OrdersToa from \"./OrdersToa\";\r\n\r\nimport { ImSpinner2 } from \"react-icons/im\";\r\n\r\nimport {\r\n  helperToast,\r\n  bigNumberify,\r\n  getLiquidationPrice,\r\n  getUsd,\r\n  getLeverage,\r\n  formatAmount,\r\n  getOrderError,\r\n  USD_DECIMALS,\r\n  FUNDING_RATE_PRECISION,\r\n  SWAP,\r\n  LONG,\r\n  SHORT,\r\n  INCREASE,\r\n  DECREASE,\r\n  BASIS_POINTS_DIVISOR,\r\n  getDeltaStr,\r\n} from \"../../lib/legacy\";\r\nimport PositionShare from \"./PositionShare\";\r\nimport PositionsItem from './PositionsItem';\r\nimport { ADDRESS_ZERO } from '@uniswap/v3-sdk';\r\nimport { GNS_PAIRS } from './../../lib/GNS_legacy';\r\nimport GNS_Trading from '../../abis/GNS/GNS_Trading.json';\r\nimport { errAlert, notifySuccess } from './../../../../components/utils/notifications';\r\nimport { ethers } from 'ethers';\r\nimport { BigNumber } from 'ethers';\r\nimport { getTokenBySymbol } from \"../../config/Tokens\";\r\nimport { expandDecimals, MARKET } from './../../lib/legacy';\r\nimport { GNS_FEES_MULTIPLIER } from './../../../../components/utils/constants';\r\nimport SLTPModal from './../../../../components/UI/modal/SLTPModal';\r\nimport { formatForContract } from \"../../../../components/utils/math\";\r\n\r\nconst getOrdersForPosition = (account, position, orders, nativeTokenAddress) => {\r\n  if (!orders || orders.length === 0) {\r\n    return [];\r\n  }\r\n  /* eslint-disable array-callback-return */\r\n  return orders\r\n    .filter((order) => {\r\n      if (order.type === SWAP) {\r\n        return false;\r\n      }\r\n      const hasMatchingIndexToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      const hasMatchingCollateralToken =\r\n        order.collateralToken === nativeTokenAddress\r\n          ? position.collateralToken.isNative\r\n          : order.collateralToken === position.collateralToken.address;\r\n      if (order.isLong === position.isLong && hasMatchingIndexToken && hasMatchingCollateralToken) {\r\n        return true;\r\n      }\r\n    })\r\n    .map((order) => {\r\n      order.error = getOrderError(account, order, undefined, position);\r\n      if (order.type === DECREASE && order.sizeDelta.gt(position.size)) {\r\n        order.error = \"Order size is bigger than position, will only be executable if position increases\";\r\n      }\r\n      return order;\r\n    });\r\n};\r\n\r\nexport default function PositionsList(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsGNS,\r\n    positions,\r\n    positionsDataIsLoading,\r\n    positionsMap,\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    setListSection,\r\n    flagOrdersEnabled,\r\n    savedIsPnlInLeverage,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    orders,\r\n    setIsWaitingForPluginApproval,\r\n    approveOrderBook,\r\n    isPluginApproving,\r\n    isWaitingForPluginApproval,\r\n    orderBookApproved,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    showPnlAfterFees,\r\n    setMarket,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n    positionsLoading,\r\n    pendingPositionsGNS,\r\n  } = props;\r\n\r\n  const hasPositions = Boolean(positions?.length || positionsGNS?.length || Object.keys(pendingPositionsGNS).length);\r\n\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [SLTPModalInfo, setSLTPModalInfo] = useState([]);\r\n\r\n\r\n  const renderSLTPModal = () => {\r\n    const [isTP, position, title, btnText] = SLTPModalInfo;\r\n    const onApply = (val, setIsLoading) => {\r\n      setSLTP(isTP, val, position, setIsLoading);\r\n    }\r\n    \r\n    return (\r\n      <SLTPModal\r\n        visible={modalVisible}\r\n        setVisible={setModalVisible}\r\n        title={title}\r\n        btnText={btnText}\r\n        onApply={onApply}\r\n        isTP={isTP}\r\n        position={position}\r\n      />\r\n    );\r\n  }\r\n  const openSLTPModal = (isTP, position) => {\r\n    const curVal = isTP ? position.tp : position.sl;\r\n    const orderName = isTP ? 'Take Profit' : 'Stop Loss';\r\n    const title = `${!curVal?.eq(0) ? 'Edit' : 'Set'} ${orderName}`;\r\n    const btnText = !curVal?.eq(0) ? 'Save changes' : title;\r\n\r\n\t\tsetSLTPModalInfo([\r\n\t\t\tisTP, position, title, btnText\r\n\t\t]);\r\n    setModalVisible(true);\r\n  }\r\n\r\n  \r\n  const setSLTP = (isTP, value, position, setIsLoading) => {\r\n    const pairIndex = position.pairIndex;\r\n    const index = position.index;\r\n    const newValue = value ? formatForContract(value, 10) : '0';\r\n    \r\n    const contract = new ethers.Contract(GNS_Trading.address, GNS_Trading.abi, library.getSigner());\r\n    const method = isTP ? 'updateTp' : 'updateSl';\r\n\r\n    contract[method](pairIndex, index, newValue)\r\n      .then(tsc => {\r\n        console.log(tsc);\r\n      \r\n        tsc.wait()\r\n          .then(() => {\r\n            notifySuccess(`${isTP ? 'Take Profit' : 'Stop Loss'} update submitted!`, tsc.hash);\r\n            setModalVisible(false);\r\n          })\r\n      }, errAlert).finally(() => setIsLoading(false));\r\n  }\r\n\r\n  const [positionToEditKey, setPositionToEditKey] = useState(undefined);\r\n  const [positionToSellKey, setPositionToSellKey] = useState(undefined);\r\n  const [positionToShare, setPositionToShare] = useState(null);\r\n  const [isPositionEditorVisible, setIsPositionEditorVisible] = useState(undefined);\r\n  const [isPositionSellerVisible, setIsPositionSellerVisible] = useState(undefined);\r\n  const [positionSellerTab, setPositionSellerTab] = useState(MARKET);\r\n  const [collateralTokenAddress, setCollateralTokenAddress] = useState(undefined);\r\n  const [isPositionShareModalOpen, setIsPositionShareModalOpen] = useState(false);\r\n  const [ordersToaOpen, setOrdersToaOpen] = useState(false);\r\n  const [isHigherSlippageAllowed, setIsHigherSlippageAllowed] = useState(false);\r\n\r\n  const editPosition = (position) => {\r\n    setCollateralTokenAddress(position.collateralToken.address);\r\n    setPositionToEditKey(position.key);\r\n    setIsPositionEditorVisible(true);\r\n  };\r\n\r\n  const sellPosition = (position, setLoading, initTab) => {\r\n    if (position.market === 'GMX') {\r\n      setPositionToSellKey(position.key);\r\n      setIsPositionSellerVisible(true);\r\n      setPositionSellerTab(initTab);\r\n      setIsHigherSlippageAllowed(false);\r\n      setLoading(false);\r\n    } else if (position.market === 'GNS') {\r\n      const contract = new ethers.Contract(GNS_Trading.address, GNS_Trading.abi, library.getSigner());\r\n\r\n      contract.closeTradeMarket(\r\n        position.pairIndex,\r\n        position.index\r\n      ).then(tsc => {\r\n        console.log(tsc);\r\n\r\n        tsc.wait().then(() => {\r\n          notifySuccess('Position closed!', tsc.hash);\r\n        })\r\n      }, err => {\r\n        errAlert(err);\r\n        setLoading(false);\r\n      });\r\n    }\r\n  };\r\n  \r\n  const onPositionClick = (position) => {\r\n    helperToast.success(`${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol} market selected`);\r\n    setMarket(position.isLong ? LONG : SHORT, position.indexToken.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"PositionsList\">\r\n      <PositionEditor\r\n        pendingPositions={pendingPositions}\r\n        setPendingPositions={setPendingPositions}\r\n        positionsMap={positionsMap}\r\n        positionKey={positionToEditKey}\r\n        isVisible={isPositionEditorVisible}\r\n        setIsVisible={setIsPositionEditorVisible}\r\n        infoTokens={infoTokens}\r\n        active={active}\r\n        account={account}\r\n        library={library}\r\n        collateralTokenAddress={collateralTokenAddress}\r\n        pendingTxns={pendingTxns}\r\n        setPendingTxns={setPendingTxns}\r\n        getUsd={getUsd}\r\n        getLeverage={getLeverage}\r\n        savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n        positionRouterApproved={positionRouterApproved}\r\n        isPositionRouterApproving={isPositionRouterApproving}\r\n        isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n        approvePositionRouter={approvePositionRouter}\r\n        chainId={chainId}\r\n        minExecutionFee={minExecutionFee}\r\n        minExecutionFeeUSD={minExecutionFeeUSD}\r\n        minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n      />\r\n      {ordersToaOpen && (\r\n        <OrdersToa\r\n          setIsVisible={setOrdersToaOpen}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n        />\r\n      )}\r\n      {isPositionShareModalOpen && (\r\n        <PositionShare\r\n          setIsPositionShareModalOpen={setIsPositionShareModalOpen}\r\n          isPositionShareModalOpen={isPositionShareModalOpen}\r\n          positionToShare={positionToShare}\r\n          chainId={chainId}\r\n          account={account}\r\n        />\r\n      )}\r\n      {ordersToaOpen && (\r\n        <OrdersToa\r\n          setIsVisible={setOrdersToaOpen}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n        />\r\n      )}\r\n      {isPositionSellerVisible && (\r\n        <PositionSeller\r\n          pendingPositions={pendingPositions}\r\n          setPendingPositions={setPendingPositions}\r\n          setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n          isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n          orderBookApproved={orderBookApproved}\r\n          positionsMap={positionsMap}\r\n          positionKey={positionToSellKey}\r\n          isVisible={isPositionSellerVisible}\r\n          setIsVisible={setIsPositionSellerVisible}\r\n          infoTokens={infoTokens}\r\n          active={active}\r\n          account={account}\r\n          orders={orders}\r\n          library={library}\r\n          pendingTxns={pendingTxns}\r\n          setPendingTxns={setPendingTxns}\r\n          flagOrdersEnabled={flagOrdersEnabled}\r\n          savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n          chainId={chainId}\r\n          nativeTokenAddress={nativeTokenAddress}\r\n          setOrdersToaOpen={setOrdersToaOpen}\r\n          positionRouterApproved={positionRouterApproved}\r\n          isPositionRouterApproving={isPositionRouterApproving}\r\n          isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n          approvePositionRouter={approvePositionRouter}\r\n          isHigherSlippageAllowed={isHigherSlippageAllowed}\r\n          setIsHigherSlippageAllowed={setIsHigherSlippageAllowed}\r\n          minExecutionFee={minExecutionFee}\r\n          minExecutionFeeUSD={minExecutionFeeUSD}\r\n          minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n          usdgSupply={usdgSupply}\r\n          totalTokenWeights={totalTokenWeights}\r\n          initTab={positionSellerTab}\r\n        />\r\n      )}\r\n      {renderSLTPModal()}\r\n      <div className=\"Exchange-list small\">\r\n        <div>\r\n          {!hasPositions && (positionsDataIsLoading || positionsLoading) && (\r\n            <div className=\"Exchange-empty-positions-list-note App-card\">\r\n              <Trans>Loading...</Trans>\r\n            </div>\r\n          )}\r\n          {!hasPositions && !positionsDataIsLoading && !positionsLoading && (\r\n            <div className=\"Exchange-empty-positions-list-note App-card Exchange-list-empty-note\">\r\n              <Trans>No open positions</Trans>\r\n            </div>\r\n          )}\r\n          {positions.map((position) => {\r\n            position.market = \"GMX\";\r\n            \r\n            const positionOrders = getOrdersForPosition(account, position, orders, nativeTokenAddress);\r\n            const liquidationPrice = getLiquidationPrice(position);\r\n            const hasPositionProfit = position[showPnlAfterFees ? \"hasProfitAfterFees\" : \"hasProfit\"];\r\n            const positionDelta =\r\n              position[showPnlAfterFees ? \"pendingDeltaAfterFees\" : \"pendingDelta\"] || bigNumberify(0);\r\n            let borrowFeeUSD;\r\n            if (position.collateralToken && position.collateralToken.fundingRate) {\r\n              const borrowFeeRate = position.collateralToken.fundingRate\r\n                .mul(position.size)\r\n                .mul(24)\r\n                .div(FUNDING_RATE_PRECISION);\r\n              borrowFeeUSD = formatAmount(borrowFeeRate, USD_DECIMALS, 2);\r\n            }\r\n\r\n            return (\r\n              <PositionsItem\r\n                openSLTPModal={openSLTPModal}\r\n                key={position.key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={positionDelta}\r\n                liquidationPrice={liquidationPrice}\r\n                cx={cx}\r\n                borrowFeeUSD={borrowFeeUSD}\r\n                editPosition={editPosition}\r\n                sellPosition={sellPosition}\r\n                setSLTP={setSLTP}\r\n                isLarge={false}\r\n              />\r\n            );\r\n          })}\r\n          {positionsGNS?.map(pos => {\r\n            if (!pos.trader || pos.trader === ADDRESS_ZERO) {\r\n              return;\r\n            }\r\n            \r\n            const position = Object.assign({}, pos);\r\n\r\n            position.market = \"GNS\";\r\n            const key = `${position.pairIndex}${position.index}`;\r\n            const isLong = position.buy;\r\n            position.isLong = isLong;\r\n\r\n            const tokenSymb = Object.keys(GNS_PAIRS).find(symb => GNS_PAIRS[symb] === Number(position.pairIndex));\r\n            position.indexToken = getTokenBySymbol(chainId, tokenSymb);\r\n            const tokenAddr = position.indexToken.address;\r\n            const curPrice = infoTokens[tokenAddr].maxPrice;\r\n\r\n            position.size = BigNumber.from(position.positionSizeDai + '0'.repeat(12)).mul(position.leverage);\r\n            position.markPrice = curPrice;\r\n            position.averagePrice = BigNumber.from(position.openPrice + '0'.repeat(20));\r\n            position.collateral = BigNumber.from(position.positionSizeDai + '0'.repeat(12));\r\n            \r\n            position.initCollateral = expandDecimals(position.positionSizeDai.div(10000 - position.leverage.mul(GNS_FEES_MULTIPLIER * 10**4)), 16);\r\n            position.fees = position.initCollateral.sub(position.collateral);\r\n            \r\n            \r\n            let hasPositionProfit;\r\n            if (isLong) {\r\n              hasPositionProfit = position.markPrice.gte(position.averagePrice);\r\n            } else {\r\n              hasPositionProfit = position.markPrice.lte(position.averagePrice);\r\n            }\r\n            position.hasProfit = hasPositionProfit;\r\n            \r\n            const priceDelta = position.averagePrice.gt(position.markPrice)\r\n            ? position.averagePrice.sub(position.markPrice)\r\n            : position.markPrice.sub(position.averagePrice);\r\n            position.delta = position.size.mul(priceDelta).div(position.averagePrice);\r\n            \r\n            position.deltaPercentage = position.delta.mul(BASIS_POINTS_DIVISOR).div(position.collateral);\r\n\r\n            let pendingDeltaAfterFees;\r\n            if (position.hasProfit) {\r\n              if (position.delta.gt(position.fees)) {\r\n                hasPositionProfit = true;\r\n                pendingDeltaAfterFees = position.delta.sub(position.fees);\r\n              } else {\r\n                hasPositionProfit = false;\r\n                pendingDeltaAfterFees = position.fees.sub(position.delta);\r\n              }\r\n            } else {\r\n              hasPositionProfit = false;\r\n              pendingDeltaAfterFees = position.delta.add(position.fees);\r\n            }\r\n      \r\n            position.hasProfit = hasPositionProfit;\r\n            position.delta = pendingDeltaAfterFees;\r\n            position.deltaPercentage = pendingDeltaAfterFees\r\n              .mul(BASIS_POINTS_DIVISOR)\r\n              .div(position.collateral);\r\n            \r\n            const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n              delta: position.delta,\r\n              deltaPercentage: position.deltaPercentage,\r\n              hasProfit: position.hasProfit,\r\n            });\r\n\r\n            position.deltaStr = deltaStr;\r\n            position.deltaPercentageStr = deltaPercentageStr;\r\n            position.deltaBeforeFeesStr = deltaStr;\r\n            \r\n            const entryPrice = position.averagePrice;\r\n            const collateral = position.collateral.mul(position.leverage);\r\n            const liqPriceDistance = (entryPrice.mul(collateral.mul(9).div(10)).div(collateral).div(position.leverage));\r\n            \r\n            const liqPrice = isLong ?\r\n                entryPrice.sub(liqPriceDistance)\r\n                : entryPrice.add(liqPriceDistance);\r\n            \r\n            position.leverage = position.leverage * 10**4;\r\n\r\n            const positionOrders = [];\r\n            return (\r\n              <PositionsItem\r\n                openSLTPModal={openSLTPModal}\r\n                key={key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={position.delta}\r\n                liquidationPrice={liqPrice}\r\n                cx={cx}\r\n                // borrowFeeUSD={borrowFeeUSD}\r\n                editPosition={editPosition}\r\n                sellPosition={sellPosition}\r\n                setSLTP={setSLTP}\r\n                isLarge={false}\r\n              />\r\n            );\r\n          })}\r\n          {Object.keys(pendingPositionsGNS)?.map(posKey => {\r\n            if (!posKey) {\r\n              return;\r\n            }\r\n\r\n            const position = Object.assign({}, pendingPositionsGNS[posKey]);\r\n\r\n            position.market = \"GNS\";\r\n            const key = `${position.pairIndex}`;\r\n\r\n            const tokenSymb = Object.keys(GNS_PAIRS).find(symb => GNS_PAIRS[symb] === Number(position.pairIndex));\r\n            \r\n            position.indexToken = getTokenBySymbol(chainId, tokenSymb);\r\n            const tokenAddr = position.indexToken.address;\r\n            const curPrice = infoTokens[tokenAddr].maxPrice;\r\n\r\n            position.size = BigNumber.from(position.positionSizeDai + '0'.repeat(12)).mul(position.leverage / 10**4);\r\n            position.markPrice = curPrice;\r\n            position.averagePrice = 0;\r\n            position.collateral = BigNumber.from(position.positionSizeDai + '0'.repeat(12));\r\n            \r\n            const hasPositionProfit = undefined;\r\n            position.hasProfit = hasPositionProfit;\r\n\r\n            const positionOrders = [];\r\n            return (\r\n              <PositionsItem\r\n                openSLTPModal={openSLTPModal}\r\n                key={key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={0}\r\n                liquidationPrice={0}\r\n                cx={cx}\r\n                // borrowFeeUSD={borrowFeeUSD}\r\n                editPosition={editPosition}\r\n                sellPosition={sellPosition}\r\n                setSLTP={setSLTP}\r\n                isLarge={true}\r\n                isPending={true}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n      <table className=\"Exchange-list large App-box\">\r\n        <tbody>\r\n          {hasPositions && (\r\n            <tr className=\"Exchange-list-header\">\r\n              <th>\r\n                <Trans>Position</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Size</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Collateral</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Mark Price</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Entry Price</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Liq. Price</Trans>\r\n              </th>\r\n              <th>\r\n                PNL (ROE %)\r\n              </th>\r\n              <th>\r\n                Stop Loss\r\n              </th>\r\n              <th>\r\n                Take Profit\r\n              </th>\r\n              <th></th>\r\n            </tr>\r\n          )}\r\n          {!hasPositions && (positionsDataIsLoading || positionsLoading) && (\r\n            <tr>\r\n              <td colSpan=\"15\">\r\n                <div className=\"Exchange-empty-positions-list-note\">Loading...</div>\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {!hasPositions && !positionsDataIsLoading && !positionsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\" className=\"Exchange-list-empty-note\">\r\n                No open positions\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {positions.map((position) => {\r\n            const liquidationPrice = getLiquidationPrice(position) || bigNumberify(0);\r\n            const positionOrders = getOrdersForPosition(account, position, orders, nativeTokenAddress);\r\n            const hasOrderError = !!positionOrders.find((order) => order.error);\r\n            const hasPositionProfit = position[showPnlAfterFees ? \"hasProfitAfterFees\" : \"hasProfit\"];\r\n            const positionDelta =\r\n              position[showPnlAfterFees ? \"pendingDeltaAfterFees\" : \"pendingDelta\"] || bigNumberify(0);\r\n            let borrowFeeUSD;\r\n            if (position.collateralToken && position.collateralToken.fundingRate) {\r\n              const borrowFeeRate = position.collateralToken.fundingRate\r\n                .mul(position.size)\r\n                .mul(24)\r\n                .div(FUNDING_RATE_PRECISION);\r\n              borrowFeeUSD = formatAmount(borrowFeeRate, USD_DECIMALS, 2);\r\n            }\r\n\r\n\r\n            return (\r\n              <PositionsItem\r\n                openSLTPModal={openSLTPModal}\r\n                key={position.key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={positionDelta}\r\n                liquidationPrice={liquidationPrice}\r\n                cx={cx}\r\n                borrowFeeUSD={borrowFeeUSD}\r\n                editPosition={editPosition}\r\n                sellPosition={sellPosition}\r\n                setSLTP={setSLTP}\r\n                isLarge={true}\r\n              />\r\n            );\r\n          })}\r\n          {positionsGNS?.map(pos => {\r\n            if (!pos.trader || pos.trader === ADDRESS_ZERO) {\r\n              return;\r\n            }\r\n            \r\n            const position = Object.assign({}, pos);\r\n\r\n            position.market = \"GNS\";\r\n            const key = `${position.pairIndex}${position.index}`;\r\n            const isLong = position.buy;\r\n            position.isLong = isLong;\r\n\r\n            const tokenSymb = Object.keys(GNS_PAIRS).find(symb => GNS_PAIRS[symb] === Number(position.pairIndex));\r\n            position.indexToken = getTokenBySymbol(chainId, tokenSymb);\r\n            const tokenAddr = position.indexToken.address;\r\n            const curPrice = infoTokens[tokenAddr].maxPrice;\r\n\r\n            position.size = BigNumber.from(position.positionSizeDai + '0'.repeat(12)).mul(position.leverage);\r\n            position.markPrice = curPrice;\r\n            position.averagePrice = BigNumber.from(position.openPrice + '0'.repeat(20));\r\n            position.collateral = BigNumber.from(position.positionSizeDai + '0'.repeat(12));\r\n            \r\n            position.initCollateral = expandDecimals(position.positionSizeDai.div(10000 - position.leverage.mul(GNS_FEES_MULTIPLIER * 10**4)), 16);\r\n            position.fees = position.initCollateral.sub(position.collateral);\r\n            \r\n            \r\n            let hasPositionProfit;\r\n            if (isLong) {\r\n              hasPositionProfit = position.markPrice.gte(position.averagePrice);\r\n            } else {\r\n              hasPositionProfit = position.markPrice.lte(position.averagePrice);\r\n            }\r\n            position.hasProfit = hasPositionProfit;\r\n            \r\n            const priceDelta = position.averagePrice.gt(position.markPrice)\r\n            ? position.averagePrice.sub(position.markPrice)\r\n            : position.markPrice.sub(position.averagePrice);\r\n            position.delta = position.size.mul(priceDelta).div(position.averagePrice);\r\n            \r\n            position.deltaPercentage = position.delta.mul(BASIS_POINTS_DIVISOR).div(position.collateral);\r\n\r\n            let pendingDeltaAfterFees;\r\n            if (position.hasProfit) {\r\n              if (position.delta.gt(position.fees)) {\r\n                hasPositionProfit = true;\r\n                pendingDeltaAfterFees = position.delta.sub(position.fees);\r\n              } else {\r\n                hasPositionProfit = false;\r\n                pendingDeltaAfterFees = position.fees.sub(position.delta);\r\n              }\r\n            } else {\r\n              hasPositionProfit = false;\r\n              pendingDeltaAfterFees = position.delta.add(position.fees);\r\n            }\r\n      \r\n            position.hasProfit = hasPositionProfit;\r\n            position.delta = pendingDeltaAfterFees;\r\n            position.deltaPercentage = pendingDeltaAfterFees\r\n              .mul(BASIS_POINTS_DIVISOR)\r\n              .div(position.collateral);\r\n            \r\n            const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n              delta: position.delta,\r\n              deltaPercentage: position.deltaPercentage,\r\n              hasProfit: position.hasProfit,\r\n            });\r\n\r\n            position.deltaStr = deltaStr;\r\n            position.deltaPercentageStr = deltaPercentageStr;\r\n            position.deltaBeforeFeesStr = deltaStr;\r\n            \r\n            const entryPrice = position.averagePrice;\r\n            const collateral = position.collateral.mul(position.leverage);\r\n            const liqPriceDistance = (entryPrice.mul(collateral.mul(9).div(10)).div(collateral).div(position.leverage));\r\n            \r\n            const liqPrice = isLong ?\r\n                entryPrice.sub(liqPriceDistance)\r\n                : entryPrice.add(liqPriceDistance);\r\n            \r\n            position.leverage = position.leverage * 10**4;\r\n\r\n            const positionOrders = [];\r\n            return (\r\n              <PositionsItem\r\n                openSLTPModal={openSLTPModal}\r\n                key={key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={position.delta}\r\n                liquidationPrice={liqPrice}\r\n                cx={cx}\r\n                // borrowFeeUSD={borrowFeeUSD}\r\n                editPosition={editPosition}\r\n                sellPosition={sellPosition}\r\n                setSLTP={setSLTP}\r\n                isLarge={true}\r\n              />\r\n            );\r\n          })}\r\n          {Object.keys(pendingPositionsGNS)?.map(posKey => {\r\n            if (!posKey) {\r\n              return;\r\n            }\r\n            \r\n            const position = Object.assign({}, pendingPositionsGNS[posKey]);\r\n\r\n            position.market = \"GNS\";\r\n            const key = `${position.pairIndex}`;\r\n\r\n            const tokenSymb = Object.keys(GNS_PAIRS).find(symb => GNS_PAIRS[symb] === Number(position.pairIndex));\r\n            \r\n            position.indexToken = getTokenBySymbol(chainId, tokenSymb);\r\n            const tokenAddr = position.indexToken.address;\r\n            const curPrice = infoTokens[tokenAddr].maxPrice;\r\n\r\n            position.size = BigNumber.from(position.positionSizeDai + '0'.repeat(12)).mul(position.leverage / 10**4);\r\n            position.markPrice = curPrice;\r\n            position.averagePrice = 0;\r\n            position.collateral = BigNumber.from(position.positionSizeDai + '0'.repeat(12));\r\n            \r\n            const hasPositionProfit = undefined;\r\n            position.hasProfit = hasPositionProfit;\r\n\r\n            const positionOrders = [];\r\n            return (\r\n              <PositionsItem\r\n                openSLTPModal={openSLTPModal}\r\n                key={key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={0}\r\n                liquidationPrice={0}\r\n                cx={cx}\r\n                // borrowFeeUSD={borrowFeeUSD}\r\n                editPosition={editPosition}\r\n                sellPosition={sellPosition}\r\n                setSLTP={setSLTP}\r\n                isLarge={true}\r\n                isPending={true}\r\n              />\r\n            );\r\n          })}\r\n          \r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}","import React, { useState, useMemo } from \"react\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  PRECISION,\r\n  USD_DECIMALS,\r\n  SWAP,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n  MIN_PROFIT_TIME,\r\n  DECREASE,\r\n  INCREASE,\r\n  useChainId,\r\n  getTokenInfo,\r\n  isTriggerRatioInverted,\r\n  bigNumberify,\r\n  formatAmountFree,\r\n  parseValue,\r\n  getNextToAmount,\r\n  getExchangeRate,\r\n  formatAmount,\r\n  getExchangeRateDisplay,\r\n  calculatePositionDelta,\r\n  getLiquidationPrice,\r\n  formatDateTime,\r\n  getDeltaStr,\r\n  getProfitPrice,\r\n  getTimeRemaining,\r\n} from \"../../lib/legacy\";\r\nimport { updateSwapOrder, updateIncreaseOrder, updateDecreaseOrder } from \"../../domain/legacy\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nexport default function OrderEditor(props) {\r\n  const {\r\n    account,\r\n    order,\r\n    setEditingOrder,\r\n    infoTokens,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    library,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    getPositionForOrder,\r\n    positionsMap,\r\n    savedShouldDisableValidationForTesting,\r\n  } = props;\r\n\r\n  const { chainId } = useChainId();\r\n\r\n  const position = order.type !== SWAP ? getPositionForOrder(account, order, positionsMap) : null;\r\n  const liquidationPrice = order.type === DECREASE && position ? getLiquidationPrice(position) : null;\r\n\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const fromTokenInfo = order.type === SWAP ? getTokenInfo(infoTokens, order.path[0], true, nativeTokenAddress) : null;\r\n  const toTokenInfo =\r\n    order.type === SWAP\r\n      ? getTokenInfo(infoTokens, order.path[order.path.length - 1], order.shouldUnwrap, nativeTokenAddress)\r\n      : null;\r\n\r\n  const triggerRatioInverted = useMemo(() => {\r\n    if (order.type !== SWAP) {\r\n      return null;\r\n    }\r\n\r\n    return isTriggerRatioInverted(fromTokenInfo, toTokenInfo);\r\n  }, [toTokenInfo, fromTokenInfo, order.type]);\r\n\r\n  let initialRatio = 0;\r\n  if (order.triggerRatio) {\r\n    initialRatio = triggerRatioInverted ? PRECISION.mul(PRECISION).div(order.triggerRatio) : order.triggerRatio;\r\n  }\r\n  const [triggerRatioValue, setTriggerRatioValue] = useState(formatAmountFree(initialRatio, USD_DECIMALS, 6));\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(formatAmountFree(order.triggerPrice, USD_DECIMALS, 4));\r\n  const triggerPrice = useMemo(() => {\r\n    return triggerPriceValue ? parseValue(triggerPriceValue, USD_DECIMALS) : 0;\r\n  }, [triggerPriceValue]);\r\n\r\n  const triggerRatio = useMemo(() => {\r\n    if (!triggerRatioValue) {\r\n      return bigNumberify(0);\r\n    }\r\n    let ratio = parseValue(triggerRatioValue, USD_DECIMALS);\r\n    if (triggerRatioInverted) {\r\n      ratio = PRECISION.mul(PRECISION).div(ratio);\r\n    }\r\n    return ratio;\r\n  }, [triggerRatioValue, triggerRatioInverted]);\r\n\r\n  const indexTokenMarkPrice = useMemo(() => {\r\n    if (order.type === SWAP) {\r\n      return;\r\n    }\r\n    const toTokenInfo = getTokenInfo(infoTokens, order.indexToken);\r\n    return order.isLong ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n  }, [infoTokens, order]);\r\n\r\n  let toAmount;\r\n  if (order.type === SWAP) {\r\n    const { amount } = getNextToAmount(\r\n      chainId,\r\n      order.amountIn,\r\n      order.path[0],\r\n      order.path[order.path.length - 1],\r\n      infoTokens,\r\n      undefined,\r\n      triggerRatio,\r\n      usdgSupply,\r\n      totalTokenWeights\r\n    );\r\n    toAmount = amount;\r\n  }\r\n\r\n  const onClickPrimary = () => {\r\n    setIsSubmitting(true);\r\n\r\n    let func;\r\n    let params;\r\n\r\n    if (order.type === SWAP) {\r\n      func = updateSwapOrder;\r\n      params = [chainId, library, order.index, toAmount, triggerRatio, order.triggerAboveThreshold];\r\n    } else if (order.type === DECREASE) {\r\n      func = updateDecreaseOrder;\r\n      params = [\r\n        chainId,\r\n        library,\r\n        order.index,\r\n        order.collateralDelta,\r\n        order.sizeDelta,\r\n        triggerPrice,\r\n        order.triggerAboveThreshold,\r\n      ];\r\n    } else if (order.type === INCREASE) {\r\n      func = updateIncreaseOrder;\r\n      params = [chainId, library, order.index, order.sizeDelta, triggerPrice, order.triggerAboveThreshold];\r\n    }\r\n\r\n    params.push({\r\n      successMsg: \"Order updated!\",\r\n      failMsg: \"Order update failed.\",\r\n      sentMsg: \"Order update submitted!\",\r\n      pendingTxns,\r\n      setPendingTxns,\r\n    });\r\n\r\n    return func(...params)\r\n      .then(() => {\r\n        setEditingOrder(null);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const onTriggerRatioChange = (evt) => {\r\n    setTriggerRatioValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const getError = () => {\r\n    if ((!triggerRatio || triggerRatio.eq(0)) && (!triggerPrice || triggerPrice.eq(0))) {\r\n      return \"Enter Price\";\r\n    }\r\n    if (order.type === SWAP && triggerRatio.eq(order.triggerRatio)) {\r\n      return \"Enter new Price\";\r\n    }\r\n    if (order.type !== SWAP && triggerPrice.eq(order.triggerPrice)) {\r\n      return \"Enter new Price\";\r\n    }\r\n    if (position) {\r\n      if (order.type === DECREASE) {\r\n        if (position.isLong && triggerPrice.lte(liquidationPrice)) {\r\n          return \"Price below Liq. Price\";\r\n        }\r\n        if (!position.isLong && triggerPrice.gte(liquidationPrice)) {\r\n          return \"Price above Liq. Price\";\r\n        }\r\n      }\r\n\r\n      const { delta, hasProfit } = calculatePositionDelta(triggerPrice, position);\r\n      if (hasProfit && delta.eq(0)) {\r\n        return \"Invalid price, see warning\";\r\n      }\r\n    }\r\n\r\n    if (order.type !== SWAP && indexTokenMarkPrice && !savedShouldDisableValidationForTesting) {\r\n      if (order.triggerAboveThreshold && indexTokenMarkPrice.gt(triggerPrice)) {\r\n        return \"Price below Mark Price\";\r\n      }\r\n      if (!order.triggerAboveThreshold && indexTokenMarkPrice.lt(triggerPrice)) {\r\n        return \"Price above Mark Price\";\r\n      }\r\n    }\r\n\r\n    if (order.type === SWAP) {\r\n      const currentRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n      if (currentRate && !currentRate.gte(triggerRatio)) {\r\n        return `Price is ${triggerRatioInverted ? \"below\" : \"above\"} Mark Price`;\r\n      }\r\n    }\r\n  };\r\n\r\n  const renderMinProfitWarning = () => {\r\n    if (MIN_PROFIT_TIME === 0 || order.type === SWAP || !position || !triggerPrice || triggerPrice.eq(0)) {\r\n      return null;\r\n    }\r\n\r\n    const { delta, pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(triggerPrice, position);\r\n    if (hasProfit && delta.eq(0)) {\r\n      const { deltaStr } = getDeltaStr({\r\n        delta: pendingDelta,\r\n        deltaPercentage: pendingDeltaPercentage,\r\n        hasProfit,\r\n      });\r\n      const profitPrice = getProfitPrice(triggerPrice, position);\r\n      const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          This order will forfeit a&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            profit\r\n          </a>{\" \"}\r\n          of {deltaStr}. <br />\r\n          Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n          only applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}\r\n          .\r\n        </div>\r\n      );\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n\r\n    if (isSubmitting) {\r\n      return \"Updating Order...\";\r\n    }\r\n    return \"Update Order\";\r\n  };\r\n\r\n  if (order.type !== SWAP) {\r\n    const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n    return (\r\n      <Modal\r\n        isVisible={true}\r\n        className=\"Exchange-list-modal\"\r\n        setIsVisible={() => setEditingOrder(null)}\r\n        label=\"Edit order\"\r\n\r\n        isNifty={true}\r\n      >\r\n        {renderMinProfitWarning()}\r\n        <div className=\"Exchange-swap-section\">\r\n          <div className=\"Exchange-swap-section-top\">\r\n            <div className=\"muted\">Price</div>\r\n            <div\r\n              className=\"muted align-right clickable\"\r\n              onClick={() => {\r\n                setTriggerPriceValue(formatAmountFree(indexTokenMarkPrice, USD_DECIMALS, 2));\r\n              }}\r\n            >\r\n              Mark: {formatAmount(indexTokenMarkPrice, USD_DECIMALS, 2)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-section-bottom\">\r\n            <div className=\"Exchange-swap-input-container\">\r\n              <input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                placeholder=\"0.0\"\r\n                className=\"Exchange-swap-input\"\r\n                value={triggerPriceValue}\r\n                onChange={onTriggerPriceChange}\r\n                onFocus={(e) => {\r\n                  e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                }}\r\n                onBlur={(e) => {\r\n                  e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                }}\r\n              />\r\n            </div>\r\n            <div className=\"PositionEditor-token-symbol\">USD</div>\r\n          </div>\r\n        </div>\r\n        <ExchangeInfoRow label=\"Price\">\r\n          {triggerPrice && !triggerPrice.eq(order.triggerPrice) ? (\r\n            <>\r\n              <span className=\"muted\">\r\n                {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n              </span>\r\n              &nbsp;\r\n              <BsArrowRight />\r\n              &nbsp;\r\n              {triggerPricePrefix} {formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n            </>\r\n          ) : (\r\n            <span>\r\n              {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n            </span>\r\n          )}\r\n        </ExchangeInfoRow>\r\n        {liquidationPrice && (\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">Liq. Price</div>\r\n            <div className=\"align-right\">{`$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}</div>\r\n          </div>\r\n        )}\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button\r\n            className={\"App-cta Exchange-swap-button Exchange-list-modal-button\" + (isPrimaryEnabled() ? \" hlight\" : \"\")}\r\n            onClick={onClickPrimary}\r\n            disabled={!isPrimaryEnabled()}\r\n          >\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      isVisible={true}\r\n      className=\"Exchange-list-modal\"\r\n      setIsVisible={() => setEditingOrder(null)}\r\n      label=\"Edit order\"\r\n      isNifty={true}\r\n    >\r\n      <div className=\"Exchange-swap-section\">\r\n        <div className=\"Exchange-swap-section-top\">\r\n          <div className=\"muted\">Price</div>\r\n          {fromTokenInfo && toTokenInfo && (\r\n            <div\r\n              className=\"muted align-right clickable\"\r\n              onClick={() => {\r\n                setTriggerRatioValue(\r\n                  formatAmountFree(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 10)\r\n                );\r\n              }}\r\n            >\r\n              Mark Price:{\" \"}\r\n              {formatAmount(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 2)}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"Exchange-swap-section-bottom\">\r\n          <div className=\"Exchange-swap-input-container\">\r\n            <input\r\n              type=\"number\"\r\n              min=\"0\"\r\n              placeholder=\"0.0\"\r\n              className=\"Exchange-swap-input\"\r\n              value={triggerRatioValue}\r\n              onChange={onTriggerRatioChange}\r\n              onFocus={(e) => {\r\n                e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n              }}\r\n              onBlur={(e) => {\r\n                e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n              }}\r\n            />\r\n          </div>\r\n          {(() => {\r\n            if (!toTokenInfo) return;\r\n            if (!fromTokenInfo) return;\r\n            const [tokenA, tokenB] = triggerRatioInverted ? [toTokenInfo, fromTokenInfo] : [fromTokenInfo, toTokenInfo];\r\n            return (\r\n              <div className=\"PositionEditor-token-symbol\">\r\n                {tokenA.symbol}&nbsp;/&nbsp;{tokenB.symbol}\r\n              </div>\r\n            );\r\n          })()}\r\n        </div>\r\n      </div>\r\n      <ExchangeInfoRow label=\"Minimum received\">\r\n        {triggerRatio && !triggerRatio.eq(order.triggerRatio) ? (\r\n          <>\r\n            <span className=\"muted\">{formatAmount(order.minOut, toTokenInfo.decimals, 4, true)}</span>\r\n            &nbsp;\r\n            <BsArrowRight />\r\n            &nbsp;\r\n            {formatAmount(toAmount, toTokenInfo.decimals, 4, true)}\r\n          </>\r\n        ) : (\r\n          formatAmount(order.minOut, toTokenInfo.decimals, 4, true)\r\n        )}\r\n        &nbsp;{toTokenInfo.symbol}\r\n      </ExchangeInfoRow>\r\n      <ExchangeInfoRow label=\"Price\">\r\n        {triggerRatio && !triggerRatio.eq(0) && !triggerRatio.eq(order.triggerRatio) ? (\r\n          <>\r\n            <span className=\"muted\">\r\n              {getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo, {\r\n                omitSymbols: !triggerRatio || !triggerRatio.eq(order.triggerRatio),\r\n              })}\r\n            </span>\r\n            &nbsp;\r\n            <BsArrowRight />\r\n            &nbsp;\r\n            {getExchangeRateDisplay(triggerRatio, fromTokenInfo, toTokenInfo)}\r\n          </>\r\n        ) : (\r\n          getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo, {\r\n            omitSymbols: !triggerRatio || !triggerRatio.eq(order.triggerRatio),\r\n          })\r\n        )}\r\n      </ExchangeInfoRow>\r\n      {fromTokenInfo && (\r\n        <div className=\"Exchange-info-row\">\r\n          <div className=\"Exchange-info-label\">{fromTokenInfo.symbol} price</div>\r\n          <div className=\"align-right\">{formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true)} USD</div>\r\n        </div>\r\n      )}\r\n      {toTokenInfo && (\r\n        <div className=\"Exchange-info-row\">\r\n          <div className=\"Exchange-info-label\">{toTokenInfo.symbol} price</div>\r\n          <div className=\"align-right\">{formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true)} USD</div>\r\n        </div>\r\n      )}\r\n      <div className=\"Exchange-swap-button-container\">\r\n        <button\r\n          className=\"App-cta Exchange-swap-button Exchange-list-modal-button\"\r\n          onClick={onClickPrimary}\r\n          disabled={!isPrimaryEnabled()}\r\n        >\r\n          {getPrimaryText()}\r\n        </button>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { formatForContract } from '../../../../components/utils/math';\r\nimport { convertInputNum } from '../../../../components/utils/sepThousands';\r\nimport { formatAmount, formatAmountFree, USD_DECIMALS } from '../../lib/legacy';\r\nimport Modal from './../../../../components/UI/modal/Modal';\r\nimport GNS_Trading from '../../abis/GNS/GNS_Trading.json';\r\nimport { ethers } from 'ethers';\r\nimport { errAlert, notifySuccess } from '../../../../components/utils/notifications';\r\n\r\nconst OrderEditorGNS = (props) => {\r\n\tconst {\r\n\t\tvisible,\r\n\t\tsetVisible,\r\n\t\torder,\r\n\t\tlibrary\r\n\t} = props;\r\n\t\r\n\tconst [priceValue, setPriceValue] = useState('');\r\n\tconst [TPValue, setTPValue] = useState('');\r\n\tconst [SLValue, setSLValue] = useState('');\r\n\r\n\tconst [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (order) {\r\n\t\t\tsetPriceValue(convertInputNum(formatAmountFree(order.triggerPrice, 30, 2)));\r\n\t\t\tif (!order.tp.eq(0)) {\r\n\t\t\t\tsetTPValue(convertInputNum(formatAmountFree(order.tp, 10, 2)));\r\n\t\t\t}\r\n\t\t\tif (!order.sl.eq(0)) {\r\n\t\t\t\tsetSLValue(convertInputNum(formatAmountFree(order.sl, 10, 2)));\r\n\t\t\t}\r\n\t\t}\r\n\t}, [order]);\r\n\r\n\tconst btnText = 'Update order';\r\n\t\r\n\tconst getError = () => {\r\n\t\tif (!order) {\r\n\t\t\treturn btnText;\r\n\t\t}\r\n\r\n\t\tif (isSubmitting) {\r\n\t\t\treturn `Updating...`;\r\n\t\t}\r\n\r\n\t\tif (!priceValue && !TPValue && !SLValue) {\r\n\t\t\treturn btnText;\r\n\t\t}\r\n\r\n\t\tconst isLong = order.isLong;\r\n\t\tconst triggerPrice = priceValue \r\n\t\t\t? formatForContract(priceValue, 10)\r\n\t\t\t: Number(formatAmount(order.triggerPrice, 20, 0, 0));\r\n\r\n\t\tconst SLVal = formatForContract(SLValue, 10);\r\n\t\tconst TPVal = formatForContract(TPValue, 10);\r\n\r\n\t\tif (SLVal) {\r\n\t\t\tif ((isLong && SLVal > triggerPrice) || (!isLong && SLVal < triggerPrice)) {\r\n\t\t\t\treturn `${isLong ? 'Long' : 'Short'} SL can't be ${isLong ? 'greater' : 'less'} than trigger price.`;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (TPVal) {\r\n\t\t\tif ((isLong && TPVal < triggerPrice) || (!isLong && TPVal > triggerPrice)) {\r\n\t\t\t\treturn `${isLong ? 'Long' : 'Short'} TP can't be ${isLong ? 'less' : 'greater'} than trigger price.`;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst getBtnText = () => {\r\n\t\tconst error = getError();\r\n\t\tif (error) {\r\n\t\t\treturn error;\r\n\t\t}\r\n\r\n\t\treturn btnText;\r\n\t}\r\n\tconst isBtnEnabled = () => {\r\n\t\tconst hasError = Boolean(getError());\r\n\t\t\r\n\t\tif (hasError) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tconst onApply = () => {\r\n\t\tsetIsSubmitting(true);\r\n\t\t\r\n\t\tconst price = priceValue ? formatForContract(priceValue, 10) : '0';\r\n\t\tconst TP = TPValue ? formatForContract(TPValue, 10) : '0';\r\n\t\tconst SL = SLValue ? formatForContract(SLValue, 10) : '0';\r\n\t\t\r\n\t\tconst contract = new ethers.Contract(GNS_Trading.address, GNS_Trading.abi, library.getSigner());\r\n\r\n\t\tcontract.updateOpenLimitOrder(\r\n\t\t\torder.pairIndex,\r\n\t\t\torder.index,\r\n\t\t\tprice,\r\n\t\t\tTP,\r\n\t\t\tSL\r\n\t\t).then(tsc => {\r\n\t\t\tconsole.log(tsc);\r\n      \r\n\t\t\ttsc.wait()\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tnotifySuccess(`Order update submitted!`, tsc.hash);\r\n\t\t\t\t\tsetVisible(false);\r\n\t\t\t\t})\r\n\t\t}, errAlert).finally(() => setIsSubmitting(false));\r\n\t}\r\n\r\n\tconst reset = () => {\r\n\t\tsetPriceValue('');\r\n\t\tsetTPValue('');\r\n\t\tsetSLValue('');\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\tclassName=\"OrderEditorModal\"\r\n\t\t\tvisible={visible}\r\n\t\t\tsetVisible={setVisible}\r\n\t\t\tresetModal={reset}\r\n\t\t>\r\n\t\t\t<h1 className=\"modal__title\">Edit Order</h1>\r\n\t\t\t<div className=\"modal__body\">\r\n\t\t\t\t<div className=\"Exchange-swap-section\">\r\n\t\t\t\t\t<div className=\"Exchange-swap-section-top\">\r\n\t\t\t\t\t\t<div className=\"muted\">\r\n\t\t\t\t\t\t\t<div className=\"Exchange-swap-usd\">\r\n\t\t\t\t\t\t\t\tPrice\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName=\"muted align-right clickable\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tsetPriceValue(formatAmountFree(order?.markPrice, USD_DECIMALS, 2));\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tMark: {formatAmount(order?.markPrice, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"Exchange-swap-section-bottom\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tplaceholder=\"0.0\"\r\n\t\t\t\t\t\t\t\tclassName=\"Exchange-swap-input\"\r\n\t\t\t\t\t\t\t\tvalue={priceValue}\r\n\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\tsetPriceValue(convertInputNum(e.target.value));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonFocus={(e) => {\r\n\t\t\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonBlur={(e) => {\r\n\t\t\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"Exchange-swap-section\">\r\n\t\t\t\t\t<div className=\"Exchange-swap-section-top\">\r\n\t\t\t\t\t\t<div className=\"muted\">\r\n\t\t\t\t\t\t\t<div className=\"Exchange-swap-usd\">\r\n\t\t\t\t\t\t\t\tTake Profit\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"Exchange-swap-section-bottom\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tplaceholder=\"0.0\"\r\n\t\t\t\t\t\t\t\tclassName=\"Exchange-swap-input\"\r\n\t\t\t\t\t\t\t\tvalue={TPValue}\r\n\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\tsetTPValue(convertInputNum(e.target.value));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonFocus={(e) => {\r\n\t\t\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonBlur={(e) => {\r\n\t\t\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"Exchange-swap-section\">\r\n\t\t\t\t\t<div className=\"Exchange-swap-section-top\">\r\n\t\t\t\t\t\t<div className=\"muted\">\r\n\t\t\t\t\t\t\t<div className=\"Exchange-swap-usd\">\r\n\t\t\t\t\t\t\t\tStop Loss\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"Exchange-swap-section-bottom\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tplaceholder=\"0.0\"\r\n\t\t\t\t\t\t\t\tclassName=\"Exchange-swap-input\"\r\n\t\t\t\t\t\t\t\tvalue={SLValue}\r\n\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\tsetSLValue(convertInputNum(e.target.value));\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonFocus={(e) => {\r\n\t\t\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonBlur={(e) => {\r\n\t\t\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button \r\n\t\t\t\t\tclassName=\"modal__btn btn btn_hlight\"\r\n\t\t\t\t\tonClick={onApply}\r\n\t\t\t\t\tdisabled={!isBtnEnabled()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{getBtnText()}\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default OrderEditorGNS;","import React, { useState, useCallback } from \"react\";\r\nimport { Trans } from \"@lingui/macro\";\r\n\r\nimport {\r\n  SWAP,\r\n  INCREASE,\r\n  DECREASE,\r\n  USD_DECIMALS,\r\n  formatAmount,\r\n  getOrderError,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n  getExchangeRateDisplay,\r\n  getTokenInfo,\r\n  getExchangeRate,\r\n  getPositionForOrder,\r\n  getUsd,\r\n  USDG_DECIMALS,\r\n} from \"../../lib/legacy.js\";\r\nimport { handleCancelOrder } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport OrderEditor from \"./OrderEditor\";\r\n\r\nimport \"./OrdersList.css\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { GNS_PAIRS } from './../../lib/GNS_legacy';\r\nimport { getTokenBySymbol } from \"../../config/Tokens.js\";\r\nimport { expandDecimals } from './../../lib/legacy';\r\nimport GNS_Trading from '../../abis/GNS/GNS_Trading.json';\r\nimport { ethers } from 'ethers';\r\nimport { errAlert, notifySuccess } from './../../../../components/utils/notifications';\r\nimport OrderEditorGNS from './OrderEditorGNS';\r\n\r\nexport default function OrdersList(props) {\r\n  const {\r\n    account,\r\n    library,\r\n    setPendingTxns,\r\n    pendingTxns,\r\n    infoTokens,\r\n    positionsMap,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    orders,\r\n    ordersGNS,\r\n    hideActions,\r\n    chainId,\r\n    savedShouldDisableValidationForTesting,\r\n    cancelOrderIdList,\r\n    setCancelOrderIdList,\r\n  } = props;\r\n\r\n  const hasOrders = Boolean(orders.length || ordersGNS.length);\r\n  const marketIconGNS = require('../../../../img/icon-GNS.svg').default;\r\n  const marketIconGMX = require('../../../../img/icon-GMX.svg').default;  \r\n\r\n  const [editingOrder, setEditingOrder] = useState(null);\r\n  const [editingOrderGNS, setEditingOrderGNS] = useState(null);\r\n  const [orderEditorGNSVisible, setOrderEditorGNSVisible] = useState();\r\n\r\n  const onCancelClick = useCallback(\r\n    (order, market = 'GMX') => {\r\n      if (market === 'GMX') {\r\n        handleCancelOrder(chainId, library, order, { pendingTxns, setPendingTxns });\r\n      }\r\n      if (market === 'GNS') {\r\n        const contract = new ethers.Contract(GNS_Trading.address, GNS_Trading.abi, library.getSigner());\r\n\r\n        contract.cancelOpenLimitOrder(order.pairIndex, order.index)\r\n          .then(tsc => {\r\n            console.log(tsc);\r\n      \r\n            tsc.wait()\r\n              .then(() => {\r\n                notifySuccess(`Limit order cancelled!`, tsc.hash);\r\n              })\r\n          }, errAlert)\r\n      }\r\n    },\r\n    [library, pendingTxns, setPendingTxns, chainId]\r\n  );\r\n\r\n  const onEditClick = useCallback(\r\n    (order, market = 'GMX') => {\r\n      if (market === 'GMX') {\r\n        setEditingOrder(order);\r\n      }\r\n      if (market === 'GNS') {\r\n        setEditingOrderGNS(order);\r\n        setOrderEditorGNSVisible(true);\r\n      }\r\n    },\r\n    [setEditingOrder]\r\n  );\r\n\r\n  const renderHead = useCallback(() => {\r\n    if (!hasOrders) {\r\n      return;\r\n    }\r\n    \r\n    const isAllOrdersSelected = cancelOrderIdList?.length > 0 && cancelOrderIdList?.length === orders.length;\r\n    return (\r\n      <tr className=\"Exchange-list-header\">\r\n        <th>\r\n          <div>\r\n            <Trans>Type</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Order</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Price</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Mark Price</Trans>\r\n          </div>\r\n        </th>\r\n      </tr>\r\n    );\r\n  }, [cancelOrderIdList, orders, ordersGNS, setCancelOrderIdList]);\r\n\r\n  const renderEmptyRow = useCallback(() => {\r\n    if (hasOrders) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <tr>\r\n        <td colSpan=\"5\" className=\"Exchange-list-empty-note\">\r\n          <Trans>No open orders</Trans>\r\n        </td>\r\n      </tr>\r\n    );\r\n  }, [orders, ordersGNS]);\r\n\r\n  const renderActions = useCallback(\r\n    (order, market) => {\r\n      return (\r\n        <>\r\n          <td>\r\n            <button className=\"Exchange-list-action\" onClick={() => onEditClick(order, market)}>\r\n              <Trans>Edit</Trans>\r\n            </button>\r\n          </td>\r\n          <td>\r\n            <button className=\"Exchange-list-action\" onClick={() => onCancelClick(order, market)}>\r\n              <Trans>Cancel</Trans>\r\n            </button>\r\n          </td>\r\n        </>\r\n      );\r\n    },\r\n    [onEditClick, onCancelClick]\r\n  );\r\n\r\n  const renderLargeList = useCallback(() => {\r\n    if (!orders || !orders.length) {\r\n      return null;\r\n    }\r\n    return orders.map((order) => {\r\n      const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n\r\n      // Longs Increase: max price\r\n      // Longs Decrease: min price\r\n      // Short Increase: min price\r\n      // Short Decrease: max price\r\n      const maximisePrice = (order.type === INCREASE && order.isLong) || (order.type === DECREASE && !order.isLong);\r\n\r\n      const markPrice = maximisePrice ? indexToken.contractMaxPrice : indexToken.contractMinPrice;\r\n      const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n      const indexTokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n\r\n      const error = getOrderError(account, order, positionsMap);\r\n      const orderId = `${order.type}-${order.index}`;\r\n      const orderText = (\r\n        <>\r\n          {order.type === INCREASE ? \"Increase\" : \"Decrease\"} {indexTokenSymbol} {order.isLong ? \"Long\" : \"Short\"}\r\n          &nbsp;by ${formatAmount(order.sizeDelta, USD_DECIMALS, 2, true)}\r\n          {error && <div className=\"Exchange-list-item-error\">{error}</div>}\r\n        </>\r\n      );\r\n\r\n      return (\r\n        <tr className=\"Exchange-list-item\" key={`${order.isLong}-${order.type}-${order.index}`}>\r\n          <td className=\"Exchange-list-item-type\">\r\n            <div className=\"icon-container\">\r\n              <img src={marketIconGMX} alt=\"GMX Icon\" style={{width: 15}} />\r\n              {order.type === INCREASE ? \"Limit\" : \"Trigger\"}\r\n            </div>\r\n          </td>\r\n          <td>\r\n            {order.type === DECREASE ? (\r\n              orderText\r\n            ) : (\r\n              <Tooltip\r\n                handle={orderText}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  const collateralTokenInfo = getTokenInfo(infoTokens, order.purchaseToken);\r\n                  const collateralUSD = getUsd(order.purchaseTokenAmount, order.purchaseToken, false, infoTokens);\r\n                  return (\r\n                    <StatsTooltipRow\r\n                      label=\"Collateral\"\r\n                      value={`${formatAmount(collateralUSD, USD_DECIMALS, 2, true)} (${formatAmount(\r\n                        order.purchaseTokenAmount,\r\n                        collateralTokenInfo.decimals,\r\n                        4,\r\n                        true\r\n                      )}\r\n                      ${collateralTokenInfo.baseSymbol || collateralTokenInfo.symbol})`}\r\n                    />\r\n                  );\r\n                }}\r\n              />\r\n            )}\r\n          </td>\r\n          <td className=\"nowrap\">\r\n            {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n          </td>\r\n          <td>\r\n            <Tooltip\r\n              handle={formatAmount(markPrice, USD_DECIMALS, 2, true)}\r\n              position=\"right-bottom\"\r\n              renderContent={() => {\r\n                return (\r\n                  <Trans>\r\n                    The price that orders can be executed at may differ slightly from the chart price, as market orders\r\n                    update oracle prices, while limit/trigger orders do not.\r\n                  </Trans>\r\n                );\r\n              }}\r\n            />\r\n          </td>\r\n          {!hideActions && renderActions(order)}\r\n        </tr>\r\n      );\r\n    });\r\n  }, [\r\n    orders,\r\n    renderActions,\r\n    infoTokens,\r\n    positionsMap,\r\n    hideActions,\r\n    chainId,\r\n    account,\r\n    cancelOrderIdList,\r\n    setCancelOrderIdList,\r\n  ]);\r\n\r\n  const renderLargeListGNS = useCallback(() => {\r\n    if (!ordersGNS || !ordersGNS.length) {\r\n      return null;\r\n    }\r\n    return ordersGNS.map((ord) => {\r\n      const order = Object.assign({}, ord);\r\n      \r\n      order.type = INCREASE;\r\n      order.isLong = order.buy;\r\n      const indexTokenSymbol = Object.keys(GNS_PAIRS).find(symb => GNS_PAIRS[symb] === order.pairIndex.toNumber());\r\n      const indexToken = getTokenBySymbol(chainId, indexTokenSymbol);\r\n\r\n      const triggerPricePrefix = order.isLong ? TRIGGER_PREFIX_BELOW : TRIGGER_PREFIX_ABOVE;\r\n\r\n      const markPrice = infoTokens[indexToken.address].maxPrice;\r\n      order.markPrice = markPrice;\r\n      order.triggerPrice = expandDecimals(order.maxPrice ?? order.minPrice, 20);\r\n      \r\n      order.positionSize = order.positionSize.mul(order.leverage)\r\n      \r\n      const orderText = (\r\n        <>\r\n          {order.type === INCREASE ? \"Increase\" : \"Decrease\"} {indexTokenSymbol} {order.isLong ? \"Long\" : \"Short\"}\r\n          &nbsp;by ${formatAmount(order.positionSize, USDG_DECIMALS, 2, true)}\r\n          <div>{!order.tp?.eq(0) && `Take Profit: $${formatAmount(order.tp, 10, 2, 1)}`}</div>\r\n          <div>{!order.sl?.eq(0) && `Stop Loss: $${formatAmount(order.sl, 10, 2, 1)}`}</div>\r\n        </>\r\n      );\r\n\r\n      return (\r\n        <tr className=\"Exchange-list-item\" key={`${order.buy}-${order.type}-${order.index}`}>\r\n          <td className=\"Exchange-list-item-type\">\r\n            <div className=\"icon-container\">\r\n              <img src={marketIconGNS} alt=\"GNS Icon\" style={{width: 15}} />\r\n              {order.type === INCREASE ? \"Limit\" : \"Trigger\"}\r\n            </div>\r\n          </td>\r\n          <td>\r\n            {orderText}\r\n          </td>\r\n          <td className=\"nowrap\">\r\n            {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n          </td>\r\n          <td>\r\n            {formatAmount(markPrice, USD_DECIMALS, 2, true)}\r\n          </td>\r\n          {!hideActions && renderActions(order, 'GNS')}\r\n        </tr>\r\n      );\r\n    });\r\n  }, [\r\n    orders,\r\n    renderActions,\r\n    infoTokens,\r\n    positionsMap,\r\n    hideActions,\r\n    chainId,\r\n    account,\r\n    cancelOrderIdList,\r\n    setCancelOrderIdList,\r\n  ]);\r\n\r\n  const renderSmallListGNS = useCallback(() => {\r\n    if (!ordersGNS || !ordersGNS.length) {\r\n      return null;\r\n    }\r\n    return ordersGNS.map((ord) => {\r\n      const order = Object.assign({}, ord);\r\n      \r\n      order.type = INCREASE;\r\n      order.isLong = order.buy;\r\n      const indexTokenSymbol = Object.keys(GNS_PAIRS).find(symb => GNS_PAIRS[symb] === order.pairIndex.toNumber());\r\n      const indexToken = getTokenBySymbol(chainId, indexTokenSymbol);\r\n\r\n      const triggerPricePrefix = order.isLong ? TRIGGER_PREFIX_BELOW : TRIGGER_PREFIX_ABOVE;\r\n\r\n      const markPrice = infoTokens[indexToken.address].maxPrice;\r\n      order.triggerPrice = expandDecimals(order.maxPrice ?? order.minPrice, 20);\r\n      \r\n      const orderText = (\r\n        <>\r\n          {order.type === INCREASE ? \"Increase\" : \"Decrease\"} {indexTokenSymbol} {order.isLong ? \"Long\" : \"Short\"}\r\n          &nbsp;by ${formatAmount(order.positionSize, USDG_DECIMALS, 2, true)}\r\n          <div style={{color: '#384263'}}>{!order.tp?.eq(0) && `Take Profit: $${formatAmount(order.tp, 10, 2, 1)}`}</div>\r\n          <div style={{color: '#384263'}}>{!order.sl?.eq(0) && `Stop Loss: $${formatAmount(order.sl, 10, 2, 1)}`}</div>\r\n        </>\r\n      );\r\n\r\n      return (\r\n        <div key={`${order.isLong}-${order.type}-${order.index}`} className=\"App-card\">\r\n          <div className=\"App-card-title-small\">\r\n            {orderText}\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"App-card-content\">\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Type</Trans>\r\n              </div>\r\n              <div className=\"icon-container\">\r\n                <img src={marketIconGNS} alt=\"GNS Icon\" style={{width: 15}} />\r\n                {order.type === INCREASE && 'Limit'}\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              <div>\r\n                {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Mark Price</Trans>\r\n              </div>\r\n              <div>\r\n                {formatAmount(markPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            {!hideActions && (\r\n              <>\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-options\">\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => onEditClick(order, 'GNS')} disabled={true}>\r\n                    <Trans>Edit</Trans>\r\n                  </button>\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => onCancelClick(order, 'GNS')}>\r\n                    <Trans>Cancel</Trans>\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  }, [orders, ordersGNS, onEditClick, onCancelClick, infoTokens, positionsMap, hideActions, chainId, account]);\r\n\r\n  const renderSmallList = useCallback(() => {\r\n    if (!orders || !orders.length) {\r\n      return null;\r\n    }\r\n\r\n    return orders.map((order) => {\r\n      const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n      const maximisePrice = (order.type === INCREASE && order.isLong) || (order.type === DECREASE && !order.isLong);\r\n      const markPrice = maximisePrice ? indexToken.contractMaxPrice : indexToken.contractMinPrice;\r\n      const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n      const indexTokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n\r\n      const collateralTokenInfo = getTokenInfo(infoTokens, order.purchaseToken);\r\n      const collateralUSD = getUsd(order.purchaseTokenAmount, order.purchaseToken, true, infoTokens);\r\n\r\n      const error = getOrderError(account, order, positionsMap);\r\n\r\n      return (\r\n        <div key={`${order.isLong}-${order.type}-${order.index}`} className=\"App-card\">\r\n          <div className=\"App-card-title-small\">\r\n            {order.type === INCREASE ? \"Increase\" : \"Decrease\"} {indexTokenSymbol} {order.isLong ? \"Long\" : \"Short\"}\r\n            &nbsp;by ${formatAmount(order.sizeDelta, USD_DECIMALS, 2, true)}\r\n            {error && <div className=\"Exchange-list-item-error\">{error}</div>}\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"App-card-content\">\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Type</Trans>\r\n              </div>\r\n              <div className=\"icon-container\">\r\n                <img src={marketIconGMX} alt=\"GMX Icon\" style={{width: 15}} />\r\n                {order.type === INCREASE ? \"Limit\" : \"Trigger\"}\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              <div>\r\n                {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Mark Price</Trans>\r\n              </div>\r\n              <div>\r\n                <Tooltip\r\n                  handle={formatAmount(markPrice, USD_DECIMALS, 2, true)}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <Trans>\r\n                        The price that the order can be executed at may differ slightly from the chart price as market\r\n                        orders can change the price while limit / trigger orders cannot.\r\n                      </Trans>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            {order.type === INCREASE && (\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Collateral</Trans>\r\n                </div>\r\n                <div>\r\n                  ${formatAmount(collateralUSD, USD_DECIMALS, 2, true)} (\r\n                  {formatAmount(order.purchaseTokenAmount, collateralTokenInfo.decimals, 4, true)}{\" \"}\r\n                  {collateralTokenInfo.baseSymbol || collateralTokenInfo.symbol})\r\n                </div>\r\n              </div>\r\n            )}\r\n            {!hideActions && (\r\n              <>\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-options\">\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => onEditClick(order)}>\r\n                    <Trans>Edit</Trans>\r\n                  </button>\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => onCancelClick(order)}>\r\n                    <Trans>Cancel</Trans>\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  }, [orders, onEditClick, onCancelClick, infoTokens, positionsMap, hideActions, chainId, account]);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <table className=\"Exchange-list Orders App-box large\">\r\n        <tbody>\r\n          {renderHead()}\r\n          {renderEmptyRow()}\r\n          {renderLargeList()}\r\n          {renderLargeListGNS()}\r\n        </tbody>\r\n      </table>\r\n      <div className=\"Exchange-list Orders small\">\r\n        {(!hasOrders) && (\r\n          <div className=\"Exchange-empty-positions-list-note App-card\">No open orders</div>\r\n        )}\r\n        {renderSmallList()}\r\n        {renderSmallListGNS()}\r\n      </div>\r\n      {editingOrder && (\r\n        <OrderEditor\r\n          account={account}\r\n          order={editingOrder}\r\n          setEditingOrder={setEditingOrder}\r\n          infoTokens={infoTokens}\r\n          pendingTxns={pendingTxns}\r\n          setPendingTxns={setPendingTxns}\r\n          getPositionForOrder={getPositionForOrder}\r\n          positionsMap={positionsMap}\r\n          library={library}\r\n          totalTokenWeights={totalTokenWeights}\r\n          usdgSupply={usdgSupply}\r\n          savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n        />\r\n      )}\r\n      <OrderEditorGNS\r\n        visible={orderEditorGNSVisible}\r\n        setVisible={setOrderEditorGNSVisible}\r\n        order={editingOrderGNS}\r\n        library={library}\r\n      />\r\n    </React.Fragment>\r\n  );\r\n}\r\n","import React, { useState, useEffect, useCallback, useMemo } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Tooltip from \"../../components/Tooltip/Tooltip\";\r\nimport cx from 'classnames';\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  MAX_LEVERAGE,\r\n  BASIS_POINTS_DIVISOR,\r\n  LIQUIDATION_FEE,\r\n  TRADES_PAGE_SIZE,\r\n  formatAmount,\r\n  getExplorerUrl,\r\n  formatDateTime,\r\n  deserialize,\r\n  getExchangeRateDisplay,\r\n  bigNumberify,\r\n} from \"../../lib/legacy\";\r\nimport { useTrades, useLiquidationsData } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport \"./TradeHistory.scss\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getPositionDisplay(increase, indexToken, isLong, sizeDelta) {\r\n  const symbol = indexToken ? (indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol) : \"\";\r\n  return `\r\n    ${increase ? \"Increase\" : \"Decrease\"} ${symbol} ${isLong ? \"Long\" : \"Short\"}\r\n    ${increase ? \"+\" : \"-\"}${formatAmount(sizeDelta, USD_DECIMALS, 2, true)} USD`;\r\n}\r\n\r\nfunction getOrderActionTitle(action) {\r\n  let actionDisplay;\r\n\r\n  if (action.startsWith(\"Create\")) {\r\n    actionDisplay = \"Create\";\r\n  } else if (action.startsWith(\"Cancel\")) {\r\n    actionDisplay = \"Cancel\";\r\n  } else {\r\n    actionDisplay = \"Update\";\r\n  }\r\n\r\n  return `${actionDisplay} Order`;\r\n}\r\n\r\nfunction renderLiquidationTooltip(liquidationData, label) {\r\n  const minCollateral = liquidationData.size.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE);\r\n  const text =\r\n    liquidationData.type === \"full\"\r\n      ? \"This position was liquidated as the max leverage of 100x was exceeded\"\r\n      : \"Max leverage of 100x was exceeded, the remaining collateral after deducting losses and fees have been sent back to your account\";\r\n  return (\r\n    <Tooltip\r\n      position=\"left-top\"\r\n      handle={label}\r\n      renderContent={() => (\r\n        <>\r\n          {text}\r\n          <br />\r\n          <br />\r\n          Initial collateral: ${formatAmount(liquidationData.collateral, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          Min required collateral: ${formatAmount(minCollateral, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          Borrow fee: ${formatAmount(liquidationData.borrowFee, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          PnL: -${formatAmount(liquidationData.loss, USD_DECIMALS, 2, true)}\r\n          {liquidationData.type === \"full\" && <div>Liquidation fee: ${formatAmount(LIQUIDATION_FEE, 30, 2, true)}</div>}\r\n        </>\r\n      )}\r\n    />\r\n  );\r\n}\r\n\r\nfunction getLiquidationData(liquidationsDataMap, key, timestamp) {\r\n  return liquidationsDataMap && liquidationsDataMap[`${key}:${timestamp}`];\r\n}\r\n\r\nexport default function TradeHistory(props) {\r\n  const { account, infoTokens, getTokenInfo, chainId, nativeTokenAddress, shouldShowPaginationButtons } = props;\r\n  const [pageIds, setPageIds] = useState({});\r\n  const [pageIndex, setPageIndex] = useState(0);\r\n\r\n  const getAfterId = () => {\r\n    return pageIds[pageIndex];\r\n  };\r\n\r\n  const { trades, updateTrades } = useTrades(chainId, account, props.forSingleAccount, getAfterId());\r\n\r\n  const liquidationsData = useLiquidationsData(chainId, account);\r\n  const liquidationsDataMap = useMemo(() => {\r\n    if (!liquidationsData) {\r\n      return null;\r\n    }\r\n    return liquidationsData.reduce((memo, item) => {\r\n      const liquidationKey = `${item.key}:${item.timestamp}`;\r\n      memo[liquidationKey] = item;\r\n      return memo;\r\n    }, {});\r\n  }, [liquidationsData]);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      updateTrades(undefined, true);\r\n    }, 10 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [updateTrades]);\r\n\r\n  const loadNextPage = () => {\r\n    if (!trades || trades.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const lastTrade = trades[trades.length - 1];\r\n    pageIds[pageIndex + 1] = lastTrade.id;\r\n    setPageIds(pageIds);\r\n    setPageIndex(pageIndex + 1);\r\n  };\r\n\r\n  const loadPrevPage = () => {\r\n    setPageIndex(pageIndex - 1);\r\n  };\r\n\r\n  const getMsg = useCallback(\r\n    (trade) => {\r\n      const tradeData = trade.data;\r\n      const params = JSON.parse(tradeData.params);\r\n      const defaultMsg = \"\";\r\n\r\n      if (tradeData.action === \"BuyUSDG\") {\r\n        const token = getTokenInfo(infoTokens, params.token, true, nativeTokenAddress);\r\n        if (!token) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.tokenAmount, token.decimals, 4, true)} ${token.symbol} for ${formatAmount(\r\n          params.usdgAmount,\r\n          18,\r\n          4,\r\n          true\r\n        )} USDG`;\r\n      }\r\n\r\n      if (tradeData.action === \"SellUSDG\") {\r\n        const token = getTokenInfo(infoTokens, params.token, true, nativeTokenAddress);\r\n        if (!token) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.usdgAmount, 18, 4, true)} USDG for ${formatAmount(\r\n          params.tokenAmount,\r\n          token.decimals,\r\n          4,\r\n          true\r\n        )} ${token.symbol}`;\r\n      }\r\n\r\n      if (tradeData.action === \"Swap\") {\r\n        const tokenIn = getTokenInfo(infoTokens, params.tokenIn, true, nativeTokenAddress);\r\n        const tokenOut = getTokenInfo(infoTokens, params.tokenOut, true, nativeTokenAddress);\r\n        if (!tokenIn || !tokenOut) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.amountIn, tokenIn.decimals, 4, true)} ${tokenIn.symbol} for ${formatAmount(\r\n          params.amountOut,\r\n          tokenOut.decimals,\r\n          4,\r\n          true\r\n        )} ${tokenOut.symbol}`;\r\n      }\r\n\r\n      if (tradeData.action === \"CreateIncreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Request deposit into ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return `Request increase ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, Acceptable Price: ${params.isLong ? \"<\" : \">\"} ${formatAmount(\r\n          params.acceptablePrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"CreateDecreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Request withdrawal from ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return `Request decrease ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, -${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, Acceptable Price: ${params.isLong ? \">\" : \"<\"} ${formatAmount(\r\n          params.acceptablePrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"CancelIncreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return (\r\n            <>\r\n              Could not execute deposit into {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"}\r\n            </>\r\n          );\r\n        }\r\n\r\n        return (\r\n          <>\r\n            Could not increase {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"},\r\n            {`+${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)}`} USD, Acceptable Price:&nbsp;\r\n            {params.isLong ? \"<\" : \">\"}&nbsp;\r\n            <Tooltip\r\n              position=\"left-top\"\r\n              handle={`${formatAmount(params.acceptablePrice, USD_DECIMALS, 2, true)} USD`}\r\n              renderContent={() => <>Try increasing the \"Allowed Slippage\", under the Settings menu on the top right</>}\r\n            />\r\n          </>\r\n        );\r\n      }\r\n\r\n      if (tradeData.action === \"CancelDecreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Could not execute withdrawal from ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return (\r\n          <>\r\n            Could not decrease {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"},\r\n            {`+${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)}`} USD, Acceptable Price:&nbsp;\r\n            {params.isLong ? \">\" : \"<\"}&nbsp;\r\n            <Tooltip\r\n              position=\"left-top\"\r\n              handle={`${formatAmount(params.acceptablePrice, USD_DECIMALS, 2, true)} USD`}\r\n              renderContent={() => <>Try increasing the \"Allowed Slippage\", under the Settings menu on the top right</>}\r\n            />\r\n          </>\r\n        );\r\n      }\r\n\r\n      if (tradeData.action === \"IncreasePosition-Long\" || tradeData.action === \"IncreasePosition-Short\") {\r\n        if (params.flags?.isOrderExecution) {\r\n          return;\r\n        }\r\n\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Deposit ${formatAmount(params.collateralDelta, USD_DECIMALS, 2, true)} USD into ${\r\n            indexToken.symbol\r\n          } ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n        return `Increase ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, ${indexToken.symbol} Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"DecreasePosition-Long\" || tradeData.action === \"DecreasePosition-Short\") {\r\n        if (params.flags?.isOrderExecution) {\r\n          return;\r\n        }\r\n\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Withdraw ${formatAmount(params.collateralDelta, USD_DECIMALS, 2, true)} USD from ${\r\n            indexToken.symbol\r\n          } ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n        const isLiquidation = params.flags?.isLiquidation;\r\n        const liquidationData = getLiquidationData(liquidationsDataMap, params.key, tradeData.timestamp);\r\n\r\n        if (isLiquidation && liquidationData) {\r\n          return (\r\n            <>\r\n              {renderLiquidationTooltip(liquidationData, \"Partial Liquidation\")} {indexToken.symbol}{\" \"}\r\n              {params.isLong ? \"Long\" : \"Short\"}, -{formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)} USD,{\" \"}\r\n              {indexToken.symbol}&nbsp; Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD\r\n            </>\r\n          );\r\n        }\r\n        const actionDisplay = isLiquidation ? \"Partially Liquidated\" : \"Decreased\";\r\n        return `\r\n        ${actionDisplay} ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"},\r\n        -${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)} USD,\r\n        ${indexToken.symbol} Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD\r\n      `;\r\n      }\r\n\r\n      if (tradeData.action === \"LiquidatePosition-Long\" || tradeData.action === \"LiquidatePosition-Short\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const liquidationData = getLiquidationData(liquidationsDataMap, params.key, tradeData.timestamp);\r\n        if (liquidationData) {\r\n          return (\r\n            <>\r\n              {renderLiquidationTooltip(liquidationData, \"Liquidated\")} {indexToken.symbol}{\" \"}\r\n              {params.isLong ? \"Long\" : \"Short\"}, -{formatAmount(params.size, USD_DECIMALS, 2, true)} USD,&nbsp;\r\n              {indexToken.symbol} Price: ${formatAmount(params.markPrice, USD_DECIMALS, 2, true)} USD\r\n            </>\r\n          );\r\n        }\r\n        return `\r\n        Liquidated ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"},\r\n        -${formatAmount(params.size, USD_DECIMALS, 2, true)} USD,\r\n        ${indexToken.symbol} Price: ${formatAmount(params.markPrice, USD_DECIMALS, 2, true)} USD\r\n      `;\r\n      }\r\n\r\n      if ([\"ExecuteIncreaseOrder\", \"ExecuteDecreaseOrder\"].includes(tradeData.action)) {\r\n        const order = deserialize(params.order);\r\n        const indexToken = getTokenInfo(infoTokens, order.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const longShortDisplay = order.isLong ? \"Long\" : \"Short\";\r\n        const executionPriceDisplay = formatAmount(order.executionPrice, USD_DECIMALS, 2, true);\r\n        const sizeDeltaDisplay = `${order.type === \"Increase\" ? \"+\" : \"-\"}${formatAmount(\r\n          order.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )}`;\r\n\r\n        return `\r\n        Execute Order: ${order.type} ${indexToken.symbol} ${longShortDisplay}\r\n        ${sizeDeltaDisplay} USD, Price: ${executionPriceDisplay} USD\r\n      `;\r\n      }\r\n\r\n      if (\r\n        [\r\n          \"CreateIncreaseOrder\",\r\n          \"CancelIncreaseOrder\",\r\n          \"UpdateIncreaseOrder\",\r\n          \"CreateDecreaseOrder\",\r\n          \"CancelDecreaseOrder\",\r\n          \"UpdateDecreaseOrder\",\r\n        ].includes(tradeData.action)\r\n      ) {\r\n        const order = deserialize(params.order);\r\n        const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const increase = tradeData.action.includes(\"Increase\");\r\n        const priceDisplay = `${order.triggerAboveThreshold ? \">\" : \"<\"} ${formatAmount(\r\n          order.triggerPrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )}`;\r\n        return `\r\n        ${getOrderActionTitle(tradeData.action)}:\r\n        ${getPositionDisplay(increase, indexToken, order.isLong, order.sizeDelta)},\r\n        Price: ${priceDisplay}\r\n      `;\r\n      }\r\n\r\n      if (tradeData.action === \"ExecuteSwapOrder\") {\r\n        const order = deserialize(params.order);\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromToken = getTokenInfo(infoTokens, order.path[0] === nativeTokenAddress ? AddressZero : order.path[0]);\r\n        const toToken = getTokenInfo(infoTokens, order.shouldUnwrap ? AddressZero : order.path[order.path.length - 1]);\r\n        if (!fromToken || !toToken) {\r\n          return defaultMsg;\r\n        }\r\n        const fromAmountDisplay = formatAmount(order.amountIn, fromToken.decimals, fromToken.isStable ? 2 : 4, true);\r\n        const toAmountDisplay = formatAmount(order.amountOut, toToken.decimals, toToken.isStable ? 2 : 4, true);\r\n        return `\r\n        Execute Order: Swap ${fromAmountDisplay} ${fromToken.symbol} for ${toAmountDisplay} ${toToken.symbol}\r\n      `;\r\n      }\r\n\r\n      if ([\"CreateSwapOrder\", \"UpdateSwapOrder\", \"CancelSwapOrder\"].includes(tradeData.action)) {\r\n        const order = deserialize(params.order);\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromToken = getTokenInfo(infoTokens, order.path[0] === nativeTokenAddress ? AddressZero : order.path[0]);\r\n        const toToken = getTokenInfo(infoTokens, order.shouldUnwrap ? AddressZero : order.path[order.path.length - 1]);\r\n        if (!fromToken || !toToken) {\r\n          return defaultMsg;\r\n        }\r\n        const amountInDisplay = fromToken\r\n          ? formatAmount(order.amountIn, fromToken.decimals, fromToken.isStable ? 2 : 4, true)\r\n          : \"\";\r\n        const minOutDisplay = toToken\r\n          ? formatAmount(order.minOut, toToken.decimals, toToken.isStable ? 2 : 4, true)\r\n          : \"\";\r\n\r\n        return `\r\n        ${getOrderActionTitle(tradeData.action)}:\r\n        Swap ${amountInDisplay} ${fromToken?.symbol || \"\"} for ${minOutDisplay} ${toToken?.symbol || \"\"},\r\n        Price: ${getExchangeRateDisplay(order.triggerRatio, fromToken, toToken)}`;\r\n      }\r\n    },\r\n    [getTokenInfo, infoTokens, nativeTokenAddress, chainId, liquidationsDataMap]\r\n  );\r\n\r\n  const tradesWithMessages = useMemo(() => {\r\n    if (!trades) {\r\n      return [];\r\n    }\r\n\r\n    return trades\r\n      .map((trade) => ({\r\n        msg: getMsg(trade),\r\n        ...trade,\r\n      }))\r\n      .filter((trade) => trade.msg);\r\n  }, [trades, getMsg]);\r\n\r\n  return (\r\n    <div className=\"TradeHistory\">\r\n      {tradesWithMessages.length === 0 && <div className=\"TradeHistory-row App-box App-box_no-border Exchange-list-empty-note\">No trades yet</div>}\r\n      {tradesWithMessages.length > 0 &&\r\n        tradesWithMessages.map((trade, index) => {\r\n          const tradeData = trade.data;\r\n          const txUrl = getExplorerUrl(chainId) + \"tx/\" + tradeData.txhash;\r\n\r\n          let msg = getMsg(trade);\r\n\r\n          if (!msg) {\r\n            return null;\r\n          }\r\n\r\n          return (\r\n            <div className=\"TradeHistory-row App-box App-box_no-border\" key={index}>\r\n              <div>\r\n                <div className=\"muted TradeHistory-time\">\r\n                  {formatDateTime(tradeData.timestamp)}\r\n                  {(!account || account.length === 0) && (\r\n                    <span>\r\n                      {\" \"}\r\n                      (<Link to={`/actions/${tradeData.account}`}>{tradeData.account}</Link>)\r\n                    </span>\r\n                  )}\r\n                </div>\r\n                <a className=\"plain\" href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  {msg}\r\n                </a>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      {shouldShowPaginationButtons && trades && trades.length >= TRADES_PAGE_SIZE && (\r\n        <div>\r\n          {pageIndex > 0 && (\r\n            <button className=\"App-button-option App-card-option\" onClick={loadPrevPage}>\r\n              Prev\r\n            </button>\r\n          )}\r\n          {trades && trades.length >= TRADES_PAGE_SIZE && (\r\n            <button className=\"App-button-option App-card-option\" onClick={loadNextPage}>\r\n              Next\r\n            </button>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nimport \"./ExchangeBanner.css\";\r\n\r\nexport default function ExchangeBanner(props) {\r\n  const { hideBanner } = props;\r\n\r\n  return (\r\n    <div className=\"ExchangeBanner\">\r\n      <p className=\"ExchangeBanner-text\">\r\n        Trade on GMX and win <span className=\"ExchangeBanner-price\">$250.000</span> in prizes! Live until November 30th,{\" \"}\r\n        <a\r\n          href=\"https://medium.com/@gmx.io/gmx-trading-competition-win-250-000-usd-in-prizes-1346504b96f6\"\r\n          target=\"_blank\"\r\n          className=\"ExchangeBanner-link\"\r\n          rel=\"noreferrer\"\r\n        >\r\n          click here\r\n        </a>{\" \"}\r\n        to learn more.\r\n      </p>\r\n      <span\r\n        className=\"ExchangeBanner-close\"\r\n        onClick={(e) => {\r\n          hideBanner();\r\n        }}\r\n      >\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"11.25\" height=\"11.25\" viewBox=\"0 0 11.25 11.25\">\r\n          <path\r\n            id=\"ic_close\"\r\n            d=\"M11-2.565,6.818-6.75,11-10.935a.844.844,0,0,0,0-1.193.844.844,0,0,0-1.193,0L5.625-7.943,1.44-12.128a.844.844,0,0,0-1.193,0,.844.844,0,0,0,0,1.193L4.432-6.75.247-2.565a.844.844,0,0,0,0,1.193.844.844,0,0,0,1.193,0L5.625-5.557,9.81-1.372a.844.844,0,0,0,1.193,0A.844.844,0,0,0,11-2.565Z\"\r\n            transform=\"translate(0 12.375)\"\r\n            fill=\"#fff\"\r\n          />\r\n        </svg>\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useMemo, useCallback, forwardRef, useImperativeHandle } from \"react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\nimport useWebSocket from 'react-use-websocket';\r\n\r\nimport {\r\n  FUNDING_RATE_PRECISION,\r\n  BASIS_POINTS_DIVISOR,\r\n  MARGIN_FEE_BASIS_POINTS,\r\n  SWAP,\r\n  LONG,\r\n  SHORT,\r\n  USD_DECIMALS,\r\n  getExplorerUrl,\r\n  helperToast,\r\n  formatAmount,\r\n  bigNumberify,\r\n  getTokenInfo,\r\n  getPositionKey,\r\n  getPositionContractKey,\r\n  getLeverage,\r\n  useLocalStorageSerializeKey,\r\n  useLocalStorageByChainId,\r\n  getDeltaStr,\r\n  useChainId,\r\n  useAccountOrders,\r\n  getPageTitle,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { approvePlugin, useInfoTokens, useMinExecutionFee, cancelMultipleOrders } from \"../../domain/legacy\";\r\n\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport { getTokens, getToken, getWhitelistedTokens, getTokenBySymbol } from \"../../config/Tokens\";\r\n\r\nimport Reader from \"../../abis/ReaderV2.json\";\r\nimport VaultV2 from \"../../abis/VaultV2.json\";\r\nimport Router from \"../../abis/Router.json\";\r\nimport Token from \"../../abis/Token.json\";\r\n\r\nimport SwapBox from \"../../components/Exchange/SwapBox\";\r\nimport ExchangeTVChart, { getChartToken } from \"../../components/Exchange/ExchangeTVChart\";\r\nimport PositionsList from \"../../components/Exchange/PositionsList\";\r\nimport OrdersList from \"../../components/Exchange/OrdersList\";\r\nimport TradeHistory from \"../../components/Exchange/TradeHistory\";\r\nimport ExchangeWalletTokens from \"../../components/Exchange/ExchangeWalletTokens\";\r\nimport ExchangeBanner from \"../../components/Exchange/ExchangeBanner\";\r\nimport Tab from \"../../components/Tab/Tab\";\r\n\r\nimport \"./Exchange.scss\";\r\nimport \"../../components/Exchange/Exchange-lists.scss\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport GNS_Storage from \"../../abis/GNS/GNS_Storage.json\";\r\nimport { GNS_PAIRS } from './../../lib/GNS_legacy';\r\nimport { ADDRESS_ZERO } from '@uniswap/v3-sdk';\r\nimport { signer } from './../../../../components/utils/providers';\r\n\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nconst PENDING_POSITION_VALID_DURATION = 600 * 1000;\r\nconst UPDATED_POSITION_VALID_DURATION = 60 * 1000;\r\n\r\nconst notifications = {};\r\n\r\nfunction pushSuccessNotification(chainId, message, e) {\r\n  const { transactionHash } = e;\r\n  const id = ethers.utils.id(message + transactionHash);\r\n  if (notifications[id]) {\r\n    return;\r\n  }\r\n\r\n  notifications[id] = true;\r\n\r\n  const txUrl = getExplorerUrl(chainId) + \"tx/\" + transactionHash;\r\n  helperToast.success(\r\n    <div>\r\n      {message}{\" \"}\r\n      <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        View\r\n      </a>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction pushErrorNotification(chainId, message, e) {\r\n  const { transactionHash } = e;\r\n  const id = ethers.utils.id(message + transactionHash);\r\n  if (notifications[id]) {\r\n    return;\r\n  }\r\n\r\n  notifications[id] = true;\r\n\r\n  const txUrl = getExplorerUrl(chainId) + \"tx/\" + transactionHash;\r\n  helperToast.error(\r\n    <div>\r\n      {message}{\" \"}\r\n      <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        View\r\n      </a>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction getFundingFee(data) {\r\n  let { entryFundingRate, cumulativeFundingRate, size } = data;\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    return size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n  }\r\n  return;\r\n}\r\n\r\nconst getTokenAddress = (token, nativeTokenAddress) => {\r\n  if (token.address === AddressZero) {\r\n    return nativeTokenAddress;\r\n  }\r\n  return token.address;\r\n};\r\n\r\nfunction applyPendingChanges(position, pendingPositions) {\r\n  if (!pendingPositions) {\r\n    return;\r\n  }\r\n  const { key } = position;\r\n\r\n  if (\r\n    pendingPositions[key] &&\r\n    pendingPositions[key].updatedAt &&\r\n    pendingPositions[key].pendingChanges &&\r\n    pendingPositions[key].updatedAt + PENDING_POSITION_VALID_DURATION > Date.now()\r\n  ) {\r\n    const { pendingChanges } = pendingPositions[key];\r\n    if (pendingChanges.size && position.size.eq(pendingChanges.size)) {\r\n      return;\r\n    }\r\n\r\n    if (pendingChanges.expectingCollateralChange && !position.collateral.eq(pendingChanges.collateralSnapshot)) {\r\n      return;\r\n    }\r\n\r\n    position.hasPendingChanges = true;\r\n    position.pendingChanges = pendingChanges;\r\n  }\r\n}\r\n\r\nexport function getPositions(\r\n  chainId,\r\n  positionQuery,\r\n  positionData,\r\n  infoTokens,\r\n  includeDelta,\r\n  showPnlAfterFees,\r\n  account,\r\n  pendingPositions,\r\n  updatedPositions,\r\n) {\r\n  const propsLength = getConstant(chainId, \"positionReaderPropsLength\");\r\n  const positions = [];\r\n  const positionsMap = {};\r\n  if (!positionData) {\r\n    return { positions, positionsMap };\r\n  }\r\n  const { collateralTokens, indexTokens, isLong } = positionQuery;\r\n  for (let i = 0; i < collateralTokens.length; i++) {\r\n    const collateralToken = getTokenInfo(infoTokens, collateralTokens[i], true, getContract(chainId, \"NATIVE_TOKEN\"));\r\n    const indexToken = getTokenInfo(infoTokens, indexTokens[i], true, getContract(chainId, \"NATIVE_TOKEN\"));\r\n    const key = getPositionKey(account, collateralTokens[i], indexTokens[i], isLong[i]);\r\n    let contractKey;\r\n    if (account) {\r\n      contractKey = getPositionContractKey(account, collateralTokens[i], indexTokens[i], isLong[i]);\r\n    }\r\n\r\n\r\n    const position = {\r\n      key,\r\n      contractKey,\r\n      collateralToken,\r\n      indexToken,\r\n      isLong: isLong[i],\r\n      size: positionData[i * propsLength],\r\n      collateral: positionData[i * propsLength + 1],\r\n      averagePrice: positionData[i * propsLength + 2],\r\n      entryFundingRate: positionData[i * propsLength + 3],\r\n      cumulativeFundingRate: collateralToken.cumulativeFundingRate,\r\n      hasRealisedProfit: positionData[i * propsLength + 4].eq(1),\r\n      realisedPnl: positionData[i * propsLength + 5],\r\n      lastIncreasedTime: positionData[i * propsLength + 6].toNumber(),\r\n      hasProfit: positionData[i * propsLength + 7].eq(1),\r\n      delta: positionData[i * propsLength + 8],\r\n      markPrice: isLong[i] ? indexToken.minPrice : indexToken.maxPrice,\r\n      market: 'GMX',\r\n    };\r\n\r\n\r\n    if (\r\n      updatedPositions &&\r\n      updatedPositions[key] &&\r\n      updatedPositions[key].updatedAt &&\r\n      updatedPositions[key].updatedAt + UPDATED_POSITION_VALID_DURATION > Date.now()\r\n    ) {\r\n      const updatedPosition = updatedPositions[key];\r\n      position.size = updatedPosition.size;\r\n      position.collateral = updatedPosition.collateral;\r\n      position.averagePrice = updatedPosition.averagePrice;\r\n      position.entryFundingRate = updatedPosition.entryFundingRate;\r\n    }\r\n\r\n    let fundingFee = getFundingFee(position);\r\n    position.fundingFee = fundingFee ? fundingFee : bigNumberify(0);\r\n    position.collateralAfterFee = position.collateral.sub(position.fundingFee);\r\n\r\n    position.closingFee = position.size.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    position.positionFee = position.size.mul(MARGIN_FEE_BASIS_POINTS).mul(2).div(BASIS_POINTS_DIVISOR);\r\n    position.totalFees = position.positionFee.add(position.fundingFee);\r\n\r\n    position.pendingDelta = position.delta;\r\n\r\n    if (position.collateral.gt(0)) {\r\n      position.hasLowCollateral =\r\n        position.collateralAfterFee.lt(0) || position.size.div(position.collateralAfterFee.abs()).gt(50);\r\n\r\n      if (position.averagePrice && position.markPrice) {\r\n        const priceDelta = position.averagePrice.gt(position.markPrice)\r\n          ? position.averagePrice.sub(position.markPrice)\r\n          : position.markPrice.sub(position.averagePrice);\r\n        position.pendingDelta = position.size.mul(priceDelta).div(position.averagePrice);\r\n\r\n        position.delta = position.pendingDelta;\r\n\r\n        if (position.isLong) {\r\n          position.hasProfit = position.markPrice.gte(position.averagePrice);\r\n        } else {\r\n          position.hasProfit = position.markPrice.lte(position.averagePrice);\r\n        }\r\n      }\r\n\r\n      position.deltaPercentage = position.pendingDelta.mul(BASIS_POINTS_DIVISOR).div(position.collateral);\r\n\r\n      const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n        delta: position.pendingDelta,\r\n        deltaPercentage: position.deltaPercentage,\r\n        hasProfit: position.hasProfit,\r\n      });\r\n\r\n      position.deltaStr = deltaStr;\r\n      position.deltaPercentageStr = deltaPercentageStr;\r\n      position.deltaBeforeFeesStr = deltaStr;\r\n\r\n      let hasProfitAfterFees;\r\n      let pendingDeltaAfterFees;\r\n\r\n      if (position.hasProfit) {\r\n        if (position.pendingDelta.gt(position.totalFees)) {\r\n          hasProfitAfterFees = true;\r\n          pendingDeltaAfterFees = position.pendingDelta.sub(position.totalFees);\r\n        } else {\r\n          hasProfitAfterFees = false;\r\n          pendingDeltaAfterFees = position.totalFees.sub(position.pendingDelta);\r\n        }\r\n      } else {\r\n        hasProfitAfterFees = false;\r\n        pendingDeltaAfterFees = position.pendingDelta.add(position.totalFees);\r\n      }\r\n\r\n      position.hasProfitAfterFees = hasProfitAfterFees;\r\n      position.pendingDeltaAfterFees = pendingDeltaAfterFees;\r\n      position.deltaPercentageAfterFees = position.pendingDeltaAfterFees\r\n        .mul(BASIS_POINTS_DIVISOR)\r\n        .div(position.collateral);\r\n\r\n      const { deltaStr: deltaAfterFeesStr, deltaPercentageStr: deltaAfterFeesPercentageStr } = getDeltaStr({\r\n        delta: position.pendingDeltaAfterFees,\r\n        deltaPercentage: position.deltaPercentageAfterFees,\r\n        hasProfit: hasProfitAfterFees,\r\n      });\r\n\r\n      position.deltaAfterFeesStr = deltaAfterFeesStr;\r\n      position.deltaAfterFeesPercentageStr = deltaAfterFeesPercentageStr;\r\n\r\n      if (showPnlAfterFees) {\r\n        position.deltaStr = position.deltaAfterFeesStr;\r\n        position.deltaPercentageStr = position.deltaAfterFeesPercentageStr;\r\n      }\r\n\r\n      let netValue = position.hasProfit\r\n        ? position.collateral.add(position.pendingDelta)\r\n        : position.collateral.sub(position.pendingDelta);\r\n\r\n      netValue = netValue.sub(position.fundingFee);\r\n\r\n      if (showPnlAfterFees) {\r\n        netValue = netValue.sub(position.closingFee);\r\n      }\r\n\r\n      position.netValue = netValue;\r\n    }\r\n\r\n    position.leverage = getLeverage({\r\n      size: position.size,\r\n      collateral: position.collateral,\r\n      entryFundingRate: position.entryFundingRate,\r\n      cumulativeFundingRate: position.cumulativeFundingRate,\r\n      hasProfit: position.hasProfit,\r\n      delta: position.delta,\r\n      includeDelta,\r\n    });\r\n\r\n    positionsMap[key] = position;\r\n\r\n    applyPendingChanges(position, pendingPositions);\r\n\r\n    if (position.size.gt(0) || position.hasPendingChanges) {\r\n      positions.push(position);\r\n    }\r\n  }\r\n\r\n  return { positions, positionsMap };\r\n}\r\n\r\nexport function getPositionQuery(tokens, nativeTokenAddress) {\r\n  const collateralTokens = [];\r\n  const indexTokens = [];\r\n  const isLong = [];\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = tokens[i];\r\n    if (token.isStable) {\r\n      continue;\r\n    }\r\n    if (token.isWrapped) {\r\n      continue;\r\n    }\r\n    collateralTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n    indexTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n    isLong.push(true);\r\n  }\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const stableToken = tokens[i];\r\n    if (!stableToken.isStable) {\r\n      continue;\r\n    }\r\n\r\n    for (let j = 0; j < tokens.length; j++) {\r\n      const token = tokens[j];\r\n      if (token.isStable) {\r\n        continue;\r\n      }\r\n      if (token.isWrapped) {\r\n        continue;\r\n      }\r\n      collateralTokens.push(stableToken.address);\r\n      indexTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n      isLong.push(false);\r\n    }\r\n  }\r\n\r\n  return { collateralTokens, indexTokens, isLong };\r\n}\r\n\r\nexport const Exchange = forwardRef((props, ref) => {\r\n  const {\r\n    savedIsPnlInLeverage,\r\n    setSavedIsPnlInLeverage,\r\n    savedShowPnlAfterFees,\r\n    savedSlippageAmount,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    savedShouldShowPositionLines,\r\n    setSavedShouldShowPositionLines,\r\n    connectWallet,\r\n    savedShouldDisableValidationForTesting,\r\n  } = props;\r\n  const [showBanner, setShowBanner] = useLocalStorageSerializeKey(\"showBanner\", true);\r\n  const [bannerHidden, setBannerHidden] = useLocalStorageSerializeKey(\"bannerHidden\", null);\r\n\r\n  const [pendingPositions, setPendingPositions] = useState({});\r\n  const [updatedPositions, setUpdatedPositions] = useState({});\r\n\r\n  const hideBanner = () => {\r\n    const hiddenLimit = new Date(new Date().getTime() + 2 * 24 * 60 * 60 * 1000);\r\n    setBannerHidden(hiddenLimit);\r\n    setShowBanner(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (new Date() > new Date(\"2021-11-30\")) {\r\n      setShowBanner(false);\r\n    } else {\r\n      if (bannerHidden && new Date(bannerHidden) > new Date()) {\r\n        setShowBanner(false);\r\n      } else {\r\n        setBannerHidden(null);\r\n        setShowBanner(true);\r\n      }\r\n    }\r\n  }, [showBanner, bannerHidden, setBannerHidden, setShowBanner]);\r\n\r\n  const { account, library } = useWeb3React();\r\n  const active = Boolean(props.walletAddress);\r\n  const { chainId } = useChainId();\r\n  const currentAccount = account;\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const readerAddress = getContract(chainId, \"Reader\");\r\n  const usdgAddress = getContract(chainId, \"USDG\");\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const whitelistedTokenAddresses = whitelistedTokens.map((token) => token.address);\r\n\r\n  const positionQuery = getPositionQuery(whitelistedTokens, nativeTokenAddress);\r\n\r\n  const defaultCollateralSymbol = getConstant(chainId, \"defaultCollateralSymbol\");\r\n  const defaultTokenSelection = useMemo(\r\n    () => ({\r\n      [SWAP]: {\r\n        from: AddressZero,\r\n        to: getTokenBySymbol(chainId, defaultCollateralSymbol).address,\r\n      },\r\n      [LONG]: {\r\n        from: AddressZero,\r\n        to: AddressZero,\r\n      },\r\n      [SHORT]: {\r\n        from: getTokenBySymbol(chainId, defaultCollateralSymbol).address,\r\n        to: AddressZero,\r\n      },\r\n    }),\r\n    [chainId, defaultCollateralSymbol]\r\n  );\r\n\r\n  const [tokenSelection, setTokenSelection] = useLocalStorageByChainId(\r\n    chainId,\r\n    \"Exchange-token-selection-v2\",\r\n    defaultTokenSelection\r\n  );\r\n\r\n  \r\n  \r\n  const [swapOption, setSwapOption] = useLocalStorageByChainId(chainId, \"Swap-option-v2\", LONG);\r\n\r\n  const fromTokenAddress = tokenSelection[swapOption].from;\r\n  const toTokenAddress = tokenSelection[swapOption].to;\r\n\r\n  const tokens = getTokens(chainId);\r\n  const stableTokens = tokens.filter((token) => token.isStable);\r\n\r\n  const setFromTokenAddress = useCallback(\r\n    (selectedSwapOption, address) => {\r\n      const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n      newTokenSelection[selectedSwapOption].from = address;\r\n      setTokenSelection(newTokenSelection);\r\n    },\r\n    [tokenSelection, setTokenSelection]\r\n  );\r\n\r\n  const setToTokenAddress = useCallback(\r\n    (selectedSwapOption, address) => {\r\n      const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n      \r\n      // ETH/USDC disabling\r\n      // address = AddressZero;\r\n      \r\n      newTokenSelection[selectedSwapOption].to = address;\r\n      if (selectedSwapOption === LONG || selectedSwapOption === SHORT) {\r\n        newTokenSelection[LONG].to = address;\r\n        newTokenSelection[SHORT].to = address;\r\n      }\r\n      setTokenSelection(newTokenSelection);\r\n    },\r\n    [tokenSelection, setTokenSelection]\r\n  );\r\n\r\n  const setMarket = (selectedSwapOption, toTokenAddress) => {\r\n    // ETH/USDC disabling\r\n    // toTokenAddress = AddressZero;\r\n    \r\n    setSwapOption(selectedSwapOption);\r\n    const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n    newTokenSelection[selectedSwapOption].to = toTokenAddress;\r\n    if (selectedSwapOption === LONG || selectedSwapOption === SHORT) {\r\n      newTokenSelection[LONG].to = toTokenAddress;\r\n      newTokenSelection[SHORT].to = toTokenAddress;\r\n    }\r\n    setTokenSelection(newTokenSelection);\r\n  };\r\n\r\n  const [isConfirming, setIsConfirming] = useState(false);\r\n  const [isPendingConfirmation, setIsPendingConfirmation] = useState(false);\r\n\r\n  const tokenAddresses = tokens.map((token) => token.address);\r\n  const { data: tokenBalances } = useSWR(active && [active, chainId, readerAddress, \"getTokenBalances\", account], {\r\n    fetcher: fetcher(library, Reader, [tokenAddresses]),\r\n  });\r\n\r\n  const { data: positionData, error: positionDataError } = useSWR(\r\n    active && [active, chainId, readerAddress, \"getPositions\", vaultAddress, account],\r\n    {\r\n      fetcher: fetcher(library, Reader, [\r\n        positionQuery.collateralTokens,\r\n        positionQuery.indexTokens,\r\n        positionQuery.isLong,\r\n      ]),\r\n    }\r\n  );\r\n\r\n  \r\n  const [pendingPositionsGNS, setPendingPositionsGNS] = useState([]);\r\n  const [positionsGNSLoading, setPositionsGNSLoading] = useState(true);\r\n  const { data: positionsGNS, error: positionsGNSError } = useSWR(\r\n    active && [active, chainId, GNS_Storage.address, pendingPositionsGNS, \"getPositionsGNS\", account],\r\n    async () => {\r\n      const positions = [];\r\n      let position;\r\n\r\n      const contract = new ethers.Contract(GNS_Storage.address, GNS_Storage.abi, library.getSigner());\r\n      const keys = [];\r\n      \r\n      for (let i = 0; i < Object.keys(GNS_PAIRS).length; i++) {\r\n        const pair = Object.keys(GNS_PAIRS)[i];\r\n        let pairIndex = GNS_PAIRS[pair];\r\n        \r\n        for (let j = 0; j < 3; j++) {\r\n          const index = j;\r\n          position = await contract.openTrades(account, pairIndex, index);\r\n          if (position.trader === ADDRESS_ZERO) {\r\n            continue;\r\n          }\r\n\r\n          positions.push(position);\r\n          \r\n          const key = `${pairIndex}${position.leverage}`;\r\n          keys.push(key);\r\n        }\r\n      }\r\n\r\n      setPositionsGNSLoading(false);\r\n\r\n      keys.forEach(key => {\r\n        if (pendingPositionsGNS[key]) {\r\n          delete pendingPositionsGNS[key];\r\n          setPendingPositionsGNS(pendingPositionsGNS);\r\n        }\r\n      })\r\n      return positions;\r\n    }\r\n  );\r\n  \r\n  const positionsDataIsLoading = active && ((!positionData && !positionDataError) || (!positionsGNS && !positionsGNSError));\r\n\r\n  const { data: fundingRateInfo } = useSWR([active, chainId, readerAddress, \"getFundingRates\"], {\r\n    fetcher: fetcher(library, Reader, [vaultAddress, nativeTokenAddress, whitelistedTokenAddresses]),\r\n  });\r\n\r\n  const { data: totalTokenWeights } = useSWR(\r\n    [`Exchange:totalTokenWeights:${active}`, chainId, vaultAddress, \"totalTokenWeights\"],\r\n    {\r\n      fetcher: fetcher(library, VaultV2),\r\n    }\r\n  );\r\n\r\n  const { data: usdgSupply } = useSWR([`Exchange:usdgSupply:${active}`, chainId, usdgAddress, \"totalSupply\"], {\r\n    fetcher: fetcher(library, Token),\r\n  });\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const { data: orderBookApproved } = useSWR(\r\n    active && [active, chainId, routerAddress, \"approvedPlugins\", account, orderBookAddress],\r\n    {\r\n      fetcher: fetcher(library, Router),\r\n    }\r\n  );\r\n\r\n  const { data: positionRouterApproved } = useSWR(\r\n    active && [active, chainId, routerAddress, \"approvedPlugins\", account, positionRouterAddress],\r\n    {\r\n      fetcher: fetcher(library, Router),\r\n    }\r\n  );\r\n\r\n\r\n  const { infoTokens } = useInfoTokens(library, chainId, active, tokenBalances, fundingRateInfo);\r\n  const { minExecutionFee, minExecutionFeeUSD, minExecutionFeeErrorMessage } = useMinExecutionFee(\r\n    library,\r\n    active,\r\n    chainId,\r\n    infoTokens\r\n  );\r\n  \r\n\r\n  useEffect(() => {\r\n    const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n    const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n    let selectedToken = getChartToken(swapOption, fromToken, toToken, chainId);\r\n    let currentTokenPriceStr = formatAmount(selectedToken.maxPrice, USD_DECIMALS, 2, true);\r\n    let title = getPageTitle(currentTokenPriceStr + ` | ${selectedToken.symbol}${selectedToken.isStable ? \"\" : \"USD\"}`);\r\n    document.title = title;\r\n  }, [tokenSelection, swapOption, infoTokens, chainId, fromTokenAddress, toTokenAddress]);\r\n\r\n  const { positions, positionsMap } = getPositions(\r\n    chainId,\r\n    positionQuery,\r\n    positionData,\r\n    infoTokens,\r\n    savedIsPnlInLeverage,\r\n    savedShowPnlAfterFees,\r\n    account,\r\n    pendingPositions,\r\n    updatedPositions,\r\n    account,\r\n  )\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    onUpdatePosition(key, size, collateral, averagePrice, entryFundingRate, reserveAmount, realisedPnl) {\r\n      for (let i = 0; i < positions.length; i++) {\r\n        const position = positions[i];\r\n        if (position.contractKey === key) {\r\n          updatedPositions[position.key] = {\r\n            size,\r\n            collateral,\r\n            averagePrice,\r\n            entryFundingRate,\r\n            reserveAmount,\r\n            realisedPnl,\r\n            updatedAt: Date.now(),\r\n          };\r\n          setUpdatedPositions({ ...updatedPositions });\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    onClosePosition(key, size, collateral, averagePrice, entryFundingRate, reserveAmount, realisedPnl, e) {\r\n      for (let i = 0; i < positions.length; i++) {\r\n        const position = positions[i];\r\n        if (position.contractKey === key) {\r\n          updatedPositions[position.key] = {\r\n            size: bigNumberify(0),\r\n            collateral: bigNumberify(0),\r\n            averagePrice,\r\n            entryFundingRate,\r\n            reserveAmount,\r\n            realisedPnl,\r\n            updatedAt: Date.now(),\r\n          };\r\n          setUpdatedPositions({ ...updatedPositions });\r\n          break;\r\n        }\r\n      }\r\n    },\r\n\r\n    onIncreasePosition(key, account, collateralToken, indexToken, collateralDelta, sizeDelta, isLong, price, fee, e) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      let message;\r\n      if (sizeDelta.eq(0)) {\r\n        message = `Deposited ${formatAmount(collateralDelta, USD_DECIMALS, 2, true)} USD into ${tokenSymbol} ${\r\n          isLong ? \"Long\" : \"Short.\"\r\n        }`;\r\n      } else {\r\n        message = `Increased ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD.`;\r\n      }\r\n\r\n      pushSuccessNotification(chainId, message, e);\r\n    },\r\n\r\n    onDecreasePosition(key, account, collateralToken, indexToken, collateralDelta, sizeDelta, isLong, price, fee, e) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      let message;\r\n      if (sizeDelta.eq(0)) {\r\n        message = `Withdrew ${formatAmount(collateralDelta, USD_DECIMALS, 2, true)} USD from ${tokenSymbol} ${\r\n          isLong ? \"Long\" : \"Short\"\r\n        }.`;\r\n      } else {\r\n        message = `Decreased ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"}, -${formatAmount(\r\n          sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD.`;\r\n      }\r\n\r\n      pushSuccessNotification(chainId, message, e);\r\n    },\r\n\r\n    onCancelIncreasePosition(\r\n      account,\r\n      path,\r\n      indexToken,\r\n      amountIn,\r\n      minOut,\r\n      sizeDelta,\r\n      isLong,\r\n      acceptablePrice,\r\n      executionFee,\r\n      blockGap,\r\n      timeGap,\r\n      e\r\n    ) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      const message = `Could not increase ${tokenSymbol} ${\r\n        isLong ? \"Long\" : \"Short\"\r\n      } within the allowed slippage, you can adjust the allowed slippage in the settings on the top right of the page.`;\r\n\r\n      pushErrorNotification(chainId, message, e);\r\n\r\n      const key = getPositionKey(account, path[path.length - 1], indexToken, isLong);\r\n      pendingPositions[key] = {};\r\n      setPendingPositions({ ...pendingPositions });\r\n    },\r\n\r\n    onCancelDecreasePosition(\r\n      account,\r\n      path,\r\n      indexToken,\r\n      collateralDelta,\r\n      sizeDelta,\r\n      isLong,\r\n      receiver,\r\n      acceptablePrice,\r\n      minOut,\r\n      executionFee,\r\n      blockGap,\r\n      timeGap,\r\n      e\r\n    ) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      const message = `Could not decrease ${tokenSymbol} ${\r\n        isLong ? \"Long\" : \"Short\"\r\n      } within the allowed slippage, you can adjust the allowed slippage in the settings on the top right of the page.`;\r\n\r\n      pushErrorNotification(chainId, message, e);\r\n\r\n      const key = getPositionKey(account, path[path.length - 1], indexToken, isLong);\r\n      pendingPositions[key] = {};\r\n      setPendingPositions({ ...pendingPositions });\r\n    },\r\n  }));\r\n\r\n  const flagOrdersEnabled = true;\r\n  const [orders] = useAccountOrders(flagOrdersEnabled, account);\r\n  \r\n  const { data: ordersGNSData, error: ordersGNSDataError } = useSWR(\r\n    active && [active, chainId, GNS_Storage.address, \"getOrders\", \"getOrdersGNS\", account],\r\n    async () => {\r\n      const orders = [];\r\n      let order;\r\n\r\n      const contract = new ethers.Contract(GNS_Storage.address, GNS_Storage.abi, library.getSigner());\r\n\r\n      for (let i = 0; i < Object.keys(GNS_PAIRS).length; i++) {\r\n        const pair = Object.keys(GNS_PAIRS)[i];\r\n        let pairIndex = GNS_PAIRS[pair];\r\n        \r\n        for (let j = 0; j < 3; j++) {\r\n          const index = j;\r\n\r\n          try {\r\n            order = await contract.getOpenLimitOrder(account, pairIndex, index);\r\n            orders.push(order);\r\n          } catch(e) {\r\n          }\r\n        }\r\n      }\r\n      \r\n      return orders;\r\n    }\r\n  );\r\n  \r\n  const [ordersGNS, setOrdersGNS] = useState([]);\r\n  useEffect(() => {\r\n    if (!ordersGNSData) {\r\n      return;\r\n    }\r\n    \r\n    setOrdersGNS(ordersGNSData);\r\n  }, [ordersGNSData]);\r\n\r\n  const [isWaitingForPluginApproval, setIsWaitingForPluginApproval] = useState(false);\r\n  const [isWaitingForPositionRouterApproval, setIsWaitingForPositionRouterApproval] = useState(false);\r\n  const [isPluginApproving, setIsPluginApproving] = useState(false);\r\n  const [isPositionRouterApproving, setIsPositionRouterApproving] = useState(false);\r\n  const [isCancelMultipleOrderProcessing, setIsCancelMultipleOrderProcessing] = useState(false);\r\n  const [cancelOrderIdList, setCancelOrderIdList] = useState([]);\r\n\r\n  const onMultipleCancelClick = useCallback(\r\n    async function () {\r\n      setIsCancelMultipleOrderProcessing(true);\r\n      try {\r\n        const tx = await cancelMultipleOrders(chainId, library, cancelOrderIdList, {\r\n          successMsg: t`Orders cancelled.`,\r\n          failMsg: t`Cancel failed.`,\r\n          sentMsg: t`Cancel submitted.`,\r\n          pendingTxns,\r\n          setPendingTxns,\r\n        });\r\n        const receipt = await tx.wait();\r\n        if (receipt.status === 1) {\r\n          setCancelOrderIdList([]);\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      } finally {\r\n        setIsCancelMultipleOrderProcessing(false);\r\n      }\r\n    },\r\n    [\r\n      chainId,\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      setCancelOrderIdList,\r\n      cancelOrderIdList,\r\n      setIsCancelMultipleOrderProcessing,\r\n    ]\r\n  );\r\n\r\n  const approveOrderBook = () => {\r\n    setIsPluginApproving(true);\r\n    return approvePlugin(chainId, orderBookAddress, {\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      sentMsg: t`Enable orders sent.`,\r\n      failMsg: t`Enable orders failed.`,\r\n    })\r\n      .then(() => {\r\n        setIsWaitingForPluginApproval(true);\r\n      })\r\n      .finally(() => {\r\n        setIsPluginApproving(false);\r\n      });\r\n  };\r\n\r\n  const approvePositionRouter = ({ sentMsg, failMsg }) => {\r\n    setIsPositionRouterApproving(true);\r\n    return approvePlugin(chainId, positionRouterAddress, {\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      sentMsg,\r\n      failMsg,\r\n    })\r\n      .then(() => {\r\n        setIsWaitingForPositionRouterApproval(true);\r\n      })\r\n      .finally(() => {\r\n        setIsPositionRouterApproving(false);\r\n      });\r\n  };\r\n\r\n  const posLength = positions?.length + positionsGNS?.length;\r\n  const ordersLength = orders?.length + ordersGNS?.length;\r\n\r\n  const LIST_SECTIONS = [\"Positions\", flagOrdersEnabled ? \"Orders\" : undefined, \"Trades\"].filter(Boolean);\r\n  let [listSection, setListSection] = useLocalStorageByChainId(chainId, \"List-section-v2\", LIST_SECTIONS[0]);\r\n  const LIST_SECTIONS_LABELS = {\r\n    Orders: ordersLength ? `Orders (${ordersLength})` : undefined,\r\n    Positions: posLength ? `Positions (${posLength})` : undefined,\r\n  };\r\n  if (!LIST_SECTIONS.includes(listSection)) {\r\n    listSection = LIST_SECTIONS[0];\r\n  }\r\n\r\n  if (!getToken(chainId, toTokenAddress)) {\r\n    return null;\r\n  }\r\n\r\n  const renderCancelOrderButton = () => {\r\n    const orderText = cancelOrderIdList.length > 1 ? t`orders` : t`order`;\r\n    if (cancelOrderIdList.length === 0) return;\r\n    return (\r\n      <button\r\n        className=\"muted font-base cancel-order-btn\"\r\n        disabled={isCancelMultipleOrderProcessing}\r\n        type=\"button\"\r\n        onClick={onMultipleCancelClick}\r\n      >\r\n        <Trans>\r\n          Cancel {cancelOrderIdList.length} {orderText}\r\n        </Trans>\r\n      </button>\r\n    );\r\n  };\r\n\r\n  const getListSection = () => {\r\n    return (\r\n      <div>\r\n        <div className=\"Exchange-list-tab-container\">\r\n          <Tab\r\n            options={LIST_SECTIONS}\r\n            optionLabels={LIST_SECTIONS_LABELS}\r\n            option={listSection}\r\n            onChange={(section) => setListSection(section)}\r\n            type=\"inline\"\r\n            className=\"Exchange-list-tabs\"\r\n          />\r\n        </div>\r\n        {listSection === \"Positions\" && (\r\n          <PositionsList\r\n            positionsDataIsLoading={positionsDataIsLoading}\r\n            pendingPositions={pendingPositions}\r\n            setPendingPositions={setPendingPositions}\r\n            setListSection={setListSection}\r\n            setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n            setIsWaitingForPositionRouterApproval={setIsWaitingForPositionRouterApproval}\r\n            approveOrderBook={approveOrderBook}\r\n            approvePositionRouter={approvePositionRouter}\r\n            isPluginApproving={isPluginApproving}\r\n            isPositionRouterApproving={isPositionRouterApproving}\r\n            isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n            isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n            orderBookApproved={orderBookApproved}\r\n            positionRouterApproved={positionRouterApproved}\r\n            positionsLoading={positionsGNSLoading}\r\n            positionsGNS={positionsGNS}\r\n            pendingPositionsGNS={pendingPositionsGNS}\r\n            setPendingPositionsGNS={setPendingPositionsGNS}\r\n            positions={positions}\r\n            positionsMap={positionsMap}\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            account={account}\r\n            library={library}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            flagOrdersEnabled={flagOrdersEnabled}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            chainId={chainId}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            setMarket={setMarket}\r\n            orders={orders}\r\n            showPnlAfterFees={true}\r\n            minExecutionFee={minExecutionFee}\r\n            minExecutionFeeUSD={minExecutionFeeUSD}\r\n            minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n            usdgSupply={usdgSupply}\r\n            totalTokenWeights={totalTokenWeights}\r\n          />\r\n        )}\r\n        {listSection === \"Orders\" && (\r\n          <OrdersList\r\n            account={account}\r\n            active={active}\r\n            library={library}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            infoTokens={infoTokens}\r\n            positionsMap={positionsMap}\r\n            chainId={chainId}\r\n            orders={orders}\r\n            ordersGNS={ordersGNS}\r\n            totalTokenWeights={totalTokenWeights}\r\n            usdgSupply={usdgSupply}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            cancelOrderIdList={cancelOrderIdList}\r\n            setCancelOrderIdList={setCancelOrderIdList}\r\n          />\r\n        )}\r\n        {listSection === \"Trades\" && (\r\n          <TradeHistory\r\n            account={account}\r\n            forSingleAccount={true}\r\n            infoTokens={infoTokens}\r\n            getTokenInfo={getTokenInfo}\r\n            chainId={chainId}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            shouldShowPaginationButtons={true}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const onSelectWalletToken = (token) => {\r\n    setFromTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  const renderChart = () => {\r\n    return (\r\n      <ExchangeTVChart\r\n        fromTokenAddress={fromTokenAddress}\r\n        toTokenAddress={toTokenAddress}\r\n        infoTokens={infoTokens}\r\n        swapOption={swapOption}\r\n        chainId={chainId}\r\n        positions={positions}\r\n        // savedShouldShowPositionLines={savedShouldShowPositionLines}\r\n        savedShouldShowPositionLines={true}\r\n        orders={orders}\r\n        setToTokenAddress={setToTokenAddress}\r\n      />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"Exchange page-layout\">\r\n      {showBanner && <ExchangeBanner hideBanner={hideBanner} />}\r\n      <div className=\"Exchange-content\">\r\n        <div className=\"Exchange-left\">\r\n          {renderChart()}\r\n        </div>\r\n        <div className=\"Exchange-right\">\r\n          <SwapBox\r\n            positions={positions}\r\n            pendingPositions={pendingPositions}\r\n            setPendingPositions={setPendingPositions}\r\n            setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n            setIsWaitingForPositionRouterApproval={setIsWaitingForPositionRouterApproval}\r\n            approveOrderBook={approveOrderBook}\r\n            approvePositionRouter={approvePositionRouter}\r\n            isPluginApproving={isPluginApproving}\r\n            isPositionRouterApproving={isPositionRouterApproving}\r\n            isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n            isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n            orderBookApproved={orderBookApproved}\r\n            positionRouterApproved={positionRouterApproved}\r\n            orders={orders}\r\n            flagOrdersEnabled={flagOrdersEnabled}\r\n            chainId={chainId}\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            connectWallet={connectWallet}\r\n            library={library}\r\n            account={account}\r\n            positionsMap={positionsMap}\r\n            fromTokenAddress={fromTokenAddress}\r\n            setFromTokenAddress={setFromTokenAddress}\r\n            toTokenAddress={toTokenAddress}\r\n            setToTokenAddress={setToTokenAddress}\r\n            swapOption={swapOption}\r\n            setSwapOption={setSwapOption}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            tokenSelection={tokenSelection}\r\n            setTokenSelection={setTokenSelection}\r\n            isConfirming={isConfirming}\r\n            setIsConfirming={setIsConfirming}\r\n            isPendingConfirmation={isPendingConfirmation}\r\n            setIsPendingConfirmation={setIsPendingConfirmation}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            setSavedIsPnlInLeverage={setSavedIsPnlInLeverage}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            savedSlippageAmount={savedSlippageAmount}\r\n            totalTokenWeights={totalTokenWeights}\r\n            usdgSupply={usdgSupply}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            minExecutionFee={minExecutionFee}\r\n            minExecutionFeeUSD={minExecutionFeeUSD}\r\n            minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n            positionsGNS={positionsGNS}\r\n            pendingPositionsGNS={pendingPositionsGNS}\r\n            setPendingPositionsGNS={setPendingPositionsGNS}\r\n          />\r\n        </div>\r\n        <div className=\"Exchange-lists large\">{getListSection()}</div>\r\n        <div className=\"Exchange-lists small\">{getListSection()}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n});","// date format: d MMM yyyy, H:mm, time should be specifed based on UTC time\r\n\r\nexport const homeEventsData = [\r\n  {\r\n    id: \"app-gmx-io-launch\",\r\n    title: \"Frontend Updates\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"Updates have been applied to the GMX frontend to inform users of the separation between gmx.io and app.gmx.io\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"arbitrum-nitro-upgrade\",\r\n    title: \"Arbitrum Nitro Upgrade\",\r\n    isActive: true,\r\n    validTill: \"31 Aug 2022, 20:00\",\r\n    bodyText: \"The Arbitrum Nitro upgrade has been completed.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/arbitrum-nitro-5f88c03a46fe\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nexport const appEventsData = [\r\n  // {\r\n  //   id: \"removal-of-min-profit-rule\",\r\n  //   title: \"Trading improvements\",\r\n  //   isActive: true,\r\n  //   validTill: \"1 Apr 2022, 12:00\",\r\n  //   bodyText: \"The 1.5% minimum profit rule has been removed\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read more\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/roadmap#30-march-2022\",\r\n  //       newTab: true,\r\n  //     },\r\n  //     {\r\n  //       text: \"Trade Now\",\r\n  //       link: \"https://gmx.io/trade\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"shorting-of-link-uni-re-enabled\",\r\n  //   title: \"Shorting of LINK and UNI\",\r\n  //   isActive: true,\r\n  //   validTill: \"20 Apr 2022, 12:00\",\r\n  //   bodyText: \"Shorting has been re-enabled for LINK and UNI.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Trade Now\",\r\n  //       link: \"https://gmx.io/trade\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"speed-up-page-loading\",\r\n  //   title: \"Speed Up Page Loading\",\r\n  //   isActive: true,\r\n  //   validTill: \"4 May 2022, 12:00\",\r\n  //   bodyText: \"If you experience data loading issues, please use a free RPC URL from Alchemy.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Learn More\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"referral-program-launch\",\r\n  //   title: \"Referral Program Launch\",\r\n  //   isActive: true,\r\n  //   validTill: \"4 May 2022, 12:00\",\r\n  //   bodyText: \"The GMX referral program is now live! Get fee discounts and refer traders to earn rewards.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://gmx.io/referrals\",\r\n  //     },\r\n  //     {\r\n  //       text: \"Join Now\",\r\n  //       link: \"https://gmx.io/referrals\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"gmx-arbitrum-odyssey\",\r\n  //   title: \"GMX Arbitrum Odyssey\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"The GMX Arbitrum Odyssey is taking place this week, all participants will receive prizes. Read on to find out more.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://medium.com/@gmx.io/gmx-arbitrum-odyssey-fc12cba2d10d\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"fix-arbitrum-transaction-issues\",\r\n  //   title: \"Fix Arbitrum Transactions\",\r\n  //   isActive: true,\r\n  //   validTill: \"30 Jun 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"If you experience transaction errors on Arbitrum or data loading issues, please use a free RPC URL from Alchemy.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Learn More\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"gmx-arbitrum-odyssey-paused\",\r\n  //   title: \"GMX Arbitrum Odyssey Paused\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText: \"The GMX Arbitrum Odyssey has been paused. Please read the linked post for more information.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://twitter.com/GMX_IO/status/1542163585111150592\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"app-gmx-io\",\r\n  //   title: \"Frontend Updates\",\r\n  //   isActive: true,\r\n  //   validTill: \"6 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"On 6 Jul 2022, updates will be applied to the GMX frontend to inform users of the separation between gmx.io and app.gmx.io\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"degraded-alchemy-performance\",\r\n  //   title: \"Alchemy RPC\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"There are ongoing syncing issues on Alchemy for Arbitrum at the moment, please check their status page and use the public Arbitrum RPC in the meantime\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Check Status\",\r\n  //       link: \"https://status.alchemy.com/\",\r\n  //       newTab: true,\r\n  //     },\r\n  //     {\r\n  //       text: \"Public RPC URL\",\r\n  //       link: \"https://metamask.zendesk.com/hc/en-us/articles/4415758358299-Network-profile-Arbitrum\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  {\r\n    id: \"app-gmx-io-settings\",\r\n    title: \"Frontend Updates\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"You are currently using app.gmx.io. Customized settings have been reset, you may need to adjust your settings by clicking on the menu in the top right after connecting your wallet.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"use-alchemy-rpc-url\",\r\n    title: \"Use Alchemy RPC URL\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"If you experience data loading or transaction issues on Arbitrum, please use a free RPC URL from Alchemy.\",\r\n    buttons: [\r\n      {\r\n        text: \"Learn More\",\r\n        link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"arbitrum-nitro-upgrade\",\r\n    title: \"Arbitrum Nitro Upgrade\",\r\n    isActive: true,\r\n    validTill: \"31 Aug 2022, 20:00\",\r\n    bodyText: \"The Arbitrum Nitro upgrade has been completed.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/arbitrum-nitro-5f88c03a46fe\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n];\r\n","function Icon({ className }) {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      aria-hidden=\"true\"\r\n      className={className}\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"2\"\r\n        d=\"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z\"\r\n      ></path>\r\n    </svg>\r\n  );\r\n}\r\n\r\nexport default Icon;\r\n","import \"./EventToast.css\";\r\nimport Icon from \"./AnnouncementIcon\";\r\nimport { MdOutlineClose } from \"react-icons/md\";\r\n\r\nexport default function EventToast({ event, id, onClick, t }) {\r\n  return (\r\n    <div className={`single-toast ${t.visible ? \"zoomIn\" : \"zoomOut\"}`} key={id}>\r\n      <header>\r\n        <div className=\"toast-title\">\r\n          <Icon className=\"announcement-icon\" />\r\n          <p>{event.title}</p>\r\n        </div>\r\n        <MdOutlineClose onClick={onClick} className=\"cross-icon\" color=\"white\" />\r\n      </header>\r\n      <p className=\"toast-body\">{event.bodyText}</p>\r\n      <div className=\"toast-links\">\r\n        {event.buttons.map((button) => {\r\n          if (button.newTab) {\r\n            return (\r\n              <a key={event.id + button.text} target=\"_blank\" rel=\"noreferrer noopener\" href={button.link}>\r\n                {button.text}\r\n              </a>\r\n            );\r\n          } else {\r\n            return (\r\n              <a key={event.id + button.text} href={button.link}>\r\n                {button.text}\r\n              </a>\r\n            );\r\n          }\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { useLocalStorage } from \"react-use\";\r\nimport toast from \"react-hot-toast\";\r\nimport { homeEventsData, appEventsData } from \"../../config/events\";\r\nimport { useEffect } from \"react\";\r\nimport EventToast from \"./EventToast\";\r\nimport { isFuture, parse } from \"date-fns\";\r\nimport { isHomeSite } from \"../../lib/legacy\";\r\n\r\nfunction useEventToast() {\r\n  const isHome = isHomeSite();\r\n  const [visited, setVisited] = useLocalStorage(\"visited-announcements\", []);\r\n\r\n  useEffect(() => {\r\n    const eventsData = isHome ? homeEventsData : appEventsData;\r\n\r\n    eventsData\r\n      .filter((event) => event.isActive)\r\n      .filter((event) => isFuture(parse(event.validTill + \", +00\", \"d MMM yyyy, H:mm, x\", new Date())))\r\n      .filter((event) => Array.isArray(visited) && !visited.includes(event.id))\r\n      .forEach((event) => {\r\n        toast.custom(\r\n          (t) => (\r\n            <EventToast\r\n              event={event}\r\n              id={event.id}\r\n              t={t}\r\n              onClick={() => {\r\n                toast.dismiss(event.id);\r\n                visited.push(event.id);\r\n                setVisited(visited);\r\n              }}\r\n            />\r\n          ),\r\n          {\r\n            id: event.id,\r\n            style: {},\r\n          }\r\n        );\r\n      });\r\n  }, [visited, setVisited, isHome]);\r\n}\r\n\r\nexport default useEventToast;\r\n","import { Toaster } from \"react-hot-toast\";\r\nimport { useWindowScroll, createBreakpoint } from \"react-use\";\r\n\r\nfunction EventToastContainer() {\r\n  let { y: scrollY } = useWindowScroll();\r\n  const useBreakpoint = createBreakpoint({ XL: 1033, L: 768, S: 350 });\r\n  const breakpoint = useBreakpoint();\r\n  return (\r\n    <Toaster\r\n      position=\"top-right\"\r\n      reverseOrder={true}\r\n      gutter={30}\r\n      containerClassName=\"event-toast-container\"\r\n      containerStyle={{\r\n        zIndex: 2,\r\n        transition: \"all 200ms\",\r\n        top: scrollY > 60 ? \"30px\" : `${93 - scrollY}px`,\r\n        right: breakpoint === \"XL\" ? \"30px\" : \"1rem\",\r\n      }}\r\n      toastOptions={{\r\n        duration: Infinity,\r\n      }}\r\n    />\r\n  );\r\n}\r\nexport default EventToastContainer;\r\n","import { Helmet } from \"react-helmet\";\r\n\r\nimport { t } from \"@lingui/macro\";\r\n\r\nfunction SEO(props) {\r\n  const { children, ...customMeta } = props;\r\n  const meta = {\r\n    title: t`GMX | Decentralized Perpetual Exchange`,\r\n    description: t`Trade spot or perpetual BTC, ETH, AVAX and other top cryptocurrencies with up to 30x leverage directly from your wallet on Arbitrum and Avalanche.`,\r\n    image: \"https://gmx.io/og.png\",\r\n    type: \"exchange\",\r\n    ...customMeta,\r\n  };\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{meta.title}</title>\r\n        <meta name=\"robots\" content=\"follow, index\" />\r\n        <meta content={meta.description} name=\"description\" />\r\n        <meta property=\"og:type\" content={meta.type} />\r\n        <meta property=\"og:site_name\" content=\"GMX\" />\r\n        <meta property=\"og:description\" content={meta.description} />\r\n        <meta property=\"og:title\" content={meta.title} />\r\n        <meta property=\"og:image\" content={meta.image} />\r\n        <meta name=\"twitter:card\" content=\"summary_large_image\" />\r\n        <meta name=\"twitter:site\" content=\"@gmx_io\" />\r\n        <meta name=\"twitter:title\" content={meta.title} />\r\n        <meta name=\"twitter:description\" content={meta.description} />\r\n        <meta name=\"twitter:image\" content={meta.image} />\r\n      </Helmet>\r\n      {children}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default SEO;\r\n","import \"./RedirectModal.css\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\n\r\nexport function RedirectPopupModal({\r\n  redirectModalVisible,\r\n  setRedirectModalVisible,\r\n  appRedirectUrl,\r\n  setRedirectPopupTimestamp,\r\n  setShouldHideRedirectModal,\r\n  shouldHideRedirectModal,\r\n  removeRedirectPopupTimestamp,\r\n}) {\r\n  const onClickAgree = () => {\r\n    if (shouldHideRedirectModal) {\r\n      setRedirectPopupTimestamp(Date.now());\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      className=\"RedirectModal\"\r\n      isVisible={redirectModalVisible}\r\n      setIsVisible={setRedirectModalVisible}\r\n      label=\"Launch App\"\r\n    >\r\n      You are leaving GMX.io and will be redirected to a third party, independent website.\r\n      <br />\r\n      <br />\r\n      The website is a community deployed and maintained instance of the open source{\" \"}\r\n      <a href=\"https://github.com/gmx-io/gmx-interface\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        GMX front end\r\n      </a>\r\n      , hosted and served on the distributed, peer-to-peer{\" \"}\r\n      <a href=\"https://ipfs.io/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        IPFS network\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      Alternative links can be found in the{\" \"}\r\n      <a href=\"https://gmxio.gitbook.io/gmx/app-links\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        docs\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      By clicking Agree you accept the{\" \"}\r\n      <a href=\"https://gmx.io/#/terms-and-conditions\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        T&Cs\r\n      </a>{\" \"}\r\n      and{\" \"}\r\n      <a href=\"https://gmx.io/#/referral-terms\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        Referral T&Cs\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      <div className=\"mb-sm\">\r\n        <Checkbox isChecked={shouldHideRedirectModal} setIsChecked={setShouldHideRedirectModal}>\r\n          Don't show this message again for 30 days.\r\n        </Checkbox>\r\n      </div>\r\n      <a href={appRedirectUrl} className=\"App-cta Exchange-swap-button\" onClick={() => onClickAgree()}>\r\n        Agree\r\n      </a>\r\n    </Modal>\r\n  );\r\n}\r\n","import { i18n } from \"@lingui/core\";\r\nimport { en, es, zh, ko, ru, ja, fr } from \"make-plural/plurals\";\r\nimport { LANGUAGE_LOCALSTORAGE_KEY } from \"./legacy\";\r\n\r\nexport const locales = {\r\n  en: \"English\",\r\n  es: \"Spanish\",\r\n  // zh: \"Chinese\",\r\n  ko: \"Korean\",\r\n  // ru: \"Russian\",\r\n  ja: \"Japanese\",\r\n  // fr: \"French\",\r\n};\r\n\r\nexport const defaultLocale = \"en\";\r\n\r\ni18n.loadLocaleData({\r\n  en: { plurals: en },\r\n  es: { plurals: es },\r\n  zh: { plurals: zh },\r\n  ko: { plurals: ko },\r\n  ru: { plurals: ru },\r\n  ja: { plurals: ja },\r\n  fr: { plurals: fr },\r\n});\r\n\r\nexport async function dynamicActivate(locale) {\r\n  // const { messages } = await import(`@lingui/loader!../config/locales/${locale}/messages.po`);\r\n  localStorage.setItem(LANGUAGE_LOCALSTORAGE_KEY, locale);\r\n  // i18n.load(locale, messages);\r\n  i18n.activate(locale);\r\n}\r\n","import React, { useState, useEffect, useCallback, useRef } from \"react\";\r\nimport { SWRConfig } from \"swr\";\r\nimport { ethers } from \"ethers\";\r\nimport { Web3ReactProvider, useWeb3React } from \"@web3-react/core\";\r\nimport { Web3Provider } from \"@ethersproject/providers\";\r\n\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\n\r\nimport {\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  SLIPPAGE_BPS_KEY,\r\n  IS_PNL_IN_LEVERAGE_KEY,\r\n  SHOW_PNL_AFTER_FEES_KEY,\r\n  BASIS_POINTS_DIVISOR,\r\n  SHOULD_SHOW_POSITION_LINES_KEY,\r\n  getAppBaseUrl,\r\n  isHomeSite,\r\n  clearWalletConnectData,\r\n  helperToast,\r\n  getAlchemyWsUrl,\r\n  useChainId,\r\n  getInjectedHandler,\r\n  useEagerConnect,\r\n  useLocalStorageSerializeKey,\r\n  useInactiveListener,\r\n  getExplorerUrl,\r\n  activateInjectedProvider,\r\n  clearWalletLinkData,\r\n  SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY,\r\n  CURRENT_PROVIDER_LOCALSTORAGE_KEY,\r\n  REFERRAL_CODE_KEY,\r\n  REFERRAL_CODE_QUERY_PARAM,\r\n  isDevelopment,\r\n  DISABLE_ORDER_VALIDATION_KEY,\r\n} from \"../lib/legacy\";\r\n\r\nimport { Exchange } from \"../pages/Exchange/Exchange\";\r\n\r\nimport { cssTransition, ToastContainer } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Modal from \"../components/Modal/Modal\";\r\nimport Checkbox from \"../components/Checkbox/Checkbox\";\r\n\r\nimport \"../styles/Shared.scss\";\r\nimport \"../styles/Font.css\";\r\nimport \"./App.scss\";\r\nimport \"../styles/Input.scss\";\r\nimport useEventToast from \"../components/EventToast/useEventToast\";\r\nimport EventToastContainer from \"../components/EventToast/EventToastContainer\";\r\nimport SEO from \"../components/Common/SEO\";\r\nimport useRouteQuery from \"../lib/useRouteQuery\";\r\nimport { encodeReferralCode, decodeReferralCode } from \"../domain/referrals\";\r\n\r\nimport { getContract } from \"../config/Addresses\";\r\nimport VaultV2 from \"../abis/VaultV2.json\";\r\nimport VaultV2b from \"../abis/VaultV2b.json\";\r\nimport PositionRouter from \"../abis/PositionRouter.json\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { RedirectPopupModal } from \"../components/ModalViews/RedirectModal\";\r\nimport { REDIRECT_POPUP_TIMESTAMP_KEY } from \"../config/ui\";\r\n\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { defaultLocale, dynamicActivate } from \"../lib/i18n\";\r\n\r\nimport _AccountManager from \"../../../deployments/arbitrum_ddl/accountManager.json\";\r\n\r\nif (\"ethereum\" in window) {\r\n  window.ethereum.autoRefreshOnNetworkChange = false;\r\n}\r\n\r\nfunction getLibrary(provider) {\r\n  const library = new Web3Provider(provider);\r\n  return library;\r\n}\r\n\r\nconst Jelly = cssTransition({\r\n  enter: \"jellyIn\",\r\n  exit: \"jellyOut\",\r\n});\r\n\r\nconst arbWsProvider = new ethers.providers.WebSocketProvider(getAlchemyWsUrl());\r\n\r\nconst avaxWsProvider = new ethers.providers.JsonRpcProvider(\"https://api.avax.network/ext/bc/C/rpc\");\r\n\r\nfunction getWsProvider(active, chainId) {\r\n  if (!active) {\r\n    return;\r\n  }\r\n  if (chainId === ARBITRUM) {\r\n    return arbWsProvider;\r\n  }\r\n\r\n  if (chainId === AVALANCHE) {\r\n    return avaxWsProvider;\r\n  }\r\n}\r\n\r\nfunction FullApp(props) {\r\n  const { setRegisterVisible } = props; \r\n  const isHome = isHomeSite();\r\n  const exchangeRef = useRef();\r\n  const { connector, library, deactivate, activate, active } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n  const location = useLocation();\r\n  const history = useNavigate();\r\n  useEventToast();\r\n  const [activatingConnector, setActivatingConnector] = useState();\r\n  useEffect(() => {\r\n    if (activatingConnector && activatingConnector === connector) {\r\n      setActivatingConnector(undefined);\r\n    }\r\n  }, [activatingConnector, connector, chainId]);\r\n  const triedEager = useEagerConnect(setActivatingConnector);\r\n  useInactiveListener(!triedEager || !!activatingConnector);\r\n\r\n  const query = useRouteQuery();\r\n\r\n  useEffect(() => {\r\n    let referralCode = query.get(REFERRAL_CODE_QUERY_PARAM);\r\n    if (!referralCode || referralCode.length === 0) {\r\n      const params = new URLSearchParams(window.location.search);\r\n      referralCode = params.get(REFERRAL_CODE_QUERY_PARAM);\r\n    }\r\n\r\n    if (referralCode && referralCode.length <= 20) {\r\n      const encodedReferralCode = encodeReferralCode(referralCode);\r\n      if (encodeReferralCode !== ethers.constants.HashZero) {\r\n        localStorage.setItem(REFERRAL_CODE_KEY, encodedReferralCode);\r\n        const queryParams = new URLSearchParams(location.search);\r\n        if (queryParams.has(REFERRAL_CODE_QUERY_PARAM)) {\r\n          queryParams.delete(REFERRAL_CODE_QUERY_PARAM);\r\n          history.replace({\r\n            search: queryParams.toString(),\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }, [query, history, location]);\r\n\r\n  const disconnectAccount = useCallback(() => {\r\n    // only works with WalletConnect\r\n    clearWalletConnectData();\r\n    // force clear localStorage connection for MM/CB Wallet (Brave legacy)\r\n    clearWalletLinkData();\r\n    deactivate();\r\n  }, [deactivate]);\r\n\r\n  const connectInjectedWallet = getInjectedHandler(activate);\r\n\r\n  useEffect(() => {\r\n    attemptActivateWallet(\"MetaMask\");\r\n  }, [props.walletAddress])\r\n  \r\n\r\n  const attemptActivateWallet = (providerName) => {\r\n    localStorage.setItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY, true);\r\n    localStorage.setItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY, providerName);\r\n    activateInjectedProvider(providerName);\r\n    connectInjectedWallet();\r\n  };\r\n\r\n  const [redirectModalVisible, setRedirectModalVisible] = useState(false);\r\n  const [shouldHideRedirectModal, setShouldHideRedirectModal] = useState(false);\r\n  const [redirectPopupTimestamp, setRedirectPopupTimestamp, removeRedirectPopupTimestamp] =\r\n    useLocalStorage(REDIRECT_POPUP_TIMESTAMP_KEY);\r\n  const [selectedToPage, setSelectedToPage] = useState(\"\");\r\n  // const connectWallet = () => setWalletModalVisible(true);\r\n  const connectWallet = () => {\r\n    props.connectWallet();\r\n    attemptActivateWallet(\"MetaMask\");\r\n  };\r\n\r\n  const [isSettingsVisible, setIsSettingsVisible] = useState(false);\r\n  const [savedSlippageAmount, setSavedSlippageAmount] = useLocalStorageSerializeKey(\r\n    [chainId, SLIPPAGE_BPS_KEY],\r\n    DEFAULT_SLIPPAGE_AMOUNT\r\n  );\r\n  \r\n  const [slippageAmount, setSlippageAmount] = useState(0);\r\n  const [isPnlInLeverage, setIsPnlInLeverage] = useState(false);\r\n  const [shouldDisableValidationForTesting, setShouldDisableValidationForTesting] = useState(false);\r\n  const [showPnlAfterFees, setShowPnlAfterFees] = useState(false);\r\n\r\n  const [savedIsPnlInLeverage, setSavedIsPnlInLeverage] = useLocalStorageSerializeKey(\r\n    [chainId, IS_PNL_IN_LEVERAGE_KEY],\r\n    false\r\n  );\r\n\r\n  const [savedShowPnlAfterFees, setSavedShowPnlAfterFees] = useLocalStorageSerializeKey(\r\n    [chainId, SHOW_PNL_AFTER_FEES_KEY],\r\n    false\r\n  );\r\n  const [savedShouldDisableValidationForTesting, setSavedShouldDisableValidationForTesting] =\r\n    useLocalStorageSerializeKey([chainId, DISABLE_ORDER_VALIDATION_KEY], false);\r\n\r\n  const [savedShouldShowPositionLines, setSavedShouldShowPositionLines] = useLocalStorageSerializeKey(\r\n    [chainId, SHOULD_SHOW_POSITION_LINES_KEY],\r\n    false\r\n  );\r\n\r\n  const saveAndCloseSettings = () => {\r\n    const slippage = parseFloat(slippageAmount);\r\n    if (isNaN(slippage)) {\r\n      helperToast.error(t`Invalid slippage value`);\r\n      return;\r\n    }\r\n    if (slippage > 5) {\r\n      helperToast.error(t`Slippage should be less than 5%`);\r\n      return;\r\n    }\r\n\r\n    const basisPoints = (slippage * BASIS_POINTS_DIVISOR) / 100;\r\n    if (parseInt(basisPoints) !== parseFloat(basisPoints)) {\r\n      helperToast.error(t`Max slippage precision is 0.01%`);\r\n      return;\r\n    }\r\n\r\n    setSavedIsPnlInLeverage(isPnlInLeverage);\r\n    setSavedShowPnlAfterFees(showPnlAfterFees);\r\n    setSavedShouldDisableValidationForTesting(shouldDisableValidationForTesting);\r\n    setSavedSlippageAmount(basisPoints);\r\n    setIsSettingsVisible(false);\r\n  };\r\n\r\n  const localStorageCode = window.localStorage.getItem(REFERRAL_CODE_KEY);\r\n  const baseUrl = getAppBaseUrl();\r\n  let appRedirectUrl = baseUrl + selectedToPage;\r\n  if (localStorageCode && localStorageCode.length > 0 && localStorageCode !== ethers.constants.HashZero) {\r\n    const decodedRefCode = decodeReferralCode(localStorageCode);\r\n    if (decodedRefCode) {\r\n      appRedirectUrl = `${appRedirectUrl}?ref=${decodedRefCode}`;\r\n    }\r\n  }\r\n\r\n  const [pendingTxns, setPendingTxns] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const checkPendingTxns = async () => {\r\n      const updatedPendingTxns = [];\r\n      for (let i = 0; i < pendingTxns.length; i++) {\r\n        const pendingTxn = pendingTxns[i];\r\n        const receipt = await library.getTransactionReceipt(pendingTxn.hash);\r\n        if (receipt) {\r\n          if (receipt.status === 0) {\r\n            const txUrl = getExplorerUrl(chainId) + \"tx/\" + pendingTxn.hash;\r\n            helperToast.error(\r\n              <div>\r\n                <Trans>Txn failed.</Trans>{\" \"}\r\n                <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>View</Trans>\r\n                </a>\r\n                <br />\r\n              </div>\r\n            );\r\n          }\r\n          if (receipt.status === 1 && pendingTxn.message) {\r\n            const txUrl = getExplorerUrl(chainId) + \"tx/\" + pendingTxn.hash;\r\n            helperToast.success(\r\n              <div>\r\n                {pendingTxn.message}{\" \"}\r\n                <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>View</Trans>\r\n                </a>\r\n                <br />\r\n              </div>\r\n            );\r\n          }\r\n          continue;\r\n        }\r\n        updatedPendingTxns.push(pendingTxn);\r\n      }\r\n\r\n      if (updatedPendingTxns.length !== pendingTxns.length) {\r\n        setPendingTxns(updatedPendingTxns);\r\n      }\r\n    };\r\n\r\n    const interval = setInterval(() => {\r\n      checkPendingTxns();\r\n    }, 2 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [library, pendingTxns, chainId]);\r\n\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n\r\n  useEffect(() => {\r\n    const wsVaultAbi = chainId === ARBITRUM ? VaultV2.abi : VaultV2b.abi;\r\n    const wsProvider = getWsProvider(active, chainId);\r\n    if (!wsProvider) {\r\n      return;\r\n    }\r\n\r\n    const wsVault = new ethers.Contract(vaultAddress, wsVaultAbi, wsProvider);\r\n    const wsPositionRouter = new ethers.Contract(positionRouterAddress, PositionRouter.abi, wsProvider);\r\n\r\n    const callExchangeRef = (method, ...args) => {\r\n      if (!exchangeRef || !exchangeRef.current) {\r\n        return;\r\n      }\r\n\r\n      exchangeRef.current[method](...args);\r\n    };\r\n\r\n    // handle the subscriptions here instead of within the Exchange component to avoid unsubscribing and re-subscribing\r\n    // each time the Exchange components re-renders, which happens on every data update\r\n    const onUpdatePosition = (...args) => callExchangeRef(\"onUpdatePosition\", ...args);\r\n    const onClosePosition = (...args) => callExchangeRef(\"onClosePosition\", ...args);\r\n    const onIncreasePosition = (...args) => callExchangeRef(\"onIncreasePosition\", ...args);\r\n    const onDecreasePosition = (...args) => callExchangeRef(\"onDecreasePosition\", ...args);\r\n    const onCancelIncreasePosition = (...args) => callExchangeRef(\"onCancelIncreasePosition\", ...args);\r\n    const onCancelDecreasePosition = (...args) => callExchangeRef(\"onCancelDecreasePosition\", ...args);\r\n\r\n    wsVault.on(\"UpdatePosition\", onUpdatePosition);\r\n    wsVault.on(\"ClosePosition\", onClosePosition);\r\n    wsVault.on(\"IncreasePosition\", onIncreasePosition);\r\n    wsVault.on(\"DecreasePosition\", onDecreasePosition);\r\n    wsPositionRouter.on(\"CancelIncreasePosition\", onCancelIncreasePosition);\r\n    wsPositionRouter.on(\"CancelDecreasePosition\", onCancelDecreasePosition);\r\n\r\n    return function cleanup() {\r\n      wsVault.off(\"UpdatePosition\", onUpdatePosition);\r\n      wsVault.off(\"ClosePosition\", onClosePosition);\r\n      wsVault.off(\"IncreasePosition\", onIncreasePosition);\r\n      wsVault.off(\"DecreasePosition\", onDecreasePosition);\r\n      wsPositionRouter.off(\"CancelIncreasePosition\", onCancelIncreasePosition);\r\n      wsPositionRouter.off(\"CancelDecreasePosition\", onCancelDecreasePosition);\r\n    };\r\n  }, [active, chainId, vaultAddress, positionRouterAddress]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"App GMX-Interface\">\r\n        <div className=\"App-content\">\r\n          <Exchange\r\n            ref={exchangeRef}\r\n            savedShowPnlAfterFees={savedShowPnlAfterFees}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            setSavedIsPnlInLeverage={setSavedIsPnlInLeverage}\r\n            savedSlippageAmount={savedSlippageAmount}\r\n            setPendingTxns={setPendingTxns}\r\n            pendingTxns={pendingTxns}\r\n            savedShouldShowPositionLines={savedShouldShowPositionLines}\r\n            setSavedShouldShowPositionLines={setSavedShouldShowPositionLines}\r\n            connectWallet={connectWallet}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            dgAddress={props.dgAddress}\r\n            walletAddress={props.walletAddress}\r\n            setRegisterVisible={setRegisterVisible}\r\n          />\r\n        </div>\r\n      </div>\r\n      <ToastContainer\r\n        limit={1}\r\n        transition={Jelly}\r\n        position=\"bottom-right\"\r\n        // autoClose={}\r\n        hideProgressBar={true}\r\n        newestOnTop={false}\r\n        closeOnClick={false}\r\n        draggable={false}\r\n        pauseOnHover\r\n      />\r\n      <EventToastContainer />\r\n      <RedirectPopupModal\r\n        redirectModalVisible={redirectModalVisible}\r\n        setRedirectModalVisible={setRedirectModalVisible}\r\n        appRedirectUrl={appRedirectUrl}\r\n        setRedirectPopupTimestamp={setRedirectPopupTimestamp}\r\n        setShouldHideRedirectModal={setShouldHideRedirectModal}\r\n        shouldHideRedirectModal={shouldHideRedirectModal}\r\n        removeRedirectPopupTimestamp={removeRedirectPopupTimestamp}\r\n      />\r\n      <Modal\r\n        className=\"App-settings\"\r\n        isVisible={isSettingsVisible}\r\n        setIsVisible={setIsSettingsVisible}\r\n        label=\"Settings\"\r\n      >\r\n        <div className=\"App-settings-row\">\r\n          <div>\r\n            <Trans>Allowed Slippage</Trans>\r\n          </div>\r\n          <div className=\"App-slippage-tolerance-input-container\">\r\n            <input\r\n              type=\"number\"\r\n              className=\"App-slippage-tolerance-input\"\r\n              min=\"0\"\r\n              value={slippageAmount}\r\n              onChange={(e) => setSlippageAmount(e.target.value)}\r\n            />\r\n            <div className=\"App-slippage-tolerance-input-percent\">%</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-settings-row\">\r\n          <Checkbox isChecked={showPnlAfterFees} setIsChecked={setShowPnlAfterFees}>\r\n            <Trans>Display PnL after fees</Trans>\r\n          </Checkbox>\r\n        </div>\r\n        <div className=\"Exchange-settings-row\">\r\n          <Checkbox isChecked={isPnlInLeverage} setIsChecked={setIsPnlInLeverage}>\r\n            <Trans>Include PnL in leverage display</Trans>\r\n          </Checkbox>\r\n        </div>\r\n        {isDevelopment() && (\r\n          <div className=\"Exchange-settings-row\">\r\n            <Checkbox isChecked={shouldDisableValidationForTesting} setIsChecked={setShouldDisableValidationForTesting}>\r\n              <Trans>Disable order validations</Trans>\r\n            </Checkbox>\r\n          </div>\r\n        )}\r\n\r\n        <button className=\"App-cta Exchange-swap-button\" onClick={saveAndCloseSettings}>\r\n          <Trans>Save</Trans>\r\n        </button>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction GMXInterface(props) {\r\n  useEffect(() => {\r\n    const defaultLanguage = defaultLocale;\r\n    dynamicActivate(defaultLanguage);\r\n  }, []);\r\n\r\n  return (\r\n    <SWRConfig value={{ refreshInterval: 5000 }}>\r\n      <Web3ReactProvider getLibrary={getLibrary}>\r\n        <SEO>\r\n          {/* <I18nProvider i18n={i18n}> */}\r\n            <FullApp {...props} />\r\n          {/* </I18nProvider> */}\r\n        </SEO>\r\n      </Web3ReactProvider>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default GMXInterface;","import React from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nexport default function useRouteQuery() {\r\n  const { search } = useLocation();\r\n  return React.useMemo(() => new URLSearchParams(search), [search]);\r\n}\r\n","const CONTRACTS = {\r\n  56: {\r\n    // bsc mainnet\r\n    Treasury: \"0xa44E7252a0C137748F523F112644042E5987FfC7\",\r\n    BUSD: \"0xe9e7cea3dedca5984780bafc599bd69add087d56\",\r\n    GMT: \"0x99e92123eB77Bc8f999316f622e5222498438784\",\r\n    Vault: \"0xc73A8DcAc88498FD4b4B1b2AaA37b0a2614Ff67B\",\r\n    Router: \"0xD46B23D042E976F8666F554E928e0Dc7478a8E1f\",\r\n    Reader: \"0x087A618fD25c92B61254DBe37b09E5E8065FeaE7\",\r\n    AmmFactory: \"0xBCfCcbde45cE874adCB698cC183deBcF17952812\",\r\n    AmmFactoryV2: \"0xcA143Ce32Fe78f1f7019d7d551a6402fC5350c73\",\r\n    OrderBook: \"0x1111111111111111111111111111111111111111\",\r\n    OrderBookReader: \"0x1111111111111111111111111111111111111111\",\r\n    GmxMigrator: \"0xDEF2af818514c1Ca1A9bBe2a4D45E28f260063f9\",\r\n    USDG: \"0x85E76cbf4893c1fbcB34dCF1239A91CE2A4CF5a7\",\r\n    NATIVE_TOKEN: \"0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c\",\r\n    XGMT: \"0xe304ff0983922787Fd84BC9170CD21bF78B16B10\",\r\n    GMT_USDG_PAIR: \"0xa41e57459f09a126F358E118b693789d088eA8A0\",\r\n    XGMT_USDG_PAIR: \"0x0b622208fc0691C2486A3AE6B7C875b4A174b317\",\r\n    GMT_USDG_FARM: \"0x3E8B08876c791dC880ADC8f965A02e53Bb9C0422\",\r\n    XGMT_USDG_FARM: \"0x68D7ee2A16AB7c0Ee1D670BECd144166d2Ae0759\",\r\n    USDG_YIELD_TRACKER: \"0x0EF0Cf825B8e9F89A43FfD392664131cFB4cfA89\",\r\n    XGMT_YIELD_TRACKER: \"0x82A012A9b3003b18B6bCd6052cbbef7Fa4892e80\",\r\n    GMT_USDG_FARM_TRACKER_XGMT: \"0x08FAb024BEfcb6068847726b2eccEAd18b6c23Cd\",\r\n    GMT_USDG_FARM_TRACKER_NATIVE: \"0xd8E26637B34B2487Cad1f91808878a391134C5c2\",\r\n    XGMT_USDG_FARM_TRACKER_XGMT: \"0x026A02F7F26C1AFccb9Cba7C4df3Dc810F4e92e8\",\r\n    XGMT_USDG_FARM_TRACKER_NATIVE: \"0x22458CEbD14a9679b2880147d08CA1ce5aa40E84\",\r\n    AUTO: \"0xa184088a740c695E156F91f5cC086a06bb78b827\",\r\n    AUTO_USDG_PAIR: \"0x0523FD5C53ea5419B4DAF656BC1b157dDFE3ce50\",\r\n    AUTO_USDG_FARM: \"0xE6958298328D02051769282628a3b4178D0F3A47\",\r\n    AUTO_USDG_FARM_TRACKER_XGMT: \"0x093b8be41c1A30704De84a9521632f9a139c08bd\",\r\n    AUTO_USDG_FARM_TRACKER_NATIVE: \"0x23ed48E5dce3acC7704d0ce275B7b9a0e346b63A\",\r\n    GMT_GMX_IOU: \"0x47052469970C2484729875CC9E2dd2683fcE71fb\",\r\n    XGMT_GMX_IOU: \"0xeB3733DFe3b68C9d26898De2493A3Bb59FDb4A7B\",\r\n    GMT_USDG_GMX_IOU: \"0x481312655F81b5e249780A6a49735335BF6Ca7f4\",\r\n    XGMT_USDG_GMX_IOU: \"0x8095F1A92526C304623483018aA28cC6E62EB1e1\",\r\n  },\r\n  97: {\r\n    // bsc testnet\r\n    Vault: \"0x1B183979a5cd95FAF392c8002dbF0D5A1C687D9a\",\r\n    Router: \"0x10800f683aa564534497a5b67F45bE3556a955AB\",\r\n    Reader: \"0x98D4742F1B6a821bae672Cd8721283b91996E454\",\r\n    AmmFactory: \"0x6725f303b657a9451d8ba641348b6761a6cc7a17\",\r\n    AmmFactoryV2: \"0x1111111111111111111111111111111111111111\",\r\n    OrderBook: \"0x9afD7B4f0b58d65F6b2978D3581383a06b2ac4e9\",\r\n    OrderBookReader: \"0x0713562970D1A802Fa3FeB1D15F9809943982Ea9\",\r\n    GmxMigrator: \"0xDEF2af818514c1Ca1A9bBe2a4D45E28f260063f9\",\r\n    USDG: \"0x2D549bdBf810523fe9cd660cC35fE05f0FcAa028\",\r\n    GMT: \"0xedba0360a44f885ed390fad01aa34d00d2532817\",\r\n    NATIVE_TOKEN: \"0x612777Eea37a44F7a95E3B101C39e1E2695fa6C2\",\r\n    XGMT: \"0x28cba798eca1a3128ffd1b734afb93870f22e613\",\r\n    GMT_USDG_PAIR: \"0xe0b0a315746f51932de033ab27223d85114c6b85\",\r\n    XGMT_USDG_PAIR: \"0x0108de1eea192ce8448080c3d90a1560cf643fa0\",\r\n    GMT_USDG_FARM: \"0xbe3cB06CE03cA692b77902040479572Ba8D01b0B\",\r\n    XGMT_USDG_FARM: \"0x138E92195D4B99CE3618092D3F9FA830d9A69B4b\",\r\n    USDG_YIELD_TRACKER: \"0x62B49Bc3bF252a5DB26D88ccc7E61119e3179B4f\",\r\n    XGMT_YIELD_TRACKER: \"0x5F235A582e0993eE9466FeEb8F7B4682993a57d0\",\r\n    GMT_USDG_FARM_TRACKER_XGMT: \"0x4f8EE3aE1152422cbCaFACd4e3041ba2D859913C\",\r\n    GMT_USDG_FARM_TRACKER_NATIVE: \"0xd691B26E544Fe370f39A776964c991363aF72e56\",\r\n    XGMT_USDG_FARM_TRACKER_XGMT: \"0xfd5617CFB082Ba9bcD62d654603972AE312bC695\",\r\n    XGMT_USDG_FARM_TRACKER_NATIVE: \"0x0354387DD85b7D8aaD1611B3D167A384d6AE0c28\",\r\n    GMT_GMX_IOU: \"0x47052469970C2484729875CC9E2dd2683fcE71fb\",\r\n    XGMT_GMX_IOU: \"0xeB3733DFe3b68C9d26898De2493A3Bb59FDb4A7B\",\r\n    GMT_USDG_GMX_IOU: \"0x481312655F81b5e249780A6a49735335BF6Ca7f4\",\r\n    XGMT_USDG_GMX_IOU: \"0x8095F1A92526C304623483018aA28cC6E62EB1e1\",\r\n  },\r\n  421611: {\r\n    // arbitrum testnet\r\n    Vault: \"0xBc9BC47A7aB63db1E0030dC7B60DDcDe29CF4Ffb\",\r\n    Router: \"0xe0d4662cdfa2d71477A7DF367d5541421FAC2547\",\r\n    VaultReader: \"0xFc371E380262536c819D12B9569106bf032cC41c\",\r\n    Reader: \"0x2E093c70E3A7E4919611d2555dFd8D697d2fC0a1\",\r\n    GlpManager: \"0xD875d99E09118d2Be80579b9d23E83469077b498\",\r\n    RewardRouter: \"0x0000000000000000000000000000000000000000\",\r\n    RewardReader: \"0x0000000000000000000000000000000000000000\",\r\n    NATIVE_TOKEN: \"0xB47e6A5f8b33b3F17603C83a0535A9dcD7E32681\",\r\n    GLP: \"0xb4f81Fa74e06b5f762A104e47276BA9b2929cb27\",\r\n    GMX: \"0x0000000000000000000000000000000000000000\",\r\n    ES_GMX: \"0x0000000000000000000000000000000000000000\",\r\n    BN_GMX: \"0x0000000000000000000000000000000000000000\",\r\n    USDG: \"0xBCDCaF67193Bf5C57be08623278fCB69f4cA9e68\",\r\n    ES_GMX_IOU: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    BonusGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    FeeGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGlpTracker: \"0x0000000000000000000000000000000000000000\",\r\n    FeeGlpTracker: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    StakedGmxDistributor: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGlpDistributor: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    GmxVester: \"0x0000000000000000000000000000000000000000\",\r\n    GlpVester: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    OrderBook: \"0xebD147E5136879520dDaDf1cA8FBa48050EFf016\",\r\n    OrderBookReader: \"0xC492c8d82DC576Ad870707bb40EDb63E2026111E\",\r\n\r\n    PositionRouter: \"0xB4bB78cd12B097603e2b55D2556c09C17a5815F8\",\r\n    PositionManager: \"0x168aDa266c2f10C1F37973B213d6178551030e44\",\r\n\r\n    // UniswapGmxEthPool: \"0x80A9ae39310abf666A87C743d6ebBD0E8C42158E\",\r\n    ReferralStorage: \"0x0000000000000000000000000000000000000000\",\r\n    ReferralReader: \"0x0000000000000000000000000000000000000000\",\r\n  },\r\n  42161: {\r\n    // arbitrum mainnet\r\n    Vault: \"0x489ee077994B6658eAfA855C308275EAd8097C4A\",\r\n    Router: \"0xaBBc5F99639c9B6bCb58544ddf04EFA6802F4064\",\r\n    VaultReader: \"0xfebB9f4CAC4cD523598fE1C5771181440143F24A\",\r\n    Reader: \"0x2b43c90D1B727cEe1Df34925bcd5Ace52Ec37694\",\r\n    GlpManager: \"0x3963FfC9dff443c2A94f21b129D429891E32ec18\",\r\n    RewardRouter: \"0xA906F338CB21815cBc4Bc87ace9e68c87eF8d8F1\",\r\n    GlpRewardRouter: \"0xB95DB5B167D75e6d04227CfFFA61069348d271F5\",\r\n    RewardReader: \"0x8BFb8e82Ee4569aee78D03235ff465Bd436D40E0\",\r\n    NATIVE_TOKEN: \"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1\",\r\n    GLP: \"0x4277f8F2c384827B5273592FF7CeBd9f2C1ac258\",\r\n    GMX: \"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a\",\r\n    ES_GMX: \"0xf42Ae1D54fd613C9bb14810b0588FaAa09a426cA\",\r\n    BN_GMX: \"0x35247165119B69A40edD5304969560D0ef486921\",\r\n    USDG: \"0x45096e7aA921f27590f8F19e457794EB09678141\",\r\n    ES_GMX_IOU: \"0x6260101218eC4cCfFF1b778936C6f2400f95A954\",\r\n    StakedGmxTracker: \"0x908C4D94D34924765f1eDc22A1DD098397c59dD4\",\r\n    BonusGmxTracker: \"0x4d268a7d4C16ceB5a606c173Bd974984343fea13\",\r\n    FeeGmxTracker: \"0xd2D1162512F927a7e282Ef43a362659E4F2a728F\",\r\n    StakedGlpTracker: \"0x1aDDD80E6039594eE970E5872D247bf0414C8903\",\r\n    FeeGlpTracker: \"0x4e971a87900b931fF39d1Aad67697F49835400b6\",\r\n\r\n    StakedGmxDistributor: \"0x23208B91A98c7C1CD9FE63085BFf68311494F193\",\r\n    StakedGlpDistributor: \"0x60519b48ec4183a61ca2B8e37869E675FD203b34\",\r\n\r\n    GmxVester: \"0x199070DDfd1CFb69173aa2F7e20906F26B363004\",\r\n    GlpVester: \"0xA75287d2f8b217273E7FCD7E86eF07D33972042E\",\r\n\r\n    OrderBook: \"0x09f77E8A13De9a35a7231028187e9fD5DB8a2ACB\",\r\n    OrderExecutor: \"0x7257ac5D0a0aaC04AA7bA2AC0A6Eb742E332c3fB\",\r\n    OrderBookReader: \"0xa27C20A7CF0e1C68C0460706bB674f98F362Bc21\",\r\n\r\n    PositionRouter: \"0xb87a436B93fFE9D75c5cFA7bAcFff96430b09868\",\r\n    PositionManager: \"0x75E42e6f01baf1D6022bEa862A28774a9f8a4A0C\",\r\n\r\n    UniswapGmxEthPool: \"0x80A9ae39310abf666A87C743d6ebBD0E8C42158E\",\r\n    ReferralStorage: \"0xe6fab3f0c7199b0d34d7fbe83394fc0e0d06e99d\",\r\n    ReferralReader: \"0x8Aa382760BCdCe8644C33e6C2D52f6304A76F5c8\",\r\n\r\n    Multicall: \"0xcA11bde05977b3631167028862bE2a173976CA11\",\r\n  },\r\n  43114: {\r\n    // avalanche\r\n    Vault: \"0x9ab2De34A33fB459b538c43f251eB825645e8595\",\r\n    Router: \"0x5F719c2F1095F7B9fc68a68e35B51194f4b6abe8\",\r\n    VaultReader: \"0x66eC8fc33A26feAEAe156afA3Cb46923651F6f0D\",\r\n    Reader: \"0x2eFEE1950ededC65De687b40Fd30a7B5f4544aBd\",\r\n    GlpManager: \"0xe1ae4d4b06A5Fe1fc288f6B4CD72f9F8323B107F\",\r\n    RewardRouter: \"0x82147C5A7E850eA4E28155DF107F2590fD4ba327\",\r\n    RewardReader: \"0x04Fc11Bd28763872d143637a7c768bD96E44c1b6\",\r\n    NATIVE_TOKEN: \"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7\",\r\n    GLP: \"0x01234181085565ed162a948b6a5e88758CD7c7b8\",\r\n    GMX: \"0x62edc0692BD897D2295872a9FFCac5425011c661\",\r\n    ES_GMX: \"0xFf1489227BbAAC61a9209A08929E4c2a526DdD17\",\r\n    BN_GMX: \"0x8087a341D32D445d9aC8aCc9c14F5781E04A26d2\",\r\n    USDG: \"0xc0253c3cC6aa5Ab407b5795a04c28fB063273894\",\r\n    ES_GMX_IOU: \"0x6260101218eC4cCfFF1b778936C6f2400f95A954\", // placeholder address\r\n\r\n    StakedGmxTracker: \"0x2bD10f8E93B3669b6d42E74eEedC65dd1B0a1342\",\r\n    BonusGmxTracker: \"0x908C4D94D34924765f1eDc22A1DD098397c59dD4\",\r\n    FeeGmxTracker: \"0x4d268a7d4C16ceB5a606c173Bd974984343fea13\",\r\n    StakedGlpTracker: \"0x9e295B5B976a184B14aD8cd72413aD846C299660\",\r\n    FeeGlpTracker: \"0xd2D1162512F927a7e282Ef43a362659E4F2a728F\",\r\n\r\n    StakedGmxDistributor: \"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a\",\r\n    StakedGlpDistributor: \"0xDd593Cf40734199afc9207eBe9ffF23dA4Bf7720\",\r\n\r\n    GmxVester: \"0x472361d3cA5F49c8E633FB50385BfaD1e018b445\",\r\n    GlpVester: \"0x62331A7Bd1dfB3A7642B7db50B5509E57CA3154A\",\r\n\r\n    OrderBook: \"0x4296e307f108B2f583FF2F7B7270ee7831574Ae5\",\r\n    OrderExecutor: \"0x4296e307f108B2f583FF2F7B7270ee7831574Ae5\",\r\n    OrderBookReader: \"0xccFE3E576f8145403d3ce8f3c2f6519Dae40683B\",\r\n\r\n    PositionRouter: \"0xffF6D276Bc37c61A23f06410Dce4A400f66420f8\",\r\n    PositionManager: \"0xA21B83E579f4315951bA658654c371520BDcB866\",\r\n\r\n    TraderJoeGmxAvaxPool: \"0x0c91a070f862666bbcce281346be45766d874d98\",\r\n    ReferralStorage: \"0x827ed045002ecdabeb6e2b0d1604cf5fc3d322f8\",\r\n    ReferralReader: \"0x505Ce16D3017be7D76a7C2631C0590E71A975083\",\r\n  },\r\n};\r\n\r\nexport function getContract(chainId, name, market) {\r\n  if (!CONTRACTS[chainId]) {\r\n    throw new Error(`Unknown chainId ${chainId}`);\r\n  }\r\n  if (!CONTRACTS[chainId][name]) {\r\n    throw new Error(`Unknown contract \"${name}\" for chainId ${chainId}`);\r\n  }\r\n  return CONTRACTS[chainId][name];\r\n}\r\n\r\nexport const XGMT_EXCLUDED_ACCOUNTS = [\r\n  \"0x330eef6b9b1ea6edd620c825c9919dc8b611d5d5\",\r\n  \"0xd9b1c23411adbb984b1c4be515fafc47a12898b2\",\r\n  \"0xa633158288520807f91ccc98aa58e0ea43acb400\",\r\n  \"0xffd0a93b4362052a336a7b22494f1b77018dd34b\",\r\n];\r\n","import { ethers } from \"ethers\";\r\nimport { getContract } from \"./Addresses\";\r\n\r\nconst TOKENS = {\r\n  56: [\r\n    {\r\n      name: \"Bitcoin (BTCB)\",\r\n      symbol: \"BTC\",\r\n      decimals: 18,\r\n      address: \"0x7130d2A12B9BCbFAe4f2634d864A1Ee1Ce3Ead9c\",\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-bitcoin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/14108/small/Binance-bitcoin.png\",\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: \"0x2170Ed0880ac9A755fd29B2688956BD959F933F8\",\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/ethereum\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png\",\r\n    },\r\n    {\r\n      name: \"Binance Coin\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/825/small/binance-coin-logo.png\",\r\n      isNative: true,\r\n    },\r\n    {\r\n      name: \"Wrapped Binance Coin\",\r\n      symbol: \"WBNB\",\r\n      decimals: 18,\r\n      address: getContract(56, \"NATIVE_TOKEN\"),\r\n      isWrapped: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/825/small/binance-coin-logo.png\",\r\n      baseSymbol: \"BNB\",\r\n    },\r\n    {\r\n      name: \"USD Gambit\",\r\n      symbol: \"USDG\",\r\n      decimals: 18,\r\n      address: getContract(56, \"USDG\"),\r\n      isUsdg: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/usd-gambit\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/15886/small/usdg-02.png\",\r\n    },\r\n    {\r\n      name: \"Binance USD\",\r\n      symbol: \"BUSD\",\r\n      decimals: 18,\r\n      address: \"0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-usd\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/9576/small/BUSD.png\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 18,\r\n      address: \"0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/small/USD_Coin_icon.png\",\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 18,\r\n      address: \"0x55d398326f99059fF775485246999027B3197955\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/tether\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/325/small/Tether-logo.png\",\r\n    },\r\n  ],\r\n  97: [\r\n    {\r\n      name: \"Bitcoin (BTCB)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0xb19C12715134bee7c4b1Ca593ee9E430dABe7b56\",\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: \"0x1958f7C067226c7C8Ac310Dc994D0cebAbfb2B02\",\r\n    },\r\n    {\r\n      name: \"Binance Coin\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n    },\r\n    {\r\n      name: \"Wrapped Binance Coin\",\r\n      symbol: \"WBNB\",\r\n      decimals: 18,\r\n      address: \"0x612777Eea37a44F7a95E3B101C39e1E2695fa6C2\",\r\n      isWrapped: true,\r\n      baseSymbol: \"BNB\",\r\n    },\r\n    {\r\n      name: \"USD Gambit\",\r\n      symbol: \"USDG\",\r\n      decimals: 18,\r\n      address: getContract(97, \"USDG\"),\r\n      isUsdg: true,\r\n    },\r\n    {\r\n      name: \"Binance USD\",\r\n      symbol: \"BUSD\",\r\n      decimals: 18,\r\n      address: \"0x3F223C4E5ac67099CB695834b20cCd5E5D5AA9Ef\",\r\n      isStable: true,\r\n    },\r\n  ],\r\n  421611: [\r\n    {\r\n      name: \"Bitcoin\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x27960f9A322BE96A1535E6c19B3958e80E6a2670\",\r\n      isShortable: true,\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n    },\r\n    // https://github.com/OffchainLabs/arbitrum/blob/950c2f91b2e951cd3764394e0a73eac3797aecf3/packages/arb-ts/src/lib/networks.ts#L65\r\n    {\r\n      name: \"Wrapped Ethereum\",\r\n      symbol: \"WETH\",\r\n      decimals: 18,\r\n      address: \"0xB47e6A5f8b33b3F17603C83a0535A9dcD7E32681\",\r\n      isWrapped: true,\r\n      baseSymbol: \"ETH\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xf0DCd4737A20ED33481A49De94C599944a3Ca737\",\r\n      isStable: true,\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 6,\r\n      address: \"0x818ED84bA1927945b631016e0d402Db50cE8865f\",\r\n      isStable: true,\r\n    },\r\n  ],\r\n  42161: [\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Wrapped Ethereum\",\r\n      symbol: \"WETH\",\r\n      decimals: 18,\r\n      address: \"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1\",\r\n      isWrapped: true,\r\n      baseSymbol: \"ETH\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/2518/thumb/weth.png?1628852295\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f\",\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n    {\r\n      name: \"Chainlink\",\r\n      symbol: \"LINK\",\r\n      decimals: 18,\r\n      address: \"0xf97f4df75117a78c1A5a0DBb814Af92458539FB4\",\r\n      isStable: false,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/877/thumb/chainlink-new-logo.png?1547034700\",\r\n    },\r\n    {\r\n      name: \"Uniswap\",\r\n      symbol: \"UNI\",\r\n      decimals: 18,\r\n      address: \"0xFa7F8980b0f1E64A2062791cc3b0871572f1F7f0\",\r\n      isStable: false,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12504/thumb/uniswap-uni.png?1600306604\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 6,\r\n      address: \"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/325/thumb/Tether-logo.png?1598003707\",\r\n    },\r\n    {\r\n      name: \"Dai\",\r\n      symbol: \"DAI\",\r\n      decimals: 18,\r\n      address: \"0xDA10009cBd5D07dd0CeCc66161FC93D7c9000da1\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/9956/thumb/4943.png?1636636734\",\r\n    },\r\n    {\r\n      name: \"Frax\",\r\n      symbol: \"FRAX\",\r\n      decimals: 18,\r\n      address: \"0x17FC002b466eEc40DaE837Fc4bE5c67993ddBd6F\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/13422/small/frax_logo.png?1608476506\",\r\n    },\r\n    {\r\n      name: \"Magic Internet Money\",\r\n      symbol: \"MIM\",\r\n      decimals: 18,\r\n      address: \"0xFEa7a6a0B346362BF88A9e4A88416B77a57D6c2A\",\r\n      isStable: true,\r\n      isTempHidden: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/16786/small/mimlogopng.png\",\r\n    },\r\n  ],\r\n  43114: [\r\n    {\r\n      name: \"Avalanche\",\r\n      symbol: \"AVAX\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png?1604021818\",\r\n    },\r\n    {\r\n      name: \"Wrapped AVAX\",\r\n      symbol: \"WAVAX\",\r\n      decimals: 18,\r\n      address: \"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7\",\r\n      isWrapped: true,\r\n      baseSymbol: \"AVAX\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png?1604021818\",\r\n    },\r\n    {\r\n      name: \"Ethereum (WETH.e)\",\r\n      symbol: \"ETH\",\r\n      address: \"0x49D5c2BdFfac6CE2BFdB6640F4F80f226bc10bAB\",\r\n      decimals: 18,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC.e)\",\r\n      symbol: \"BTC\",\r\n      address: \"0x50b7545627a5162F82A992c33b87aDc75187B218\",\r\n      decimals: 8,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (BTC.b)\",\r\n      symbol: \"BTC.b\",\r\n      address: \"0x152b9d0FdC40C096757F570A51E494bd4b943E50\",\r\n      decimals: 8,\r\n      isShortable: false,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/26115/thumb/btcb.png?1655921693\",\r\n    },\r\n    {\r\n      name: \"USD Coin (USDC.e)\",\r\n      symbol: \"USDC.e\",\r\n      address: \"0xA7D7079b0FEaD91F3e65f86E8915Cb59c1a4C664\",\r\n      decimals: 6,\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      address: \"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E\",\r\n      decimals: 6,\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"Magic Internet Money\",\r\n      symbol: \"MIM\",\r\n      address: \"0x130966628846BFd36ff31a822705796e8cb8C18D\",\r\n      decimals: 18,\r\n      isStable: true,\r\n      isTempHidden: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/16786/small/mimlogopng.png\",\r\n    },\r\n  ],\r\n};\r\n\r\nconst ADDITIONAL_TOKENS = {\r\n  42161: [\r\n    {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      address: getContract(42161, \"GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"Escrowed GMX\",\r\n      symbol: \"esGMX\",\r\n      address: getContract(42161, \"ES_GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      address: getContract(42161, \"GLP\"),\r\n      decimals: 18,\r\n    },\r\n  ],\r\n  43114: [\r\n    {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      address: getContract(43114, \"GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"Escrowed GMX\",\r\n      symbol: \"esGMX\",\r\n      address: getContract(43114, \"ES_GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      address: getContract(42161, \"GLP\"),\r\n      decimals: 18,\r\n    },\r\n  ],\r\n};\r\n\r\nconst CHAIN_IDS = [56, 97, 42161, 421611, 43114];\r\n\r\nconst TOKENS_MAP = {};\r\nconst TOKENS_BY_SYMBOL_MAP = {};\r\n\r\nfor (let j = 0; j < CHAIN_IDS.length; j++) {\r\n  const chainId = CHAIN_IDS[j];\r\n  TOKENS_MAP[chainId] = {};\r\n  TOKENS_BY_SYMBOL_MAP[chainId] = {};\r\n  let tokens = TOKENS[chainId];\r\n  if (ADDITIONAL_TOKENS[chainId]) {\r\n    tokens = tokens.concat(ADDITIONAL_TOKENS[chainId]);\r\n  }\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = tokens[i];\r\n    TOKENS_MAP[chainId][token.address] = token;\r\n    TOKENS_BY_SYMBOL_MAP[chainId][token.symbol] = token;\r\n  }\r\n}\r\n\r\nconst WRAPPED_TOKENS_MAP = {};\r\nconst NATIVE_TOKENS_MAP = {};\r\nfor (const chainId of CHAIN_IDS) {\r\n  for (const token of TOKENS[chainId]) {\r\n    if (token.isWrapped) {\r\n      WRAPPED_TOKENS_MAP[chainId] = token;\r\n    } else if (token.isNative) {\r\n      NATIVE_TOKENS_MAP[chainId] = token;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getWrappedToken(chainId) {\r\n  return WRAPPED_TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getNativeToken(chainId) {\r\n  return NATIVE_TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getTokens(chainId) {\r\n  return TOKENS[chainId];\r\n}\r\n\r\nexport function isValidToken(chainId, address) {\r\n  if (!TOKENS_MAP[chainId]) {\r\n    throw new Error(`Incorrect chainId ${chainId}`);\r\n  }\r\n  return address in TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getToken(chainId, address) {\r\n  if (!TOKENS_MAP[chainId]) {\r\n    throw new Error(`Incorrect chainId ${chainId}`);\r\n  }\r\n  if (!TOKENS_MAP[chainId][address]) {\r\n    throw new Error(`Incorrect address \"${address}\" for chainId ${chainId}`);\r\n  }\r\n  return TOKENS_MAP[chainId][address];\r\n}\r\n\r\nexport function getTokenBySymbol(chainId, symbol) {\r\n  const token = TOKENS_BY_SYMBOL_MAP[chainId][symbol];\r\n  if (!token) {\r\n    throw new Error(`Incorrect symbol \"${symbol}\" for chainId ${chainId}`);\r\n  }\r\n  return token;\r\n}\r\n\r\nexport function getWhitelistedTokens(chainId) {\r\n  return TOKENS[chainId].filter((token) => token.symbol !== \"USDG\");\r\n}\r\n\r\nexport function getVisibleTokens(chainId) {\r\n  return getWhitelistedTokens(chainId).filter((token) => !token.isWrapped && !token.isTempHidden);\r\n}\r\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { InjectedConnector } from \"@web3-react/injected-connector\";\r\nimport {\r\n  UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,\r\n  WalletConnectConnector,\r\n} from \"@web3-react/walletconnect-connector\";\r\nimport { toast } from \"react-toastify\";\r\nimport { UnsupportedChainIdError, useWeb3React } from \"@web3-react/core\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { ethers } from \"ethers\";\r\nimport { format as formatDateFn } from \"date-fns\";\r\nimport Token from \"../abis/Token.json\";\r\nimport _ from \"lodash\";\r\nimport { getContract } from \"../config/Addresses\";\r\nimport useSWR from \"swr\";\r\n\r\nimport OrderBookReader from \"../abis/OrderBookReader.json\";\r\nimport OrderBook from \"../abis/OrderBook.json\";\r\n\r\nimport { getWhitelistedTokens, isValidToken } from \"../config/Tokens\";\r\n\r\nimport callIcon from \"../../../img/icon-call.svg\";\r\nimport putIcon from \"../../../img/icon-put.svg\";\r\nimport putActiveIcon from \"../../../img/icon-put-active.svg\";\r\nimport callActiveIcon from \"../../../img/icon-call-active.svg\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport const UI_VERSION = \"1.3\";\r\n\r\n// use a random placeholder account instead of the zero address as the zero address might have tokens\r\nexport const PLACEHOLDER_ACCOUNT = ethers.Wallet.createRandom().address;\r\n\r\nexport const MAINNET = 56;\r\nexport const AVALANCHE = 43114;\r\nexport const TESTNET = 97;\r\nexport const ARBITRUM_TESTNET = 421611;\r\nexport const ARBITRUM = 42161;\r\n// TODO take it from web3\r\nexport const DEFAULT_CHAIN_ID = ARBITRUM;\r\nexport const CHAIN_ID = DEFAULT_CHAIN_ID;\r\n\r\nexport const MIN_PROFIT_TIME = 0;\r\n\r\nconst SELECTED_NETWORK_LOCAL_STORAGE_KEY = \"SELECTED_NETWORK\";\r\n\r\nexport const IS_NETWORK_DISABLED = {\r\n  [ARBITRUM]: false,\r\n  [AVALANCHE]: false,\r\n};\r\n\r\nconst CHAIN_NAMES_MAP = {\r\n  [MAINNET]: \"BSC\",\r\n  [TESTNET]: \"BSC Testnet\",\r\n  [ARBITRUM_TESTNET]: \"ArbRinkeby\",\r\n  [ARBITRUM]: \"Arbitrum\",\r\n  [AVALANCHE]: \"Avalanche\",\r\n};\r\n\r\nconst alchemyWhitelistedDomains = [\"gmx.io\", \"app.gmx.io\"];\r\n\r\nexport function getDefaultArbitrumRpcUrl() {\r\n  return \"https://arb1.arbitrum.io/rpc\";\r\n}\r\n\r\nexport function getAlchemyHttpUrl() {\r\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\r\n    return \"https://arb-mainnet.g.alchemy.com/v2/ha7CFsr1bx5ZItuR6VZBbhKozcKDY4LZ\";\r\n  }\r\n  return \"https://arb-mainnet.g.alchemy.com/v2/EmVYwUw0N2tXOuG0SZfe5Z04rzBsCbr2\";\r\n}\r\n\r\nexport function getAlchemyWsUrl() {\r\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\r\n    return \"wss://arb-mainnet.g.alchemy.com/v2/ha7CFsr1bx5ZItuR6VZBbhKozcKDY4LZ\";\r\n  }\r\n  return \"wss://arb-mainnet.g.alchemy.com/v2/EmVYwUw0N2tXOuG0SZfe5Z04rzBsCbr2\";\r\n}\r\n\r\nconst ARBITRUM_RPC_PROVIDERS = [getDefaultArbitrumRpcUrl()];\r\nconst AVALANCHE_RPC_PROVIDERS = [\"https://api.avax.network/ext/bc/C/rpc\"];\r\nexport const WALLET_CONNECT_LOCALSTORAGE_KEY = \"walletconnect\";\r\nexport const WALLET_LINK_LOCALSTORAGE_PREFIX = \"-walletlink\";\r\nexport const SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY = \"eagerconnect\";\r\nexport const CURRENT_PROVIDER_LOCALSTORAGE_KEY = \"currentprovider\";\r\nexport const LANGUAGE_LOCALSTORAGE_KEY = \"LANGUAGE_KEY\";\r\n\r\nexport function getChainName(chainId) {\r\n  return CHAIN_NAMES_MAP[chainId];\r\n}\r\n\r\nexport const USDG_ADDRESS = getContract(CHAIN_ID, \"USDG\");\r\n\r\nexport const BASIS_POINTS_DIVISOR = 10000;\r\nexport const MAX_LEVERAGE = 100 * BASIS_POINTS_DIVISOR;\r\nexport const MAX_ALLOWED_LEVERAGE = 50 * BASIS_POINTS_DIVISOR;\r\n\r\nexport const MAX_PRICE_DEVIATION_BASIS_POINTS = 750;\r\nexport const DEFAULT_GAS_LIMIT = 1 * 1000 * 1000;\r\nexport const SECONDS_PER_YEAR = 31536000;\r\nexport const USDG_DECIMALS = 18;\r\nexport const USD_DECIMALS = 30;\r\nexport const DEPOSIT_FEE = 30;\r\nexport const DUST_BNB = \"2000000000000000\";\r\nexport const DUST_USD = expandDecimals(1, USD_DECIMALS);\r\nexport const PRECISION = expandDecimals(1, 30);\r\nexport const GLP_DECIMALS = 18;\r\nexport const GMX_DECIMALS = 18;\r\nexport const DEFAULT_MAX_USDG_AMOUNT = expandDecimals(200 * 1000 * 1000, 18);\r\n\r\nexport const TAX_BASIS_POINTS = 50;\r\nexport const STABLE_TAX_BASIS_POINTS = 5;\r\nexport const MINT_BURN_FEE_BASIS_POINTS = 25;\r\nexport const SWAP_FEE_BASIS_POINTS = 30;\r\nexport const STABLE_SWAP_FEE_BASIS_POINTS = 1;\r\nexport const MARGIN_FEE_BASIS_POINTS = 10;\r\n\r\nexport const LIQUIDATION_FEE = expandDecimals(5, USD_DECIMALS);\r\n\r\nexport const TRADES_PAGE_SIZE = 100;\r\n\r\nexport const GLP_COOLDOWN_DURATION = 15 * 60;\r\nexport const THRESHOLD_REDEMPTION_VALUE = expandDecimals(993, 27); // 0.993\r\nexport const FUNDING_RATE_PRECISION = 1000000;\r\n\r\nexport const SWAP = \"Swap\";\r\nexport const INCREASE = \"Increase\";\r\nexport const DECREASE = \"Decrease\";\r\nexport const LONG = \"Long\";\r\nexport const SHORT = \"Short\";\r\n\r\nexport const MARKET = \"Market\";\r\nexport const LIMIT = \"Limit\";\r\nexport const STOP = \"Stop\";\r\nexport const BORROW = \"Borrow\";\r\n\r\n// Market/limit orders disabling\r\n// export const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT, STOP];\r\nexport const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT];\r\n\r\nexport const SWAP_ORDER_OPTIONS = [MARKET, LIMIT];\r\n\r\n\r\n// Options\r\nexport const CALL = \"Call\";\r\nexport const PUT = \"Put\";\r\nexport const SWAP_OPTIONS = [CALL, PUT];\r\nexport const SWAP_ICONS = {\r\n  [CALL]: callIcon,\r\n  [PUT]: putIcon,\r\n  Call_active: callActiveIcon,\r\n  Put_active: putActiveIcon,\r\n};\r\n\r\nexport const ASSET_OPTIONS = ['ETH', 'BTC'];\r\n\r\n\r\n\r\n// Default Slippage\r\nexport const DEFAULT_SLIPPAGE_AMOUNT = 30;\r\n// export const DEFAULT_SLIPPAGE_AMOUNT = 100;\r\n\r\nexport const DEFAULT_HIGHER_SLIPPAGE_AMOUNT = 100;\r\n\r\nexport const SLIPPAGE_BPS_KEY = \"Exchange-swap-slippage-basis-points-v3\";\r\nexport const CLOSE_POSITION_RECEIVE_TOKEN_KEY = \"Close-position-receive-token\";\r\nexport const IS_PNL_IN_LEVERAGE_KEY = \"Exchange-swap-is-pnl-in-leverage\";\r\nexport const SHOW_PNL_AFTER_FEES_KEY = \"Exchange-swap-show-pnl-after-fees\";\r\nexport const DISABLE_ORDER_VALIDATION_KEY = \"disable-order-validation\";\r\nexport const SHOULD_SHOW_POSITION_LINES_KEY = \"Exchange-swap-should-show-position-lines\";\r\nexport const REFERRAL_CODE_KEY = \"GMX-referralCode\";\r\nexport const REFERRAL_CODE_QUERY_PARAM = \"ref\";\r\nexport const REFERRALS_SELECTED_TAB_KEY = \"Referrals-selected-tab\";\r\nexport const MAX_REFERRAL_CODE_LENGTH = 20;\r\n\r\nexport const TRIGGER_PREFIX_ABOVE = \">\";\r\nexport const TRIGGER_PREFIX_BELOW = \"<\";\r\n\r\nexport const MIN_PROFIT_BIPS = 0;\r\n\r\nexport const GLPPOOLCOLORS = {\r\n  ETH: \"#6062a6\",\r\n  BTC: \"#F7931A\",\r\n  \"BTC.b\": \"#F7931A\",\r\n  USDC: \"#2775CA\",\r\n  \"USDC.e\": \"#2A5ADA\",\r\n  USDT: \"#67B18A\",\r\n  MIM: \"#9695F8\",\r\n  FRAX: \"#000\",\r\n  DAI: \"#FAC044\",\r\n  UNI: \"#E9167C\",\r\n  AVAX: \"#E84142\",\r\n  LINK: \"#3256D6\",\r\n};\r\n\r\nexport const HIGH_EXECUTION_FEES_MAP = {\r\n  [ARBITRUM]: 3, // 3 USD\r\n  [AVALANCHE]: 3, // 3 USD\r\n};\r\n\r\nexport function getHighExecutionFee(chainId) {\r\n  return HIGH_EXECUTION_FEES_MAP[chainId] || 3;\r\n}\r\n\r\nexport const ICONLINKS = {\r\n  [ARBITRUM_TESTNET]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a\",\r\n    },\r\n    GLP: {\r\n      arbitrum: \"https://testnet.arbiscan.io/token/0xb4f81Fa74e06b5f762A104e47276BA9b2929cb27\",\r\n    },\r\n  },\r\n  [ARBITRUM]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a\",\r\n    },\r\n    GLP: {\r\n      arbitrum: \"https://arbiscan.io/token/0x1aDDD80E6039594eE970E5872D247bf0414C8903\",\r\n    },\r\n    ETH: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/ethereum\",\r\n    },\r\n    BTC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      arbitrum: \"https://arbiscan.io/address/0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f\",\r\n    },\r\n    LINK: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/chainlink\",\r\n      arbitrum: \"https://arbiscan.io/address/0xf97f4df75117a78c1a5a0dbb814af92458539fb4\",\r\n    },\r\n    UNI: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/uniswap\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0\",\r\n    },\r\n    USDC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      arbitrum: \"https://arbiscan.io/address/0xff970a61a04b1ca14834a43f5de4533ebddb5cc8\",\r\n    },\r\n    USDT: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/tether\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9\",\r\n    },\r\n    DAI: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/dai\",\r\n      arbitrum: \"https://arbiscan.io/address/0xda10009cbd5d07dd0cecc66161fc93d7c9000da1\",\r\n    },\r\n    MIM: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfea7a6a0b346362bf88a9e4a88416b77a57d6c2a\",\r\n    },\r\n    FRAX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/frax\",\r\n      arbitrum: \"https://arbiscan.io/address/0x17fc002b466eec40dae837fc4be5c67993ddbd6f\",\r\n    },\r\n  },\r\n  [AVALANCHE]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      avalanche: \"https://snowtrace.io/address/0x62edc0692bd897d2295872a9ffcac5425011c661\",\r\n    },\r\n    GLP: {\r\n      avalanche: \"https://snowtrace.io/address/0x9e295B5B976a184B14aD8cd72413aD846C299660\",\r\n    },\r\n    AVAX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/avalanche\",\r\n    },\r\n    ETH: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/weth\",\r\n      avalanche: \"https://snowtrace.io/address/0x49d5c2bdffac6ce2bfdb6640f4f80f226bc10bab\",\r\n    },\r\n    BTC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      avalanche: \"https://snowtrace.io/address/0x50b7545627a5162f82a992c33b87adc75187b218\",\r\n    },\r\n    \"BTC.b\": {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      avalanche: \"https://snowtrace.io/address/0x152b9d0FdC40C096757F570A51E494bd4b943E50\",\r\n    },\r\n    MIM: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\r\n      avalanche: \"https://snowtrace.io/address/0x130966628846bfd36ff31a822705796e8cb8c18d\",\r\n    },\r\n    \"USDC.e\": {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin-avalanche-bridged-usdc-e\",\r\n      avalanche: \"https://snowtrace.io/address/0xa7d7079b0fead91f3e65f86e8915cb59c1a4c664\",\r\n    },\r\n    USDC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      avalanche: \"https://snowtrace.io/address/0xb97ef9ef8734c71904d8002f8b6bc66dd9c48a6e\",\r\n    },\r\n  },\r\n};\r\n\r\nexport const platformTokens = {\r\n  42161: {\r\n    // arbitrum\r\n    GMX: {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      decimals: 18,\r\n      address: getContract(ARBITRUM, \"GMX\"),\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/18323/small/arbit.png?1631532468\",\r\n    },\r\n    GLP: {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      decimals: 18,\r\n      address: getContract(ARBITRUM, \"StakedGlpTracker\"), // address of fsGLP token because user only holds fsGLP\r\n      imageUrl: \"https://github.com/gmx-io/gmx-assets/blob/main/GMX-Assets/PNG/GLP_LOGO%20ONLY.png?raw=true\",\r\n    },\r\n  },\r\n  43114: {\r\n    // avalanche\r\n    GMX: {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      decimals: 18,\r\n      address: getContract(AVALANCHE, \"GMX\"),\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/18323/small/arbit.png?1631532468\",\r\n    },\r\n    GLP: {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      decimals: 18,\r\n      address: getContract(AVALANCHE, \"StakedGlpTracker\"), // address of fsGLP token because user only holds fsGLP\r\n      imageUrl: \"https://github.com/gmx-io/gmx-assets/blob/main/GMX-Assets/PNG/GLP_LOGO%20ONLY.png?raw=true\",\r\n    },\r\n  },\r\n};\r\n\r\nconst supportedChainIds = [ARBITRUM, AVALANCHE];\r\nif (isDevelopment()) {\r\n  supportedChainIds.push(ARBITRUM_TESTNET);\r\n}\r\nconst injectedConnector = new InjectedConnector({\r\n  supportedChainIds,\r\n});\r\n\r\nconst getWalletConnectConnector = () => {\r\n  const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\r\n  return new WalletConnectConnector({\r\n    rpc: {\r\n      [AVALANCHE]: AVALANCHE_RPC_PROVIDERS[0],\r\n      [ARBITRUM]: ARBITRUM_RPC_PROVIDERS[0],\r\n      [ARBITRUM_TESTNET]: \"https://rinkeby.arbitrum.io/rpc\",\r\n    },\r\n    qrcode: true,\r\n    chainId,\r\n  });\r\n};\r\n\r\nexport function isSupportedChain(chainId) {\r\n  return supportedChainIds.includes(chainId);\r\n}\r\n\r\nexport function deserialize(data) {\r\n  for (const [key, value] of Object.entries(data)) {\r\n    if (value._type === \"BigNumber\") {\r\n      data[key] = bigNumberify(value.value);\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function isHomeSite() {\r\n  return process.env.REACT_APP_IS_HOME_SITE === \"true\";\r\n}\r\n\r\nexport const helperToast = {\r\n  success: (content, opts) => {\r\n    toast.dismiss();\r\n    toast.success(content, opts);\r\n  },\r\n  error: (content, opts) => {\r\n    toast.dismiss();\r\n    toast.error(content, opts);\r\n  },\r\n};\r\n\r\nexport function useLocalStorageByChainId(chainId, key, defaultValue) {\r\n  const [internalValue, setInternalValue] = useLocalStorage(key, {});\r\n\r\n  const setValue = useCallback(\r\n    (value) => {\r\n      setInternalValue((internalValue) => {\r\n        if (typeof value === \"function\") {\r\n          value = value(internalValue[chainId] || defaultValue);\r\n        }\r\n        const newInternalValue = {\r\n          ...internalValue,\r\n          [chainId]: value,\r\n        };\r\n        return newInternalValue;\r\n      });\r\n    },\r\n    [chainId, setInternalValue, defaultValue]\r\n  );\r\n\r\n  let value;\r\n  if (chainId in internalValue) {\r\n    value = internalValue[chainId];\r\n  } else {\r\n    value = defaultValue;\r\n  }\r\n\r\n  return [value, setValue];\r\n}\r\n\r\nexport function useLocalStorageSerializeKey(key, value, opts) {\r\n  key = JSON.stringify(key);\r\n  return useLocalStorage(key, value, opts);\r\n}\r\n\r\nfunction getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd) {\r\n  // Limit/stop orders are executed with price specified by user\r\n  if (orderOption && orderOption !== MARKET && triggerPriceUsd) {\r\n    return triggerPriceUsd;\r\n  }\r\n\r\n  // Market orders are executed with current market price\r\n  if (!info) {\r\n    return;\r\n  }\r\n  if (max && !info.maxPrice) {\r\n    return;\r\n  }\r\n  if (!max && !info.minPrice) {\r\n    return;\r\n  }\r\n  return max ? info.maxPrice : info.minPrice;\r\n}\r\n\r\nexport function getLiquidationPriceFromDelta({ liquidationAmount, size, collateral, averagePrice, isLong }) {\r\n  if (!size || size.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  if (liquidationAmount.gt(collateral)) {\r\n    const liquidationDelta = liquidationAmount.sub(collateral);\r\n    const priceDelta = liquidationDelta.mul(averagePrice).div(size);\r\n    return isLong ? averagePrice.add(priceDelta) : averagePrice.sub(priceDelta);\r\n  }\r\n\r\n  const liquidationDelta = collateral.sub(liquidationAmount);\r\n  const priceDelta = liquidationDelta.mul(averagePrice).div(size);\r\n\r\n  return isLong ? averagePrice.sub(priceDelta) : averagePrice.add(priceDelta);\r\n}\r\n\r\nexport const replaceNativeTokenAddress = (path, nativeTokenAddress) => {\r\n  if (!path) {\r\n    return;\r\n  }\r\n\r\n  let updatedPath = [];\r\n  for (let i = 0; i < path.length; i++) {\r\n    let address = path[i];\r\n    if (address === AddressZero) {\r\n      address = nativeTokenAddress;\r\n    }\r\n    updatedPath.push(address);\r\n  }\r\n\r\n  return updatedPath;\r\n};\r\n\r\nexport function getMarginFee(sizeDelta) {\r\n  if (!sizeDelta) {\r\n    return bigNumberify(0);\r\n  }\r\n  const afterFeeUsd = sizeDelta.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n  return sizeDelta.sub(afterFeeUsd);\r\n}\r\n\r\nexport function getServerBaseUrl(chainId) {\r\n  if (!chainId) {\r\n    throw new Error(\"chainId is not provided\");\r\n  }\r\n  if (document.location.hostname.includes(\"deploy-preview\")) {\r\n    const fromLocalStorage = localStorage.getItem(\"SERVER_BASE_URL\");\r\n    if (fromLocalStorage) {\r\n      return fromLocalStorage;\r\n    }\r\n  }\r\n  if (chainId === MAINNET) {\r\n    return \"https://gambit-server-staging.uc.r.appspot.com\";\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return \"https://gambit-server-devnet.uc.r.appspot.com\";\r\n  } else if (chainId === ARBITRUM) {\r\n    return \"https://gmx-server-mainnet.uw.r.appspot.com\";\r\n  } else if (chainId === AVALANCHE) {\r\n    return \"https://gmx-avax-server.uc.r.appspot.com\";\r\n  }\r\n  return \"https://gmx-server-mainnet.uw.r.appspot.com\";\r\n}\r\n\r\nexport function getServerUrl(chainId, path) {\r\n  return `${getServerBaseUrl(chainId)}${path}`;\r\n}\r\n\r\nexport function isTriggerRatioInverted(fromTokenInfo, toTokenInfo) {\r\n  if (!toTokenInfo || !fromTokenInfo) return false;\r\n  if (toTokenInfo.isStable || toTokenInfo.isUsdg) return true;\r\n  if (toTokenInfo.maxPrice) return toTokenInfo.maxPrice.lt(fromTokenInfo.maxPrice);\r\n  return false;\r\n}\r\n\r\nexport function getExchangeRate(tokenAInfo, tokenBInfo, inverted) {\r\n  if (!tokenAInfo || !tokenAInfo.minPrice || !tokenBInfo || !tokenBInfo.maxPrice) {\r\n    return;\r\n  }\r\n  if (inverted) {\r\n    return tokenAInfo.minPrice.mul(PRECISION).div(tokenBInfo.maxPrice);\r\n  }\r\n  return tokenBInfo.maxPrice.mul(PRECISION).div(tokenAInfo.minPrice);\r\n}\r\n\r\nexport function getMostAbundantStableToken(chainId, infoTokens) {\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  let availableAmount;\r\n  let stableToken = whitelistedTokens.find((t) => t.isStable);\r\n  for (let i = 0; i < whitelistedTokens.length; i++) {\r\n    const info = getTokenInfo(infoTokens, whitelistedTokens[i].address);\r\n    if (!info.isStable || !info.availableAmount) {\r\n      continue;\r\n    }\r\n\r\n    const adjustedAvailableAmount = adjustForDecimals(info.availableAmount, info.decimals, USD_DECIMALS);\r\n    if (!availableAmount || adjustedAvailableAmount.gt(availableAmount)) {\r\n      availableAmount = adjustedAvailableAmount;\r\n      stableToken = info;\r\n    }\r\n  }\r\n  return stableToken;\r\n}\r\n\r\nexport function shouldInvertTriggerRatio(tokenA, tokenB) {\r\n  if (tokenB.isStable || tokenB.isUsdg) return true;\r\n  if (tokenB.maxPrice && tokenA.maxPrice && tokenB.maxPrice.lt(tokenA.maxPrice)) return true;\r\n  return false;\r\n}\r\n\r\nexport function getExchangeRateDisplay(rate, tokenA, tokenB, opts = {}) {\r\n  if (!rate || !tokenA || !tokenB) return \"...\";\r\n  if (shouldInvertTriggerRatio(tokenA, tokenB)) {\r\n    [tokenA, tokenB] = [tokenB, tokenA];\r\n    rate = PRECISION.mul(PRECISION).div(rate);\r\n  }\r\n  const rateValue = formatAmount(rate, USD_DECIMALS, tokenA.isStable || tokenA.isUsdg ? 2 : 4, true);\r\n  if (opts.omitSymbols) {\r\n    return rateValue;\r\n  }\r\n  return `${rateValue} ${tokenA.symbol}/${tokenB.symbol}`;\r\n}\r\n\r\nconst adjustForDecimalsFactory = (n) => (number) => {\r\n  if (n === 0) {\r\n    return number;\r\n  }\r\n  if (n > 0) {\r\n    return number.mul(expandDecimals(1, n));\r\n  }\r\n  return number.div(expandDecimals(1, -n));\r\n};\r\n\r\nexport function adjustForDecimals(amount, divDecimals, mulDecimals) {\r\n  return amount.mul(expandDecimals(1, mulDecimals)).div(expandDecimals(1, divDecimals));\r\n}\r\n\r\nexport function getTargetUsdgAmount(token, usdgSupply, totalTokenWeights) {\r\n  if (!token || !token.weight || !usdgSupply) {\r\n    return;\r\n  }\r\n\r\n  if (usdgSupply.eq(0)) {\r\n    return bigNumberify(0);\r\n  }\r\n\r\n  return token.weight.mul(usdgSupply).div(totalTokenWeights);\r\n}\r\n\r\nexport function getFeeBasisPoints(\r\n  token,\r\n  usdgDelta,\r\n  feeBasisPoints,\r\n  taxBasisPoints,\r\n  increment,\r\n  usdgSupply,\r\n  totalTokenWeights\r\n) {\r\n  if (!token || !token.usdgAmount || !usdgSupply || !totalTokenWeights) {\r\n    return 0;\r\n  }\r\n\r\n  feeBasisPoints = bigNumberify(feeBasisPoints);\r\n  taxBasisPoints = bigNumberify(taxBasisPoints);\r\n\r\n  const initialAmount = token.usdgAmount;\r\n  let nextAmount = initialAmount.add(usdgDelta);\r\n  if (!increment) {\r\n    nextAmount = usdgDelta.gt(initialAmount) ? bigNumberify(0) : initialAmount.sub(usdgDelta);\r\n  }\r\n\r\n  const targetAmount = getTargetUsdgAmount(token, usdgSupply, totalTokenWeights);\r\n  if (!targetAmount || targetAmount.eq(0)) {\r\n    return feeBasisPoints.toNumber();\r\n  }\r\n\r\n  const initialDiff = initialAmount.gt(targetAmount)\r\n    ? initialAmount.sub(targetAmount)\r\n    : targetAmount.sub(initialAmount);\r\n  const nextDiff = nextAmount.gt(targetAmount) ? nextAmount.sub(targetAmount) : targetAmount.sub(nextAmount);\r\n\r\n  if (nextDiff.lt(initialDiff)) {\r\n    const rebateBps = taxBasisPoints.mul(initialDiff).div(targetAmount);\r\n    return rebateBps.gt(feeBasisPoints) ? 0 : feeBasisPoints.sub(rebateBps).toNumber();\r\n  }\r\n\r\n  let averageDiff = initialDiff.add(nextDiff).div(2);\r\n  if (averageDiff.gt(targetAmount)) {\r\n    averageDiff = targetAmount;\r\n  }\r\n  const taxBps = taxBasisPoints.mul(averageDiff).div(targetAmount);\r\n  return feeBasisPoints.add(taxBps).toNumber();\r\n}\r\n\r\nexport function getBuyGlpToAmount(fromAmount, swapTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\r\n  if (!fromAmount || !swapTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\r\n  if (!swapToken || !swapToken.minPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let glpAmount = fromAmount.mul(swapToken.minPrice).div(glpPrice);\r\n  glpAmount = adjustForDecimals(glpAmount, swapToken.decimals, USDG_DECIMALS);\r\n\r\n  let usdgAmount = fromAmount.mul(swapToken.minPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    swapToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  glpAmount = glpAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n  return { amount: glpAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getSellGlpFromAmount(toAmount, swapTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\r\n  if (!toAmount || !swapTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\r\n  if (!swapToken || !swapToken.maxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let glpAmount = toAmount.mul(swapToken.maxPrice).div(glpPrice);\r\n  glpAmount = adjustForDecimals(glpAmount, swapToken.decimals, USDG_DECIMALS);\r\n\r\n  let usdgAmount = toAmount.mul(swapToken.maxPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    swapToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  glpAmount = glpAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\r\n\r\n  return { amount: glpAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getBuyGlpFromAmount(toAmount, fromTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!toAmount || !fromTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  if (!fromToken || !fromToken.minPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let fromAmount = toAmount.mul(glpPrice).div(fromToken.minPrice);\r\n  fromAmount = adjustForDecimals(fromAmount, GLP_DECIMALS, fromToken.decimals);\r\n\r\n  const usdgAmount = toAmount.mul(glpPrice).div(PRECISION);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\r\n\r\n  return { amount: fromAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getSellGlpToAmount(toAmount, fromTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!toAmount || !fromTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  if (!fromToken || !fromToken.maxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let fromAmount = toAmount.mul(glpPrice).div(fromToken.maxPrice);\r\n  fromAmount = adjustForDecimals(fromAmount, GLP_DECIMALS, fromToken.decimals);\r\n\r\n  const usdgAmount = toAmount.mul(glpPrice).div(PRECISION);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n  return { amount: fromAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getNextFromAmount(\r\n  chainId,\r\n  toAmount,\r\n  fromTokenAddress,\r\n  toTokenAddress,\r\n  infoTokens,\r\n  toTokenPriceUsd,\r\n  ratio,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  forSwap\r\n) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n\r\n  if (!toAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (fromTokenAddress === toTokenAddress) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  if (fromToken.isNative && toToken.isWrapped) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  if (fromToken.isWrapped && toToken.isNative) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  // the realtime price should be used if it is for a transaction to open / close a position\r\n  // or if the transaction involves doing a swap and opening / closing a position\r\n  // otherwise use the contract price instead of realtime price for swaps\r\n\r\n  let fromTokenMinPrice;\r\n  if (fromToken) {\r\n    fromTokenMinPrice = forSwap ? fromToken.contractMinPrice : fromToken.minPrice;\r\n  }\r\n\r\n  let toTokenMaxPrice;\r\n  if (toToken) {\r\n    toTokenMaxPrice = forSwap ? toToken.contractMaxPrice : toToken.maxPrice;\r\n  }\r\n\r\n  if (!fromToken || !fromTokenMinPrice || !toToken || !toTokenMaxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const adjustDecimals = adjustForDecimalsFactory(fromToken.decimals - toToken.decimals);\r\n\r\n  let fromAmountBasedOnRatio;\r\n  if (ratio && !ratio.isZero()) {\r\n    fromAmountBasedOnRatio = toAmount.mul(ratio).div(PRECISION);\r\n  }\r\n\r\n  const fromAmount =\r\n    ratio && !ratio.isZero() ? fromAmountBasedOnRatio : toAmount.mul(toTokenMaxPrice).div(fromTokenMinPrice);\r\n\r\n  let usdgAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, toToken.decimals, USDG_DECIMALS);\r\n  const swapFeeBasisPoints =\r\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\r\n  const feeBasisPoints0 = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints1 = getFeeBasisPoints(\r\n    toToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\r\n\r\n  return {\r\n    amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints)),\r\n    feeBasisPoints,\r\n  };\r\n}\r\n\r\nexport function getNextToAmount(\r\n  chainId,\r\n  fromAmount,\r\n  fromTokenAddress,\r\n  toTokenAddress,\r\n  infoTokens,\r\n  toTokenPriceUsd,\r\n  ratio,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  forSwap\r\n) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!fromAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (fromTokenAddress === toTokenAddress) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  if (fromToken.isNative && toToken.isWrapped) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  if (fromToken.isWrapped && toToken.isNative) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  // the realtime price should be used if it is for a transaction to open / close a position\r\n  // or if the transaction involves doing a swap and opening / closing a position\r\n  // otherwise use the contract price instead of realtime price for swaps\r\n\r\n  let fromTokenMinPrice;\r\n  if (fromToken) {\r\n    fromTokenMinPrice = forSwap ? fromToken.contractMinPrice : fromToken.minPrice;\r\n  }\r\n\r\n  let toTokenMaxPrice;\r\n  if (toToken) {\r\n    toTokenMaxPrice = forSwap ? toToken.contractMaxPrice : toToken.maxPrice;\r\n  }\r\n\r\n  if (!fromTokenMinPrice || !toTokenMaxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const adjustDecimals = adjustForDecimalsFactory(toToken.decimals - fromToken.decimals);\r\n\r\n  let toAmountBasedOnRatio = bigNumberify(0);\r\n  if (ratio && !ratio.isZero()) {\r\n    toAmountBasedOnRatio = fromAmount.mul(PRECISION).div(ratio);\r\n  }\r\n\r\n  if (toTokenAddress === USDG_ADDRESS) {\r\n    const feeBasisPoints = getSwapFeeBasisPoints(fromToken.isStable);\r\n\r\n    if (ratio && !ratio.isZero()) {\r\n      const toAmount = toAmountBasedOnRatio;\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const toAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n    return {\r\n      amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n      feeBasisPoints,\r\n    };\r\n  }\r\n\r\n  if (fromTokenAddress === USDG_ADDRESS) {\r\n    const redemptionValue = toToken.redemptionAmount\r\n      .mul(toTokenPriceUsd || toTokenMaxPrice)\r\n      .div(expandDecimals(1, toToken.decimals));\r\n\r\n    if (redemptionValue.gt(THRESHOLD_REDEMPTION_VALUE)) {\r\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\r\n\r\n      const toAmount =\r\n        ratio && !ratio.isZero()\r\n          ? toAmountBasedOnRatio\r\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\r\n\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const expectedAmount = fromAmount;\r\n\r\n    const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n    if (!stableToken || stableToken.availableAmount.lt(expectedAmount)) {\r\n      const toAmount =\r\n        ratio && !ratio.isZero()\r\n          ? toAmountBasedOnRatio\r\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\r\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const feeBasisPoints0 = getSwapFeeBasisPoints(true);\r\n    const feeBasisPoints1 = getSwapFeeBasisPoints(false);\r\n\r\n    if (ratio && !ratio.isZero()) {\r\n      const toAmount = toAmountBasedOnRatio\r\n        .mul(BASIS_POINTS_DIVISOR - feeBasisPoints0 - feeBasisPoints1)\r\n        .div(BASIS_POINTS_DIVISOR);\r\n      return {\r\n        amount: adjustDecimals(toAmount),\r\n        path: [USDG_ADDRESS, stableToken.address, toToken.address],\r\n        feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\r\n      };\r\n    }\r\n\r\n    // get toAmount for USDG => stableToken\r\n    let toAmount = fromAmount.mul(PRECISION).div(stableToken.maxPrice);\r\n    // apply USDG => stableToken fees\r\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints0).div(BASIS_POINTS_DIVISOR);\r\n\r\n    // get toAmount for stableToken => toToken\r\n    toAmount = toAmount.mul(stableToken.minPrice).div(toTokenPriceUsd || toTokenMaxPrice);\r\n    // apply stableToken => toToken fees\r\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\r\n\r\n    return {\r\n      amount: adjustDecimals(toAmount),\r\n      path: [USDG_ADDRESS, stableToken.address, toToken.address],\r\n      feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\r\n    };\r\n  }\r\n\r\n  const toAmount =\r\n    ratio && !ratio.isZero()\r\n      ? toAmountBasedOnRatio\r\n      : fromAmount.mul(fromTokenMinPrice).div(toTokenPriceUsd || toTokenMaxPrice);\r\n\r\n  let usdgAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, fromToken.decimals, USDG_DECIMALS);\r\n  const swapFeeBasisPoints =\r\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\r\n  const feeBasisPoints0 = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints1 = getFeeBasisPoints(\r\n    toToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\r\n\r\n  return {\r\n    amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n    feeBasisPoints,\r\n  };\r\n}\r\n\r\nexport function getProfitPrice(closePrice, position) {\r\n  let profitPrice;\r\n  if (position && position.averagePrice && closePrice) {\r\n    profitPrice = position.isLong\r\n      ? position.averagePrice.mul(BASIS_POINTS_DIVISOR + MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR)\r\n      : position.averagePrice.mul(BASIS_POINTS_DIVISOR - MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR);\r\n  }\r\n  return profitPrice;\r\n}\r\n\r\nexport function calculatePositionDelta(\r\n  price,\r\n  { size, collateral, isLong, averagePrice, lastIncreasedTime },\r\n  sizeDelta\r\n) {\r\n  if (!sizeDelta) {\r\n    sizeDelta = size;\r\n  }\r\n  const priceDelta = averagePrice.gt(price) ? averagePrice.sub(price) : price.sub(averagePrice);\r\n  let delta = sizeDelta.mul(priceDelta).div(averagePrice);\r\n  const pendingDelta = delta;\r\n\r\n  const minProfitExpired = lastIncreasedTime + MIN_PROFIT_TIME < Date.now() / 1000;\r\n  const hasProfit = isLong ? price.gt(averagePrice) : price.lt(averagePrice);\r\n  if (!minProfitExpired && hasProfit && delta.mul(BASIS_POINTS_DIVISOR).lte(size.mul(MIN_PROFIT_BIPS))) {\r\n    delta = bigNumberify(0);\r\n  }\r\n\r\n  const deltaPercentage = delta.mul(BASIS_POINTS_DIVISOR).div(collateral);\r\n  const pendingDeltaPercentage = pendingDelta.mul(BASIS_POINTS_DIVISOR).div(collateral);\r\n\r\n  return {\r\n    delta,\r\n    pendingDelta,\r\n    pendingDeltaPercentage,\r\n    hasProfit,\r\n    deltaPercentage,\r\n  };\r\n}\r\n\r\nexport function getDeltaStr({ delta, deltaPercentage, hasProfit }) {\r\n  let deltaStr;\r\n  let deltaPercentageStr;\r\n\r\n  if (delta.gt(0)) {\r\n    deltaStr = hasProfit ? \"+\" : \"-\";\r\n    deltaPercentageStr = hasProfit ? \"+\" : \"-\";\r\n  } else {\r\n    deltaStr = \"\";\r\n    deltaPercentageStr = \"\";\r\n  }\r\n  deltaStr += `$${formatAmount(delta, USD_DECIMALS, 2, true)}`;\r\n  deltaPercentageStr += `${formatAmount(deltaPercentage, 2, 2)}%`;\r\n\r\n  return { deltaStr, deltaPercentageStr };\r\n}\r\n\r\nexport function getLeverage({\r\n  size,\r\n  sizeDelta,\r\n  increaseSize,\r\n  collateral,\r\n  collateralDelta,\r\n  increaseCollateral,\r\n  entryFundingRate,\r\n  cumulativeFundingRate,\r\n  hasProfit,\r\n  delta,\r\n  includeDelta,\r\n}) {\r\n  if (!size && !sizeDelta) {\r\n    return;\r\n  }\r\n  if (!collateral && !collateralDelta) {\r\n    return;\r\n  }\r\n\r\n  let nextSize = size ? size : bigNumberify(0);\r\n  if (sizeDelta) {\r\n    if (increaseSize) {\r\n      nextSize = size.add(sizeDelta);\r\n    } else {\r\n      if (sizeDelta.gte(size)) {\r\n        return;\r\n      }\r\n      nextSize = size.sub(sizeDelta);\r\n    }\r\n  }\r\n\r\n  let remainingCollateral = collateral ? collateral : bigNumberify(0);\r\n  if (collateralDelta) {\r\n    if (increaseCollateral) {\r\n      remainingCollateral = collateral.add(collateralDelta);\r\n    } else {\r\n      if (collateralDelta.gte(collateral)) {\r\n        return;\r\n      }\r\n      remainingCollateral = collateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  if (delta && includeDelta) {\r\n    if (hasProfit) {\r\n      remainingCollateral = remainingCollateral.add(delta);\r\n    } else {\r\n      if (delta.gt(remainingCollateral)) {\r\n        return;\r\n      }\r\n\r\n      remainingCollateral = remainingCollateral.sub(delta);\r\n    }\r\n  }\r\n\r\n  if (remainingCollateral.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  remainingCollateral = sizeDelta\r\n    ? remainingCollateral.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR)\r\n    : remainingCollateral;\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n    remainingCollateral = remainingCollateral.sub(fundingFee);\r\n  }\r\n\r\n  return nextSize.mul(BASIS_POINTS_DIVISOR).div(remainingCollateral);\r\n}\r\n\r\nexport function getLiquidationPrice(data) {\r\n  let {\r\n    isLong,\r\n    size,\r\n    collateral,\r\n    averagePrice,\r\n    entryFundingRate,\r\n    cumulativeFundingRate,\r\n    sizeDelta,\r\n    collateralDelta,\r\n    increaseCollateral,\r\n    increaseSize,\r\n    delta,\r\n    hasProfit,\r\n    includeDelta,\r\n  } = data;\r\n  if (!size || !collateral || !averagePrice) {\r\n    return;\r\n  }\r\n\r\n  let nextSize = size ? size : bigNumberify(0);\r\n  let remainingCollateral = collateral;\r\n\r\n  if (sizeDelta) {\r\n    if (increaseSize) {\r\n      nextSize = size.add(sizeDelta);\r\n    } else {\r\n      if (sizeDelta.gte(size)) {\r\n        return;\r\n      }\r\n      nextSize = size.sub(sizeDelta);\r\n    }\r\n\r\n    if (includeDelta && !hasProfit) {\r\n      const adjustedDelta = sizeDelta.mul(delta).div(size);\r\n      remainingCollateral = remainingCollateral.sub(adjustedDelta);\r\n    }\r\n  }\r\n\r\n  if (collateralDelta) {\r\n    if (increaseCollateral) {\r\n      remainingCollateral = remainingCollateral.add(collateralDelta);\r\n    } else {\r\n      if (collateralDelta.gte(remainingCollateral)) {\r\n        return;\r\n      }\r\n      remainingCollateral = remainingCollateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  let positionFee = getMarginFee(size).add(LIQUIDATION_FEE);\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n    positionFee = positionFee.add(fundingFee);\r\n  }\r\n\r\n  const liquidationPriceForFees = getLiquidationPriceFromDelta({\r\n    liquidationAmount: positionFee,\r\n    size: nextSize,\r\n    collateral: remainingCollateral,\r\n    averagePrice,\r\n    isLong,\r\n  });\r\n\r\n  const liquidationPriceForMaxLeverage = getLiquidationPriceFromDelta({\r\n    liquidationAmount: nextSize.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE),\r\n    size: nextSize,\r\n    collateral: remainingCollateral,\r\n    averagePrice,\r\n    isLong,\r\n  });\r\n\r\n  if (!liquidationPriceForFees) {\r\n    return liquidationPriceForMaxLeverage;\r\n  }\r\n  if (!liquidationPriceForMaxLeverage) {\r\n    return liquidationPriceForFees;\r\n  }\r\n\r\n  if (isLong) {\r\n    // return the higher price\r\n    return liquidationPriceForFees.gt(liquidationPriceForMaxLeverage)\r\n      ? liquidationPriceForFees\r\n      : liquidationPriceForMaxLeverage;\r\n  }\r\n\r\n  // return the lower price\r\n  return liquidationPriceForFees.lt(liquidationPriceForMaxLeverage)\r\n    ? liquidationPriceForFees\r\n    : liquidationPriceForMaxLeverage;\r\n}\r\n\r\nexport function getUsd(amount, tokenAddress, max, infoTokens, orderOption, triggerPriceUsd) {\r\n  if (!amount) {\r\n    return;\r\n  }\r\n  if (tokenAddress === USDG_ADDRESS) {\r\n    return amount.mul(PRECISION).div(expandDecimals(1, 18));\r\n  }\r\n  const info = getTokenInfo(infoTokens, tokenAddress);\r\n  const price = getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd);\r\n  if (!price) {\r\n    return;\r\n  }\r\n\r\n  return amount.mul(price).div(expandDecimals(1, info.decimals));\r\n}\r\n\r\nexport function getPositionKey(account, collateralTokenAddress, indexTokenAddress, isLong, nativeTokenAddress) {\r\n  const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n  const tokenAddress1 = indexTokenAddress === AddressZero ? nativeTokenAddress : indexTokenAddress;\r\n  return account + \":\" + tokenAddress0 + \":\" + tokenAddress1 + \":\" + isLong;\r\n}\r\n\r\nexport function getPositionContractKey(account, collateralToken, indexToken, isLong) {\r\n  return ethers.utils.solidityKeccak256(\r\n    [\"address\", \"address\", \"address\", \"bool\"],\r\n    [account, collateralToken, indexToken, isLong]\r\n  );\r\n}\r\n\r\nexport function getSwapFeeBasisPoints(isStable) {\r\n  return isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n}\r\n\r\n// BSC TESTNET\r\n// const RPC_PROVIDERS = [\r\n//   \"https://data-seed-prebsc-1-s1.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s1.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-1-s2.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s2.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-1-s3.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s3.binance.org:8545\"\r\n// ]\r\n\r\n// BSC MAINNET\r\nexport const BSC_RPC_PROVIDERS = [\r\n  \"https://bsc-dataseed.binance.org\",\r\n  \"https://bsc-dataseed1.defibit.io\",\r\n  \"https://bsc-dataseed1.ninicoin.io\",\r\n  \"https://bsc-dataseed2.defibit.io\",\r\n  \"https://bsc-dataseed3.defibit.io\",\r\n  \"https://bsc-dataseed4.defibit.io\",\r\n  \"https://bsc-dataseed2.ninicoin.io\",\r\n  \"https://bsc-dataseed3.ninicoin.io\",\r\n  \"https://bsc-dataseed4.ninicoin.io\",\r\n  \"https://bsc-dataseed1.binance.org\",\r\n  \"https://bsc-dataseed2.binance.org\",\r\n  \"https://bsc-dataseed3.binance.org\",\r\n  \"https://bsc-dataseed4.binance.org\",\r\n];\r\n\r\nconst RPC_PROVIDERS = {\r\n  [MAINNET]: BSC_RPC_PROVIDERS,\r\n  [ARBITRUM]: ARBITRUM_RPC_PROVIDERS,\r\n  [AVALANCHE]: AVALANCHE_RPC_PROVIDERS,\r\n};\r\n\r\nconst FALLBACK_PROVIDERS = {\r\n  [ARBITRUM]: [getAlchemyHttpUrl()],\r\n  [AVALANCHE]: [\"https://avax-mainnet.gateway.pokt.network/v1/lb/626f37766c499d003aada23b\"],\r\n};\r\n\r\nexport function shortenAddress(address, length) {\r\n  if (!length) {\r\n    return \"\";\r\n  }\r\n  if (!address) {\r\n    return address;\r\n  }\r\n  if (address.length < 10) {\r\n    return address;\r\n  }\r\n  let left = Math.floor((length - 3) / 2) + 1;\r\n  return address.substring(0, left) + \"...\" + address.substring(address.length - (length - (left + 3)), address.length);\r\n}\r\n\r\nexport function formatDateTime(time) {\r\n  return formatDateFn(time * 1000, \"dd MMM yyyy, h:mm a\");\r\n}\r\n\r\nexport function getTimeRemaining(time) {\r\n  const now = parseInt(Date.now() / 1000);\r\n  if (time < now) {\r\n    return \"0h 0m\";\r\n  }\r\n  const diff = time - now;\r\n  const hours = parseInt(diff / (60 * 60));\r\n  const minutes = parseInt((diff - hours * 60 * 60) / 60);\r\n  return `${hours}h ${minutes}m`;\r\n}\r\n\r\nexport function formatDate(time) {\r\n  return formatDateFn(time * 1000, \"dd MMM yyyy\");\r\n}\r\n\r\nexport function hasMetaMaskWalletExtension() {\r\n  return window.ethereum;\r\n}\r\n\r\nexport function hasCoinBaseWalletExtension() {\r\n  const { ethereum } = window;\r\n\r\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet) {\r\n    return false;\r\n  }\r\n  return window.ethereum.isCoinbaseWallet || ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\r\n}\r\n\r\nexport function activateInjectedProvider(providerName) {\r\n  const { ethereum } = window;\r\n\r\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet && !ethereum?.isMetaMask) {\r\n    return undefined;\r\n  }\r\n\r\n  let provider;\r\n  if (ethereum?.providers) {\r\n    switch (providerName) {\r\n      case \"CoinBase\":\r\n        provider = ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\r\n        break;\r\n      case \"MetaMask\":\r\n      default:\r\n        provider = ethereum.providers.find(({ isMetaMask }) => isMetaMask);\r\n        break;\r\n    }\r\n  }\r\n\r\n  if (provider) {\r\n    ethereum.setSelectedProvider(provider);\r\n  }\r\n}\r\n\r\nexport function getInjectedConnector() {\r\n  return injectedConnector;\r\n}\r\n\r\nexport function useChainId() {\r\n  let { chainId } = useWeb3React();\r\n\r\n  if (!chainId) {\r\n    const chainIdFromLocalStorage = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\r\n    if (chainIdFromLocalStorage) {\r\n      chainId = parseInt(chainIdFromLocalStorage);\r\n      if (!chainId) {\r\n        // localstorage value is invalid\r\n        localStorage.removeItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!chainId || !supportedChainIds.includes(chainId)) {\r\n    chainId = DEFAULT_CHAIN_ID;\r\n  }\r\n  return { chainId };\r\n}\r\n\r\nexport function useENS(address) {\r\n  const [ensName, setENSName] = useState();\r\n\r\n  useEffect(() => {\r\n    async function resolveENS() {\r\n      if (address) {\r\n        const provider = new ethers.providers.JsonRpcProvider(\"https://rpc.ankr.com/eth\");\r\n        const name = await provider.lookupAddress(address.toLowerCase());\r\n        if (name) setENSName(name);\r\n      }\r\n    }\r\n    resolveENS();\r\n  }, [address]);\r\n\r\n  return { ensName };\r\n}\r\n\r\nexport function clearWalletConnectData() {\r\n  localStorage.removeItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\r\n}\r\n\r\nexport function clearWalletLinkData() {\r\n  Object.entries(localStorage)\r\n    .map((x) => x[0])\r\n    .filter((x) => x.startsWith(WALLET_LINK_LOCALSTORAGE_PREFIX))\r\n    .map((x) => localStorage.removeItem(x));\r\n}\r\n\r\nexport function useEagerConnect(setActivatingConnector) {\r\n  const { activate, active } = useWeb3React();\r\n  const [tried, setTried] = useState(false);\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      if (Boolean(localStorage.getItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY)) !== true) {\r\n        // only works with WalletConnect\r\n        clearWalletConnectData();\r\n        // force clear localStorage connection for MM/CB Wallet (Brave legacy)\r\n        clearWalletLinkData();\r\n        return;\r\n      }\r\n\r\n      let shouldTryWalletConnect = false;\r\n      try {\r\n        // naive validation to not trigger Wallet Connect if data is corrupted\r\n        const rawData = localStorage.getItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\r\n        if (rawData) {\r\n          const data = JSON.parse(rawData);\r\n          if (data && data.connected) {\r\n            shouldTryWalletConnect = true;\r\n          }\r\n        }\r\n      } catch (ex) {\r\n        if (ex instanceof SyntaxError) {\r\n          // rawData is not a valid json\r\n          clearWalletConnectData();\r\n        }\r\n      }\r\n\r\n      if (shouldTryWalletConnect) {\r\n        try {\r\n          const connector = getWalletConnectConnector();\r\n          setActivatingConnector(connector);\r\n          await activate(connector, undefined, true);\r\n          // in case Wallet Connect is activated no need to check injected wallet\r\n          return;\r\n        } catch (ex) {\r\n          // assume data in localstorage is corrupted and delete it to not retry on next page load\r\n          clearWalletConnectData();\r\n        }\r\n      }\r\n\r\n      try {\r\n        const connector = getInjectedConnector();\r\n        const currentProviderName = localStorage.getItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY) ?? false;\r\n        if (currentProviderName !== false) {\r\n          activateInjectedProvider(currentProviderName);\r\n        }\r\n        const authorized = await connector.isAuthorized();\r\n        if (authorized) {\r\n          setActivatingConnector(connector);\r\n          await activate(connector, undefined, true);\r\n        }\r\n      } catch (ex) {}\r\n\r\n      setTried(true);\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []); // intentionally only running on mount (make sure it's only mounted once :))\r\n\r\n  // if the connection worked, wait until we get confirmation of that to flip the flag\r\n  useEffect(() => {\r\n    if (!tried && active) {\r\n      setTried(true);\r\n    }\r\n  }, [tried, active]);\r\n\r\n  return tried;\r\n}\r\n\r\nexport function useInactiveListener(suppress = false) {\r\n  const injected = getInjectedConnector();\r\n  const { active, error, activate } = useWeb3React();\r\n\r\n  useEffect(() => {\r\n    const { ethereum } = window;\r\n    if (ethereum && ethereum.on && !active && !error && !suppress) {\r\n      const handleConnect = () => {\r\n        activate(injected);\r\n      };\r\n      const handleChainChanged = (chainId) => {\r\n        activate(injected);\r\n      };\r\n      const handleAccountsChanged = (accounts) => {\r\n        if (accounts.length > 0) {\r\n          activate(injected);\r\n        }\r\n      };\r\n      const handleNetworkChanged = (networkId) => {\r\n        activate(injected);\r\n      };\r\n\r\n      ethereum.on(\"connect\", handleConnect);\r\n      ethereum.on(\"chainChanged\", handleChainChanged);\r\n      ethereum.on(\"accountsChanged\", handleAccountsChanged);\r\n      ethereum.on(\"networkChanged\", handleNetworkChanged);\r\n\r\n      return () => {\r\n        if (ethereum.removeListener) {\r\n          ethereum.removeListener(\"connect\", handleConnect);\r\n          ethereum.removeListener(\"chainChanged\", handleChainChanged);\r\n          ethereum.removeListener(\"accountsChanged\", handleAccountsChanged);\r\n          ethereum.removeListener(\"networkChanged\", handleNetworkChanged);\r\n        }\r\n      };\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [active, error, suppress, activate]);\r\n}\r\n\r\nexport function getProvider(library, chainId) {\r\n  let provider;\r\n  if (library) {\r\n    return library.getSigner();\r\n  }\r\n  provider = _.sample(RPC_PROVIDERS[chainId]);\r\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\r\n}\r\n\r\nexport function getFallbackProvider(chainId) {\r\n  if (!FALLBACK_PROVIDERS[chainId]) {\r\n    return;\r\n  }\r\n\r\n  const provider = _.sample(FALLBACK_PROVIDERS[chainId]);\r\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\r\n}\r\n\r\nexport function bigNumberify(n) {\r\n  try {\r\n    return ethers.BigNumber.from(n);\r\n  } catch (e) {\r\n    console.error(\"bigNumberify error\", e);\r\n    return undefined;\r\n  }\r\n}\r\n\r\nexport function expandDecimals(n, decimals) {\r\n  return bigNumberify(n).mul(bigNumberify(10).pow(decimals));\r\n}\r\n\r\nexport const trimZeroDecimals = (amount) => {\r\n  if (parseFloat(amount) === parseInt(amount)) {\r\n    return parseInt(amount).toString();\r\n  }\r\n  return amount;\r\n};\r\n\r\nexport const limitDecimals = (amount, maxDecimals) => {\r\n  let amountStr = amount.toString();\r\n  \r\n  if (maxDecimals === undefined) {\r\n    return amountStr;\r\n  }\r\n  if (maxDecimals === 0) {\r\n    return amountStr.split(\".\")[0];\r\n  }\r\n  const dotIndex = amountStr.indexOf(\".\");\r\n  if (dotIndex !== -1) {\r\n    let decimals = amountStr.length - dotIndex - 1;\r\n    if (decimals > maxDecimals) {\r\n      amountStr = amountStr.substr(0, amountStr.length - (decimals - maxDecimals));\r\n    }\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const padDecimals = (amount, minDecimals) => {\r\n  let amountStr = amount.toString();\r\n  const dotIndex = amountStr.indexOf(\".\");\r\n  if (dotIndex !== -1) {\r\n    const decimals = amountStr.length - dotIndex - 1;\r\n    if (decimals < minDecimals) {\r\n      amountStr = amountStr.padEnd(amountStr.length + (minDecimals - decimals), \"0\");\r\n    }\r\n  } else {\r\n    amountStr = amountStr + \".0000\";\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const formatKeyAmount = (map, key, tokenDecimals, displayDecimals, useCommas) => {\r\n  if (!map || !map[key]) {\r\n    return \"...\";\r\n  }\r\n\r\n  return formatAmount(map[key], tokenDecimals, displayDecimals, useCommas);\r\n};\r\n\r\nexport const formatArrayAmount = (arr, index, tokenDecimals, displayDecimals, useCommas) => {\r\n  if (!arr || !arr[index]) {\r\n    return \"...\";\r\n  }\r\n\r\n  return formatAmount(arr[index], tokenDecimals, displayDecimals, useCommas);\r\n};\r\n\r\nfunction _parseOrdersData(ordersData, account, indexes, extractor, uintPropsLength, addressPropsLength) {\r\n  if (!ordersData || ordersData.length === 0) {\r\n    return [];\r\n  }\r\n  const [uintProps, addressProps] = ordersData;\r\n  const count = uintProps.length / uintPropsLength;\r\n\r\n  const orders = [];\r\n  for (let i = 0; i < count; i++) {\r\n    const sliced = addressProps\r\n      .slice(addressPropsLength * i, addressPropsLength * (i + 1))\r\n      .concat(uintProps.slice(uintPropsLength * i, uintPropsLength * (i + 1)));\r\n\r\n    if (sliced[0] === AddressZero && sliced[1] === AddressZero) {\r\n      continue;\r\n    }\r\n\r\n    const order = extractor(sliced);\r\n    order.index = indexes[i];\r\n    order.account = account;\r\n    orders.push(order);\r\n  }\r\n\r\n  return orders;\r\n}\r\n\r\nfunction parseDecreaseOrdersData(chainId, decreaseOrdersData, account, indexes) {\r\n  const extractor = (sliced) => {\r\n    const isLong = sliced[4].toString() === \"1\";\r\n    return {\r\n      collateralToken: sliced[0],\r\n      indexToken: sliced[1],\r\n      collateralDelta: sliced[2],\r\n      sizeDelta: sliced[3],\r\n      isLong,\r\n      triggerPrice: sliced[5],\r\n      triggerAboveThreshold: sliced[6].toString() === \"1\",\r\n      type: DECREASE,\r\n    };\r\n  };\r\n  return _parseOrdersData(decreaseOrdersData, account, indexes, extractor, 5, 2).filter((order) => {\r\n    return isValidToken(chainId, order.collateralToken) && isValidToken(chainId, order.indexToken);\r\n  });\r\n}\r\n\r\nfunction parseIncreaseOrdersData(chainId, increaseOrdersData, account, indexes) {\r\n  const extractor = (sliced) => {\r\n    const isLong = sliced[5].toString() === \"1\";\r\n    return {\r\n      purchaseToken: sliced[0],\r\n      collateralToken: sliced[1],\r\n      indexToken: sliced[2],\r\n      purchaseTokenAmount: sliced[3],\r\n      sizeDelta: sliced[4],\r\n      isLong,\r\n      triggerPrice: sliced[6],\r\n      triggerAboveThreshold: sliced[7].toString() === \"1\",\r\n      type: INCREASE,\r\n    };\r\n  };\r\n  return _parseOrdersData(increaseOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\r\n    return (\r\n      isValidToken(chainId, order.purchaseToken) &&\r\n      isValidToken(chainId, order.collateralToken) &&\r\n      isValidToken(chainId, order.indexToken)\r\n    );\r\n  });\r\n}\r\n\r\nfunction parseSwapOrdersData(chainId, swapOrdersData, account, indexes) {\r\n  if (!swapOrdersData || !swapOrdersData.length) {\r\n    return [];\r\n  }\r\n\r\n  const extractor = (sliced) => {\r\n    const triggerAboveThreshold = sliced[6].toString() === \"1\";\r\n    const shouldUnwrap = sliced[7].toString() === \"1\";\r\n\r\n    return {\r\n      path: [sliced[0], sliced[1], sliced[2]].filter((address) => address !== AddressZero),\r\n      amountIn: sliced[3],\r\n      minOut: sliced[4],\r\n      triggerRatio: sliced[5],\r\n      triggerAboveThreshold,\r\n      type: SWAP,\r\n      shouldUnwrap,\r\n    };\r\n  };\r\n  return _parseOrdersData(swapOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\r\n    return order.path.every((token) => isValidToken(chainId, token));\r\n  });\r\n}\r\n\r\nexport function getOrderKey(order) {\r\n  return `${order.type}-${order.account}-${order.index}`;\r\n}\r\n\r\nexport function useAccountOrders(flagOrdersEnabled, overrideAccount) {\r\n  const { library, account: connectedAccount } = useWeb3React();\r\n  const active = true; // this is used in Actions.js so set active to always be true\r\n  const account = overrideAccount || connectedAccount;\r\n\r\n  const { chainId } = useChainId();\r\n  const shouldRequest = active && account && flagOrdersEnabled;\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const orderBookReaderAddress = getContract(chainId, \"OrderBookReader\");\r\n  const key = shouldRequest ? [active, chainId, orderBookAddress, account] : false;\r\n  const {\r\n    data: orders = [],\r\n    mutate: updateOrders,\r\n    error: ordersError,\r\n  } = useSWR(key, {\r\n    dedupingInterval: 5000,\r\n    fetcher: async (active, chainId, orderBookAddress, account) => {\r\n      const provider = getProvider(library, chainId);\r\n      const orderBookContract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\r\n      const orderBookReaderContract = new ethers.Contract(orderBookReaderAddress, OrderBookReader.abi, provider);\r\n\r\n      const fetchIndexesFromServer = () => {\r\n        const ordersIndexesUrl = `${getServerBaseUrl(chainId)}/orders_indices?account=${account}`;\r\n        return fetch(ordersIndexesUrl)\r\n          .then(async (res) => {\r\n            const json = await res.json();\r\n            const ret = {};\r\n            for (const key of Object.keys(json)) {\r\n              ret[key.toLowerCase()] = json[key].map((val) => parseInt(val.value)).sort((a, b) => a - b);\r\n            }\r\n\r\n            return ret;\r\n          })\r\n          .catch(() => ({ swap: [], increase: [], decrease: [] }));\r\n      };\r\n\r\n      const fetchLastIndex = async (type) => {\r\n        const method = type.toLowerCase() + \"OrdersIndex\";\r\n        return await orderBookContract[method](account).then((res) => bigNumberify(res._hex).toNumber());\r\n      };\r\n\r\n      const fetchLastIndexes = async () => {\r\n        const [swap, increase, decrease] = await Promise.all([\r\n          fetchLastIndex(\"swap\"),\r\n          fetchLastIndex(\"increase\"),\r\n          fetchLastIndex(\"decrease\"),\r\n        ]);\r\n\r\n        return { swap, increase, decrease };\r\n      };\r\n\r\n      const getRange = (to, from) => {\r\n        const LIMIT = 10;\r\n        const _indexes = [];\r\n        from = from || Math.max(to - LIMIT, 0);\r\n        for (let i = to - 1; i >= from; i--) {\r\n          _indexes.push(i);\r\n        }\r\n        return _indexes;\r\n      };\r\n\r\n      const getIndexes = (knownIndexes, lastIndex) => {\r\n        if (knownIndexes.length === 0) {\r\n          return getRange(lastIndex);\r\n        }\r\n        return [\r\n          ...knownIndexes,\r\n          ...getRange(lastIndex, knownIndexes[knownIndexes.length - 1] + 1).sort((a, b) => b - a),\r\n        ];\r\n      };\r\n\r\n      const getOrders = async (method, knownIndexes, lastIndex, parseFunc) => {\r\n        const indexes = getIndexes(knownIndexes, lastIndex);\r\n        const ordersData = await orderBookReaderContract[method](orderBookAddress, account, indexes);\r\n        const orders = parseFunc(chainId, ordersData, account, indexes);\r\n\r\n        return orders;\r\n      };\r\n\r\n      try {\r\n        const [serverIndexes, lastIndexes] = await Promise.all([fetchIndexesFromServer(), fetchLastIndexes()]);\r\n        const [swapOrders = [], increaseOrders = [], decreaseOrders = []] = await Promise.all([\r\n          getOrders(\"getSwapOrders\", serverIndexes.swap, lastIndexes.swap, parseSwapOrdersData),\r\n          getOrders(\"getIncreaseOrders\", serverIndexes.increase, lastIndexes.increase, parseIncreaseOrdersData),\r\n          getOrders(\"getDecreaseOrders\", serverIndexes.decrease, lastIndexes.decrease, parseDecreaseOrdersData),\r\n        ]);\r\n        return [...swapOrders, ...increaseOrders, ...decreaseOrders];\r\n      } catch (ex) {\r\n        console.error(ex);\r\n      }\r\n    },\r\n  });\r\n\r\n  return [orders, updateOrders, ordersError];\r\n}\r\n\r\nexport const formatAmount = (amount, tokenDecimals, displayDecimals, useCommas, defaultValue) => {\r\n  if (amount === null) {\r\n    return;\r\n  }\r\n  \r\n  if (!defaultValue) {\r\n    defaultValue = \"...\";\r\n  }\r\n  if (amount === undefined || amount.toString().length === 0) {\r\n    return defaultValue;\r\n  }\r\n  if (displayDecimals === undefined) {\r\n    displayDecimals = 4;\r\n  }\r\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\r\n  amountStr = limitDecimals(amountStr, displayDecimals);\r\n  if (displayDecimals !== 0) {\r\n    amountStr = padDecimals(amountStr, displayDecimals);\r\n  }\r\n  if (useCommas) {\r\n    return numberWithCommas(amountStr);\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const formatAmountFree = (amount, tokenDecimals, displayDecimals) => {\r\n  if (!amount) {\r\n    return \"...\";\r\n  }\r\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\r\n  amountStr = limitDecimals(amountStr, displayDecimals);\r\n  return trimZeroDecimals(amountStr);\r\n};\r\n\r\nexport const parseValue = (value, tokenDecimals) => {\r\n  const pValue = parseFloat(value);\r\n  if (isNaN(pValue)) {\r\n    return undefined;\r\n  }\r\n  value = limitDecimals(value, tokenDecimals);\r\n  const amount = ethers.utils.parseUnits(value, tokenDecimals);\r\n  return bigNumberify(amount);\r\n};\r\n\r\nexport function numberWithCommas(x) {\r\n  if (!x) {\r\n    return \"...\";\r\n  }\r\n  var parts = x.toString().split(\".\");\r\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n  return parts.join(\".\");\r\n}\r\n\r\nexport function getExplorerUrl(chainId) {\r\n  if (chainId === 3) {\r\n    return \"https://ropsten.etherscan.io/\";\r\n  } else if (chainId === 42) {\r\n    return \"https://kovan.etherscan.io/\";\r\n  } else if (chainId === MAINNET) {\r\n    return \"https://bscscan.com/\";\r\n  } else if (chainId === TESTNET) {\r\n    return \"https://testnet.bscscan.com/\";\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return \"https://testnet.arbiscan.io/\";\r\n  } else if (chainId === ARBITRUM) {\r\n    return \"https://arbiscan.io/\";\r\n  } else if (chainId === AVALANCHE) {\r\n    return \"https://snowtrace.io/\";\r\n  }\r\n  return \"https://etherscan.io/\";\r\n}\r\n\r\nexport function getAccountUrl(chainId, account) {\r\n  if (!account) {\r\n    return getExplorerUrl(chainId);\r\n  }\r\n  return getExplorerUrl(chainId) + \"address/\" + account;\r\n}\r\n\r\nexport function getTokenUrl(chainId, address) {\r\n  if (!address) {\r\n    return getExplorerUrl(chainId);\r\n  }\r\n  return getExplorerUrl(chainId) + \"token/\" + address;\r\n}\r\n\r\nexport function usePrevious(value) {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n\r\nexport function approveTokens({\r\n  setIsApproving,\r\n  library,\r\n  tokenAddress,\r\n  spender,\r\n  chainId,\r\n  onApproveSubmitted,\r\n  getTokenInfo,\r\n  infoTokens,\r\n  pendingTxns,\r\n  setPendingTxns,\r\n  includeMessage,\r\n}) {\r\n  setIsApproving(true);\r\n  const contract = new ethers.Contract(tokenAddress, Token.abi, library.getSigner());\r\n  contract\r\n    .approve(spender, ethers.constants.MaxUint256)\r\n    .then(async (res) => {\r\n      const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\r\n      helperToast.success(\r\n        <div>\r\n          Approval submitted!{\" \"}\r\n          <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n            View status.\r\n          </a>\r\n          <br />\r\n        </div>\r\n      );\r\n      if (onApproveSubmitted) {\r\n        onApproveSubmitted();\r\n      }\r\n      if (getTokenInfo && infoTokens && pendingTxns && setPendingTxns) {\r\n        const token = getTokenInfo(infoTokens, tokenAddress);\r\n        const pendingTxn = {\r\n          hash: res.hash,\r\n          message: includeMessage ? `${token.symbol} Approved!` : false,\r\n        };\r\n        setPendingTxns([...pendingTxns, pendingTxn]);\r\n      }\r\n    })\r\n    .catch((e) => {\r\n      console.error(e);\r\n      let failMsg;\r\n      if (\r\n        [\"not enough funds for gas\", \"failed to execute call with revert code InsufficientGasFunds\"].includes(\r\n          e.data?.message\r\n        )\r\n      ) {\r\n        failMsg = (\r\n          <div>\r\n            There is not enough ETH in your account on Arbitrum to send this transaction.\r\n            <br />\r\n            <br />\r\n            <a href={\"https://arbitrum.io/bridge-tutorial/\"} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              Bridge ETH to Arbitrum\r\n            </a>\r\n          </div>\r\n        );\r\n      } else if (e.message?.includes(\"User denied transaction signature\")) {\r\n        failMsg = \"Approval was cancelled\";\r\n      } else {\r\n        failMsg = \"Approval failed\";\r\n      }\r\n      helperToast.error(failMsg);\r\n    })\r\n    .finally(() => {\r\n      setIsApproving(false);\r\n    });\r\n}\r\n\r\nexport const shouldRaiseGasError = (token, amount) => {\r\n  if (!amount) {\r\n    return false;\r\n  }\r\n  if (token.address !== AddressZero) {\r\n    return false;\r\n  }\r\n  if (!token.balance) {\r\n    return false;\r\n  }\r\n  if (amount.gte(token.balance)) {\r\n    return true;\r\n  }\r\n  if (token.balance.sub(amount).lt(DUST_BNB)) {\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getTokenInfo = (infoTokens, tokenAddress, replaceNative, nativeTokenAddress) => {\r\n  if (replaceNative && tokenAddress === nativeTokenAddress) {\r\n    return infoTokens[AddressZero];\r\n  }\r\n  return infoTokens[tokenAddress];\r\n};\r\n\r\nconst NETWORK_METADATA = {\r\n  [MAINNET]: {\r\n    chainId: \"0x\" + MAINNET.toString(16),\r\n    chainName: \"BSC\",\r\n    nativeCurrency: {\r\n      name: \"BNB\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: BSC_RPC_PROVIDERS,\r\n    blockExplorerUrls: [\"https://bscscan.com\"],\r\n  },\r\n  [TESTNET]: {\r\n    chainId: \"0x\" + TESTNET.toString(16),\r\n    chainName: \"BSC Testnet\",\r\n    nativeCurrency: {\r\n      name: \"BNB\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: [\"https://data-seed-prebsc-1-s1.binance.org:8545/\"],\r\n    blockExplorerUrls: [\"https://testnet.bscscan.com/\"],\r\n  },\r\n  [ARBITRUM_TESTNET]: {\r\n    chainId: \"0x\" + ARBITRUM_TESTNET.toString(16),\r\n    chainName: \"Arbitrum Testnet\",\r\n    nativeCurrency: {\r\n      name: \"ETH\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: [\"https://rinkeby.arbitrum.io/rpc\"],\r\n    blockExplorerUrls: [\"https://rinkeby-explorer.arbitrum.io/\"],\r\n  },\r\n  [ARBITRUM]: {\r\n    chainId: \"0x\" + ARBITRUM.toString(16),\r\n    chainName: \"Arbitrum\",\r\n    nativeCurrency: {\r\n      name: \"ETH\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: ARBITRUM_RPC_PROVIDERS,\r\n    blockExplorerUrls: [getExplorerUrl(ARBITRUM)],\r\n  },\r\n  [AVALANCHE]: {\r\n    chainId: \"0x\" + AVALANCHE.toString(16),\r\n    chainName: \"Avalanche\",\r\n    nativeCurrency: {\r\n      name: \"AVAX\",\r\n      symbol: \"AVAX\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: AVALANCHE_RPC_PROVIDERS,\r\n    blockExplorerUrls: [getExplorerUrl(AVALANCHE)],\r\n  },\r\n};\r\n\r\nexport const addBscNetwork = async () => {\r\n  return addNetwork(NETWORK_METADATA[MAINNET]);\r\n};\r\n\r\nexport const addNetwork = async (metadata) => {\r\n  await window.ethereum.request({ method: \"wallet_addEthereumChain\", params: [metadata] }).catch();\r\n};\r\n\r\nexport const switchNetwork = async (chainId, active) => {\r\n  if (!active) {\r\n    // chainId in localStorage allows to switch network even if wallet is not connected\r\n    // or there is no wallet at all\r\n    localStorage.setItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY, chainId);\r\n    document.location.reload();\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const chainIdHex = \"0x\" + chainId.toString(16);\r\n    await window.ethereum.request({\r\n      method: \"wallet_switchEthereumChain\",\r\n      params: [{ chainId: chainIdHex }],\r\n    });\r\n    helperToast.success(\"Connected to \" + getChainName(chainId));\r\n    return getChainName(chainId);\r\n  } catch (ex) {\r\n    // https://docs.metamask.io/guide/rpc-api.html#other-rpc-methods\r\n    // This error code indicates that the chain has not been added to MetaMask.\r\n    // 4001 error means user has denied the request\r\n    // If the error code is not 4001, then we need to add the network\r\n    if (ex.code !== 4001) {\r\n      return await addNetwork(NETWORK_METADATA[chainId]);\r\n    }\r\n\r\n    console.error(\"error\", ex);\r\n  }\r\n};\r\n\r\nexport const getWalletConnectHandler = (activate, deactivate, setActivatingConnector) => {\r\n  const fn = async () => {\r\n    const walletConnect = getWalletConnectConnector();\r\n    setActivatingConnector(walletConnect);\r\n    activate(walletConnect, (ex) => {\r\n      if (ex instanceof UnsupportedChainIdError) {\r\n        helperToast.error(\"Unsupported chain. Switch to Arbitrum network on your wallet and try again\");\r\n        console.warn(ex);\r\n      } else if (!(ex instanceof UserRejectedRequestErrorWalletConnect)) {\r\n        helperToast.error(ex.message);\r\n        console.warn(ex);\r\n      }\r\n      clearWalletConnectData();\r\n      deactivate();\r\n    });\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport const getInjectedHandler = (activate) => {\r\n  const fn = async () => {\r\n    activate(getInjectedConnector(), (e) => {\r\n      const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\r\n\r\n      if (e instanceof UnsupportedChainIdError) {\r\n        helperToast.error(\r\n          <div>\r\n            <div>Your wallet is not connected to {getChainName(chainId)}.</div>\r\n            <br />\r\n            <div className=\"clickable underline margin-bottom\" onClick={() => switchNetwork(chainId, true)}>\r\n              Switch to {getChainName(chainId)}\r\n            </div>\r\n            <div className=\"clickable underline\" onClick={() => switchNetwork(chainId, true)}>\r\n              Add {getChainName(chainId)}\r\n            </div>\r\n          </div>\r\n        );\r\n        return;\r\n      }\r\n      const errString = e.message ?? e.toString();\r\n      helperToast.error(errString);\r\n    });\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport function isMobileDevice(navigator) {\r\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n}\r\n\r\nexport function setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress) {\r\n  if (!indexPrices) {\r\n    // console.log('return');\r\n    return;\r\n  }\r\n\r\n  // console.log('-------------------WENT THROUGH')\r\n\r\n  const tokenAddress = token.isNative ? nativeTokenAddress : token.address;\r\n\r\n  const indexPrice = indexPrices[tokenAddress];\r\n  if (!indexPrice) {\r\n    return;\r\n  }\r\n\r\n  const indexPriceBn = bigNumberify(indexPrice);\r\n  if (indexPriceBn.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  const spread = token.maxPrice.sub(token.minPrice);\r\n  const spreadBps = spread.mul(BASIS_POINTS_DIVISOR).div(token.maxPrice.add(token.minPrice).div(2));\r\n\r\n  if (spreadBps.gt(MAX_PRICE_DEVIATION_BASIS_POINTS - 50)) {\r\n    // only set one of the values as there will be a spread between the index price and the Chainlink price\r\n    if (indexPriceBn.gt(token.minPrimaryPrice)) {\r\n      token.maxPrice = indexPriceBn;\r\n    } else {\r\n      token.minPrice = indexPriceBn;\r\n    }\r\n    return;\r\n  }\r\n\r\n  const halfSpreadBps = spreadBps.div(2).toNumber();\r\n  token.maxPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR + halfSpreadBps).div(BASIS_POINTS_DIVISOR);\r\n  token.minPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR - halfSpreadBps).div(BASIS_POINTS_DIVISOR);\r\n}\r\n\r\nexport function getInfoTokens(\r\n  tokens,\r\n  tokenBalances,\r\n  whitelistedTokens,\r\n  vaultTokenInfo,\r\n  fundingRateInfo,\r\n  vaultPropsLength,\r\n  indexPrices,\r\n  nativeTokenAddress\r\n) {\r\n  if (!vaultPropsLength) {\r\n    vaultPropsLength = 15;\r\n  }\r\n  const fundingRatePropsLength = 2;\r\n  const infoTokens = {};\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = JSON.parse(JSON.stringify(tokens[i]));\r\n    if (tokenBalances) {\r\n      token.balance = tokenBalances[i];\r\n    }\r\n    if (token.address === USDG_ADDRESS) {\r\n      token.minPrice = expandDecimals(1, USD_DECIMALS);\r\n      token.maxPrice = expandDecimals(1, USD_DECIMALS);\r\n    }\r\n    infoTokens[token.address] = token;\r\n  }\r\n\r\n  for (let i = 0; i < whitelistedTokens.length; i++) {\r\n    const token = JSON.parse(JSON.stringify(whitelistedTokens[i]));\r\n    if (vaultTokenInfo) {\r\n      token.poolAmount = vaultTokenInfo[i * vaultPropsLength];\r\n      token.reservedAmount = vaultTokenInfo[i * vaultPropsLength + 1];\r\n      token.availableAmount = token.poolAmount.sub(token.reservedAmount);\r\n      token.usdgAmount = vaultTokenInfo[i * vaultPropsLength + 2];\r\n      token.redemptionAmount = vaultTokenInfo[i * vaultPropsLength + 3];\r\n      token.weight = vaultTokenInfo[i * vaultPropsLength + 4];\r\n      token.bufferAmount = vaultTokenInfo[i * vaultPropsLength + 5];\r\n      token.maxUsdgAmount = vaultTokenInfo[i * vaultPropsLength + 6];\r\n      token.globalShortSize = vaultTokenInfo[i * vaultPropsLength + 7];\r\n      token.maxGlobalShortSize = vaultTokenInfo[i * vaultPropsLength + 8];\r\n      token.maxGlobalLongSize = vaultTokenInfo[i * vaultPropsLength + 9];\r\n      token.minPrice = vaultTokenInfo[i * vaultPropsLength + 10];\r\n      token.maxPrice = vaultTokenInfo[i * vaultPropsLength + 11];\r\n      token.guaranteedUsd = vaultTokenInfo[i * vaultPropsLength + 12];\r\n      token.maxPrimaryPrice = vaultTokenInfo[i * vaultPropsLength + 13];\r\n      token.minPrimaryPrice = vaultTokenInfo[i * vaultPropsLength + 14];\r\n\r\n      // save minPrice and maxPrice as setTokenUsingIndexPrices may override it\r\n      token.contractMinPrice = token.minPrice;\r\n      token.contractMaxPrice = token.maxPrice;\r\n\r\n      token.maxAvailableShort = bigNumberify(0);\r\n      token.hasMaxAvailableShort = false;\r\n      if (token.maxGlobalShortSize.gt(0)) {\r\n        token.hasMaxAvailableShort = true;\r\n        if (token.maxGlobalShortSize.gt(token.globalShortSize)) {\r\n          token.maxAvailableShort = token.maxGlobalShortSize.sub(token.globalShortSize);\r\n        }\r\n      }\r\n\r\n      if (token.maxUsdgAmount.eq(0)) {\r\n        token.maxUsdgAmount = DEFAULT_MAX_USDG_AMOUNT;\r\n      }\r\n\r\n      token.availableUsd = token.isStable\r\n        ? token.poolAmount.mul(token.minPrice).div(expandDecimals(1, token.decimals))\r\n        : token.availableAmount.mul(token.minPrice).div(expandDecimals(1, token.decimals));\r\n\r\n      token.maxAvailableLong = bigNumberify(0);\r\n      token.hasMaxAvailableLong = false;\r\n      if (token.maxGlobalLongSize.gt(0)) {\r\n        token.hasMaxAvailableLong = true;\r\n\r\n        if (token.maxGlobalLongSize.gt(token.guaranteedUsd)) {\r\n          const remainingLongSize = token.maxGlobalLongSize.sub(token.guaranteedUsd);\r\n          token.maxAvailableLong = remainingLongSize.lt(token.availableUsd) ? remainingLongSize : token.availableUsd;\r\n        }\r\n      } else {\r\n        token.maxAvailableLong = token.availableUsd;\r\n      }\r\n\r\n      token.maxLongCapacity =\r\n        token.maxGlobalLongSize.gt(0) && token.maxGlobalLongSize.lt(token.availableUsd.add(token.guaranteedUsd))\r\n          ? token.maxGlobalLongSize\r\n          : token.availableUsd.add(token.guaranteedUsd);\r\n\r\n      token.managedUsd = token.availableUsd.add(token.guaranteedUsd);\r\n      token.managedAmount = token.managedUsd.mul(expandDecimals(1, token.decimals)).div(token.minPrice);\r\n\r\n      setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress);\r\n    }\r\n\r\n    if (fundingRateInfo) {\r\n      token.fundingRate = fundingRateInfo[i * fundingRatePropsLength];\r\n      token.cumulativeFundingRate = fundingRateInfo[i * fundingRatePropsLength + 1];\r\n    }\r\n\r\n    if (infoTokens[token.address]) {\r\n      token.balance = infoTokens[token.address].balance;\r\n    }\r\n\r\n    infoTokens[token.address] = token;\r\n  }\r\n\r\n  return infoTokens;\r\n}\r\n\r\nexport const CHART_PERIODS = {\r\n  \"5m\": 60 * 5,\r\n  \"15m\": 60 * 15,\r\n  \"1h\": 60 * 60,\r\n  \"4h\": 60 * 60 * 4,\r\n  \"1d\": 60 * 60 * 24,\r\n};\r\n\r\nexport function getTotalVolumeSum(volumes) {\r\n  if (!volumes || volumes.length === 0) {\r\n    return;\r\n  }\r\n\r\n  let volume = bigNumberify(0);\r\n  for (let i = 0; i < volumes.length; i++) {\r\n    volume = volume.add(volumes[i].data.volume);\r\n  }\r\n\r\n  return volume;\r\n}\r\n\r\nexport function getBalanceAndSupplyData(balances) {\r\n  if (!balances || balances.length === 0) {\r\n    return {};\r\n  }\r\n\r\n  const keys = [\"gmx\", \"esGmx\", \"glp\", \"stakedGmxTracker\"];\r\n  const balanceData = {};\r\n  const supplyData = {};\r\n  const propsLength = 2;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    balanceData[key] = balances[i * propsLength];\r\n    supplyData[key] = balances[i * propsLength + 1];\r\n  }\r\n\r\n  return { balanceData, supplyData };\r\n}\r\n\r\nexport function getDepositBalanceData(depositBalances) {\r\n  if (!depositBalances || depositBalances.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\r\n    \"gmxInStakedGmx\",\r\n    \"esGmxInStakedGmx\",\r\n    \"stakedGmxInBonusGmx\",\r\n    \"bonusGmxInFeeGmx\",\r\n    \"bnGmxInFeeGmx\",\r\n    \"glpInStakedGlp\",\r\n  ];\r\n  const data = {};\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = depositBalances[i];\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getVestingData(vestingInfo) {\r\n  if (!vestingInfo || vestingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"gmxVester\", \"glpVester\"];\r\n  const data = {};\r\n  const propsLength = 7;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      pairAmount: vestingInfo[i * propsLength],\r\n      vestedAmount: vestingInfo[i * propsLength + 1],\r\n      escrowedBalance: vestingInfo[i * propsLength + 2],\r\n      claimedAmounts: vestingInfo[i * propsLength + 3],\r\n      claimable: vestingInfo[i * propsLength + 4],\r\n      maxVestableAmount: vestingInfo[i * propsLength + 5],\r\n      averageStakedAmount: vestingInfo[i * propsLength + 6],\r\n    };\r\n\r\n    data[key + \"PairAmount\"] = data[key].pairAmount;\r\n    data[key + \"VestedAmount\"] = data[key].vestedAmount;\r\n    data[key + \"EscrowedBalance\"] = data[key].escrowedBalance;\r\n    data[key + \"ClaimSum\"] = data[key].claimedAmounts.add(data[key].claimable);\r\n    data[key + \"Claimable\"] = data[key].claimable;\r\n    data[key + \"MaxVestableAmount\"] = data[key].maxVestableAmount;\r\n    data[key + \"AverageStakedAmount\"] = data[key].averageStakedAmount;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getStakingData(stakingInfo) {\r\n  if (!stakingInfo || stakingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"stakedGmxTracker\", \"bonusGmxTracker\", \"feeGmxTracker\", \"stakedGlpTracker\", \"feeGlpTracker\"];\r\n  const data = {};\r\n  const propsLength = 5;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      claimable: stakingInfo[i * propsLength],\r\n      tokensPerInterval: stakingInfo[i * propsLength + 1],\r\n      averageStakedAmounts: stakingInfo[i * propsLength + 2],\r\n      cumulativeRewards: stakingInfo[i * propsLength + 3],\r\n      totalSupply: stakingInfo[i * propsLength + 4],\r\n    };\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getProcessedData(\r\n  balanceData,\r\n  supplyData,\r\n  depositBalanceData,\r\n  stakingData,\r\n  vestingData,\r\n  aum,\r\n  nativeTokenPrice,\r\n  stakedGmxSupply,\r\n  gmxPrice,\r\n  gmxSupply\r\n) {\r\n  if (\r\n    !balanceData ||\r\n    !supplyData ||\r\n    !depositBalanceData ||\r\n    !stakingData ||\r\n    !vestingData ||\r\n    !aum ||\r\n    !nativeTokenPrice ||\r\n    !stakedGmxSupply ||\r\n    !gmxPrice ||\r\n    !gmxSupply\r\n  ) {\r\n    return {};\r\n  }\r\n\r\n  const data = {};\r\n\r\n  data.gmxBalance = balanceData.gmx;\r\n  data.gmxBalanceUsd = balanceData.gmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.gmxSupply = bigNumberify(gmxSupply);\r\n\r\n  data.gmxSupplyUsd = data.gmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.stakedGmxSupply = stakedGmxSupply;\r\n  data.stakedGmxSupplyUsd = stakedGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.gmxInStakedGmx = depositBalanceData.gmxInStakedGmx;\r\n  data.gmxInStakedGmxUsd = depositBalanceData.gmxInStakedGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.esGmxBalance = balanceData.esGmx;\r\n  data.esGmxBalanceUsd = balanceData.esGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGmxTrackerSupply = supplyData.stakedGmxTracker;\r\n  data.stakedGmxTrackerSupplyUsd = supplyData.stakedGmxTracker.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.stakedEsGmxSupply = data.stakedGmxTrackerSupply.sub(data.stakedGmxSupply);\r\n  data.stakedEsGmxSupplyUsd = data.stakedEsGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.esGmxInStakedGmx = depositBalanceData.esGmxInStakedGmx;\r\n  data.esGmxInStakedGmxUsd = depositBalanceData.esGmxInStakedGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.bnGmxInFeeGmx = depositBalanceData.bnGmxInFeeGmx;\r\n  data.bonusGmxInFeeGmx = depositBalanceData.bonusGmxInFeeGmx;\r\n  data.feeGmxSupply = stakingData.feeGmxTracker.totalSupply;\r\n  data.feeGmxSupplyUsd = data.feeGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGmxTrackerRewards = stakingData.stakedGmxTracker.claimable;\r\n  data.stakedGmxTrackerRewardsUsd = stakingData.stakedGmxTracker.claimable.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.bonusGmxTrackerRewards = stakingData.bonusGmxTracker.claimable;\r\n\r\n  data.feeGmxTrackerRewards = stakingData.feeGmxTracker.claimable;\r\n  data.feeGmxTrackerRewardsUsd = stakingData.feeGmxTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\r\n\r\n  data.boostBasisPoints = bigNumberify(0);\r\n  if (data && data.bnGmxInFeeGmx && data.bonusGmxInFeeGmx && data.bonusGmxInFeeGmx.gt(0)) {\r\n    data.boostBasisPoints = data.bnGmxInFeeGmx.mul(BASIS_POINTS_DIVISOR).div(data.bonusGmxInFeeGmx);\r\n  }\r\n\r\n  data.stakedGmxTrackerAnnualRewardsUsd = stakingData.stakedGmxTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(gmxPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.gmxAprForEsGmx =\r\n    data.stakedGmxTrackerSupplyUsd && data.stakedGmxTrackerSupplyUsd.gt(0)\r\n      ? data.stakedGmxTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.stakedGmxTrackerSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.feeGmxTrackerAnnualRewardsUsd = stakingData.feeGmxTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(nativeTokenPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.gmxAprForNativeToken =\r\n    data.feeGmxSupplyUsd && data.feeGmxSupplyUsd.gt(0)\r\n      ? data.feeGmxTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.feeGmxSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.gmxBoostAprForNativeToken = data.gmxAprForNativeToken.mul(data.boostBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n  data.gmxAprTotal = data.gmxAprForNativeToken.add(data.gmxAprForEsGmx);\r\n  data.gmxAprTotalWithBoost = data.gmxAprForNativeToken.add(data.gmxBoostAprForNativeToken).add(data.gmxAprForEsGmx);\r\n  data.gmxAprForNativeTokenWithBoost = data.gmxAprForNativeToken.add(data.gmxBoostAprForNativeToken);\r\n\r\n  data.totalGmxRewardsUsd = data.stakedGmxTrackerRewardsUsd.add(data.feeGmxTrackerRewardsUsd);\r\n\r\n  data.glpSupply = supplyData.glp;\r\n  data.glpPrice =\r\n    data.glpSupply && data.glpSupply.gt(0)\r\n      ? aum.mul(expandDecimals(1, GLP_DECIMALS)).div(data.glpSupply)\r\n      : bigNumberify(0);\r\n\r\n  data.glpSupplyUsd = supplyData.glp.mul(data.glpPrice).div(expandDecimals(1, 18));\r\n\r\n  data.glpBalance = depositBalanceData.glpInStakedGlp;\r\n  data.glpBalanceUsd = depositBalanceData.glpInStakedGlp.mul(data.glpPrice).div(expandDecimals(1, GLP_DECIMALS));\r\n\r\n  data.stakedGlpTrackerRewards = stakingData.stakedGlpTracker.claimable;\r\n  data.stakedGlpTrackerRewardsUsd = stakingData.stakedGlpTracker.claimable.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.feeGlpTrackerRewards = stakingData.feeGlpTracker.claimable;\r\n  data.feeGlpTrackerRewardsUsd = stakingData.feeGlpTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGlpTrackerAnnualRewardsUsd = stakingData.stakedGlpTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(gmxPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.glpAprForEsGmx =\r\n    data.glpSupplyUsd && data.glpSupplyUsd.gt(0)\r\n      ? data.stakedGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.glpSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.feeGlpTrackerAnnualRewardsUsd = stakingData.feeGlpTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(nativeTokenPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.glpAprForNativeToken =\r\n    data.glpSupplyUsd && data.glpSupplyUsd.gt(0)\r\n      ? data.feeGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.glpSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.glpAprTotal = data.glpAprForNativeToken.add(data.glpAprForEsGmx);\r\n\r\n  data.totalGlpRewardsUsd = data.stakedGlpTrackerRewardsUsd.add(data.feeGlpTrackerRewardsUsd);\r\n\r\n  data.totalEsGmxRewards = data.stakedGmxTrackerRewards.add(data.stakedGlpTrackerRewards);\r\n  data.totalEsGmxRewardsUsd = data.stakedGmxTrackerRewardsUsd.add(data.stakedGlpTrackerRewardsUsd);\r\n\r\n  data.gmxVesterRewards = vestingData.gmxVester.claimable;\r\n  data.glpVesterRewards = vestingData.glpVester.claimable;\r\n  data.totalVesterRewards = data.gmxVesterRewards.add(data.glpVesterRewards);\r\n  data.totalVesterRewardsUsd = data.totalVesterRewards.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.totalNativeTokenRewards = data.feeGmxTrackerRewards.add(data.feeGlpTrackerRewards);\r\n  data.totalNativeTokenRewardsUsd = data.feeGmxTrackerRewardsUsd.add(data.feeGlpTrackerRewardsUsd);\r\n\r\n  data.totalRewardsUsd = data.totalEsGmxRewardsUsd.add(data.totalNativeTokenRewardsUsd).add(data.totalVesterRewardsUsd);\r\n\r\n  return data;\r\n}\r\n\r\nexport async function addTokenToMetamask(token) {\r\n  try {\r\n    const wasAdded = await window.ethereum.request({\r\n      method: \"wallet_watchAsset\",\r\n      params: {\r\n        type: \"ERC20\",\r\n        options: {\r\n          address: token.address,\r\n          symbol: token.symbol,\r\n          decimals: token.decimals,\r\n          image: token.imageUrl,\r\n        },\r\n      },\r\n    });\r\n    if (wasAdded) {\r\n      // https://github.com/MetaMask/metamask-extension/issues/11377\r\n      // We can show a toast message when the token is added to metamask but because of the bug we can't. Once the bug is fixed we can show a toast message.\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\nexport function sleep(ms) {\r\n  return new Promise((resolve) => resolve(), ms);\r\n}\r\n\r\nexport function getPageTitle(data) {\r\n  return `${data} | DeDeLend`;\r\n}\r\n\r\nexport function isHashZero(value) {\r\n  return value === ethers.constants.HashZero;\r\n}\r\nexport function isAddressZero(value) {\r\n  return value === ethers.constants.AddressZero;\r\n}\r\n\r\nexport function useDebounce(value, delay) {\r\n  // State and setters for debounced value\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n  useEffect(\r\n    () => {\r\n      // Update debounced value after delay\r\n      const handler = setTimeout(() => {\r\n        setDebouncedValue(value);\r\n      }, delay);\r\n      // Cancel the timeout if value changes (also on delay change or unmount)\r\n      // This is how we prevent debounced value from updating if value is changed ...\r\n      // .. within the delay period. Timeout gets cleared and restarted.\r\n      return () => {\r\n        clearTimeout(handler);\r\n      };\r\n    },\r\n    [value, delay] // Only re-call effect if value or delay changes\r\n  );\r\n  return debouncedValue;\r\n}\r\n\r\nexport function isDevelopment() {\r\n  return !window.location.host?.includes(\"gmx.io\") && !window.location.host?.includes(\"ipfs.io\");\r\n}\r\n\r\nexport function isLocal() {\r\n  return window.location.host?.includes(\"localhost\");\r\n}\r\n\r\nexport function getHomeUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3010\";\r\n  }\r\n\r\n  return \"https://gmx.io\";\r\n}\r\n\r\nexport function getAppBaseUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3011/#\";\r\n  }\r\n\r\n  return \"https://app.gmx.io/#\";\r\n}\r\n\r\nexport function getRootShareApiUrl() {\r\n  if (isLocal()) {\r\n    return \"https://gmxs.vercel.app\";\r\n  }\r\n\r\n  return \"https://share.gmx.io\";\r\n}\r\n\r\nexport function getTradePageUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3011/#/trade\";\r\n  }\r\n\r\n  return \"https://app.gmx.io/#/trade\";\r\n}\r\n\r\nexport function importImage(name) {\r\n  let tokenImage = null;\r\n  try {\r\n    tokenImage = require(\"../img/\" + name);\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n  return tokenImage && tokenImage.default;\r\n}\r\n\r\nexport function getTwitterIntentURL(text, url = \"\", hashtag = \"\") {\r\n  let finalURL = \"https://twitter.com/intent/tweet?text=\";\r\n  if (text.length > 0) {\r\n    finalURL += encodeURIComponent(text.replace(/[\\r\\n]+/g, \" \"))\r\n      .replace(/\\*%7C/g, \"*|URL:\")\r\n      .replace(/%7C\\*/g, \"|*\");\r\n\r\n    if (hashtag.length > 0) {\r\n      finalURL += \"&hashtags=\" + encodeURIComponent(hashtag.replace(/#/g, \"\"));\r\n    }\r\n    if (url.length > 0) {\r\n      finalURL += \"&url=\" + encodeURIComponent(url);\r\n    }\r\n  }\r\n  return finalURL;\r\n}\r\n\r\nexport function isValidTimestamp(timestamp) {\r\n  return new Date(timestamp).getTime() > 0;\r\n}\r\n\r\nexport function getPositionForOrder(account, order, positionsMap) {\r\n  const key = getPositionKey(account, order.collateralToken, order.indexToken, order.isLong);\r\n  const position = positionsMap[key];\r\n  return position && position.size && position.size.gt(0) ? position : null;\r\n}\r\n\r\nexport function getOrderError(account, order, positionsMap, position) {\r\n  if (order.type !== DECREASE) {\r\n    return;\r\n  }\r\n\r\n  const positionForOrder = position ? position : getPositionForOrder(account, order, positionsMap);\r\n\r\n  if (!positionForOrder) {\r\n    return \"No open position, order cannot be executed unless a position is opened\";\r\n  }\r\n  if (positionForOrder.size.lt(order.sizeDelta)) {\r\n    return \"Order size is bigger than position, will only be executable if position increases\";\r\n  }\r\n\r\n  if (positionForOrder.size.gt(order.sizeDelta)) {\r\n    if (positionForOrder.size.sub(order.sizeDelta).lt(positionForOrder.collateral.sub(order.collateralDelta))) {\r\n      return \"Order cannot be executed as it would reduce the position's leverage below 1\";\r\n    }\r\n    if (positionForOrder.size.sub(order.sizeDelta).lt(expandDecimals(5, USD_DECIMALS))) {\r\n      return \"Order cannot be executed as the remaining position would be smaller than $5.00\";\r\n    }\r\n  }\r\n}\r\n\r\nexport function arrayURLFetcher(...urlArr) {\r\n  const fetcher = (url) => fetch(url).then((res) => res.json());\r\n  return Promise.all(urlArr.map(fetcher));\r\n}\r\n\r\nexport function shouldShowRedirectModal(timestamp) {\r\n  const thirtyDays = 1000 * 60 * 60 * 24 * 30;\r\n  const expiryTime = timestamp + thirtyDays;\r\n  return !isValidTimestamp(timestamp) || Date.now() > expiryTime;\r\n}\r\n","import { ethers } from \"ethers\";\r\n\r\nimport { MAINNET, TESTNET, ARBITRUM_TESTNET, ARBITRUM, AVALANCHE } from \"../lib/legacyOptions\";\r\n\r\nconst { parseEther } = ethers.utils;\r\n\r\nconst constants = {\r\n  [MAINNET]: {\r\n    nativeTokenSymbol: \"BNB\",\r\n    defaultCollateralSymbol: \"BUSD\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 8,\r\n    v2: false,\r\n  },\r\n\r\n  [TESTNET]: {\r\n    nativeTokenSymbol: \"BNB\",\r\n    defaultCollateralSymbol: \"BUSD\",\r\n    defaultFlagOrdersEnabled: true,\r\n    positionReaderPropsLength: 8,\r\n    v2: false,\r\n  },\r\n\r\n  [ARBITRUM_TESTNET]: {\r\n    nativeTokenSymbol: \"ETH\",\r\n    defaultCollateralSymbol: \"USDC\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.000300001\"),\r\n  },\r\n\r\n  [ARBITRUM]: {\r\n    nativeTokenSymbol: \"ETH\",\r\n    wrappedTokenSymbol: \"WETH\",\r\n    defaultCollateralSymbol: \"USDC\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.000300001\"),\r\n  },\r\n\r\n  [AVALANCHE]: {\r\n    nativeTokenSymbol: \"AVAX\",\r\n    wrappedTokenSymbol: \"WAVAX\",\r\n    defaultCollateralSymbol: \"MIM\",\r\n    defaultFlagOrdersEnabled: true,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.01\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.01\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0100001\"),\r\n  },\r\n};\r\n\r\nexport const getConstant = (chainId, key) => {\r\n  if (!constants[chainId]) {\r\n    throw new Error(`Unsupported chainId ${chainId}`);\r\n  }\r\n  if (!(key in constants[chainId])) {\r\n    throw new Error(`Key ${key} does not exist for chainId ${chainId}`);\r\n  }\r\n  return constants[chainId][key];\r\n};\r\n","import { ApolloClient, InMemoryCache } from \"@apollo/client\";\r\n\r\nexport const chainlinkClient = createClient(\"https://api.thegraph.com/subgraphs/name/deividask/chainlink\");\r\nexport const arbitrumGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-stats\");\r\nexport const avalancheGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-avalanche-stats\");\r\nexport const nissohGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/nissoh/gmx-vault\");\r\nexport const arbitrumReferralsGraphClient = createClient(\r\n  \"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-arbitrum-referrals\"\r\n);\r\nexport const avalancheReferralsGraphClient = createClient(\r\n  \"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-avalanche-referrals\"\r\n);\r\n\r\nfunction createClient(uri) {\r\n  return new ApolloClient({\r\n    uri,\r\n    cache: new InMemoryCache(),\r\n  });\r\n}\r\n\r\nexport function get1InchSwapUrl(chainId, from, to) {\r\n  const rootUrl = `https://app.1inch.io/#/${chainId}/unified/swap`;\r\n  if (!from && !to) return rootUrl;\r\n  return `${rootUrl}/${from}/${to}`;\r\n}\r\n","// prettier-ignore\r\nimport {ethers} from \"ethers\";\r\nimport { Web3Provider } from \"@ethersproject/providers\";\r\nimport { getFallbackProvider, getProvider } from \"../legacyOptions\";\r\n\r\nexport const fetcher =\r\n  (library: Web3Provider, contractInfo: any, additionalArgs: any[]) =>\r\n  (...args: any) => {\r\n    // eslint-disable-next-line\r\n    const [id, chainId, arg0, arg1, ...params] = args;\r\n    const provider = getProvider(library, chainId);\r\n\r\n    const method = ethers.utils.isAddress(arg0) ? arg1 : arg0;\r\n\r\n    const contractCall = getContractCall({\r\n      provider,\r\n      contractInfo,\r\n      arg0,\r\n      arg1,\r\n      method,\r\n      params,\r\n      additionalArgs,\r\n    });\r\n\r\n    let shouldCallFallback = true;\r\n\r\n    const handleFallback = async (resolve, reject, error) => {\r\n      if (!shouldCallFallback) {\r\n        return;\r\n      }\r\n      // prevent fallback from being called twice\r\n      shouldCallFallback = false;\r\n\r\n      const fallbackProvider = getFallbackProvider(chainId);\r\n      if (!fallbackProvider) {\r\n        reject(error);\r\n        return;\r\n      }\r\n\r\n      console.info(\"using fallbackProvider for\", method);\r\n      const fallbackContractCall = getContractCall({\r\n        provider: fallbackProvider,\r\n        contractInfo,\r\n        arg0,\r\n        arg1,\r\n        method,\r\n        params,\r\n        additionalArgs,\r\n      });\r\n\r\n      fallbackContractCall\r\n        .then((result) => resolve(result))\r\n        .catch((e) => {\r\n          console.error(\"fallback fetcher error\", id, contractInfo.contractName, method, e);\r\n          reject(e);\r\n        });\r\n    };\r\n\r\n    return new Promise(async (resolve, reject) => {\r\n      contractCall\r\n        .then((result) => {\r\n          shouldCallFallback = false;\r\n          resolve(result);\r\n        })\r\n        .catch((e) => {\r\n          console.error(\"fetcher error\", id, contractInfo.contractName, method, e);\r\n          handleFallback(resolve, reject, e);\r\n        });\r\n\r\n      setTimeout(() => {\r\n        handleFallback(resolve, reject, \"contractCall timeout\");\r\n      }, 2000);\r\n    });\r\n  };\r\n\r\nfunction getContractCall({ provider, contractInfo, arg0, arg1, method, params, additionalArgs }) {\r\n  if (ethers.utils.isAddress(arg0)) {\r\n    const address = arg0;\r\n    const contract = new ethers.Contract(address, contractInfo.abi, provider);\r\n\r\n    if (additionalArgs) {\r\n      return contract[method](...params.concat(additionalArgs));\r\n    }\r\n    return contract[method](...params);\r\n  }\r\n\r\n  if (!provider) {\r\n    return;\r\n  }\r\n\r\n  return provider[method](arg1, ...params);\r\n}\r\n","import { toast, ToastContent, ToastOptions } from \"react-toastify\";\r\n\r\nexport const helperToast = {\r\n  success: (content: ToastContent, opts?: ToastOptions) => {\r\n    toast.dismiss();\r\n    toast.success(content, opts);\r\n  },\r\n  error: (content: ToastContent, opts?: ToastOptions) => {\r\n    toast.dismiss();\r\n    toast.error(content, opts);\r\n  },\r\n};\r\n","export const NOT_ENOUGH_FUNDS = \"NOT_ENOUGH_FUNDS\";\r\nexport const USER_DENIED = \"USER_DENIED\";\r\nexport const SLIPPAGE = \"SLIPPAGE\";\r\nexport const RPC_ERROR = \"RPC_ERROR\";\r\n\r\ntype ErrorPattern = { msg?: string; code?: number };\r\n\r\nconst TX_ERROR_PATTERNS: { [key: string]: ErrorPattern[] } = {\r\n  [NOT_ENOUGH_FUNDS]: [\r\n    { msg: \"not enough funds for gas\" },\r\n    { msg: \"failed to execute call with revert code InsufficientGasFunds\" },\r\n  ],\r\n  [USER_DENIED]: [{ msg: \"User denied transaction signature\" }],\r\n  [SLIPPAGE]: [{ msg: \"Router: mark price lower than limit\" }, { msg: \"Router: mark price higher than limit\" }],\r\n  [RPC_ERROR]: [\r\n    // @see https://eips.ethereum.org/EIPS/eip-1474#error-codes\r\n    { code: -32005 },\r\n    { msg: \"Non-200 status code\" },\r\n    { msg: \"Request limit exceeded\" },\r\n    { msg: \"Internal JSON-RPC error\" },\r\n    { msg: \"Response has no error or result\" },\r\n    { msg: \"couldn't connect to the network\" },\r\n  ],\r\n};\r\n\r\ntype TxError = {\r\n  message?: string;\r\n  code?: number;\r\n  data?: any;\r\n};\r\n\r\nexport function extractError(ex: TxError) {\r\n  if (!ex) {\r\n    return [];\r\n  }\r\n\r\n  const message = ex.data?.message || ex.message;\r\n  const code = ex.code;\r\n\r\n  if (!message && !code) {\r\n    return [];\r\n  }\r\n\r\n  for (const [type, patterns] of Object.entries(TX_ERROR_PATTERNS)) {\r\n    for (const pattern of patterns) {\r\n      const matchCode = pattern.code && code === pattern.code;\r\n      const matchMessage = pattern.msg && message && message.includes(pattern.msg);\r\n\r\n      if (matchCode || matchMessage) {\r\n        return [message, type, ex.data];\r\n      }\r\n    }\r\n  }\r\n\r\n  return [message, null, ex.data];\r\n}\r\n","import { ARBITRUM, AVALANCHE } from \"../legacyOptions\";\r\n\r\nexport const GAS_PRICE_ADJUSTMENT_MAP = {\r\n  [ARBITRUM]: \"0\",\r\n  [AVALANCHE]: \"3000000000\", // 3 gwei\r\n};\r\n\r\nexport const MAX_GAS_PRICE_MAP = {\r\n  [AVALANCHE]: \"200000000000\", // 200 gwei\r\n};","import { useMemo } from \"react\";\r\nimport { gql } from \"@apollo/client\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport { USD_DECIMALS, CHART_PERIODS, formatAmount, sleep } from \"../lib/legacyOptions\";\r\nimport { chainlinkClient } from \"./common\";\r\n\r\nconst BigNumber = ethers.BigNumber;\r\n\r\n// Ethereum network, Chainlink Aggregator contracts\r\nconst FEED_ID_MAP = {\r\n  BTC_USD: \"0xae74faa92cb67a95ebcab07358bc222e33a34da7\",\r\n  ETH_USD: \"0x37bc7498f4ff12c19678ee8fe19d713b87f6a9e6\",\r\n  BNB_USD: \"0xc45ebd0f901ba6b2b8c7e70b717778f055ef5e6d\",\r\n  LINK_USD: \"0xdfd03bfc3465107ce570a0397b247f546a42d0fa\",\r\n  UNI_USD: \"0x68577f915131087199fe48913d8b416b3984fd38\",\r\n  SUSHI_USD: \"0x7213536a36094cd8a768a5e45203ec286cba2d74\",\r\n  AVAX_USD: \"0x0fc3657899693648bba4dbd2d8b33b82e875105d\",\r\n  AAVE_USD: \"0xe3f0dede4b499c07e12475087ab1a084b5f93bc0\",\r\n  YFI_USD: \"0x8a4d74003870064d41d4f84940550911fbfccf04\",\r\n  SPELL_USD: \"0x8640b23468815902e011948f3ab173e1e83f9879\",\r\n};\r\nconst timezoneOffset = -new Date().getTimezoneOffset() * 60;\r\n\r\nfunction fillGaps(prices, periodSeconds) {\r\n  if (prices.length < 2) {\r\n    return prices;\r\n  }\r\n\r\n  const newPrices = [prices[0]];\r\n  let prevTime = prices[0].time;\r\n  for (let i = 1; i < prices.length; i++) {\r\n    const { time, open } = prices[i];\r\n    if (prevTime) {\r\n      let j = (time - prevTime) / periodSeconds - 1;\r\n      while (j > 0) {\r\n        newPrices.push({\r\n          time: time - j * periodSeconds,\r\n          open,\r\n          close: open,\r\n          high: open * 1.0003,\r\n          low: open * 0.9996,\r\n        });\r\n        j--;\r\n      }\r\n    }\r\n\r\n    prevTime = time;\r\n    newPrices.push(prices[i]);\r\n  }\r\n\r\n  return newPrices;\r\n}\r\n\r\nasync function getChartPricesFromStats(chainId, symbol, period) {\r\n  if ([\"WBTC\", \"WETH\", \"WAVAX\"].includes(symbol)) {\r\n    symbol = symbol.substr(1);\r\n  } else if (symbol === \"BTC.b\") {\r\n    symbol = \"BTC\";\r\n  }\r\n  const hostname = \"https://stats.gmx.io/\";\r\n  // const hostname = 'http://localhost:3113/'\r\n  const timeDiff = CHART_PERIODS[period] * 3000;\r\n  const from = Math.floor(Date.now() / 1000 - timeDiff);\r\n  const url = `${hostname}api/candles/${symbol}?preferableChainId=${chainId}&period=${period}&from=${from}&preferableSource=fast`;\r\n  const TIMEOUT = 5000;\r\n  const res = await new Promise(async (resolve, reject) => {\r\n    let done = false;\r\n    setTimeout(() => {\r\n      done = true;\r\n      reject(new Error(`request timeout ${url}`));\r\n    }, TIMEOUT);\r\n\r\n    let lastEx;\r\n    for (let i = 0; i < 3; i++) {\r\n      if (done) return;\r\n      try {\r\n        const res = await fetch(url);\r\n        resolve(res);\r\n        return;\r\n      } catch (ex) {\r\n        await sleep(300);\r\n        lastEx = ex;\r\n      }\r\n    }\r\n    reject(lastEx);\r\n  });\r\n  if (!res.ok) {\r\n    throw new Error(`request failed ${res.status} ${res.statusText}`);\r\n  }\r\n  const json = await res.json();\r\n  let prices = json?.prices;\r\n  if (!prices || prices.length < 10) {\r\n    throw new Error(`not enough prices data: ${prices?.length}`);\r\n  }\r\n\r\n  const OBSOLETE_THRESHOLD = Date.now() / 1000 - 60 * 30; // 30 min ago\r\n  const updatedAt = json?.updatedAt || 0;\r\n  if (updatedAt < OBSOLETE_THRESHOLD) {\r\n    throw new Error(\r\n      \"chart data is obsolete, last price record at \" +\r\n        new Date(updatedAt * 1000).toISOString() +\r\n        \" now: \" +\r\n        new Date().toISOString()\r\n    );\r\n  }\r\n\r\n  prices = prices.map(({ t, o: open, c: close, h: high, l: low }) => ({\r\n    time: t + timezoneOffset,\r\n    open,\r\n    close,\r\n    high,\r\n    low,\r\n  }));\r\n  return prices;\r\n}\r\n\r\nfunction getCandlesFromPrices(prices, period) {\r\n  const periodTime = CHART_PERIODS[period];\r\n\r\n  if (prices.length < 2) {\r\n    return [];\r\n  }\r\n\r\n  const candles = [];\r\n  const first = prices[0];\r\n  let prevTsGroup = Math.floor(first[0] / periodTime) * periodTime;\r\n  let prevPrice = first[1];\r\n  let o = prevPrice;\r\n  let h = prevPrice;\r\n  let l = prevPrice;\r\n  let c = prevPrice;\r\n  for (let i = 1; i < prices.length; i++) {\r\n    const [ts, price] = prices[i];\r\n    const tsGroup = Math.floor(ts / periodTime) * periodTime;\r\n    if (prevTsGroup !== tsGroup) {\r\n      candles.push({ t: prevTsGroup + timezoneOffset, o, h, l, c });\r\n      o = c;\r\n      h = Math.max(o, c);\r\n      l = Math.min(o, c);\r\n    }\r\n    c = price;\r\n    h = Math.max(h, price);\r\n    l = Math.min(l, price);\r\n    prevTsGroup = tsGroup;\r\n  }\r\n\r\n  return candles.map(({ t: time, o: open, c: close, h: high, l: low }) => ({\r\n    time,\r\n    open,\r\n    close,\r\n    high,\r\n    low,\r\n  }));\r\n}\r\n\r\nfunction getChainlinkChartPricesFromGraph(tokenSymbol, period) {\r\n  if ([\"WBTC\", \"WETH\", \"WAVAX\"].includes(tokenSymbol)) {\r\n    tokenSymbol = tokenSymbol.substr(1);\r\n  }\r\n  const marketName = tokenSymbol + \"_USD\";\r\n  const feedId = FEED_ID_MAP[marketName];\r\n  if (!feedId) {\r\n    throw new Error(`undefined marketName ${marketName}`);\r\n  }\r\n\r\n  const PER_CHUNK = 1000;\r\n  const CHUNKS_TOTAL = 6;\r\n  const requests = [];\r\n  for (let i = 0; i < CHUNKS_TOTAL; i++) {\r\n    const query = gql(`{\r\n      rounds(\r\n        first: ${PER_CHUNK},\r\n        skip: ${i * PER_CHUNK},\r\n        orderBy: unixTimestamp,\r\n        orderDirection: desc,\r\n        where: {feed: \"${feedId}\"}\r\n      ) {\r\n        unixTimestamp,\r\n        value\r\n      }\r\n    }`);\r\n    requests.push(chainlinkClient.query({ query }));\r\n  }\r\n\r\n  return Promise.all(requests)\r\n    .then((chunks) => {\r\n      let prices = [];\r\n      const uniqTs = new Set();\r\n      chunks.forEach((chunk) => {\r\n        chunk.data.rounds.forEach((item) => {\r\n          if (uniqTs.has(item.unixTimestamp)) {\r\n            return;\r\n          }\r\n\r\n          uniqTs.add(item.unixTimestamp);\r\n          prices.push([item.unixTimestamp, Number(item.value) / 1e8]);\r\n        });\r\n      });\r\n\r\n      prices.sort(([timeA], [timeB]) => timeA - timeB);\r\n      prices = getCandlesFromPrices(prices, period);\r\n      return prices;\r\n    })\r\n    .catch((err) => {\r\n      console.error(err);\r\n    });\r\n}\r\n\r\nexport function useChartPrices(chainId, symbol, isStable, period, currentAveragePrice) {\r\n  const swrKey = !isStable && symbol ? [\"getChartCandles\", chainId, symbol, period] : null;\r\n  let { data: prices, mutate: updatePrices } = useSWR(swrKey, {\r\n    fetcher: async (...args) => {\r\n      try {\r\n        return await getChartPricesFromStats(chainId, symbol, period);\r\n      } catch (ex) {\r\n        console.warn(ex);\r\n        console.warn(\"Switching to graph chainlink data\");\r\n        try {\r\n          return await getChainlinkChartPricesFromGraph(symbol, period);\r\n        } catch (ex2) {\r\n          console.warn(\"getChainlinkChartPricesFromGraph failed\");\r\n          console.warn(ex2);\r\n          return [];\r\n        }\r\n      }\r\n    },\r\n    dedupingInterval: 60000,\r\n    focusThrottleInterval: 60000 * 10,\r\n  });\r\n\r\n  const currentAveragePriceString = currentAveragePrice && currentAveragePrice.toString();\r\n  const retPrices = useMemo(() => {\r\n    if (isStable) {\r\n      return getStablePriceData(period);\r\n    }\r\n\r\n    if (!prices) {\r\n      return [];\r\n    }\r\n\r\n    let _prices = [...prices];\r\n    if (currentAveragePriceString && prices.length) {\r\n      _prices = appendCurrentAveragePrice(_prices, BigNumber.from(currentAveragePriceString), period);\r\n    }\r\n\r\n    return fillGaps(_prices, CHART_PERIODS[period]);\r\n  }, [prices, isStable, currentAveragePriceString, period]);\r\n\r\n  return [retPrices, updatePrices];\r\n}\r\n\r\nfunction appendCurrentAveragePrice(prices, currentAveragePrice, period) {\r\n  const periodSeconds = CHART_PERIODS[period];\r\n  const currentCandleTime = Math.floor(Date.now() / 1000 / periodSeconds) * periodSeconds + timezoneOffset;\r\n  const last = prices[prices.length - 1];\r\n  const averagePriceValue = parseFloat(formatAmount(currentAveragePrice, USD_DECIMALS, 2));\r\n  if (currentCandleTime === last.time) {\r\n    last.close = averagePriceValue;\r\n    last.high = Math.max(last.high, averagePriceValue);\r\n    last.low = Math.max(last.low, averagePriceValue);\r\n    return prices;\r\n  } else {\r\n    const newCandle = {\r\n      time: currentCandleTime,\r\n      open: last.close,\r\n      close: averagePriceValue,\r\n      high: averagePriceValue,\r\n      low: averagePriceValue,\r\n    };\r\n    return [...prices, newCandle];\r\n  }\r\n}\r\n\r\nfunction getStablePriceData(period) {\r\n  const periodSeconds = CHART_PERIODS[period];\r\n  const now = Math.floor(Date.now() / 1000 / periodSeconds) * periodSeconds;\r\n  let priceData = [];\r\n  for (let i = 100; i > 0; i--) {\r\n    priceData.push({\r\n      time: now - i * periodSeconds,\r\n      open: 1,\r\n      close: 1,\r\n      high: 1,\r\n      low: 1,\r\n    });\r\n  }\r\n  return priceData;\r\n}\r\n","import { ethers } from \"ethers\";\r\nimport { gql } from \"@apollo/client\";\r\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Token as UniToken } from \"@uniswap/sdk-core\";\r\nimport { Pool } from \"@uniswap/v3-sdk\";\r\nimport useSWR from \"swr\";\r\n\r\nimport OrderBook from \"../abis/OrderBook.json\";\r\nimport PositionManager from \"../abis/PositionManager.json\";\r\nimport Vault from \"../abis/Vault.json\";\r\nimport Router from \"../abis/Router.json\";\r\nimport UniPool from \"../abis/UniPool.json\";\r\nimport UniswapV2 from \"../abis/UniswapV2.json\";\r\nimport Token from \"../abis/Token.json\";\r\nimport VaultReader from \"../abis/VaultReader.json\";\r\nimport PositionRouter from \"../abis/PositionRouter.json\";\r\n\r\nimport { getContract } from \"../config/Addresses\";\r\nimport { getConstant } from \"../config/chains\";\r\nimport {\r\n  ARBITRUM,\r\n  ARBITRUM_TESTNET,\r\n  AVALANCHE,\r\n  bigNumberify,\r\n  DECREASE,\r\n  expandDecimals,\r\n  getHighExecutionFee,\r\n  getInfoTokens,\r\n  getOrderKey,\r\n  getProvider,\r\n  getServerBaseUrl,\r\n  getServerUrl,\r\n  getUsd,\r\n  INCREASE,\r\n  parseValue,\r\n  replaceNativeTokenAddress,\r\n  SWAP,\r\n  UI_VERSION,\r\n  USD_DECIMALS,\r\n} from \"../lib/legacyOptions\";\r\nimport { getTokenBySymbol, getTokens, getWhitelistedTokens } from \"../config/Tokens\";\r\n\r\nimport { arbitrumGraphClient, avalancheGraphClient, nissohGraphClient } from \"./common\";\r\nimport { groupBy } from \"lodash\";\r\nimport { fetcher } from \"../lib/contracts/fetcher\";\r\nimport { callContract } from \"../lib/contracts/callContract\";\r\n\r\nexport * from \"./prices\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getGmxGraphClient(chainId) {\r\n  if (chainId === ARBITRUM) {\r\n    return arbitrumGraphClient;\r\n  } else if (chainId === AVALANCHE) {\r\n    return avalancheGraphClient;\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return null;\r\n  }\r\n  throw new Error(`Unsupported chain ${chainId}`);\r\n}\r\n\r\nexport function useAllOrdersStats(chainId) {\r\n  const query = gql(`{\r\n    orderStat(id: \"total\") {\r\n      openSwap\r\n      openIncrease\r\n      openDecrease\r\n      executedSwap\r\n      executedIncrease\r\n      executedDecrease\r\n      cancelledSwap\r\n      cancelledIncrease\r\n      cancelledDecrease\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    const graphClient = getGmxGraphClient(chainId);\r\n    if (graphClient) {\r\n      graphClient.query({ query }).then(setRes).catch(console.warn);\r\n    }\r\n  }, [setRes, query, chainId]);\r\n\r\n  return res ? res.data.orderStat : null;\r\n}\r\n\r\nexport function useInfoTokens(library, chainId, active, tokenBalances, fundingRateInfo, vaultPropsLength) {\r\n  const tokens = getTokens(chainId);\r\n  const vaultReaderAddress = getContract(chainId, \"VaultReader\");\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const whitelistedTokenAddresses = whitelistedTokens.map((token) => token.address);\r\n\r\n  const { data: vaultTokenInfo } = useSWR(\r\n    [`useInfoTokens:${active}`, chainId, vaultReaderAddress, \"getVaultTokenInfoV4\"],\r\n    {\r\n      fetcher: fetcher(library, VaultReader, [\r\n        vaultAddress,\r\n        positionRouterAddress,\r\n        nativeTokenAddress,\r\n        expandDecimals(1, 18),\r\n        whitelistedTokenAddresses,\r\n      ]),\r\n    }\r\n  );\r\n\r\n  const indexPricesUrl = getServerUrl(chainId, \"/prices\");\r\n  const { data: indexPrices } = useSWR([indexPricesUrl], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.json()),\r\n    refreshInterval: 500,\r\n    refreshWhenHidden: true,\r\n  });\r\n  \r\n  return {\r\n    infoTokens: getInfoTokens(\r\n      tokens,\r\n      tokenBalances,\r\n      whitelistedTokens,\r\n      vaultTokenInfo,\r\n      fundingRateInfo,\r\n      vaultPropsLength,\r\n      indexPrices,\r\n      nativeTokenAddress\r\n    ),\r\n  };\r\n}\r\n\r\nexport function useUserStat(chainId) {\r\n  const query = gql(`{\r\n    userStat(id: \"total\") {\r\n      id\r\n      uniqueCount\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    getGmxGraphClient(chainId).query({ query }).then(setRes).catch(console.warn);\r\n  }, [setRes, query, chainId]);\r\n\r\n  return res ? res.data.userStat : null;\r\n}\r\n\r\nexport function useLiquidationsData(chainId, account) {\r\n  const [data, setData] = useState(null);\r\n  useEffect(() => {\r\n    if (account) {\r\n      const query = gql(`{\r\n         liquidatedPositions(\r\n           where: {account: \"${account.toLowerCase()}\"}\r\n           first: 100\r\n           orderBy: timestamp\r\n           orderDirection: desc\r\n         ) {\r\n           key\r\n           timestamp\r\n           borrowFee\r\n           loss\r\n           collateral\r\n           size\r\n           markPrice\r\n           type\r\n         }\r\n      }`);\r\n      const graphClient = getGmxGraphClient(chainId);\r\n      if (!graphClient) {\r\n        return;\r\n      }\r\n\r\n      graphClient\r\n        .query({ query })\r\n        .then((res) => {\r\n          const _data = res.data.liquidatedPositions.map((item) => {\r\n            return {\r\n              ...item,\r\n              size: bigNumberify(item.size),\r\n              collateral: bigNumberify(item.collateral),\r\n              markPrice: bigNumberify(item.markPrice),\r\n            };\r\n          });\r\n          setData(_data);\r\n        })\r\n        .catch(console.warn);\r\n    }\r\n  }, [setData, chainId, account]);\r\n\r\n  return data;\r\n}\r\n\r\nexport function useAllPositions(chainId, library) {\r\n  const count = 1000;\r\n  const query = gql(`{\r\n    aggregatedTradeOpens(\r\n      first: ${count}\r\n    ) {\r\n      account\r\n      initialPosition{\r\n        indexToken\r\n        collateralToken\r\n        isLong\r\n        sizeDelta\r\n      }\r\n      increaseList {\r\n        sizeDelta\r\n      }\r\n      decreaseList {\r\n        sizeDelta\r\n      }\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    nissohGraphClient.query({ query }).then(setRes).catch(console.warn);\r\n  }, [setRes, query]);\r\n\r\n  const key = res ? `allPositions${count}__` : false;\r\n  const { data: positions = [] } = useSWR(key, async () => {\r\n    const provider = getProvider(library, chainId);\r\n    const vaultAddress = getContract(chainId, \"Vault\");\r\n    const contract = new ethers.Contract(vaultAddress, Vault.abi, provider);\r\n    const ret = await Promise.all(\r\n      res.data.aggregatedTradeOpens.map(async (dataItem) => {\r\n        try {\r\n          const { indexToken, collateralToken, isLong } = dataItem.initialPosition;\r\n          const positionData = await contract.getPosition(dataItem.account, collateralToken, indexToken, isLong);\r\n          const position = {\r\n            size: bigNumberify(positionData[0]),\r\n            collateral: bigNumberify(positionData[1]),\r\n            entryFundingRate: bigNumberify(positionData[3]),\r\n            account: dataItem.account,\r\n          };\r\n          position.fundingFee = await contract.getFundingFee(collateralToken, position.size, position.entryFundingRate);\r\n          position.marginFee = position.size.div(1000);\r\n          position.fee = position.fundingFee.add(position.marginFee);\r\n\r\n          const THRESHOLD = 5000;\r\n          const collateralDiffPercent = position.fee.mul(10000).div(position.collateral);\r\n          position.danger = collateralDiffPercent.gt(THRESHOLD);\r\n\r\n          return position;\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n\r\n    return ret.filter(Boolean);\r\n  });\r\n\r\n  return positions;\r\n}\r\n\r\nexport function useAllOrders(chainId, library) {\r\n  const query = gql(`{\r\n    orders(\r\n      first: 1000,\r\n      orderBy: createdTimestamp,\r\n      orderDirection: desc,\r\n      where: {status: \"open\"}\r\n    ) {\r\n      type\r\n      account\r\n      index\r\n      status\r\n      createdTimestamp\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    getGmxGraphClient(chainId).query({ query }).then(setRes);\r\n  }, [setRes, query, chainId]);\r\n\r\n  const key = res ? res.data.orders.map((order) => `${order.type}-${order.account}-${order.index}`) : null;\r\n  const { data: orders = [] } = useSWR(key, () => {\r\n    const provider = getProvider(library, chainId);\r\n    const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n    const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\r\n    return Promise.all(\r\n      res.data.orders.map(async (order) => {\r\n        try {\r\n          const type = order.type.charAt(0).toUpperCase() + order.type.substring(1);\r\n          const method = `get${type}Order`;\r\n          const orderFromChain = await contract[method](order.account, order.index);\r\n          const ret = {};\r\n          for (const [key, val] of Object.entries(orderFromChain)) {\r\n            ret[key] = val;\r\n          }\r\n          if (order.type === \"swap\") {\r\n            ret.path = [ret.path0, ret.path1, ret.path2].filter((address) => address !== AddressZero);\r\n          }\r\n          ret.type = type;\r\n          ret.index = order.index;\r\n          ret.account = order.account;\r\n          ret.createdTimestamp = order.createdTimestamp;\r\n          return ret;\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n  });\r\n\r\n  return orders.filter(Boolean);\r\n}\r\n\r\nexport function usePositionsForOrders(chainId, library, orders) {\r\n  const key = orders ? orders.map((order) => getOrderKey(order) + \"____\") : null;\r\n  const { data: positions = {} } = useSWR(key, async () => {\r\n    const provider = getProvider(library, chainId);\r\n    const vaultAddress = getContract(chainId, \"Vault\");\r\n    const contract = new ethers.Contract(vaultAddress, Vault.abi, provider);\r\n    const data = await Promise.all(\r\n      orders.map(async (order) => {\r\n        try {\r\n          const position = await contract.getPosition(\r\n            order.account,\r\n            order.collateralToken,\r\n            order.indexToken,\r\n            order.isLong\r\n          );\r\n          if (position[0].eq(0)) {\r\n            return [null, order];\r\n          }\r\n          return [position, order];\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n    return data.reduce((memo, [position, order]) => {\r\n      memo[getOrderKey(order)] = position;\r\n      return memo;\r\n    }, {});\r\n  });\r\n\r\n  return positions;\r\n}\r\n\r\nfunction invariant(condition, errorMsg) {\r\n  if (!condition) {\r\n    throw new Error(errorMsg);\r\n  }\r\n}\r\n\r\nexport function useTrades(chainId, account, forSingleAccount, afterId) {\r\n  let url =\r\n    account && account.length > 0\r\n      ? `${getServerBaseUrl(chainId)}/actions?account=${account}`\r\n      : !forSingleAccount && `${getServerBaseUrl(chainId)}/actions`;\r\n\r\n  if (afterId && afterId.length > 0) {\r\n    const urlItem = new URL(url);\r\n    urlItem.searchParams.append(\"after\", afterId);\r\n    url = urlItem.toString();\r\n  }\r\n\r\n  const { data: trades, mutate: updateTrades } = useSWR(url && url, {\r\n    dedupingInterval: 10000,\r\n    fetcher: (...args) => fetch(...args).then((res) => res.json()),\r\n  });\r\n\r\n  if (trades) {\r\n    trades.sort((item0, item1) => {\r\n      const data0 = item0.data;\r\n      const data1 = item1.data;\r\n      const time0 = parseInt(data0.timestamp);\r\n      const time1 = parseInt(data1.timestamp);\r\n      if (time1 > time0) {\r\n        return 1;\r\n      }\r\n      if (time1 < time0) {\r\n        return -1;\r\n      }\r\n\r\n      const block0 = parseInt(data0.blockNumber);\r\n      const block1 = parseInt(data1.blockNumber);\r\n\r\n      if (isNaN(block0) && isNaN(block1)) {\r\n        return 0;\r\n      }\r\n\r\n      if (isNaN(block0)) {\r\n        return 1;\r\n      }\r\n\r\n      if (isNaN(block1)) {\r\n        return -1;\r\n      }\r\n\r\n      if (block1 > block0) {\r\n        return 1;\r\n      }\r\n\r\n      if (block1 < block0) {\r\n        return -1;\r\n      }\r\n\r\n      return 0;\r\n    });\r\n  }\r\n\r\n  return { trades, updateTrades };\r\n}\r\n\r\nexport function useMinExecutionFee(library, active, chainId, infoTokens) {\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const { data: minExecutionFee } = useSWR([active, chainId, positionRouterAddress, \"minExecutionFee\"], {\r\n    fetcher: fetcher(library, PositionRouter),\r\n  });\r\n\r\n  const { data: gasPrice } = useSWR([\"gasPrice\", chainId], {\r\n    fetcher: () => {\r\n      return new Promise(async (resolve, reject) => {\r\n        const provider = getProvider(library, chainId);\r\n        if (!provider) {\r\n          resolve(undefined);\r\n          return;\r\n        }\r\n\r\n        try {\r\n          const gasPrice = await provider.getGasPrice();\r\n          resolve(gasPrice);\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      });\r\n    },\r\n  });\r\n\r\n  let multiplier;\r\n\r\n  // if gas prices on Arbitrum are high, the main transaction costs would come from the L2 gas usage\r\n  // for executing positions this is around 65,000 gas\r\n  // if gas prices on Ethereum are high, than the gas usage might be higher, this calculation doesn't deal with that\r\n  // case yet\r\n  if (chainId === ARBITRUM || chainId === ARBITRUM_TESTNET) {\r\n    multiplier = 65000;\r\n  }\r\n\r\n  // multiplier for Avalanche is just the average gas usage\r\n  if (chainId === AVALANCHE) {\r\n    multiplier = 700000;\r\n  }\r\n\r\n  let finalExecutionFee = minExecutionFee;\r\n\r\n  if (gasPrice && minExecutionFee) {\r\n    const estimatedExecutionFee = gasPrice.mul(multiplier);\r\n    if (estimatedExecutionFee.gt(minExecutionFee)) {\r\n      finalExecutionFee = estimatedExecutionFee;\r\n    }\r\n  }\r\n\r\n  const finalExecutionFeeUSD = getUsd(finalExecutionFee, nativeTokenAddress, false, infoTokens);\r\n  const isFeeHigh = finalExecutionFeeUSD?.gt(expandDecimals(getHighExecutionFee(chainId), USD_DECIMALS));\r\n  const errorMessage =\r\n    isFeeHigh &&\r\n    `The network cost to send transactions is high at the moment, please check the \"Execution Fee\" value before proceeding.`;\r\n\r\n  return {\r\n    minExecutionFee: finalExecutionFee,\r\n    minExecutionFeeUSD: finalExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage: errorMessage,\r\n  };\r\n}\r\n\r\nexport function useStakedGmxSupply(library, active) {\r\n  const gmxAddressArb = getContract(ARBITRUM, \"GMX\");\r\n  const stakedGmxTrackerAddressArb = getContract(ARBITRUM, \"StakedGmxTracker\");\r\n\r\n  const { data: arbData, mutate: arbMutate } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, ARBITRUM, gmxAddressArb, \"balanceOf\", stakedGmxTrackerAddressArb],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  const gmxAddressAvax = getContract(AVALANCHE, \"GMX\");\r\n  const stakedGmxTrackerAddressAvax = getContract(AVALANCHE, \"StakedGmxTracker\");\r\n\r\n  const { data: avaxData, mutate: avaxMutate } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, AVALANCHE, gmxAddressAvax, \"balanceOf\", stakedGmxTrackerAddressAvax],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n\r\n  let data;\r\n  if (arbData && avaxData) {\r\n    data = arbData.add(avaxData);\r\n  }\r\n\r\n  const mutate = () => {\r\n    arbMutate();\r\n    avaxMutate();\r\n  };\r\n\r\n  return { data, mutate };\r\n}\r\n\r\nexport function useHasOutdatedUi() {\r\n  const url = getServerUrl(ARBITRUM, \"/ui_version\");\r\n  const { data, mutate } = useSWR([url], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  let hasOutdatedUi = false;\r\n\r\n  if (data && parseFloat(data) > parseFloat(UI_VERSION)) {\r\n    // hasOutdatedUi = true;\r\n    hasOutdatedUi = false;\r\n  }\r\n\r\n  return { data: hasOutdatedUi, mutate };\r\n}\r\n\r\nexport function useGmxPrice(chainId, libraries, active) {\r\n  const arbitrumLibrary = libraries && libraries.arbitrum ? libraries.arbitrum : undefined;\r\n  const { data: gmxPriceFromArbitrum, mutate: mutateFromArbitrum } = useGmxPriceFromArbitrum(arbitrumLibrary, active);\r\n  const { data: gmxPriceFromAvalanche, mutate: mutateFromAvalanche } = useGmxPriceFromAvalanche();\r\n\r\n  const gmxPrice = chainId === ARBITRUM ? gmxPriceFromArbitrum : gmxPriceFromAvalanche;\r\n  const mutate = useCallback(() => {\r\n    mutateFromAvalanche();\r\n    mutateFromArbitrum();\r\n  }, [mutateFromAvalanche, mutateFromArbitrum]);\r\n\r\n  return {\r\n    gmxPrice,\r\n    gmxPriceFromArbitrum,\r\n    gmxPriceFromAvalanche,\r\n    mutate,\r\n  };\r\n}\r\n\r\n// use only the supply endpoint on arbitrum, it includes the supply on avalanche\r\nexport function useTotalGmxSupply() {\r\n  const gmxSupplyUrlArbitrum = getServerUrl(ARBITRUM, \"/gmx_supply\");\r\n\r\n  const { data: gmxSupply, mutate: updateGmxSupply } = useSWR([gmxSupplyUrlArbitrum], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  return {\r\n    total: gmxSupply ? bigNumberify(gmxSupply) : undefined,\r\n    mutate: updateGmxSupply,\r\n  };\r\n}\r\n\r\nexport function useTotalGmxStaked() {\r\n  const stakedGmxTrackerAddressArbitrum = getContract(ARBITRUM, \"StakedGmxTracker\");\r\n  const stakedGmxTrackerAddressAvax = getContract(AVALANCHE, \"StakedGmxTracker\");\r\n  let totalStakedGmx = useRef(bigNumberify(0));\r\n  const { data: stakedGmxSupplyArbitrum, mutate: updateStakedGmxSupplyArbitrum } = useSWR(\r\n    [\r\n      `StakeV2:stakedGmxSupply:${ARBITRUM}`,\r\n      ARBITRUM,\r\n      getContract(ARBITRUM, \"GMX\"),\r\n      \"balanceOf\",\r\n      stakedGmxTrackerAddressArbitrum,\r\n    ],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const { data: stakedGmxSupplyAvax, mutate: updateStakedGmxSupplyAvax } = useSWR(\r\n    [\r\n      `StakeV2:stakedGmxSupply:${AVALANCHE}`,\r\n      AVALANCHE,\r\n      getContract(AVALANCHE, \"GMX\"),\r\n      \"balanceOf\",\r\n      stakedGmxTrackerAddressAvax,\r\n    ],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n\r\n  const mutate = useCallback(() => {\r\n    updateStakedGmxSupplyArbitrum();\r\n    updateStakedGmxSupplyAvax();\r\n  }, [updateStakedGmxSupplyArbitrum, updateStakedGmxSupplyAvax]);\r\n\r\n  if (stakedGmxSupplyArbitrum && stakedGmxSupplyAvax) {\r\n    let total = bigNumberify(stakedGmxSupplyArbitrum).add(stakedGmxSupplyAvax);\r\n    totalStakedGmx.current = total;\r\n  }\r\n\r\n  return {\r\n    avax: stakedGmxSupplyAvax,\r\n    arbitrum: stakedGmxSupplyArbitrum,\r\n    total: totalStakedGmx.current,\r\n    mutate,\r\n  };\r\n}\r\n\r\nexport function useTotalGmxInLiquidity() {\r\n  let poolAddressArbitrum = getContract(ARBITRUM, \"UniswapGmxEthPool\");\r\n  let poolAddressAvax = getContract(AVALANCHE, \"TraderJoeGmxAvaxPool\");\r\n  let totalGMX = useRef(bigNumberify(0));\r\n\r\n  const { data: gmxInLiquidityOnArbitrum, mutate: mutateGMXInLiquidityOnArbitrum } = useSWR(\r\n    [`StakeV2:gmxInLiquidity:${ARBITRUM}`, ARBITRUM, getContract(ARBITRUM, \"GMX\"), \"balanceOf\", poolAddressArbitrum],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const { data: gmxInLiquidityOnAvax, mutate: mutateGMXInLiquidityOnAvax } = useSWR(\r\n    [`StakeV2:gmxInLiquidity:${AVALANCHE}`, AVALANCHE, getContract(AVALANCHE, \"GMX\"), \"balanceOf\", poolAddressAvax],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const mutate = useCallback(() => {\r\n    mutateGMXInLiquidityOnArbitrum();\r\n    mutateGMXInLiquidityOnAvax();\r\n  }, [mutateGMXInLiquidityOnArbitrum, mutateGMXInLiquidityOnAvax]);\r\n\r\n  if (gmxInLiquidityOnAvax && gmxInLiquidityOnArbitrum) {\r\n    let total = bigNumberify(gmxInLiquidityOnArbitrum).add(gmxInLiquidityOnAvax);\r\n    totalGMX.current = total;\r\n  }\r\n  return {\r\n    avax: gmxInLiquidityOnAvax,\r\n    arbitrum: gmxInLiquidityOnArbitrum,\r\n    total: totalGMX.current,\r\n    mutate,\r\n  };\r\n}\r\n\r\nfunction useGmxPriceFromAvalanche() {\r\n  const poolAddress = getContract(AVALANCHE, \"TraderJoeGmxAvaxPool\");\r\n\r\n  const { data, mutate: updateReserves } = useSWR([\"TraderJoeGmxAvaxReserves\", AVALANCHE, poolAddress, \"getReserves\"], {\r\n    fetcher: fetcher(undefined, UniswapV2),\r\n  });\r\n  const { _reserve0: gmxReserve, _reserve1: avaxReserve } = data || {};\r\n\r\n  const vaultAddress = getContract(AVALANCHE, \"Vault\");\r\n  const avaxAddress = getTokenBySymbol(AVALANCHE, \"WAVAX\").address;\r\n  const { data: avaxPrice, mutate: updateAvaxPrice } = useSWR(\r\n    [`StakeV2:avaxPrice`, AVALANCHE, vaultAddress, \"getMinPrice\", avaxAddress],\r\n    {\r\n      fetcher: fetcher(undefined, Vault),\r\n    }\r\n  );\r\n\r\n  const PRECISION = bigNumberify(10).pow(18);\r\n  let gmxPrice;\r\n  if (avaxReserve && gmxReserve && avaxPrice) {\r\n    gmxPrice = avaxReserve.mul(PRECISION).div(gmxReserve).mul(avaxPrice).div(PRECISION);\r\n  }\r\n\r\n  const mutate = useCallback(() => {\r\n    updateReserves(undefined, true);\r\n    updateAvaxPrice(undefined, true);\r\n  }, [updateReserves, updateAvaxPrice]);\r\n\r\n  return { data: gmxPrice, mutate };\r\n}\r\n\r\nfunction useGmxPriceFromArbitrum(library, active) {\r\n  const poolAddress = getContract(ARBITRUM, \"UniswapGmxEthPool\");\r\n  const { data: uniPoolSlot0, mutate: updateUniPoolSlot0 } = useSWR(\r\n    [`StakeV2:uniPoolSlot0:${active}`, ARBITRUM, poolAddress, \"slot0\"],\r\n    {\r\n      fetcher: fetcher(library, UniPool),\r\n    }\r\n  );\r\n\r\n  const vaultAddress = getContract(ARBITRUM, \"Vault\");\r\n  const ethAddress = getTokenBySymbol(ARBITRUM, \"WETH\").address;\r\n  const { data: ethPrice, mutate: updateEthPrice } = useSWR(\r\n    [`StakeV2:ethPrice:${active}`, ARBITRUM, vaultAddress, \"getMinPrice\", ethAddress],\r\n    {\r\n      fetcher: fetcher(library, Vault),\r\n    }\r\n  );\r\n\r\n  const gmxPrice = useMemo(() => {\r\n    if (uniPoolSlot0 && ethPrice) {\r\n      const tokenA = new UniToken(ARBITRUM, ethAddress, 18, \"SYMBOL\", \"NAME\");\r\n\r\n      const gmxAddress = getContract(ARBITRUM, \"GMX\");\r\n      const tokenB = new UniToken(ARBITRUM, gmxAddress, 18, \"SYMBOL\", \"NAME\");\r\n\r\n      const pool = new Pool(\r\n        tokenA, // tokenA\r\n        tokenB, // tokenB\r\n        10000, // fee\r\n        uniPoolSlot0.sqrtPriceX96, // sqrtRatioX96\r\n        1, // liquidity\r\n        uniPoolSlot0.tick, // tickCurrent\r\n        []\r\n      );\r\n\r\n      const poolTokenPrice = pool.priceOf(tokenB).toSignificant(6);\r\n      const poolTokenPriceAmount = parseValue(poolTokenPrice, 18);\r\n      return poolTokenPriceAmount.mul(ethPrice).div(expandDecimals(1, 18));\r\n    }\r\n  }, [ethPrice, uniPoolSlot0, ethAddress]);\r\n\r\n  const mutate = useCallback(() => {\r\n    updateUniPoolSlot0(undefined, true);\r\n    updateEthPrice(undefined, true);\r\n  }, [updateEthPrice, updateUniPoolSlot0]);\r\n\r\n  return { data: gmxPrice, mutate };\r\n}\r\n\r\nexport async function approvePlugin(\r\n  chainId,\r\n  pluginAddress,\r\n  { library, pendingTxns, setPendingTxns, sentMsg, failMsg }\r\n) {\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const contract = new ethers.Contract(routerAddress, Router.abi, library.getSigner());\r\n  return callContract(chainId, contract, \"approvePlugin\", [pluginAddress], {\r\n    sentMsg,\r\n    failMsg,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n  });\r\n}\r\n\r\nexport async function createSwapOrder(\r\n  chainId,\r\n  library,\r\n  path,\r\n  amountIn,\r\n  minOut,\r\n  triggerRatio,\r\n  nativeTokenAddress,\r\n  opts = {}\r\n) {\r\n  const executionFee = getConstant(chainId, \"SWAP_ORDER_EXECUTION_GAS_FEE\");\r\n  const triggerAboveThreshold = false;\r\n  let shouldWrap = false;\r\n  let shouldUnwrap = false;\r\n  opts.value = executionFee;\r\n\r\n  if (path[0] === AddressZero) {\r\n    shouldWrap = true;\r\n    opts.value = opts.value.add(amountIn);\r\n  }\r\n  if (path[path.length - 1] === AddressZero) {\r\n    shouldUnwrap = true;\r\n  }\r\n  path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n\r\n  const params = [path, amountIn, minOut, triggerRatio, triggerAboveThreshold, executionFee, shouldWrap, shouldUnwrap];\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createSwapOrder\", params, opts);\r\n}\r\n\r\nexport async function createIncreaseOrder(\r\n  chainId,\r\n  library,\r\n  nativeTokenAddress,\r\n  path,\r\n  amountIn,\r\n  indexTokenAddress,\r\n  minOut,\r\n  sizeDelta,\r\n  collateralTokenAddress,\r\n  isLong,\r\n  triggerPrice,\r\n  opts = {}\r\n) {\r\n  invariant(!isLong || indexTokenAddress === collateralTokenAddress, \"invalid token addresses\");\r\n  invariant(indexTokenAddress !== AddressZero, \"indexToken is 0\");\r\n  invariant(collateralTokenAddress !== AddressZero, \"collateralToken is 0\");\r\n\r\n  const fromETH = path[0] === AddressZero;\r\n\r\n  path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n  const shouldWrap = fromETH;\r\n  const triggerAboveThreshold = !isLong;\r\n  const executionFee = getConstant(chainId, \"INCREASE_ORDER_EXECUTION_GAS_FEE\");\r\n\r\n  const params = [\r\n    path,\r\n    amountIn,\r\n    indexTokenAddress,\r\n    minOut,\r\n    sizeDelta,\r\n    collateralTokenAddress,\r\n    isLong,\r\n    triggerPrice,\r\n    triggerAboveThreshold,\r\n    executionFee,\r\n    shouldWrap,\r\n  ];\r\n\r\n  if (!opts.value) {\r\n    opts.value = fromETH ? amountIn.add(executionFee) : executionFee;\r\n  }\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createIncreaseOrder\", params, opts);\r\n}\r\n\r\nexport async function createDecreaseOrder(\r\n  chainId,\r\n  library,\r\n  indexTokenAddress,\r\n  sizeDelta,\r\n  collateralTokenAddress,\r\n  collateralDelta,\r\n  isLong,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts = {}\r\n) {\r\n  invariant(!isLong || indexTokenAddress === collateralTokenAddress, \"invalid token addresses\");\r\n  invariant(indexTokenAddress !== AddressZero, \"indexToken is 0\");\r\n  invariant(collateralTokenAddress !== AddressZero, \"collateralToken is 0\");\r\n\r\n  const executionFee = getConstant(chainId, \"DECREASE_ORDER_EXECUTION_GAS_FEE\");\r\n\r\n  const params = [\r\n    indexTokenAddress,\r\n    sizeDelta,\r\n    collateralTokenAddress,\r\n    collateralDelta,\r\n    isLong,\r\n    triggerPrice,\r\n    triggerAboveThreshold,\r\n  ];\r\n  opts.value = executionFee;\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createDecreaseOrder\", params, opts);\r\n}\r\n\r\nexport async function cancelSwapOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelSwapOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function cancelDecreaseOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelDecreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function cancelIncreaseOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelIncreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport function handleCancelOrder(chainId, library, order, opts) {\r\n  let func;\r\n  if (order.type === SWAP) {\r\n    func = cancelSwapOrder;\r\n  } else if (order.type === INCREASE) {\r\n    func = cancelIncreaseOrder;\r\n  } else if (order.type === DECREASE) {\r\n    func = cancelDecreaseOrder;\r\n  }\r\n\r\n  return func(chainId, library, order.index, {\r\n    successMsg: \"Order cancelled.\",\r\n    failMsg: \"Cancel failed.\",\r\n    sentMsg: \"Cancel submitted.\",\r\n    pendingTxns: opts.pendingTxns,\r\n    setPendingTxns: opts.setPendingTxns,\r\n  });\r\n}\r\n\r\nexport async function cancelMultipleOrders(chainId, library, allIndexes = [], opts) {\r\n  const ordersWithTypes = groupBy(allIndexes, (v) => v.split(\"-\")[0]);\r\n  function getIndexes(key) {\r\n    if (!ordersWithTypes[key]) return;\r\n    return ordersWithTypes[key].map((d) => d.split(\"-\")[1]);\r\n  }\r\n  // params order => swap, increase, decrease\r\n  const params = [\"Swap\", \"Increase\", \"Decrease\"].map((key) => getIndexes(key) || []);\r\n  const method = \"cancelMultiple\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateDecreaseOrder(\r\n  chainId,\r\n  library,\r\n  index,\r\n  collateralDelta,\r\n  sizeDelta,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts\r\n) {\r\n  const params = [index, collateralDelta, sizeDelta, triggerPrice, triggerAboveThreshold];\r\n  const method = \"updateDecreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateIncreaseOrder(\r\n  chainId,\r\n  library,\r\n  index,\r\n  sizeDelta,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts\r\n) {\r\n  const params = [index, sizeDelta, triggerPrice, triggerAboveThreshold];\r\n  const method = \"updateIncreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateSwapOrder(chainId, library, index, minOut, triggerRatio, triggerAboveThreshold, opts) {\r\n  const params = [index, minOut, triggerRatio, triggerAboveThreshold];\r\n  const method = \"updateSwapOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function _executeOrder(chainId, library, method, account, index, feeReceiver, opts) {\r\n  const params = [account, index, feeReceiver];\r\n  const positionManagerAddress = getContract(chainId, \"PositionManager\");\r\n  const contract = new ethers.Contract(positionManagerAddress, PositionManager.abi, library.getSigner());\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport function executeSwapOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeSwapOrder\", account, index, feeReceiver, opts);\r\n}\r\n\r\nexport function executeIncreaseOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeIncreaseOrder\", account, index, feeReceiver, opts);\r\n}\r\n\r\nexport function executeDecreaseOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeDecreaseOrder\", account, index, feeReceiver, opts);\r\n}","import React, { useState, useEffect } from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport \"./../../../gmx-test/components/Tab/Tab.css\";\r\nimport \"./TabOptions.scss\";\r\n\r\nexport default function Tab(props) {\r\n  const { options, option, setOption, onChange, type = \"block\", className, optionLabels, icons, disabled, disabledTooltip } = props;\r\n  \r\n  const onClick = (opt) => {\r\n    if (disabled) {\r\n      return;\r\n    }\r\n    \r\n    if (setOption) {\r\n      setOption(opt);\r\n    }\r\n    if (onChange) {\r\n      onChange(opt);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={cx(\"Tab\", type, className, disabled && 'disabled', type === 'inline' && icons && 'Tab-inline-icon')}>\r\n      {options.map((opt) => {\r\n        const label = optionLabels && optionLabels[opt] ? optionLabels[opt] : opt;\r\n        let disabledNode;\r\n        \r\n        if (props.disabledList) {\r\n          props.disabledList.forEach(el => {\r\n            if (el.label === label && el.disabled) {\r\n              disabledNode = (\r\n                <div className={cx(\"Tab-option\", \"tab-tooltip-container\")} onClick={() => {return}} key={opt}>\r\n                  {disabledTooltip}\r\n                  {icons && icons[opt] && <img className=\"Tab-option-icon\" src={opt === option ? (icons[opt + '_active'] ?? icons[opt]) : icons[opt]} alt={option} />}\r\n                  {label}\r\n                </div>\r\n              );\r\n            }\r\n          })\r\n        }\r\n\r\n        if (disabledNode) {\r\n          return disabledNode;\r\n        }\r\n        \r\n        return (\r\n          <div className={cx(\"Tab-option\", \"muted\", { active: opt === option })} onClick={() => onClick(opt)} key={opt}>\r\n            {icons && icons[opt] && <img className=\"Tab-option-icon\" src={opt === option ? (icons[opt + '_active'] ?? icons[opt]) : icons[opt]} alt={option} />}\r\n            {label}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport Slider, { SliderTooltip } from \"rc-slider\";\r\nimport \"rc-slider/assets/index.css\";\r\nimport \"../../../gmx-test/components/Exchange/SwapBox.scss\";\r\nimport \"./SwapBoxOptions.scss\";\r\n\r\nimport cx from \"classnames\";\r\nimport { ethers, BigNumber } from \"ethers\";\r\n\r\nimport {\r\n  ARBITRUM,\r\n  expandDecimals,\r\n  formatAmountFree,\r\n  SWAP_OPTIONS,\r\n  ASSET_OPTIONS,\r\n} from \"../../lib/legacyOptions\";\r\n\r\nimport Tab from \"../Tab/TabOptions\";\r\n\r\nimport { getTokenBySymbol } from \"../../config/Tokens\";\r\n\r\nimport iconBTC from \"../../../../img/icon-BTC.svg\";\r\nimport iconETH from \"../../../../img/icon-ETH.svg\";\r\n\r\nimport { LyraQuoter, PRICE_CALCULATORS } from '../../../../components/utils/contracts';\r\nimport { SWAP_ICONS, USD_DECIMALS } from './../../lib/legacyOptions';\r\nimport { format } from \"date-fns\";\r\nimport NumberInput_v3 from './../../../../components/UI/input/NumberInput_v3';\r\nimport { daysToMs, fromBigNumber } from \"../../../../components/utils/utils\";\r\nimport { HEGIC_STRATEGIES, HEGIC_BUY_URLS, PremiaPools } from './../../../../components/utils/contracts';\r\nimport HegicStrategy_ABI from '../../../../deployments/options/HegicStrategy_ABI.json';\r\nimport PriceCalculator_ABI from '../../../../deployments/options/PriceCalculator_ABI.json';\r\nimport Lyra from '@lyrafinance/lyra-js';\r\nimport { sepToNumber } from \"../../../../components/utils/sepThousands\";\r\nimport { formatAmount } from './../../../gmx-test/lib/legacy';\r\nimport PremiaPool_ABI from '../../../../deployments/options/PremiaPool_ABI.json';\r\nimport DAI_ABI from '../../../../deployments/options/DAI_ABI.json';\r\nimport { fixedFromFloat, fixedFromBigNumber, fixedToNumber, fixedToBn, formatTokenId } from '@premia/utils';\r\nimport { ADDRESS_ZERO } from '@uniswap/v3-sdk';\r\nimport { PremiaStrikeRange, tokenDecimals, PremiaStrikeRangeMultiplier } from './../../../../components/utils/constants';\r\n\r\n\r\nconst leverageSliderHandle = (props) => {\r\n  const { value, dragging, index, ...restProps } = props;\r\n  return (\r\n    <SliderTooltip\r\n      prefixCls=\"rc-slider-tooltip\"\r\n      overlay={`${value}`}\r\n      visible={dragging}\r\n      placement=\"top\"\r\n      key={index}\r\n    >\r\n      <Slider.Handle value={value} {...restProps} />\r\n    </SliderTooltip>\r\n  );\r\n};\r\n\r\nexport default function SwapBox(props) {\r\n  const {\r\n    active,\r\n    connectWallet,\r\n    walletAddress,\r\n    library,\r\n    infoTokens,\r\n    selectedToken,\r\n    tokenSelection,\r\n    setTokenSelection,\r\n    assetOption,\r\n    setAssetOption,\r\n    swapOption,\r\n    setSwapOption,\r\n    leverageOption,\r\n    setLeverageOption,\r\n    amountValue,\r\n    setAmountValue,\r\n    options,\r\n    setOptions,\r\n    setOptionsLength,\r\n    setOptionsExpectedLength,\r\n    isOptionsLoading,\r\n    setIsOptionsLoading,\r\n    optionPrices,\r\n    setOptionPrices,\r\n    scrollToList,\r\n    chaiMarkPrice,\r\n  } = props;\r\n  \r\n  const isCall = swapOption === 'Call';\r\n\r\n  const getError = () => {\r\n    if (!amountValue) {\r\n      return `Enter Amount`;\r\n    }\r\n\r\n    if (!chaiMarkPrice) {\r\n      return `Please, wait`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (!active) {\r\n      return true;\r\n    }\r\n    \r\n    if (getError()) {\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  };\r\n\r\n\r\n  const getPrimaryText = () => {\r\n    if (!active) {\r\n      return `Connect wallet`;\r\n    }\r\n    \r\n    const err = getError();\r\n    if (err) {\r\n      return err;\r\n    }\r\n    \r\n    return `See Available Options`;\r\n  };\r\n\r\n  const period = daysToMs(leverageOption);\r\n  const expirationDate = period && (Date.now() + period);\r\n  // Options expire at 8 a.m. UTC\r\n  const expDateUTC = new Date(expirationDate);\r\n  if (expDateUTC.getUTCHours() >= 8) {\r\n    expDateUTC.setUTCDate(expDateUTC.getUTCDate() + 1);\r\n  }\r\n  expDateUTC.setUTCHours(8, 0, 0, 0);\r\n  const periodEightAM = expDateUTC.getTime() - Date.now();\r\n\r\n  const fetchHegicOptions = (strikes = []) => {\r\n    const periodDays = leverageOption;\r\n    \r\n    if (periodDays < 7 || periodDays > 90) {\r\n      return;\r\n    }\r\n\r\n    let strategies;\r\n    if (periodDays < 14) {\r\n      strategies = HEGIC_STRATEGIES.short;\r\n    } else if (periodDays < 30) {\r\n      strategies = HEGIC_STRATEGIES.medShort;\r\n    } else if (periodDays < 60) {\r\n      strategies = HEGIC_STRATEGIES.medLong;\r\n    } else if (periodDays <= 90) {\r\n      strategies = HEGIC_STRATEGIES.long;\r\n    }\r\n    const expectedLength = Object.keys(strategies).filter(str => {\r\n      return isCall ? str.includes('CALL') : !str.includes('CALL');\r\n    }).filter(str => {\r\n      return str.split('_')[3] === selectedToken.symbol;\r\n    }).length;\r\n    setOptionsExpectedLength(expectedLength);\r\n    \r\n    for (let i = 0; i < Object.keys(strategies).length; i++) {\r\n      const strategy = Object.keys(strategies)[i];\r\n      const [, strategySentiment, strikeScale, strategyTokenSymbol] = strategy.split('_');\r\n\r\n      const strategyIsCall = strategySentiment === 'CALL';\r\n      if (isCall && !strategyIsCall || !isCall && strategyIsCall) {\r\n        continue;\r\n      }\r\n      if (strategyTokenSymbol !== selectedToken.symbol) {\r\n        continue;\r\n      }\r\n      \r\n      const strike = formatAmountFree(chaiMarkPrice, 8, 2) / 100 * strikeScale;\r\n      strikes.push(expandDecimals(BigNumber.from((strike * 10**2).toFixed(0)), 16));\r\n      \r\n      const strategyAddress = strategies[strategy];\r\n      const strategyContract = new ethers.Contract(strategyAddress, HegicStrategy_ABI, library.getSigner());\r\n      const priceName = `PriceCalculator_${strategySentiment}_${strikeScale}_${strategyTokenSymbol}`;\r\n      const priceAddress = PRICE_CALCULATORS[priceName];\r\n      const priceContract = new ethers.Contract(priceAddress, PriceCalculator_ABI, library.getSigner());\r\n\r\n      const urlName = `${strategySentiment}_${strikeScale}_${strategyTokenSymbol}`;\r\n\r\n      const periodS = (periodEightAM / 1000).toFixed(0);\r\n      strategyContract.getAvailableContracts(periodS, [ethers.constants.HashZero])\r\n        .then(res => {\r\n          options.push({\r\n            strategy,\r\n            market: 'Hegic',\r\n            type: 'American',\r\n            isCall,\r\n            token: strategyTokenSymbol,\r\n            strike: expandDecimals((strike * 10**2).toFixed(0), 16),\r\n            liq: strategyTokenSymbol === 'ETH' ? res : expandDecimals(res, 10),\r\n            period: periodEightAM,\r\n            buyUrl: HEGIC_BUY_URLS[urlName] + `&period=${periodDays}`,\r\n          });\r\n          setOptionsLength(options.length);\r\n          setOptions(options);\r\n          if (options.length === expectedLength) {\r\n            setIsOptionsLoading(false);\r\n          }\r\n        })\r\n      \r\n      \r\n      const decimals = strategyTokenSymbol === 'ETH'\r\n        ? 18 : 8;\r\n\r\n      const amountStr = (sepToNumber(amountValue).toFixed(2) * 10**2).toFixed(0);\r\n      const amount = BigNumber.from(amountStr).mul(String(10**(decimals - 2)));\r\n      priceContract.calculatePremium(periodS, amount, 0)\r\n        .then(res => {\r\n          const cost = expandDecimals(res, 12);\r\n          const price = expandDecimals(cost.mul(String(10**2)).div(amount), decimals - 2);\r\n          \r\n          optionPrices[strategy] = { price, cost };\r\n        })\r\n    }\r\n  }\r\n\r\n  const fetchLyraOptions = async (strikes = []) => {\r\n    const lyra = new Lyra(ARBITRUM);\r\n    const token = selectedToken.symbol;\r\n    const periodMs = period;\r\n\r\n    const market = (await lyra.markets()).find(mkt => {\r\n      return mkt.baseToken.symbol === `W${token}`;\r\n    });\r\n    const boardId = market.liveBoards().reduce((prevBd, curBd) => {\r\n      const prev = prevBd.expiryTimestamp * 10**3;\r\n      const cur = curBd.expiryTimestamp * 10**3;\r\n      const expDate = Date.now() + periodMs;\r\n\r\n      return Math.abs(cur - expDate) < Math.abs(prev - expDate) ? curBd : prevBd;\r\n    }).id;\r\n    const board = market.liveBoardsMap[boardId];\r\n    \r\n    board.strikes.forEach(strike => {\r\n      const { strikeId, strikePrice } = strike;\r\n      strikes.push(strikePrice);\r\n      const strategy = `Lyra_${swapOption.toUpperCase()}_${strikeId.toString()}_${token}`;\r\n      \r\n      options.push({\r\n        strategy,\r\n        market: 'Lyra',\r\n        type: 'European',\r\n        isCall,\r\n        token,\r\n        strike: strikePrice,\r\n        strikeId,\r\n        liq: null,\r\n        period: board.expiry.toString() * 10**3 - Date.now(),\r\n        buyUrl: token === 'ETH'\r\n          ? `https://app.lyra.finance/#/trade/arbitrum/eth-usdc?expiry=${board.expiry.toString()}`\r\n          : `https://app.lyra.finance/#/trade/arbitrum/wbtc-usdc?expiry=${board.expiry.toString()}`,\r\n      });\r\n      setOptionsLength(options.length);\r\n      setOptions(options);\r\n\r\n      const amountStr = (sepToNumber(amountValue).toFixed(2) * 10**2).toFixed(0);\r\n      const amount = BigNumber.from(amountStr).mul(String(10**16));\r\n      lyra.quoteOption(market.address, strikeId, isCall, amount)\r\n        .then(res => {\r\n          const price = res.ask.pricePerOption;\r\n          const cost = res.ask.premium;\r\n          optionPrices[strategy] = { price, cost };\r\n          \r\n          const opt = options.find(opt => {\r\n            return opt.strategy === strategy;\r\n          });\r\n          if (opt) {\r\n            opt.liq = cost.eq(0) ? BigNumber.from(0) : amount;\r\n          }\r\n          \r\n          setOptionPrices(Object.assign({}, optionPrices));\r\n        })\r\n    })\r\n\r\n    setIsOptionsLoading(false);\r\n  }\r\n\r\n  const fetchPremiaOptions = async (strikes) => {\r\n    if (leverageOption > 90) {\r\n      return;\r\n    }\r\n    \r\n    const token = selectedToken.symbol;\r\n    const address = PremiaPools[token];\r\n    \r\n    const contract = new ethers.Contract(address, PremiaPool_ABI, library.getSigner());\r\n    const base = (await contract.getPoolSettings()).base;\r\n    const baseContract = new ethers.Contract(base, DAI_ABI, library.getSigner());\r\n    \r\n    strikes.forEach(strike => {\r\n      const strikeFormatted = fromBigNumber(strike, 18);\r\n      const rangeMultiplier = PremiaStrikeRangeMultiplier[swapOption];\r\n      const markPrice = infoTokens[tokenSelection].maxPrice;\r\n      const markPriceFormatted = fromBigNumber(markPrice, USD_DECIMALS);\r\n      \r\n      const lowerBoundary = ((markPriceFormatted * rangeMultiplier[0]) / 100).toFixed(0) * 100;\r\n      const higherBoundary = ((markPriceFormatted * rangeMultiplier[1]) / 100).toFixed(0) * 100;\r\n      console.log(lowerBoundary, higherBoundary);\r\n      if (strikeFormatted < lowerBoundary || strikeFormatted > higherBoundary) {\r\n        return;\r\n      }\r\n      const strategy = `Premia_${swapOption.toUpperCase()}_${strikeFormatted}_${token}`;\r\n      \r\n      options.push({\r\n        strategy,\r\n        market: 'Premia',\r\n        type: 'American',\r\n        isCall,\r\n        token,\r\n        strike,\r\n        liq: null,\r\n        period: periodEightAM,\r\n        buyUrl: `https://app.premia.finance/options/W${token}-DAI`,\r\n      });\r\n      setOptionsLength(options.length);\r\n      setOptions(options);\r\n\r\n      const decimals = tokenDecimals[token];\r\n\r\n      const amountStr = (sepToNumber(amountValue).toFixed(2) * 10**2).toFixed(0);\r\n      const amount = BigNumber.from(amountStr).mul(String(10**(decimals - 2)));\r\n\r\n      const opt = options.find(opt => {\r\n        return opt.strategy === strategy;\r\n      });\r\n      contract.quote(\r\n        walletAddress,\r\n        expDateUTC.getTime() / 1000,\r\n        fixedFromFloat(strikeFormatted),\r\n        amount,\r\n        isCall,\r\n      ).then(res => {\r\n        let cost = fixedToBn(res.baseCost64x64).add(fixedToBn(res.feeCost64x64));\r\n        if (isCall) {\r\n          cost = cost.mul(BigNumber.from(formatAmountFree(markPrice, USD_DECIMALS, 0)));\r\n        }\r\n        const price = expandDecimals(cost.div(BigNumber.from(amountStr)), 2);\r\n        optionPrices[strategy] = { price, cost };\r\n\r\n        setOptionPrices(Object.assign({}, optionPrices));\r\n      }, console.log);\r\n\r\n      contract.totalSupply(0)\r\n        .then(res => {\r\n          /* baseContract.totalSupply()\r\n            .then(res => {\r\n                console.log(fromBigNumber(res, 18).toFixed(0));\r\n                formatTokenId({\r\n                  tokenType: fromBigNumber(res, 18).toFixed(0),\r\n                  maturity: BigNumber.from(0),\r\n                  strike64x64: BigNumber.from(0),\r\n                })\r\n              }) */\r\n          \r\n          if (res.lt(amount)) {\r\n            opt.liq = BigNumber.from(0);\r\n          } else {\r\n            opt.liq = expandDecimals(res, 18 - decimals);\r\n          }\r\n        }, console.log)\r\n    })\r\n    \r\n  }\r\n  \r\n  const strikes = [];\r\n  const fetchAvailableOptions = () => {\r\n    if (isOptionsLoading) {\r\n      return;\r\n    }\r\n    \r\n    strikes.splice(0, strikes.length);\r\n    options.splice(0, options.length);\r\n    setOptionsLength(0);\r\n    Object.keys(optionPrices).forEach(key => {\r\n      optionPrices[key] = undefined;\r\n    });\r\n    \r\n    setIsOptionsLoading(true);\r\n    \r\n    fetchHegicOptions(strikes);\r\n    fetchLyraOptions(strikes).then(() => {\r\n      fetchPremiaOptions(strikes);\r\n    });\r\n  }\r\n\r\n  const onClickPrimary = () => {\r\n    if (!active) {\r\n      connectWallet();\r\n      return;\r\n    }\r\n    \r\n    scrollToList();\r\n    fetchAvailableOptions();\r\n  };\r\n\r\n  const onAssetOptionChange = (opt) => {\r\n    setTokenSelection(getTokenBySymbol(ARBITRUM, opt).address);\r\n    setAssetOption(opt);\r\n  }\r\n  const onSwapOptionChange = (opt) => {\r\n    setSwapOption(opt);\r\n  }\r\n\r\n\r\n  const assetIcons = {\r\n    ETH: iconETH,\r\n    BTC: iconBTC,\r\n  }\r\n\r\n  if (!tokenSelection) {\r\n    return null;\r\n  }\r\n  return (\r\n    <div className={cx(\"Exchange-swap-box\")}>\r\n      <div className=\"Exchange-swap-box-inner App-box\">\r\n        <div className=\"Exchange-swap-box__settings\">\r\n          <Tab\r\n            icons={SWAP_ICONS}\r\n            options={SWAP_OPTIONS}\r\n            option={swapOption}\r\n            onChange={onSwapOptionChange}\r\n            className={\"Exchange-swap-option-tabs\"}\r\n          />\r\n        </div>\r\n        <div className=\"Exchange-info-row\" style={{ marginBottom: 15 }}>\r\n          <div className=\"Exchange-info-label\">\r\n            Asset\r\n          </div>\r\n          <Tab\r\n            className=\"align-right\"\r\n            icons={assetIcons}\r\n            options={ASSET_OPTIONS}\r\n            type=\"inline\"\r\n            option={assetOption}\r\n            onChange={onAssetOptionChange}\r\n          />\r\n        </div>\r\n        <NumberInput_v3\r\n          value={amountValue}\r\n          setValue={setAmountValue}\r\n          title=\"Amount\"\r\n        />\r\n        <div className=\"Exchange-leverage-box\">\r\n          <div className=\"Exchange-leverage-slider-settings\">\r\n            <div className=\"Exchange-leverage-name\">Period</div>\r\n            <div className=\"Exchange-leverage-value\">\r\n              {leverageOption} {`Day${leverageOption !== 1 ? 's' : ''}`}\r\n            </div>\r\n          </div>\r\n          <div\r\n            className={cx(\"Exchange-leverage-slider\", \"App-slider\")}\r\n          >\r\n            <Slider\r\n              min={1}\r\n              max={120}\r\n              step={1}\r\n              handle={leverageSliderHandle}\r\n              onChange={(value) => setLeverageOption(value)}\r\n              value={leverageOption}\r\n              defaultValue={leverageOption}\r\n            />\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              Expiration Date\r\n            </div>\r\n            <div className=\"align-right\">\r\n              {format(expDateUTC, 'MM/dd/yy, hh:mm a')}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className={\"Exchange-swap-button btn\" + (isPrimaryEnabled() ? \" btn_hlight\" : \"\")} onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Menu } from \"@headlessui/react\";\r\nimport { FaChevronDown } from \"react-icons/fa\";\r\nimport cx from \"classnames\";\r\nimport \"./ChartTokenSelector.scss\";\r\nimport \"../AddressDropdown/AddressDropdown.css\";\r\nimport { getTokens, getWhitelistedTokens } from \"../../config/Tokens\";\r\nimport { LONG, SHORT, SWAP } from \"../../lib/legacyOptions\";\r\nimport { ethers } from 'ethers';\r\n\r\nexport default function ChartTokenSelector(props) {\r\n  const { chainId, selectedToken, onSelectToken } = props;\r\n\r\n  let options = getTokens(chainId);\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n\r\n  const indexTokens = whitelistedTokens.filter((token) => !token.isStable && !token.isWrapped && (token.symbol === 'ETH' || token.symbol === 'BTC'));\r\n\r\n  options = indexTokens;\r\n\r\n  const onSelect = async (token) => {\r\n    onSelectToken(token);\r\n  };\r\n\r\n  const value = selectedToken;\r\n  let icon;\r\n  if (value.symbol) {\r\n    icon = require(\"../../img/ddl/ic_\" + value.symbol?.toLowerCase() + \"_40.svg\")?.default;\r\n  }\r\n\r\n  return (\r\n    <Menu>\r\n      <Menu.Button as=\"div\">\r\n        <button className={cx(\"App-cta small transparent chart-token-selector\")}>\r\n          <div className=\"chart-token-selector--name\">\r\n            <img src={icon} className=\"chart-token-selector--icon\" alt={value.symbol + ' icon'} />\r\n            <span className=\"chart-token-selector--current\">{value.symbol}/USD</span>\r\n          </div>\r\n          <svg className=\"chevron-down\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"21\" viewBox=\"0 0 20 21\" fill=\"none\">\r\n            <path d=\"M4 8L10 13L16 8\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n          </svg>\r\n        </button>\r\n      </Menu.Button>\r\n      <div className=\"chart-token-menu\">\r\n        <Menu.Items as=\"div\" className=\"menu-items chart-token-menu-items divided\">\r\n          {options.map((option, index) => {\r\n            let tokenPopupImage;\r\n            try {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_\" + option.symbol.toLowerCase() + \"_40.svg\");\r\n            } catch (error) {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_eth_40.svg\");\r\n            }\r\n            \r\n            return (<Menu.Item key={index}>\r\n              <div\r\n                className={\"menu-item\" + (option.symbol === value.symbol ? ' chosen' : '')}\r\n                onClick={() => {\r\n                  onSelect(option);\r\n                }}\r\n              >\r\n                <img src={tokenPopupImage?.default} alt={option.symbol + ' icon'} className=\"token-icon\" />\r\n                <span style={{ marginLeft: 7, marginRight: 35 }} className=\"token-label\">\r\n                  {option.symbol} / USD\r\n                </span>\r\n              </div>\r\n            </Menu.Item>)\r\n          })}\r\n        </Menu.Items>\r\n      </div>\r\n    </Menu>\r\n  );\r\n}\r\n","export const REDIRECT_POPUP_TIMESTAMP_KEY = \"redirect-popup-timestamp\";\r\n\r\nexport const IS_TOUCH = \"ontouchstart\" in window;\r\n","import cx from \"classnames\";\r\nimport { useCallback, useState, useRef } from \"react\";\r\nimport { IS_TOUCH } from \"../../config/ui\";\r\n\r\nconst OPEN_DELAY = 0;\r\nconst CLOSE_DELAY = 100;\r\n\r\nexport default function Tooltip(props) {\r\n  const { enabled } = props;\r\n  const [visible, setVisible] = useState(false);\r\n  const intervalCloseRef = useRef(null);\r\n  const intervalOpenRef = useRef(null);\r\n\r\n  const position = props.position ?? \"left-bottom\";\r\n  const trigger = props.trigger ?? \"hover\";\r\n\r\n  const onMouseEnter = useCallback(() => {\r\n    if (trigger !== \"hover\" || IS_TOUCH) return;\r\n\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (!intervalOpenRef.current) {\r\n      intervalOpenRef.current = setTimeout(() => {\r\n        if (enabled) {\r\n          setVisible(true)\r\n        }\r\n        intervalOpenRef.current = null;\r\n      }, OPEN_DELAY);\r\n    }\r\n  }, [setVisible, intervalCloseRef, intervalOpenRef, trigger]);\r\n\r\n  const onMouseClick = useCallback(() => {\r\n    if (trigger !== \"click\" && !IS_TOUCH) return;\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n\r\n    if (enabled) {\r\n      setVisible(true)\r\n    }\r\n  }, [setVisible, intervalCloseRef, trigger]);\r\n\r\n  const onMouseLeave = useCallback(() => {\r\n    intervalCloseRef.current = setTimeout(() => {\r\n      setVisible(false);\r\n      intervalCloseRef.current = null;\r\n    }, CLOSE_DELAY);\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n  }, [setVisible, intervalCloseRef]);\r\n\r\n  const className = cx(\"Tooltip\", props.className);\r\n\r\n  return (\r\n    <span className={className} style={props.style} onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} onClick={onMouseClick} id={props.id}>\r\n      <span\r\n        className={cx({ \"Tooltip-handle\": !props.disableHandleStyle }, [props.handleClassName], { active: visible })}\r\n      >\r\n        {props.handle}\r\n      </span>\r\n      {visible && <div className={cx([\"Tooltip-popup\", position])}>{props.renderContent()}</div>}\r\n    </span>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useRef, useCallback, useMemo } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport { createChart } from \"krasulya-lightweight-charts\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  SWAP,\r\n  INCREASE,\r\n  CHART_PERIODS,\r\n  getTokenInfo,\r\n  formatAmount,\r\n  formatDateTime,\r\n  usePrevious,\r\n  getLiquidationPrice,\r\n  useLocalStorageSerializeKey,\r\n  numberWithCommas,\r\n} from \"../../lib/legacyOptions\";\r\nimport { useChartPrices } from \"../../domain/legacy\";\r\nimport Tab from \"../Tab/TabOptions\";\r\n\r\nimport { getTokens, getToken } from \"../../config/Tokens\";\r\nimport ChartTokenSelector from \"./ChartTokenSelectorOptions\";\r\nimport Tooltip from '../Tooltip/Tooltip';\r\n\r\nconst PRICE_LINE_TEXT_WIDTH = 15;\r\n\r\nconst timezoneOffset = -new Date().getTimezoneOffset() * 60;\r\n\r\nconst DEFAULT_PERIOD = \"4h\";\r\n\r\nconst RED_COLOR = \"#C75E4B\";\r\nconst GREEN_COLOR = \"#46956A\";\r\n\r\nconst getSeriesOptions = () => ({\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/area-series.md\r\n  lineColor: \"#5472cc\",\r\n  topColor: \"rgba(49, 69, 131, 0.4)\",\r\n  bottomColor: \"rgba(42, 64, 103, 0.0)\",\r\n  lineWidth: 2,\r\n  priceLineColor: \"#384263\",\r\n  downColor: RED_COLOR,\r\n  wickDownColor: RED_COLOR,\r\n  upColor: GREEN_COLOR,\r\n  wickUpColor: GREEN_COLOR,\r\n  borderVisible: false,\r\n});\r\n\r\nconst getChartOptions = (width, height) => ({\r\n  width,\r\n  height,\r\n  layout: {\r\n    backgroundColor: \"rgba(255, 255, 255, 0)\",\r\n    textColor: \"#747FA6\",\r\n    fontFamily: \"Gantari\",\r\n  },\r\n  localization: {\r\n    // https://github.com/tradingview/lightweight-charts/blob/master/docs/customization.md#time-format\r\n    timeFormatter: (businessDayOrTimestamp) => {\r\n      return formatDateTime(businessDayOrTimestamp - timezoneOffset);\r\n    },\r\n  },\r\n  grid: {\r\n    vertLines: {\r\n      visible: true,\r\n      color: \"rgba(35, 38, 59, 1)\",\r\n      style: 2,\r\n    },\r\n    horzLines: {\r\n      visible: true,\r\n      color: \"rgba(35, 38, 59, 1)\",\r\n      style: 2,\r\n    },\r\n  },\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/time-scale.md#time-scale\r\n  timeScale: {\r\n    rightOffset: 5,\r\n    borderVisible: false,\r\n    barSpacing: 5,\r\n    timeVisible: true,\r\n    fixLeftEdge: true,\r\n  },\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/customization.md#price-axis\r\n  priceScale: {\r\n    borderVisible: false,\r\n  },\r\n  crosshair: {\r\n    horzLine: {\r\n      color: \"#aaa\",\r\n    },\r\n    vertLine: {\r\n      color: \"#aaa\",\r\n    },\r\n    mode: 0,\r\n  },\r\n});\r\n\r\nexport default function ExchangeTVChart(props) {\r\n  const {\r\n    infoTokens,\r\n    chainId,\r\n    tokenSelection,\r\n    setTokenSelection,\r\n  } = props;\r\n\r\n  const [currentChart, setCurrentChart] = useState();\r\n  const [currentSeries, setCurrentSeries] = useState();\r\n\r\n  let [period, setPeriod] = useLocalStorageSerializeKey([chainId, \"Chart-period\"], DEFAULT_PERIOD);\r\n  if (!(period in CHART_PERIODS)) {\r\n    period = DEFAULT_PERIOD;\r\n  }\r\n\r\n  const [hoveredCandlestick, setHoveredCandlestick] = useState();\r\n\r\n  const [chartToken, setChartToken] = useState({\r\n    maxPrice: null,\r\n    minPrice: null,\r\n  });\r\n  useEffect(() => {\r\n    const tmp = getTokenInfo(infoTokens, tokenSelection);\r\n    setChartToken(tmp);\r\n  }, [tokenSelection, infoTokens]);\r\n\r\n  const symbol = chartToken ? (chartToken.isWrapped ? chartToken.baseSymbol : chartToken.symbol) : undefined;\r\n  const marketName = chartToken ? symbol + \"_USD\" : undefined;\r\n  const previousMarketName = usePrevious(marketName);\r\n\r\n  const ref = useRef(null);\r\n  const chartRef = useRef(null);\r\n\r\n  const currentAveragePrice =\r\n    chartToken.maxPrice && chartToken.minPrice ? chartToken.maxPrice.add(chartToken.minPrice).div(2) : null;\r\n  const [priceData, updatePriceData] = useChartPrices(\r\n    chainId,\r\n    chartToken.symbol,\r\n    chartToken.isStable,\r\n    period,\r\n    currentAveragePrice\r\n  );\r\n\r\n  const [chartInited, setChartInited] = useState(false);\r\n  useEffect(() => {\r\n    if (marketName !== previousMarketName) {\r\n      setChartInited(false);\r\n    }\r\n  }, [marketName, previousMarketName]);\r\n\r\n  const scaleChart = useCallback(() => {\r\n    const from = Date.now() / 1000 - (7 * 24 * CHART_PERIODS[period]) / 2 + timezoneOffset;\r\n    const to = Date.now() / 1000 + timezoneOffset;\r\n    currentChart.timeScale().setVisibleRange({ from, to });\r\n  }, [currentChart, period]);\r\n\r\n  const onCrosshairMove = useCallback(\r\n    (evt) => {\r\n      if (!evt.time) {\r\n        setHoveredCandlestick(null);\r\n        return;\r\n      }\r\n\r\n      for (const point of evt.seriesPrices.values()) {\r\n        setHoveredCandlestick((hoveredCandlestick) => {\r\n          if (hoveredCandlestick && hoveredCandlestick.time === evt.time) {\r\n            // rerender optimisations\r\n            return hoveredCandlestick;\r\n          }\r\n          return {\r\n            time: evt.time,\r\n            ...point,\r\n          };\r\n        });\r\n        break;\r\n      }\r\n    },\r\n    [setHoveredCandlestick]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!ref.current || !priceData || !priceData.length || currentChart) {\r\n      return;\r\n    }\r\n\r\n    const chart = createChart(\r\n      chartRef.current,\r\n      getChartOptions(chartRef.current.offsetWidth, chartRef.current.offsetHeight)\r\n    );\r\n\r\n    chart.subscribeCrosshairMove(onCrosshairMove);\r\n\r\n    const series = chart.addCandlestickSeries(getSeriesOptions());\r\n\r\n    setCurrentChart(chart);\r\n    setCurrentSeries(series);\r\n  }, [ref, priceData, currentChart, onCrosshairMove]);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      updatePriceData(undefined, true);\r\n    }, 10 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [updatePriceData]);\r\n\r\n  useEffect(() => {\r\n    if (!currentChart) {\r\n      return;\r\n    }\r\n    const resizeChart = () => {\r\n      currentChart.resize(chartRef.current.offsetWidth, chartRef.current.offsetHeight);\r\n    };\r\n    window.addEventListener(\"resize\", resizeChart);\r\n    return () => window.removeEventListener(\"resize\", resizeChart);\r\n  }, [currentChart]);\r\n\r\n  useEffect(() => {\r\n    if (currentSeries && priceData && priceData.length) {\r\n      currentSeries.setData(priceData);\r\n\r\n      if (!chartInited) {\r\n        scaleChart();\r\n        setChartInited(true);\r\n      }\r\n    }\r\n  }, [priceData, currentSeries, chartInited, scaleChart]);\r\n\r\n  const candleStatsHtml = useMemo(() => {\r\n    if (!priceData) {\r\n      return null;\r\n    }\r\n    const candlestick = hoveredCandlestick || priceData[priceData.length - 1];\r\n    if (!candlestick) {\r\n      return null;\r\n    }\r\n\r\n    const className = cx({\r\n      \"ExchangeChart-bottom-stats\": true,\r\n      positive: candlestick.open <= candlestick.close,\r\n      negative: candlestick.open > candlestick.close,\r\n      [`length-${String(parseInt(candlestick.close)).length}`]: true,\r\n    });\r\n\r\n    const toFixedNumbers = 2;\r\n\r\n    return (\r\n      <div className={className}>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">O</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.open.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">H</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.high.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">L</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.low.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">C</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.close.toFixed(toFixedNumbers)}</span>\r\n      </div>\r\n    );\r\n  }, [hoveredCandlestick, priceData]);\r\n\r\n  let high;\r\n  let low;\r\n  let deltaPrice;\r\n  let delta;\r\n  let deltaPercentage;\r\n  let deltaPercentageStr;\r\n\r\n  const now = parseInt(Date.now() / 1000);\r\n  const timeThreshold = now - 24 * 60 * 60;\r\n\r\n  if (priceData) {\r\n    for (let i = priceData.length - 1; i > 0; i--) {\r\n      const price = priceData[i];\r\n      if (price.time < timeThreshold) {\r\n        break;\r\n      }\r\n      if (!low) {\r\n        low = price.low;\r\n      }\r\n      if (!high) {\r\n        high = price.high;\r\n      }\r\n\r\n      if (price.high > high) {\r\n        high = price.high;\r\n      }\r\n      if (price.low < low) {\r\n        low = price.low;\r\n      }\r\n\r\n      deltaPrice = price.open;\r\n    }\r\n  }\r\n\r\n  if (deltaPrice && currentAveragePrice) {\r\n    const average = parseFloat(formatAmount(currentAveragePrice, USD_DECIMALS, 2));\r\n    delta = average - deltaPrice;\r\n    deltaPercentage = (delta * 100) / average;\r\n    if (deltaPercentage > 0) {\r\n      deltaPercentageStr = `+${deltaPercentage.toFixed(2)}%`;\r\n    } else {\r\n      deltaPercentageStr = `${deltaPercentage.toFixed(2)}%`;\r\n    }\r\n    if (deltaPercentage === 0) {\r\n      deltaPercentageStr = \"0.00\";\r\n    }\r\n  }\r\n\r\n  if (!chartToken) {\r\n    return null;\r\n  }\r\n\r\n  const onSelectToken = (token) => {\r\n    const tmp = getTokenInfo(infoTokens, token.address);\r\n    setChartToken(tmp);\r\n    setTokenSelection(token.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"ExchangeChart tv\" ref={ref}>\r\n      <div className=\"ExchangeChart-top App-box App-box-border\">\r\n        <div className=\"ExchangeChart-top-inner\">\r\n          <div>\r\n            <div className=\"ExchangeChart-title\">\r\n              <ChartTokenSelector\r\n                chainId={chainId}\r\n                selectedToken={chartToken}\r\n                infoTokens={infoTokens}\r\n                onSelectToken={onSelectToken}\r\n                className=\"chart-token-selector pos-relative\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"ExchangeChart-stats-container\">\r\n            <div>\r\n              <div className=\"ExchangeChart-info-label\">\r\n                <Tooltip\r\n                  className=\"has-hint-tooltip nowrap cur-price-tooltip\"\r\n                  handle=\"Current Price\"\r\n                  position=\"left-bottom\"\r\n                  enabled={true}\r\n                  renderContent={() => {\r\n                    return (\r\n                      <div className=\"Tooltip__text\">\r\n                        Asset price is taken from GMX\r\n                      </div>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n              \r\n              {/* <div className=\"ExchangeChart-info-label\">\r\n                Current Price\r\n              </div> */}\r\n              <div className=\"ExchangeChart-main-price\">\r\n                ${chartToken.maxPrice && formatAmount(chartToken.maxPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"ExchangeChart-info-label\">24h Change</div>\r\n              <div className={cx({ positive: deltaPercentage > 0, negative: deltaPercentage < 0 })}>\r\n                {!deltaPercentageStr && \"-\"}\r\n                {deltaPercentageStr && deltaPercentageStr}\r\n              </div>\r\n            </div>\r\n            <div className=\"ExchangeChart-additional-info\">\r\n              <div className=\"ExchangeChart-info-label\">24h High</div>\r\n              <div>\r\n                {!high && \"-\"}\r\n                {high && numberWithCommas(high.toFixed(2))}\r\n              </div>\r\n            </div>\r\n            <div className=\"ExchangeChart-additional-info\">\r\n              <div className=\"ExchangeChart-info-label\">24h Low</div>\r\n              <div>\r\n                {!low && \"-\"}\r\n                {low && numberWithCommas(low.toFixed(2))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"ExchangeChart-bottom App-box App-box-border\">\r\n        <div className=\"ExchangeChart-bottom-header\">\r\n          <div className=\"ExchangeChart-bottom-controls\">\r\n            <Tab options={Object.keys(CHART_PERIODS)} option={period} setOption={setPeriod} />\r\n          </div>\r\n          {candleStatsHtml}\r\n        </div>\r\n        <div className=\"ExchangeChart-bottom-content\" ref={chartRef}></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Checkbox.scss\";\r\nimport { ImCheckboxUnchecked, ImCheckboxChecked } from \"react-icons/im\";\r\n\r\nexport default function Checkbox(props) {\r\n  const { isChecked, setIsChecked, disabled, className } = props;\r\n\r\n  return (\r\n    <div\r\n      className={cx(\"Checkbox\", { disabled, selected: isChecked }, className)}\r\n      onClick={() => setIsChecked(!isChecked)}\r\n    >\r\n      <span className=\"Checkbox-icon-wrapper\">\r\n        {isChecked && <ImCheckboxChecked className=\"App-icon Checkbox-icon active\" />}\r\n        {!isChecked && <ImCheckboxUnchecked className=\"App-icon Checkbox-icon inactive\" />}\r\n      </span>\r\n      <span className=\"Checkbox-label\">{props.children}</span>\r\n    </div>\r\n  );\r\n}\r\n","import { disableBodyScroll, enableBodyScroll, clearAllBodyScrollLocks } from \"body-scroll-lock\";\r\nimport { RefObject, useEffect } from \"react\";\r\n\r\nexport const TOUCH_MOVE_CONTAINER_CLASS_NAME = \"DiableScroll-touch-move-container\";\r\n\r\n// @see https://github.com/willmcpo/body-scroll-lock#allowtouchmove\r\nconst allowTouchMoveFn = (el: HTMLElement) => {\r\n  while (el && el !== document.body) {\r\n    if (el.className?.includes?.(TOUCH_MOVE_CONTAINER_CLASS_NAME)) return true;\r\n\r\n    el = el.parentElement as HTMLElement;\r\n  }\r\n};\r\n\r\nexport default function useLockBodyScroll(\r\n  ref: RefObject<HTMLElement>,\r\n  isVisible: boolean,\r\n  opts: {\r\n    disableLock?: boolean;\r\n    allowTouchMove?: boolean;\r\n  } = {}\r\n) {\r\n  useEffect(() => {\r\n    if (opts.disableLock) {\r\n      return;\r\n    }\r\n\r\n    if (ref.current) {\r\n      if (isVisible) {\r\n        disableBodyScroll(ref.current, {\r\n          allowTouchMove: opts.allowTouchMove ? allowTouchMoveFn : undefined,\r\n        });\r\n      } else {\r\n        enableBodyScroll(ref.current);\r\n      }\r\n    }\r\n\r\n    return () => clearAllBodyScrollLocks();\r\n\r\n    // needs ref.current in deps, not just ref\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [ref.current, opts.allowTouchMove, opts.disableLock, isVisible]);\r\n}\r\n","import React, { useRef, useEffect, useState } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\n\r\nimport { MdClose } from \"react-icons/md\";\r\n\r\nimport \"./Modal.scss\";\r\nimport useLockBodyScroll, { TOUCH_MOVE_CONTAINER_CLASS_NAME } from \"../../lib/useLockBodyScroll\";\r\n\r\nexport default function Modal(props) {\r\n  const { isVisible, setIsVisible, className, zIndex, onAfterOpen, disableBodyScrollLock, allowContentTouchMove, isNifty } =\r\n    props;\r\n\r\n  const modalRef = useRef(null);\r\n\r\n  const [isActive, setIsActive] = useState(isVisible);\r\n\r\n  function closeModal() {\r\n    setIsVisible(false);\r\n  }\r\n\r\n  useLockBodyScroll(modalRef, isVisible, {\r\n    disableLock: false,\r\n    allowTouchMove: allowContentTouchMove,\r\n  });\r\n\r\n\r\n  useEffect(() => {\r\n    function close(e) {\r\n      if (e.keyCode === 27) {\r\n        setIsVisible(false);\r\n      }\r\n    }\r\n    window.addEventListener(\"keydown\", close);\r\n    return () => window.removeEventListener(\"keydown\", close);\r\n  }, [setIsVisible]);\r\n\r\n  useEffect(() => {\r\n    if (typeof onAfterOpen === \"function\") onAfterOpen();\r\n  }, [onAfterOpen]);\r\n\r\n  const fadeVariants = {\r\n    hidden: { opacity: 0, visibility: 'hidden' },\r\n    visible: { opacity: 1, visibility: 'visible' },\r\n  };\r\n  const niftyFadeVariants = {\r\n    hidden: {\r\n      transform: 'rotateX(-60deg)',\r\n      opacity: 0,\r\n    },\r\n    visible: {\r\n      transform: 'rotateX(0)',\r\n      opacity: 1,\r\n    }\r\n  }\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isVisible && (\r\n        <motion.div\r\n          className={cx(\"Modal\", isNifty && \"Modal_nifty\", isNifty && isActive && \"active\", className)}\r\n          style={{ zIndex }}\r\n          initial=\"hidden\"\r\n          animate=\"visible\"\r\n          exit=\"hidden\"\r\n          variants={fadeVariants}\r\n          transition={{ duration: 0 }}\r\n        >\r\n          <div\r\n            className=\"Modal-backdrop\"\r\n            style={{\r\n              overflow: isVisible ? \"hidden\" : \"visible\",\r\n              position: \"fixed\",\r\n            }}\r\n            onClick={closeModal}\r\n          ></div>\r\n\r\n          {isNifty && (\r\n            <div className=\"Modal-close-button\" onClick={closeModal}>\r\n              <MdClose fontSize={20} className=\"Modal-close-icon\" />\r\n            </div>\r\n          )}\r\n          \r\n\r\n          <div className={isNifty && \"Modal-content-wrapper\"}>\r\n            <motion.div\r\n              className={cx(\"Modal-content\")}\r\n              style={{ transformStyle: 'preserve-3d', transformOrigin: '50% 0' }}\r\n              initial=\"hidden\"\r\n              animate=\"visible\"\r\n              exit=\"hidden\"\r\n              variants={isNifty && niftyFadeVariants}\r\n              transition={{ duration: 0 }}\r\n            >\r\n              <div className=\"Modal-title-bar\">\r\n                <div className=\"Modal-title\">{props.label}</div>\r\n              </div>\r\n              <div className=\"divider\" />\r\n              <div className={cx(\"Modal-body\", TOUCH_MOVE_CONTAINER_CLASS_NAME)} ref={modalRef}>\r\n                {props.children}\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}\r\n","import React, { useState, useCallback, useEffect, useMemo } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  formatAmount,\r\n  bigNumberify,\r\n  ARBITRUM,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  USD_DECIMALS,\r\n  DUST_USD,\r\n  BASIS_POINTS_DIVISOR,\r\n  USDG_ADDRESS,\r\n  SLIPPAGE_BPS_KEY,\r\n  TRIGGER_PREFIX_BELOW,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  MIN_PROFIT_TIME,\r\n  usePrevious,\r\n  formatAmountFree,\r\n  parseValue,\r\n  expandDecimals,\r\n  getTokenInfo,\r\n  getLiquidationPrice,\r\n  getLeverage,\r\n  getMarginFee,\r\n  PRECISION,\r\n  MARKET,\r\n  STOP,\r\n  DECREASE,\r\n  useLocalStorageSerializeKey,\r\n  calculatePositionDelta,\r\n  getDeltaStr,\r\n  getProfitPrice,\r\n  formatDateTime,\r\n  getTimeRemaining,\r\n  getNextToAmount,\r\n  getUsd,\r\n  USDG_DECIMALS,\r\n  CLOSE_POSITION_RECEIVE_TOKEN_KEY,\r\n  useLocalStorageByChainId,\r\n  adjustForDecimals,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n  MAX_ALLOWED_LEVERAGE,\r\n} from \"../../lib/legacyOptions\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { createDecreaseOrder, useHasOutdatedUi } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport Tab from \"../Tab/TabOptions\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport TokenSelector from \"./TokenSelector\";\r\nimport { getTokens } from \"../../config/Tokens\";\r\nimport \"./PositionSeller.css\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nimport marketImg from '../../img/ddl/icon_market.svg'\r\nimport marketActiveImg from '../../img/ddl/icon_market_active.svg'\r\nimport triggerImg from '../../img/ddl/icon_trigger.svg'\r\nimport triggerActiveImg from '../../img/ddl/icon_trigger_active.svg'\r\nimport SlippageInput from './../SlippageInput/SlippageInput';\r\n\r\nconst CLOSE_ICONS = {\r\n  Market: marketImg,\r\n  Market_active: marketActiveImg,\r\n  Stop: triggerImg,\r\n  Stop_active: triggerActiveImg,\r\n}\r\n\r\nconst { AddressZero } = ethers.constants;\r\nconst ORDER_SIZE_DUST_USD = expandDecimals(1, USD_DECIMALS - 1); // $0.10\r\n\r\nconst orderOptionLabels = {\r\n  [MARKET]: \"Market\",\r\n  [STOP]: \"Trigger\",\r\n};\r\n\r\nfunction getTokenAmount(usdAmount, tokenAddress, max, infoTokens) {\r\n  if (!usdAmount) {\r\n    return;\r\n  }\r\n  if (tokenAddress === USDG_ADDRESS) {\r\n    return usdAmount.mul(expandDecimals(1, 18)).div(PRECISION);\r\n  }\r\n  const info = getTokenInfo(infoTokens, tokenAddress);\r\n  if (!info) {\r\n    return;\r\n  }\r\n  if (max && !info.maxPrice) {\r\n    return;\r\n  }\r\n  if (!max && !info.minPrice) {\r\n    return;\r\n  }\r\n\r\n  return usdAmount.mul(expandDecimals(1, info.decimals)).div(max ? info.minPrice : info.maxPrice);\r\n}\r\n\r\nfunction shouldSwap(collateralToken, receiveToken) {\r\n  // If position collateral is WETH in contract, then position.collateralToken is { symbol: ETH, isNative: true,  }\r\n  // @see https://github.com/gmx-io/gmx-interface/blob/master/src/pages/Exchange/Exchange.js#L162\r\n  // meaning if collateralToken.isNative === true in reality position has WETH as a collateral\r\n  // and if collateralToken.isNative === true and receiveToken.isNative === true then positions WETH will be unwrapped and user will receive native ETH\r\n  const isCollateralWrapped = collateralToken.isNative;\r\n\r\n  const isSameToken =\r\n    collateralToken.address === receiveToken.address || (isCollateralWrapped && receiveToken.isWrapped);\r\n\r\n  const isUnwrap = isCollateralWrapped && receiveToken.isNative;\r\n\r\n  return !isSameToken && !isUnwrap;\r\n}\r\n\r\nfunction getSwapLimits(infoTokens, fromTokenAddress, toTokenAddress) {\r\n  const fromInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  let maxInUsd;\r\n  let maxIn;\r\n  let maxOut;\r\n  let maxOutUsd;\r\n\r\n  if (!fromInfo?.maxUsdgAmount) {\r\n    maxInUsd = bigNumberify(0);\r\n    maxIn = bigNumberify(0);\r\n  } else {\r\n    maxInUsd = fromInfo.maxUsdgAmount\r\n      .sub(fromInfo.usdgAmount)\r\n      .mul(expandDecimals(1, USD_DECIMALS))\r\n      .div(expandDecimals(1, USDG_DECIMALS));\r\n\r\n    maxIn = maxInUsd.mul(expandDecimals(1, fromInfo.decimals)).div(fromInfo.maxPrice).toString();\r\n  }\r\n\r\n  if (!toInfo?.poolAmount || !toInfo?.bufferAmount) {\r\n    maxOut = bigNumberify(0);\r\n    maxOutUsd = bigNumberify(0);\r\n  } else {\r\n    maxOut = toInfo.availableAmount.gt(toInfo.poolAmount.sub(toInfo.bufferAmount))\r\n      ? toInfo.poolAmount.sub(toInfo.bufferAmount)\r\n      : toInfo.availableAmount;\r\n\r\n    maxOutUsd = getUsd(maxOut, toInfo.address, false, infoTokens);\r\n  }\r\n\r\n  return {\r\n    maxIn,\r\n    maxInUsd,\r\n    maxOut,\r\n    maxOutUsd,\r\n  };\r\n}\r\n\r\nexport default function PositionSeller(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsMap,\r\n    positionKey,\r\n    isVisible,\r\n    setIsVisible,\r\n    account,\r\n    library,\r\n    infoTokens,\r\n    setPendingTxns,\r\n    flagOrdersEnabled,\r\n    savedIsPnlInLeverage,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    orders,\r\n    isWaitingForPluginApproval,\r\n    isPluginApproving,\r\n    orderBookApproved,\r\n    setOrdersToaOpen,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    minExecutionFee,\r\n    minExecutionFeeErrorMessage,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n    initTab,\r\n  } = props;\r\n\r\n  const [savedSlippageAmount] = useLocalStorageSerializeKey([chainId, SLIPPAGE_BPS_KEY], DEFAULT_SLIPPAGE_AMOUNT);\r\n\r\n  const [keepLeverage, setKeepLeverage] = useLocalStorageSerializeKey([chainId, \"Exchange-keep-leverage\"], true);\r\n  const position = positionsMap && positionKey ? positionsMap[positionKey] : undefined;\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n\r\n  const [userSlippage, setUserSlippage] = useState('')\r\n  \r\n  const [isProfitWarningAccepted, setIsProfitWarningAccepted] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const prevIsVisible = usePrevious(isVisible);\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n  const toTokens = getTokens(chainId);\r\n\r\n  const [savedRecieveTokenAddress, setSavedRecieveTokenAddress] = useLocalStorageByChainId(\r\n    chainId,\r\n    `${CLOSE_POSITION_RECEIVE_TOKEN_KEY}-${position.indexToken.symbol}-${position?.isLong ? \"long\" : \"short\"}`\r\n  );\r\n\r\n  const [swapToToken, setSwapToToken] = useState(() =>\r\n    savedRecieveTokenAddress ? toTokens.find((token) => token.address === savedRecieveTokenAddress) : undefined\r\n  );\r\n\r\n  // Slippage Edit\r\n  // let allowedSlippage = savedSlippageAmount;\r\n  let allowedSlippage = DEFAULT_SLIPPAGE_AMOUNT;\r\n  // if (isHigherSlippageAllowed) {\r\n  //   allowedSlippage = DEFAULT_HIGHER_SLIPPAGE_AMOUNT;\r\n  // }\r\n  if (userSlippage !== '') {\r\n    allowedSlippage = userSlippage * 100;\r\n  }\r\n\r\n  const orderOptions = [MARKET, STOP];\r\n  let [orderOption, setOrderOption] = useState(initTab ?? MARKET);\r\n\r\n  if (!flagOrdersEnabled) {\r\n    orderOption = MARKET;\r\n  }\r\n\r\n  const needPositionRouterApproval = !positionRouterApproved && orderOption === MARKET;\r\n\r\n  const onOrderOptionChange = (option) => {\r\n    setOrderOption(option);\r\n  };\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(\"\");\r\n  const triggerPriceUsd = orderOption === MARKET ? 0 : parseValue(triggerPriceValue, USD_DECIMALS);\r\n\r\n  const [nextDelta, nextHasProfit = bigNumberify(0)] = useMemo(() => {\r\n    if (!position) {\r\n      return [bigNumberify(0), false];\r\n    }\r\n\r\n    if (orderOption !== STOP) {\r\n      return [position.delta, position.hasProfit, position.deltaPercentage];\r\n    }\r\n\r\n    if (!triggerPriceUsd) {\r\n      return [bigNumberify(0), false];\r\n    }\r\n\r\n    const { delta, hasProfit, deltaPercentage } = calculatePositionDelta(triggerPriceUsd, position);\r\n    return [delta, hasProfit, deltaPercentage];\r\n  }, [position, orderOption, triggerPriceUsd]);\r\n\r\n  const existingOrders = useMemo(() => {\r\n    if (orderOption === STOP && (!triggerPriceUsd || triggerPriceUsd.eq(0))) {\r\n      return [];\r\n    }\r\n    if (!orders || !position) {\r\n      return [];\r\n    }\r\n\r\n    const ret = [];\r\n    for (const order of orders) {\r\n      // only Stop orders can't be executed without corresponding opened position\r\n      if (order.type !== DECREASE) continue;\r\n\r\n      // if user creates Stop-Loss we need only Stop-Loss orders and vice versa\r\n      if (orderOption === STOP) {\r\n        const triggerAboveThreshold = triggerPriceUsd.gt(position.markPrice);\r\n        if (triggerAboveThreshold !== order.triggerAboveThreshold) continue;\r\n      }\r\n\r\n      const sameToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      if (order.isLong === position.isLong && sameToken) {\r\n        ret.push(order);\r\n      }\r\n    }\r\n    return ret;\r\n  }, [position, orders, triggerPriceUsd, orderOption, nativeTokenAddress]);\r\n\r\n  const existingOrder = existingOrders[0];\r\n\r\n  const needOrderBookApproval = orderOption === STOP && !orderBookApproved;\r\n\r\n  const isSwapAllowed = orderOption === MARKET;\r\n\r\n  const { data: hasOutdatedUi } = useHasOutdatedUi();\r\n\r\n  let collateralToken;\r\n  let receiveToken;\r\n  let maxAmount;\r\n  let maxAmountFormatted;\r\n  let maxAmountFormattedFree;\r\n  let fromAmount;\r\n\r\n  let convertedAmount;\r\n  let convertedAmountFormatted;\r\n\r\n  let nextLeverage;\r\n  let liquidationPrice;\r\n  let nextLiquidationPrice;\r\n  let isClosing;\r\n  let sizeDelta;\r\n\r\n  let nextCollateral;\r\n  let collateralDelta = bigNumberify(0);\r\n  let receiveAmount = bigNumberify(0);\r\n  let convertedReceiveAmount = bigNumberify(0);\r\n  let adjustedDelta = bigNumberify(0);\r\n\r\n  let isNotEnoughReceiveTokenLiquidity;\r\n  let isCollateralPoolCapacityExceeded;\r\n\r\n  let title;\r\n  let fundingFee;\r\n  let positionFee;\r\n  let swapFeeToken;\r\n  let swapFee;\r\n  let totalFees = bigNumberify(0);\r\n\r\n  let executionFee = orderOption === STOP ? getConstant(chainId, \"DECREASE_ORDER_EXECUTION_GAS_FEE\") : minExecutionFee;\r\n\r\n  let executionFeeUsd = getUsd(executionFee, nativeTokenAddress, false, infoTokens) || bigNumberify(0);\r\n\r\n  if (position) {\r\n    fundingFee = position.fundingFee;\r\n    fromAmount = parseValue(fromValue, USD_DECIMALS);\r\n    sizeDelta = fromAmount;\r\n\r\n    title = `Close ${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol}`;\r\n    collateralToken = position.collateralToken;\r\n    liquidationPrice = getLiquidationPrice(position);\r\n\r\n    if (fromAmount) {\r\n      isClosing = position.size.sub(fromAmount).lt(DUST_USD);\r\n      positionFee = getMarginFee(fromAmount);\r\n    }\r\n\r\n    if (isClosing) {\r\n      sizeDelta = position.size;\r\n      receiveAmount = position.collateral;\r\n    } else if (orderOption === STOP && sizeDelta && existingOrders.length > 0) {\r\n      let residualSize = position.size;\r\n      for (const order of existingOrders) {\r\n        residualSize = residualSize.sub(order.sizeDelta);\r\n      }\r\n      if (residualSize.sub(sizeDelta).abs().lt(ORDER_SIZE_DUST_USD)) {\r\n        sizeDelta = residualSize;\r\n      }\r\n    }\r\n\r\n    if (sizeDelta) {\r\n      adjustedDelta = nextDelta.mul(sizeDelta).div(position.size);\r\n    }\r\n\r\n    if (nextHasProfit) {\r\n      receiveAmount = receiveAmount.add(adjustedDelta);\r\n    } else {\r\n      if (receiveAmount.gt(adjustedDelta)) {\r\n        receiveAmount = receiveAmount.sub(adjustedDelta);\r\n      } else {\r\n        receiveAmount = bigNumberify(0);\r\n      }\r\n    }\r\n\r\n    if (keepLeverage && sizeDelta && !isClosing) {\r\n      collateralDelta = sizeDelta.mul(position.collateral).div(position.size);\r\n      // if the position will be realising a loss then reduce collateralDelta by the realised loss\r\n      if (!nextHasProfit) {\r\n        const deductions = adjustedDelta.add(positionFee).add(fundingFee);\r\n        if (collateralDelta.gt(deductions)) {\r\n          collateralDelta = collateralDelta = collateralDelta.sub(deductions);\r\n        } else {\r\n          collateralDelta = bigNumberify(0);\r\n        }\r\n      }\r\n    }\r\n\r\n    maxAmount = position.size;\r\n    maxAmountFormatted = formatAmount(maxAmount, USD_DECIMALS, 2, true);\r\n    maxAmountFormattedFree = formatAmountFree(maxAmount, USD_DECIMALS, 2);\r\n\r\n    if (fromAmount && collateralToken.maxPrice) {\r\n      convertedAmount = fromAmount.mul(expandDecimals(1, collateralToken.decimals)).div(collateralToken.maxPrice);\r\n      convertedAmountFormatted = formatAmount(convertedAmount, collateralToken.decimals, 4, true);\r\n    }\r\n\r\n    totalFees = totalFees.add(positionFee || bigNumberify(0)).add(fundingFee || bigNumberify(0));\r\n\r\n    receiveAmount = receiveAmount.add(collateralDelta);\r\n\r\n    if (sizeDelta) {\r\n      if (receiveAmount.gt(totalFees)) {\r\n        receiveAmount = receiveAmount.sub(totalFees);\r\n      } else {\r\n        receiveAmount = bigNumberify(0);\r\n      }\r\n    }\r\n\r\n    receiveToken = isSwapAllowed && swapToToken ? swapToToken : collateralToken;\r\n\r\n    // Calculate swap fees\r\n    if (isSwapAllowed && swapToToken) {\r\n      const { feeBasisPoints } = getNextToAmount(\r\n        chainId,\r\n        convertedAmount,\r\n        collateralToken.address,\r\n        receiveToken.address,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        true\r\n      );\r\n\r\n      if (feeBasisPoints) {\r\n        swapFee = receiveAmount.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n        swapFeeToken = getTokenAmount(swapFee, collateralToken.address, false, infoTokens);\r\n        totalFees = totalFees.add(swapFee || bigNumberify(0));\r\n        receiveAmount = receiveAmount.sub(swapFee);\r\n      }\r\n    }\r\n\r\n    convertedReceiveAmount = getTokenAmount(receiveAmount, receiveToken.address, false, infoTokens);\r\n\r\n    // Check swap limits (max in / max out)\r\n    if (isSwapAllowed && shouldSwap(collateralToken, receiveToken)) {\r\n      const collateralInfo = getTokenInfo(infoTokens, collateralToken.address);\r\n      const receiveTokenInfo = getTokenInfo(infoTokens, receiveToken.address);\r\n\r\n      isNotEnoughReceiveTokenLiquidity =\r\n        receiveTokenInfo.availableAmount.lt(convertedReceiveAmount) ||\r\n        receiveTokenInfo.bufferAmount.gt(receiveTokenInfo.poolAmount.sub(convertedReceiveAmount));\r\n\r\n      if (\r\n        collateralInfo.maxUsdgAmount &&\r\n        collateralInfo.maxUsdgAmount.gt(0) &&\r\n        collateralInfo.usdgAmount &&\r\n        collateralInfo.maxPrice\r\n      ) {\r\n        const usdgFromAmount = adjustForDecimals(receiveAmount, USD_DECIMALS, USDG_DECIMALS);\r\n        const nextUsdgAmount = collateralInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n        if (nextUsdgAmount.gt(collateralInfo.maxUsdgAmount)) {\r\n          isCollateralPoolCapacityExceeded = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isClosing) {\r\n      nextCollateral = bigNumberify(0);\r\n    } else {\r\n      if (position.collateral) {\r\n        nextCollateral = position.collateral;\r\n        if (collateralDelta && collateralDelta.gt(0)) {\r\n          nextCollateral = position.collateral.sub(collateralDelta);\r\n        } else if (position.delta && position.delta.gt(0) && sizeDelta) {\r\n          if (!position.hasProfit) {\r\n            nextCollateral = nextCollateral.sub(adjustedDelta);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (fromAmount) {\r\n      if (!isClosing && !keepLeverage) {\r\n        nextLeverage = getLeverage({\r\n          size: position.size,\r\n          sizeDelta,\r\n          collateral: position.collateral,\r\n          entryFundingRate: position.entryFundingRate,\r\n          cumulativeFundingRate: position.cumulativeFundingRate,\r\n          hasProfit: nextHasProfit,\r\n          delta: nextDelta,\r\n          includeDelta: savedIsPnlInLeverage,\r\n        });\r\n        nextLiquidationPrice = getLiquidationPrice({\r\n          isLong: position.isLong,\r\n          size: position.size,\r\n          sizeDelta,\r\n          collateral: position.collateral,\r\n          averagePrice: position.averagePrice,\r\n          entryFundingRate: position.entryFundingRate,\r\n          cumulativeFundingRate: position.cumulativeFundingRate,\r\n          delta: nextDelta,\r\n          hasProfit: nextHasProfit,\r\n          includeDelta: true,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  const [deltaStr, deltaPercentageStr] = useMemo(() => {\r\n    if (!position || !position.markPrice) {\r\n      return [\"-\", \"-\"];\r\n    }\r\n    if (orderOption !== STOP) {\r\n      const { pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(\r\n        position.markPrice,\r\n        position,\r\n        fromAmount\r\n      );\r\n      const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n        delta: pendingDelta,\r\n        deltaPercentage: pendingDeltaPercentage,\r\n        hasProfit,\r\n      });\r\n      return [deltaStr, deltaPercentageStr];\r\n    }\r\n    if (!triggerPriceUsd || triggerPriceUsd.eq(0)) {\r\n      return [\"-\", \"-\"];\r\n    }\r\n\r\n    const { pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(\r\n      triggerPriceUsd,\r\n      position,\r\n      fromAmount\r\n    );\r\n\r\n    const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n      delta: pendingDelta,\r\n      deltaPercentage: pendingDeltaPercentage,\r\n      hasProfit,\r\n    });\r\n    return [deltaStr, deltaPercentageStr];\r\n  }, [position, triggerPriceUsd, orderOption, fromAmount]);\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (orderOption === STOP) return [t`Trigger order disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`Position close disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (hasOutdatedUi) {\r\n      return t`Page outdated, please refresh`;\r\n    }\r\n    if (!fromAmount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (nextLeverage && nextLeverage.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (orderOption === STOP) {\r\n      if (!triggerPriceUsd || triggerPriceUsd.eq(0)) {\r\n        return t`Enter Price`;\r\n      }\r\n      if (position.isLong && triggerPriceUsd.lte(liquidationPrice)) {\r\n        return t`Price below Liq. Price`;\r\n      }\r\n      if (!position.isLong && triggerPriceUsd.gte(liquidationPrice)) {\r\n        return t`Price above Liq. Price`;\r\n      }\r\n\r\n      if (profitPrice && nextDelta.eq(0) && nextHasProfit) {\r\n        return t`Invalid price, see warning`;\r\n      }\r\n    }\r\n\r\n    if (isNotEnoughReceiveTokenLiquidity) {\r\n      return \"Insufficient receive token liquidity\";\r\n    }\r\n\r\n    if (isCollateralPoolCapacityExceeded) {\r\n      return `${collateralToken.symbol} pool exceeded, can only Receive ${collateralToken.symbol}`;\r\n    }\r\n\r\n    if (!isClosing && position && position.size && fromAmount) {\r\n      if (position.size.sub(fromAmount).lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return t`Leftover position below 10 USD`;\r\n      }\r\n      if (nextCollateral && nextCollateral.lt(expandDecimals(5, USD_DECIMALS))) {\r\n        return t`Leftover collateral below 5 USD`;\r\n      }\r\n    }\r\n\r\n    if (position && position.size && position.size.lt(fromAmount)) {\r\n      return t`Max close amount exceeded`;\r\n    }\r\n\r\n    if (nextLeverage && nextLeverage.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Min leverage: 1.1x`;\r\n    }\r\n\r\n    if (nextLeverage && nextLeverage.gt(MAX_ALLOWED_LEVERAGE)) {\r\n      return t`Max leverage: ${(MAX_ALLOWED_LEVERAGE / BASIS_POINTS_DIVISOR).toFixed(1)}x`;\r\n    }\r\n\r\n    if (hasPendingProfit && orderOption !== STOP && !isProfitWarningAccepted) {\r\n      return t`Forfeit profit not checked`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return false;\r\n    }\r\n    if (isPluginApproving) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const hasPendingProfit = MIN_PROFIT_TIME > 0 && position.delta.eq(0) && position.pendingDelta.gt(0);\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n\r\n    if (orderOption === STOP) {\r\n      if (isSubmitting) return t`Creating Order...`;\r\n\r\n      if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n        return t`Enabling Orders...`;\r\n      }\r\n      if (isPluginApproving) {\r\n        return t`Enabling Orders...`;\r\n      }\r\n      if (needOrderBookApproval) {\r\n        return t`Enable Orders`;\r\n      }\r\n\r\n      return t`Create Order`;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (hasPendingProfit) {\r\n      return t`Close without profit`;\r\n    }\r\n    return isSubmitting ? t`Closing...` : t`Close`;\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFromValue(\"\");\r\n    setIsProfitWarningAccepted(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevIsVisible !== isVisible) {\r\n      resetForm();\r\n    }\r\n  }, [prevIsVisible, isVisible]);\r\n\r\n  const onClickPrimary = async () => {\r\n    if (needOrderBookApproval) {\r\n      setOrdersToaOpen(true);\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: t`Enable leverage sent.`,\r\n        failMsg: t`Enable leverage failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    const collateralTokenAddress = position.collateralToken.isNative\r\n      ? nativeTokenAddress\r\n      : position.collateralToken.address;\r\n    const indexTokenAddress = position.indexToken.isNative ? nativeTokenAddress : position.indexToken.address;\r\n\r\n    if (orderOption === STOP) {\r\n      const triggerAboveThreshold = triggerPriceUsd.gt(position.markPrice);\r\n\r\n      createDecreaseOrder(\r\n        chainId,\r\n        library,\r\n        indexTokenAddress,\r\n        sizeDelta,\r\n        collateralTokenAddress,\r\n        collateralDelta,\r\n        position.isLong,\r\n        triggerPriceUsd,\r\n        triggerAboveThreshold,\r\n        {\r\n          sentMsg: t`Order submitted!`,\r\n          successMsg: t`Order created!`,\r\n          failMsg: t`Order creation failed.`,\r\n          setPendingTxns,\r\n        }\r\n      )\r\n        .then(() => {\r\n          setFromValue(\"\");\r\n          setIsVisible(false);\r\n        })\r\n        .finally(() => {\r\n          setIsSubmitting(false);\r\n        });\r\n      return;\r\n    }\r\n\r\n    const priceBasisPoints = position.isLong\r\n      ? BASIS_POINTS_DIVISOR - allowedSlippage\r\n      : BASIS_POINTS_DIVISOR + allowedSlippage;\r\n    const refPrice = position.isLong ? position.indexToken.minPrice : position.indexToken.maxPrice;\r\n    let priceLimit = refPrice.mul(priceBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n    const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n    const minProfitTimeExpired = parseInt(Date.now() / 1000) > minProfitExpiration;\r\n\r\n    if (nextHasProfit && !minProfitTimeExpired && !isProfitWarningAccepted) {\r\n      if ((position.isLong && priceLimit.lt(profitPrice)) || (!position.isLong && priceLimit.gt(profitPrice))) {\r\n        priceLimit = profitPrice;\r\n      }\r\n    }\r\n\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n\r\n    const path = [tokenAddress0];\r\n\r\n    const isUnwrap = receiveToken.address === AddressZero;\r\n    const isSwap = receiveToken.address !== tokenAddress0;\r\n\r\n    if (isSwap) {\r\n      if (isUnwrap && tokenAddress0 !== nativeTokenAddress) {\r\n        path.push(nativeTokenAddress);\r\n      } else if (!isUnwrap) {\r\n        path.push(receiveToken.address);\r\n      }\r\n    }\r\n\r\n    const withdrawETH = isUnwrap;\r\n\r\n    const params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      collateralDelta, // _collateralDelta\r\n      sizeDelta, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      account, // _receiver\r\n      priceLimit, // _acceptablePrice\r\n      0, // _minOut\r\n      minExecutionFee, // _executionFee\r\n      withdrawETH, // _withdrawETH\r\n      AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    const successMsg = t`Requested decrease of ${position.indexToken.symbol} ${\r\n      position.isLong ? \"Long\" : \"Short\"\r\n    } by ${formatAmount(sizeDelta, USD_DECIMALS, 2)} USD.`;\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, \"createDecreasePosition\", params, {\r\n      value: minExecutionFee,\r\n      sentMsg: t`Close submitted!`,\r\n      successMsg,\r\n      failMsg: t`Close failed.`,\r\n      setPendingTxns,\r\n      // for Arbitrum, sometimes the successMsg shows after the position has already been executed\r\n      // hide the success message for Arbitrum as a workaround\r\n      hideSuccessMsg: chainId === ARBITRUM,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        let nextSize = position.size.sub(sizeDelta);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            size: nextSize,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const renderExistingOrderWarning = useCallback(() => {\r\n    if (!existingOrder) {\r\n      return;\r\n    }\r\n    const indexToken = getTokenInfo(infoTokens, existingOrder.indexToken);\r\n    const sizeInToken = formatAmount(\r\n      existingOrder.sizeDelta.mul(PRECISION).div(existingOrder.triggerPrice),\r\n      USD_DECIMALS,\r\n      4,\r\n      true\r\n    );\r\n    const prefix = existingOrder.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n    return (\r\n      <div className=\"Confirmation-box-warning\">\r\n        You have an active order to decrease {existingOrder.isLong ? \"Long\" : \"Short\"} {sizeInToken} {indexToken.symbol}{\" \"}\r\n        ($\r\n        {formatAmount(existingOrder.sizeDelta, USD_DECIMALS, 2, true)}) at {prefix}{\" \"}\r\n        {formatAmount(existingOrder.triggerPrice, USD_DECIMALS, 2, true)}\r\n      </div>\r\n    );\r\n  }, [existingOrder, infoTokens]);\r\n\r\n  function renderMinProfitWarning() {\r\n    if (MIN_PROFIT_TIME === 0) {\r\n      return null;\r\n    }\r\n\r\n    if (profitPrice && nextDelta.eq(0) && nextHasProfit) {\r\n      const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n\r\n      if (orderOption === MARKET) {\r\n        return (\r\n          <div className=\"Confirmation-box-warning\">\r\n            Reducing the position at the current price will forfeit a&nbsp;\r\n            <a\r\n              href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              pending profit\r\n            </a>{\" \"}\r\n            of {deltaStr}. <br />\r\n            <br />\r\n            Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n            applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}.\r\n          </div>\r\n        );\r\n      }\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          This order will forfeit a&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            profit\r\n          </a>{\" \"}\r\n          of {deltaStr}. <br />\r\n          Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n          applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}.\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  const profitPrice = getProfitPrice(orderOption === MARKET ? position.markPrice : triggerPriceUsd, position);\r\n\r\n  let triggerPricePrefix;\r\n  if (triggerPriceUsd) {\r\n    triggerPricePrefix = triggerPriceUsd.gt(position.markPrice) ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n  }\r\n\r\n  const shouldShowExistingOrderWarning = false;\r\n\r\n  const [hasInputFocus, setHasInputFocus] = useState(false);\r\n  const [hasInputError, setHasInputError] = useState(false);\r\n  const checkInputError = (inputVal) => {\r\n    if (!isPrimaryEnabled() && inputVal !== '') {\r\n      setHasInputError(true);\r\n    } else {\r\n      setHasInputError(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkInputError(fromValue);\r\n  }, [fromValue])\r\n\r\n  return (\r\n    <div className=\"PositionEditor\">\r\n      {position && (\r\n        <Modal\r\n          className=\"PositionSeller-modal\"\r\n          isVisible={isVisible}\r\n          setIsVisible={setIsVisible}\r\n          label={title}\r\n          allowContentTouchMove\r\n          isNifty={true}\r\n        >\r\n          {flagOrdersEnabled && (\r\n            <Tab\r\n              options={orderOptions}\r\n              option={orderOption}\r\n              optionLabels={orderOptionLabels}\r\n              onChange={onOrderOptionChange}\r\n              icons={CLOSE_ICONS}\r\n            />\r\n          )}\r\n          <div className={\"Exchange-swap-section\"\r\n            + (hasInputError ? \" error\" : \"\") + (hasInputFocus ? \" hlight\" : \"\")}>\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                {convertedAmountFormatted && (\r\n                  <div className=\"Exchange-swap-usd\">\r\n                    Close: {convertedAmountFormatted} {position.collateralToken.symbol}\r\n                  </div>\r\n                )}\r\n                {!convertedAmountFormatted && \"Close\"}\r\n              </div>\r\n              {maxAmount && (\r\n                <div className=\"muted align-right clickable\" onClick={() => setFromValue(maxAmountFormattedFree)}>\r\n                  Max: {maxAmountFormatted}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input\"\r\n                  value={fromValue}\r\n                  onChange={(e) => setFromValue(e.target.value)}\r\n                  onFocus={(e) => {\r\n                    setHasInputFocus(true);\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    setHasInputFocus(false);\r\n                  }}\r\n                />\r\n                {fromValue !== maxAmountFormattedFree && (\r\n                  <div\r\n                    className=\"Exchange-swap-max\"\r\n                    onClick={() => {\r\n                      setFromValue(maxAmountFormattedFree);\r\n                    }}\r\n                  >\r\n                    MAX\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"PositionEditor-token-symbol\">USD</div>\r\n            </div>\r\n          </div>\r\n          {orderOption === MARKET && (\r\n            <SlippageInput \r\n              value={userSlippage}\r\n              setValue={setUserSlippage} \r\n            />\r\n          )}\r\n          {orderOption === STOP && (\r\n            <div className=\"Exchange-swap-section\">\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  <Trans>Price</Trans>\r\n                </div>\r\n                <div\r\n                  className=\"muted align-right clickable\"\r\n                  onClick={() => {\r\n                    setTriggerPriceValue(formatAmountFree(position.markPrice, USD_DECIMALS, 2));\r\n                  }}\r\n                >\r\n                  Mark: {formatAmount(position.markPrice, USD_DECIMALS, 2, true)}\r\n                </div>\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div className=\"Exchange-swap-input-container\">\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={triggerPriceValue}\r\n                    onChange={onTriggerPriceChange}\r\n                    onFocus={(e) => {\r\n                      e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                    }}\r\n                    onBlur={(e) => {\r\n                      e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div className=\"PositionEditor-token-symbol\">USD</div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {renderMinProfitWarning()}\r\n          {shouldShowExistingOrderWarning && renderExistingOrderWarning()}\r\n          <div className=\"PositionEditor-info-box\">\r\n            {minExecutionFeeErrorMessage && (\r\n              <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>\r\n            )}\r\n            {hasPendingProfit && orderOption !== STOP && (\r\n              <div className=\"PositionEditor-accept-profit-warning\">\r\n                <Checkbox isChecked={isProfitWarningAccepted} setIsChecked={setIsProfitWarningAccepted}>\r\n                  <span className=\"muted\">Forfeit profit</span>\r\n                </Checkbox>\r\n              </div>\r\n            )}\r\n            {/* <div className=\"PositionEditor-keep-leverage-settings\">\r\n              <Checkbox isChecked={keepLeverage} setIsChecked={setKeepLeverage}>\r\n                <span className=\"muted font-sm\">Keep leverage at {formatAmount(position.leverage, 4, 2)}x</span>\r\n              </Checkbox>\r\n            </div> */}\r\n            {/* {orderOption === MARKET && (\r\n              <div className=\"PositionEditor-allow-higher-slippage\">\r\n                <Checkbox isChecked={isHigherSlippageAllowed} setIsChecked={setIsHigherSlippageAllowed}>\r\n                  <span className=\"muted font-sm\">Allow up to 1% slippage</span>\r\n                </Checkbox>\r\n              </div>\r\n            )} */}\r\n            {orderOption === MARKET && (\r\n              <div>\r\n                <ExchangeInfoRow label=\"Allowed Slippage\" className=\"Slippage-row\">\r\n                  <Tooltip\r\n                    handle={`${formatAmount(allowedSlippage, 2, 2)}%`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          You can change this in the settings menu on the top right of the page.\r\n                          <br />\r\n                          <br />\r\n                          Note that a low allowed slippage, e.g. less than 0.5%, may result in failed orders if prices\r\n                          are volatile.\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </ExchangeInfoRow>\r\n              </div>\r\n            )}\r\n            {orderOption === STOP && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Trigger Price</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {!triggerPriceUsd && \"-\"}\r\n                  {triggerPriceUsd && `${triggerPricePrefix} ${formatAmount(triggerPriceUsd, USD_DECIMALS, 2, true)}`}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Mark Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Entry Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Liq. Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {isClosing && orderOption !== STOP && \"-\"}\r\n                {(!isClosing || orderOption === STOP) && (\r\n                  <div>\r\n                    {(!nextLiquidationPrice || nextLiquidationPrice.eq(liquidationPrice)) && (\r\n                      <div>{`$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}</div>\r\n                    )}\r\n                    {nextLiquidationPrice && !nextLiquidationPrice.eq(liquidationPrice) && (\r\n                      <div>\r\n                        <div className=\"inline-block muted\">\r\n                          ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                          <BsArrowRight className=\"transition-arrow\" />\r\n                        </div>\r\n                        ${formatAmount(nextLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Size</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {position && position.size && fromAmount && (\r\n                  <div>\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(position.size, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                    ${formatAmount(position.size.sub(fromAmount), USD_DECIMALS, 2, true)}\r\n                  </div>\r\n                )}\r\n                {position && position.size && !fromAmount && (\r\n                  <div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Collateral ({collateralToken.symbol})</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {nextCollateral && !nextCollateral.eq(position.collateral) ? (\r\n                  <div>\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                    ${formatAmount(nextCollateral, USD_DECIMALS, 2, true)}\r\n                  </div>\r\n                ) : (\r\n                  `$${formatAmount(position.collateral, USD_DECIMALS, 4, true)}`\r\n                )}\r\n              </div>\r\n            </div>\r\n            {!keepLeverage && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Leverage</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {isClosing && \"-\"}\r\n                  {!isClosing && (\r\n                    <div>\r\n                      {!nextLeverage && <div>{formatAmount(position.leverage, 4, 2)}x</div>}\r\n                      {nextLeverage && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            {formatAmount(position.leverage, 4, 2)}x\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          {formatAmount(nextLeverage, 4, 2)}x\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>PnL</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {deltaStr} ({deltaPercentageStr})\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Fees</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  position=\"right-top\"\r\n                  className=\"PositionSeller-fees-tooltip\"\r\n                  handle={\r\n                    <div>\r\n                      {totalFees ? `$${formatAmount(totalFees.add(executionFeeUsd), USD_DECIMALS, 2, true)}` : \"-\"}\r\n                    </div>\r\n                  }\r\n                  renderContent={() => (\r\n                    <div>\r\n                      {fundingFee && (\r\n                        <StatsTooltipRow label=\"Borrow fee\" value={formatAmount(fundingFee, USD_DECIMALS, 2, true)} />\r\n                      )}\r\n\r\n                      {positionFee && (\r\n                        <StatsTooltipRow label=\"Closing fee\" value={formatAmount(positionFee, USD_DECIMALS, 2, true)} />\r\n                      )}\r\n\r\n                      {swapFee && (\r\n                        <StatsTooltipRow\r\n                          label=\"Swap fee\"\r\n                          showDollar={false}\r\n                          value={`${formatAmount(swapFeeToken, collateralToken.decimals, 5)}${collateralToken.symbol}\r\n                          ($${formatAmount(swapFee, USD_DECIMALS, 2, true)})`}\r\n                        />\r\n                      )}\r\n\r\n                      <StatsTooltipRow\r\n                        label=\"Execution fee\"\r\n                        showDollar={false}\r\n                        value={`${formatAmount(executionFee, 18, 5, true)}${nativeTokenSymbol}($${formatAmount(\r\n                          executionFeeUsd,\r\n                          USD_DECIMALS,\r\n                          2\r\n                        )})`}\r\n                      />\r\n\r\n                      <br />\r\n\r\n                      <div className=\"PositionSeller-fee-item\">\r\n                        <a href=\"https://gmxio.gitbook.io/gmx/trading#fees\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          More Info\r\n                        </a>{\" \"}\r\n                        about fees.\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row PositionSeller-receive-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Receive</Trans>\r\n              </div>\r\n\r\n              {!isSwapAllowed && receiveToken && (\r\n                <div className=\"align-right PositionSelector-selected-receive-token\">\r\n                  {formatAmount(convertedReceiveAmount, receiveToken.decimals, 4, true)}&nbsp;{receiveToken.symbol} ($\r\n                  {formatAmount(receiveAmount, USD_DECIMALS, 2, true)})\r\n                </div>\r\n              )}\r\n\r\n              {isSwapAllowed && receiveToken && (\r\n                <div className=\"align-right\">\r\n                  <TokenSelector\r\n                    // Scroll lock lead to side effects\r\n                    // if it applied on modal inside another modal\r\n                    disableBodyScrollLock={true}\r\n                    className={cx(\"PositionSeller-token-selector\", {\r\n                      warning: isNotEnoughReceiveTokenLiquidity || isCollateralPoolCapacityExceeded,\r\n                    })}\r\n                    label={\"Receive\"}\r\n                    showBalances={false}\r\n                    chainId={chainId}\r\n                    tokenAddress={receiveToken.address}\r\n                    onSelectToken={(token) => {\r\n                      setSwapToToken(token);\r\n                      setSavedRecieveTokenAddress(token.address);\r\n                    }}\r\n                    tokens={toTokens}\r\n                    getTokenState={(tokenOptionInfo) => {\r\n                      if (!shouldSwap(collateralToken, tokenOptionInfo)) {\r\n                        return;\r\n                      }\r\n\r\n                      const convertedTokenAmount = getTokenAmount(\r\n                        receiveAmount,\r\n                        tokenOptionInfo.address,\r\n                        false,\r\n                        infoTokens\r\n                      );\r\n\r\n                      const isNotEnoughLiquidity =\r\n                        tokenOptionInfo.availableAmount.lt(convertedTokenAmount) ||\r\n                        tokenOptionInfo.bufferAmount.gt(tokenOptionInfo.poolAmount.sub(convertedTokenAmount));\r\n\r\n                      if (isNotEnoughLiquidity) {\r\n                        const { maxIn, maxOut, maxInUsd, maxOutUsd } = getSwapLimits(\r\n                          infoTokens,\r\n                          collateralToken.address,\r\n                          tokenOptionInfo.address\r\n                        );\r\n\r\n                        const collateralInfo = getTokenInfo(infoTokens, collateralToken.address);\r\n\r\n                        return {\r\n                          disabled: true,\r\n                          message: (\r\n                            <div>\r\n                              Insufficient Available Liquidity to swap to {tokenOptionInfo.symbol}:\r\n                              <br />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Max ${collateralInfo.symbol} in`}\r\n                                value={[\r\n                                  `${formatAmount(maxIn, collateralInfo.decimals, 0, true)} ${collateralInfo.symbol}`,\r\n                                  `($${formatAmount(maxInUsd, USD_DECIMALS, 0, true)})`,\r\n                                ]}\r\n                              />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Max ${tokenOptionInfo.symbol} out`}\r\n                                value={[\r\n                                  `${formatAmount(maxOut, tokenOptionInfo.decimals, 0, true)} ${\r\n                                    tokenOptionInfo.symbol\r\n                                  }`,\r\n                                  `($${formatAmount(maxOutUsd, USD_DECIMALS, 0, true)})`,\r\n                                ]}\r\n                              />\r\n                            </div>\r\n                          ),\r\n                        };\r\n                      }\r\n                    }}\r\n                    infoTokens={infoTokens}\r\n                    showTokenImgInDropdown={true}\r\n                    selectedTokenLabel={\r\n                      <span className=\"PositionSelector-selected-receive-token\">\r\n                        {formatAmount(convertedReceiveAmount, receiveToken.decimals, 4, true)}&nbsp;\r\n                        {receiveToken.symbol} (${formatAmount(receiveAmount, USD_DECIMALS, 2, true)})\r\n                      </span>\r\n                    }\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-button-container\">\r\n            <button className={\"App-cta Exchange-swap-button\" + (isPrimaryEnabled() ? \" hlight\" : \"\")} onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n              {getPrimaryText()}\r\n            </button>\r\n          </div>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport useSWR from \"swr\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { ethers } from \"ethers\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  BASIS_POINTS_DIVISOR,\r\n  DEPOSIT_FEE,\r\n  DUST_BNB,\r\n  helperToast,\r\n  formatAmount,\r\n  bigNumberify,\r\n  usePrevious,\r\n  formatAmountFree,\r\n  parseValue,\r\n  expandDecimals,\r\n  shouldRaiseGasError,\r\n  getTokenInfo,\r\n  getLiquidationPrice,\r\n  approveTokens,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n  MAX_ALLOWED_LEVERAGE,\r\n} from \"../../lib/legacyOptions\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport Tab from \"../Tab/TabOptions\";\r\nimport Modal from \"../Modal/Modal\";\r\n\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\n\r\nimport { getConstant } from \"../../config/chains\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nimport depositImg from '../../img/ddl/icon_dollar.svg'\r\nimport depositActiveImg from '../../img/ddl/icon_dollar_active.svg'\r\nimport withdrawImg from '../../img/ddl/icon_withdraw.svg'\r\nimport withdrawActiveImg from '../../img/ddl/icon_withdraw_active.svg'\r\n\r\nconst DEPOSIT = t`Deposit`;\r\nconst WITHDRAW = t`Withdraw`;\r\nconst EDIT_OPTIONS = [DEPOSIT, WITHDRAW];\r\nconst EDIT_ICONS = {\r\n  [DEPOSIT]: depositImg,\r\n  [WITHDRAW]: withdrawImg,\r\n  [DEPOSIT + '_active']: depositActiveImg,\r\n  [WITHDRAW + '_active']: withdrawActiveImg,\r\n\r\n}\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport default function PositionEditor(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsMap,\r\n    positionKey,\r\n    isVisible,\r\n    setIsVisible,\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    collateralTokenAddress,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    getUsd,\r\n    getLeverage,\r\n    savedIsPnlInLeverage,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    chainId,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  } = props;\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const position = positionsMap && positionKey ? positionsMap[positionKey] : undefined;\r\n  const [option, setOption] = useState(DEPOSIT);\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isSwapping, setIsSwapping] = useState(false);\r\n  const prevIsVisible = usePrevious(isVisible);\r\n\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n\r\n  const { data: tokenAllowance } = useSWR(\r\n    [active, chainId, collateralTokenAddress, \"allowance\", account, routerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  // const { data: minExecutionFee } = useSWR([active, chainId, positionRouterAddress, \"minExecutionFee\"], {\r\n  //   fetcher: fetcher(library, PositionRouter),\r\n  // });\r\n\r\n  const isDeposit = option === DEPOSIT;\r\n  const isWithdrawal = option === WITHDRAW;\r\n\r\n  const needPositionRouterApproval = !positionRouterApproved;\r\n\r\n  let collateralToken;\r\n  let maxAmount;\r\n  let maxAmountFormatted;\r\n  let maxAmountFormattedFree;\r\n  let fromAmount;\r\n  let needApproval;\r\n\r\n  let convertedAmount;\r\n  let convertedAmountFormatted;\r\n\r\n  let nextLeverage;\r\n  let nextLeverageExcludingPnl;\r\n  let liquidationPrice;\r\n  let nextLiquidationPrice;\r\n  let nextCollateral;\r\n\r\n  let title;\r\n  let collateralDelta;\r\n  if (position) {\r\n    title = `Edit ${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol}`;\r\n    collateralToken = position.collateralToken;\r\n    liquidationPrice = getLiquidationPrice(position);\r\n\r\n    if (isDeposit) {\r\n      fromAmount = parseValue(fromValue, collateralToken.decimals);\r\n      maxAmount = collateralToken ? collateralToken.balance : bigNumberify(0);\r\n      maxAmountFormatted = formatAmount(maxAmount, collateralToken.decimals, 4, true);\r\n      maxAmountFormattedFree = formatAmountFree(maxAmount, collateralToken.decimals, 8);\r\n      if (fromAmount) {\r\n        convertedAmount = getUsd(fromAmount, position.collateralToken.address, false, infoTokens);\r\n        convertedAmountFormatted = formatAmount(convertedAmount, USD_DECIMALS, 2);\r\n      }\r\n    } else {\r\n      fromAmount = parseValue(fromValue, USD_DECIMALS);\r\n      maxAmount = position.collateral;\r\n      maxAmountFormatted = formatAmount(maxAmount, USD_DECIMALS, 2, true);\r\n      maxAmountFormattedFree = formatAmountFree(maxAmount, USD_DECIMALS, 2);\r\n      if (fromAmount) {\r\n        convertedAmount = fromAmount.mul(expandDecimals(1, collateralToken.decimals)).div(collateralToken.maxPrice);\r\n        convertedAmountFormatted = formatAmount(convertedAmount, collateralToken.decimals, 4, true);\r\n      }\r\n    }\r\n    needApproval = isDeposit && tokenAllowance && fromAmount && fromAmount.gt(tokenAllowance);\r\n\r\n    if (fromAmount) {\r\n      collateralDelta = isDeposit ? convertedAmount : fromAmount;\r\n      if (position.isLong) {\r\n        collateralDelta = collateralDelta.mul(BASIS_POINTS_DIVISOR - DEPOSIT_FEE).div(BASIS_POINTS_DIVISOR);\r\n      }\r\n      nextLeverage = getLeverage({\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        hasProfit: position.hasProfit,\r\n        delta: position.delta,\r\n        includeDelta: savedIsPnlInLeverage,\r\n      });\r\n      nextLeverageExcludingPnl = getLeverage({\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        hasProfit: position.hasProfit,\r\n        delta: position.delta,\r\n        includeDelta: false,\r\n      });\r\n\r\n      nextLiquidationPrice = getLiquidationPrice({\r\n        isLong: position.isLong,\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        averagePrice: position.averagePrice,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n      });\r\n\r\n      nextCollateral = isDeposit ? position.collateral.add(collateralDelta) : position.collateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (isDeposit) return [t`Deposit disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`Withdraw disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (!fromAmount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (nextLeverage && nextLeverage.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n\r\n    if (!isDeposit && fromAmount) {\r\n      if (fromAmount.gte(position.collateral)) {\r\n        return t`Min order: 10 USD`;\r\n      }\r\n      if (position.collateral.sub(fromAmount).lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return t`Min order: 10 USD`;\r\n      }\r\n    }\r\n\r\n    if (!isDeposit && fromAmount && nextLiquidationPrice) {\r\n      if (position.isLong && position.markPrice.lt(nextLiquidationPrice)) {\r\n        return t`Invalid liq. price`;\r\n      }\r\n      if (!position.isLong && position.markPrice.gt(nextLiquidationPrice)) {\r\n        return t`Invalid liq. price`;\r\n      }\r\n    }\r\n\r\n    if (nextLeverageExcludingPnl && nextLeverageExcludingPnl.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Min leverage: 1.1x`;\r\n    }\r\n\r\n    if (nextLeverageExcludingPnl && nextLeverageExcludingPnl.gt(MAX_ALLOWED_LEVERAGE)) {\r\n      return t`Max leverage: ${(MAX_ALLOWED_LEVERAGE / BASIS_POINTS_DIVISOR).toFixed(1)}x`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isSwapping) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isSwapping) {\r\n      if (isDeposit) {\r\n        return t`Depositing...`;\r\n      }\r\n      return t`Withdrawing...`;\r\n    }\r\n\r\n    if (isApproving) {\r\n      return t`Approving ${position.collateralToken.symbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve ${position.collateralToken.symbol}`;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage`;\r\n    }\r\n\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (isDeposit) {\r\n      return t`Deposit`;\r\n    }\r\n\r\n    return t`Withdraw`;\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFromValue(\"\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevIsVisible !== isVisible) {\r\n      resetForm();\r\n    }\r\n  }, [prevIsVisible, isVisible]);\r\n\r\n  const depositCollateral = async () => {\r\n    setIsSwapping(true);\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n    const path = [tokenAddress0];\r\n    const indexTokenAddress =\r\n      position.indexToken.address === AddressZero ? nativeTokenAddress : position.indexToken.address;\r\n\r\n    const priceBasisPoints = position.isLong ? 11000 : 9000;\r\n    const priceLimit = position.indexToken.maxPrice.mul(priceBasisPoints).div(10000);\r\n\r\n    const referralCode = ethers.constants.HashZero;\r\n    let params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      fromAmount, // _amountIn\r\n      0, // _minOut\r\n      0, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      priceLimit, // _acceptablePrice\r\n      minExecutionFee, // _executionFee\r\n      referralCode, // _referralCode\r\n      AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    let method = \"createIncreasePosition\";\r\n    let value = minExecutionFee;\r\n    if (collateralTokenAddress === AddressZero) {\r\n      method = \"createIncreasePositionETH\";\r\n      value = fromAmount.add(minExecutionFee);\r\n      params = [\r\n        path, // _path\r\n        indexTokenAddress, // _indexToken\r\n        0, // _minOut\r\n        0, // _sizeDelta\r\n        position.isLong, // _isLong\r\n        priceLimit, // _acceptablePrice\r\n        minExecutionFee, // _executionFee\r\n        referralCode, // _referralCode\r\n        AddressZero, // _callbackTarget\r\n      ];\r\n    }\r\n\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, collateralTokenAddress), fromAmount)) {\r\n      setIsSwapping(false);\r\n      helperToast.error(`Leave at least ${formatAmount(DUST_BNB, 18, 3)} ETH for gas`);\r\n      return;\r\n    }\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      sentMsg: t`Deposit submitted.`,\r\n      successMsg: t`Requested deposit of ${formatAmount(fromAmount, position.collateralToken.decimals, 4)} ${\r\n        position.collateralToken.symbol\r\n      } into ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}.`,\r\n      failMsg: t`Deposit failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            collateralSnapshot: position.collateral,\r\n            expectingCollateralChange: true,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSwapping(false);\r\n      });\r\n  };\r\n\r\n  const withdrawCollateral = async () => {\r\n    setIsSwapping(true);\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n    const indexTokenAddress =\r\n      position.indexToken.address === AddressZero ? nativeTokenAddress : position.indexToken.address;\r\n    const priceBasisPoints = position.isLong ? 9000 : 11000;\r\n    const priceLimit = position.indexToken.maxPrice.mul(priceBasisPoints).div(10000);\r\n\r\n    const withdrawETH = collateralTokenAddress === AddressZero || collateralTokenAddress === nativeTokenAddress;\r\n    const params = [\r\n      [tokenAddress0], // _path\r\n      indexTokenAddress, // _indexToken\r\n      fromAmount, // _collateralDelta\r\n      0, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      account, // _receiver\r\n      priceLimit, // _acceptablePrice\r\n      0, // _minOut\r\n      minExecutionFee, // _executionFee\r\n      withdrawETH, // _withdrawETH\r\n      AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    const method = \"createDecreasePosition\";\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    callContract(chainId, contract, method, params, {\r\n      value: minExecutionFee,\r\n      sentMsg: t`Withdrawal submitted.`,\r\n      successMsg: t`Requested withdrawal of ${formatAmount(fromAmount, USD_DECIMALS, 2)} USD from ${\r\n        position.indexToken.symbol\r\n      } ${position.isLong ? \"Long\" : \"Short\"}.`,\r\n      failMsg: t`Withdrawal failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            collateralSnapshot: position.collateral,\r\n            expectingCollateralChange: true,\r\n          },\r\n        };\r\n      })\r\n      .finally(() => {\r\n        setIsSwapping(false);\r\n      });\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    if (needApproval) {\r\n      approveTokens({\r\n        setIsApproving,\r\n        library,\r\n        tokenAddress: collateralTokenAddress,\r\n        spender: routerAddress,\r\n        chainId: chainId,\r\n        infoTokens,\r\n        getTokenInfo,\r\n        pendingTxns,\r\n        setPendingTxns,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: isDeposit ? t`Enable deposit sent.` : t`Enable withdraw sent.`,\r\n        failMsg: isDeposit ? t`Enable deposit failed.` : t`Enable withdraw failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (isDeposit) {\r\n      depositCollateral();\r\n      return;\r\n    }\r\n\r\n    withdrawCollateral();\r\n  };\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n\r\n\r\n  const [hasInputFocus, setHasInputFocus] = useState(false);\r\n  const [hasInputError, setHasInputError] = useState(false);\r\n  const checkInputError = (inputVal) => {\r\n    if (!isPrimaryEnabled() && inputVal !== '') {\r\n      setHasInputError(true);\r\n    } else {\r\n      setHasInputError(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkInputError(fromValue);\r\n  }, [fromValue])\r\n\r\n  return (\r\n    <div className=\"PositionEditor\">\r\n      {position && (\r\n        <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title} isNifty={true}>\r\n          <div>\r\n            <Tab options={EDIT_OPTIONS} option={option} setOption={setOption} onChange={resetForm}\r\n              icons={EDIT_ICONS} />\r\n            {(isDeposit || isWithdrawal) && (\r\n              <div>\r\n                <div className={\"Exchange-swap-section\"\r\n                  + (hasInputError ? \" error\" : \"\") + (hasInputFocus ? \" hlight\" : \"\")}>\r\n                  <div className=\"Exchange-swap-section-top\">\r\n                    <div className=\"muted\">\r\n                      {convertedAmountFormatted && (\r\n                        <div className=\"Exchange-swap-usd\">\r\n                          {isDeposit ? t`Deposit` : t`Withdraw`}: {convertedAmountFormatted}{\" \"}\r\n                          {isDeposit ? \"USD\" : position.collateralToken.symbol}\r\n                        </div>\r\n                      )}\r\n                      {!convertedAmountFormatted && `${isDeposit ? t`Deposit` : t`Withdraw`}`}\r\n                    </div>\r\n                    {maxAmount && (\r\n                      <div className=\"muted align-right clickable\" onClick={() => setFromValue(maxAmountFormattedFree)}>\r\n                        Max: {maxAmountFormatted}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"Exchange-swap-section-bottom\">\r\n                    <div className=\"Exchange-swap-input-container\">\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"0\"\r\n                        placeholder=\"0.0\"\r\n                        className=\"Exchange-swap-input\"\r\n                        value={fromValue}\r\n                        onChange={(e) => setFromValue(e.target.value)}\r\n                        onFocus={(e) => {\r\n                          setHasInputFocus(true);\r\n                        }}\r\n                        onBlur={(e) => {\r\n                          setHasInputFocus(false);\r\n                        }}\r\n                      />\r\n                      {fromValue !== maxAmountFormattedFree && (\r\n                        <div\r\n                          className=\"Exchange-swap-max\"\r\n                          onClick={() => {\r\n                            setFromValue(maxAmountFormattedFree);\r\n                          }}\r\n                        >\r\n                          MAX\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"PositionEditor-token-symbol\">\r\n                      {isDeposit ? position.collateralToken.symbol : \"USD\"}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"PositionEditor-info-box\">\r\n                  {minExecutionFeeErrorMessage && (\r\n                    <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>\r\n                  )}\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Size</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">{formatAmount(position.size, USD_DECIMALS, 2, true)} USD</div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Collateral</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextCollateral && <div>${formatAmount(position.collateral, USD_DECIMALS, 2, true)}</div>}\r\n                      {nextCollateral && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            ${formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          ${formatAmount(nextCollateral, USD_DECIMALS, 2, true)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Leverage</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextLeverage && <div>{formatAmount(position.leverage, 4, 2, true)}x</div>}\r\n                      {nextLeverage && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            {formatAmount(position.leverage, 4, 2, true)}x\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          {formatAmount(nextLeverage, 4, 2, true)}x\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Mark Price</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Liq. Price</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextLiquidationPrice && (\r\n                        <div>\r\n                          {!fromAmount && `$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}\r\n                          {fromAmount && \"-\"}\r\n                        </div>\r\n                      )}\r\n                      {nextLiquidationPrice && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          ${formatAmount(nextLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Execution Fee</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      <Tooltip\r\n                        handle={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol}`}\r\n                        position=\"right-top\"\r\n                        renderContent={() => {\r\n                          return (\r\n                            <>\r\n                              <StatsTooltipRow\r\n                                label=\"Network fee\"\r\n                                showDollar={false}\r\n                                value={`${formatAmountFree(\r\n                                  minExecutionFee,\r\n                                  18,\r\n                                  5\r\n                                )} ${nativeTokenSymbol} ($${formatAmount(minExecutionFeeUSD, USD_DECIMALS, 2)})`}\r\n                              />\r\n                              <br />\r\n                              This is the network cost required to execute the {isDeposit\r\n                                ? \"deposit\"\r\n                                : \"withdrawal\"}.{\" \"}\r\n                              <a\r\n                                href=\"https://gmxio.gitbook.io/gmx/trading#execution-fee\"\r\n                                target=\"_blank\"\r\n                                rel=\"noopener noreferrer\"\r\n                              >\r\n                                More Info\r\n                              </a>\r\n                            </>\r\n                          );\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"Exchange-swap-button-container\">\r\n                  <button\r\n                    className={\"App-cta Exchange-swap-button\" + (isPrimaryEnabled() ? \" hlight\" : \"\")}\r\n                    onClick={onClickPrimary}\r\n                    disabled={!isPrimaryEnabled()}\r\n                  >\r\n                    {getPrimaryText()}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import { ethers } from \"ethers\";\r\nimport { gql } from \"@apollo/client\";\r\nimport { useState, useEffect, useMemo } from \"react\";\r\nimport useSWR from \"swr\";\r\n\r\nimport ReferralStorage from \"../abis/ReferralStorage.json\";\r\nimport {\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  MAX_REFERRAL_CODE_LENGTH,\r\n  bigNumberify,\r\n  isAddressZero,\r\n  helperToast,\r\n  getProvider,\r\n  isHashZero,\r\n  REFERRAL_CODE_KEY,\r\n} from \"../lib/legacyOptions\";\r\nimport { arbitrumReferralsGraphClient, avalancheReferralsGraphClient } from \"./common\";\r\nimport { getContract } from \"../config/Addresses\";\r\nimport { REGEX_VERIFY_BYTES32 } from \"../components/Referrals/referralsHelper\";\r\nimport { fetcher } from \"../lib/contracts/fetcher\";\r\nimport { callContract } from \"../lib/contracts/callContract\";\r\n\r\nconst ACTIVE_CHAINS = [ARBITRUM, AVALANCHE];\r\nconst DISTRIBUTION_TYPE_REBATES = \"1\";\r\nconst DISTRIBUTION_TYPE_DISCOUNT = \"2\";\r\n\r\nfunction getGraphClient(chainId) {\r\n  if (chainId === ARBITRUM) {\r\n    return arbitrumReferralsGraphClient;\r\n  } else if (chainId === AVALANCHE) {\r\n    return avalancheReferralsGraphClient;\r\n  }\r\n  throw new Error(`Unsupported chain ${chainId}`);\r\n}\r\n\r\nexport function decodeReferralCode(hexCode) {\r\n  try {\r\n    return ethers.utils.parseBytes32String(hexCode);\r\n  } catch (ex) {\r\n    let code = \"\";\r\n    hexCode = hexCode.substring(2);\r\n    for (let i = 0; i < 32; i++) {\r\n      code += String.fromCharCode(parseInt(hexCode.substring(i * 2, i * 2 + 2), 16));\r\n    }\r\n    return code.trim();\r\n  }\r\n}\r\n\r\nexport function encodeReferralCode(code) {\r\n  let final = code.replace(/[^\\w_]/g, \"\"); // replace everything other than numbers, string  and underscor to ''\r\n  if (final.length > MAX_REFERRAL_CODE_LENGTH) {\r\n    return ethers.constants.HashZero;\r\n  }\r\n  return ethers.utils.formatBytes32String(final);\r\n}\r\n\r\nasync function getCodeOwnersData(network, account, codes = []) {\r\n  if (codes.length === 0 || !account || !network) {\r\n    return undefined;\r\n  }\r\n  const query = gql`\r\n    query allCodes($codes: [String!]!) {\r\n      referralCodes(where: { code_in: $codes }) {\r\n        owner\r\n        id\r\n      }\r\n    }\r\n  `;\r\n  return getGraphClient(network)\r\n    .query({ query, variables: { codes } })\r\n    .then(({ data }) => {\r\n      const { referralCodes } = data;\r\n      const codeOwners = referralCodes.reduce((acc, cv) => {\r\n        acc[cv.id] = cv.owner;\r\n        return acc;\r\n      }, {});\r\n      return codes.map((code) => {\r\n        const owner = codeOwners[code];\r\n        return {\r\n          code,\r\n          codeString: decodeReferralCode(code),\r\n          owner,\r\n          isTaken: Boolean(owner),\r\n          isTakenByCurrentUser: owner && owner.toLowerCase() === account.toLowerCase(),\r\n        };\r\n      });\r\n    });\r\n}\r\n\r\nexport function useUserCodesOnAllChain(account) {\r\n  const [data, setData] = useState(null);\r\n  const query = gql`\r\n    query referralCodesOnAllChain($account: String!) {\r\n      referralCodes(first: 1000, where: { owner: $account }) {\r\n        code\r\n      }\r\n    }\r\n  `;\r\n  useEffect(() => {\r\n    async function main() {\r\n      const [arbitrumCodes, avalancheCodes] = await Promise.all(\r\n        ACTIVE_CHAINS.map((chainId) => {\r\n          return getGraphClient(chainId)\r\n            .query({ query, variables: { account: (account || \"\").toLowerCase() } })\r\n            .then(({ data }) => {\r\n              return data.referralCodes.map((c) => c.code);\r\n            });\r\n        })\r\n      );\r\n      const [codeOwnersOnAvax = [], codeOwnersOnArbitrum = []] = await Promise.all([\r\n        getCodeOwnersData(AVALANCHE, account, arbitrumCodes),\r\n        getCodeOwnersData(ARBITRUM, account, avalancheCodes),\r\n      ]);\r\n\r\n      setData({\r\n        [ARBITRUM]: codeOwnersOnAvax.reduce((acc, cv) => {\r\n          acc[cv.code] = cv;\r\n          return acc;\r\n        }, {}),\r\n        [AVALANCHE]: codeOwnersOnArbitrum.reduce((acc, cv) => {\r\n          acc[cv.code] = cv;\r\n          return acc;\r\n        }, {}),\r\n      });\r\n    }\r\n\r\n    main();\r\n  }, [account, query]);\r\n  return data;\r\n}\r\n\r\nexport function useReferralsData(chainId, account) {\r\n  const [data, setData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const ownerOnOtherChain = useUserCodesOnAllChain(account);\r\n  useEffect(() => {\r\n    if (!chainId || !account) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    const startOfDayTimestamp = Math.floor(parseInt(Date.now() / 1000) / 86400) * 86400;\r\n    const query = gql`\r\n      query referralData($typeIds: [String!]!, $account: String!, $timestamp: Int!, $referralTotalStatsId: String!) {\r\n        distributions(\r\n          first: 1000\r\n          orderBy: timestamp\r\n          orderDirection: desc\r\n          where: { receiver: $account, typeId_in: $typeIds }\r\n        ) {\r\n          receiver\r\n          amount\r\n          typeId\r\n          token\r\n          transactionHash\r\n          timestamp\r\n        }\r\n        referrerTotalStats: referrerStats(\r\n          first: 1000\r\n          orderBy: volume\r\n          orderDirection: desc\r\n          where: { period: total, referrer: $account }\r\n        ) {\r\n          referralCode\r\n          volume\r\n          trades\r\n          tradedReferralsCount\r\n          registeredReferralsCount\r\n          totalRebateUsd\r\n          discountUsd\r\n        }\r\n        referrerLastDayStats: referrerStats(\r\n          first: 1000\r\n          where: { period: daily, referrer: $account, timestamp: $timestamp }\r\n        ) {\r\n          referralCode\r\n          volume\r\n          trades\r\n          tradedReferralsCount\r\n          registeredReferralsCount\r\n          totalRebateUsd\r\n          discountUsd\r\n        }\r\n        referralCodes(first: 1000, where: { owner: $account }) {\r\n          code\r\n        }\r\n        referralTotalStats: referralStat(id: $referralTotalStatsId) {\r\n          volume\r\n          discountUsd\r\n        }\r\n        referrerTierInfo: referrer(id: $account) {\r\n          tierId\r\n          id\r\n          discountShare\r\n        }\r\n      }\r\n    `;\r\n    setLoading(true);\r\n\r\n    getGraphClient(chainId)\r\n      .query({\r\n        query,\r\n        variables: {\r\n          typeIds: [DISTRIBUTION_TYPE_REBATES, DISTRIBUTION_TYPE_DISCOUNT],\r\n          account: (account || \"\").toLowerCase(),\r\n          timestamp: startOfDayTimestamp,\r\n          referralTotalStatsId: account && `total:0:${account.toLowerCase()}`,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        const rebateDistributions = [];\r\n        const discountDistributions = [];\r\n        res.data.distributions.forEach((d) => {\r\n          const item = {\r\n            timestamp: parseInt(d.timestamp),\r\n            transactionHash: d.transactionHash,\r\n            receiver: ethers.utils.getAddress(d.receiver),\r\n            amount: bigNumberify(d.amount),\r\n            typeId: d.typeId,\r\n            token: ethers.utils.getAddress(d.token),\r\n          };\r\n          if (d.typeId === DISTRIBUTION_TYPE_REBATES) {\r\n            rebateDistributions.push(item);\r\n          } else {\r\n            discountDistributions.push(item);\r\n          }\r\n        });\r\n\r\n        function prepareStatsItem(e) {\r\n          return {\r\n            volume: bigNumberify(e.volume),\r\n            trades: parseInt(e.trades),\r\n            tradedReferralsCount: parseInt(e.tradedReferralsCount),\r\n            registeredReferralsCount: parseInt(e.registeredReferralsCount),\r\n            totalRebateUsd: bigNumberify(e.totalRebateUsd),\r\n            discountUsd: bigNumberify(e.discountUsd),\r\n            referralCode: decodeReferralCode(e.referralCode),\r\n            ownerOnOtherChain: ownerOnOtherChain?.[chainId][e.referralCode],\r\n          };\r\n        }\r\n\r\n        function getCumulativeStats(data = []) {\r\n          return data.reduce(\r\n            (acc, cv) => {\r\n              acc.totalRebateUsd = acc.totalRebateUsd.add(cv.totalRebateUsd);\r\n              acc.volume = acc.volume.add(cv.volume);\r\n              acc.discountUsd = acc.discountUsd.add(cv.discountUsd);\r\n              acc.trades = acc.trades + cv.trades;\r\n              acc.tradedReferralsCount = acc.tradedReferralsCount + cv.tradedReferralsCount;\r\n              acc.registeredReferralsCount = acc.registeredReferralsCount + cv.registeredReferralsCount;\r\n              return acc;\r\n            },\r\n            {\r\n              totalRebateUsd: bigNumberify(0),\r\n              volume: bigNumberify(0),\r\n              discountUsd: bigNumberify(0),\r\n              trades: 0,\r\n              tradedReferralsCount: 0,\r\n              registeredReferralsCount: 0,\r\n            }\r\n          );\r\n        }\r\n\r\n        let referrerTotalStats = res.data.referrerTotalStats.map(prepareStatsItem);\r\n        setData({\r\n          rebateDistributions,\r\n          discountDistributions,\r\n          referrerTotalStats,\r\n          referrerTierInfo: res.data.referrerTierInfo,\r\n          referrerLastDayStats: res.data.referrerLastDayStats.map(prepareStatsItem),\r\n          cumulativeStats: getCumulativeStats(referrerTotalStats),\r\n          codes: res.data.referralCodes.map((e) => decodeReferralCode(e.code)),\r\n          referralTotalStats: res.data.referralTotalStats\r\n            ? {\r\n                volume: bigNumberify(res.data.referralTotalStats.volume),\r\n                discountUsd: bigNumberify(res.data.referralTotalStats.discountUsd),\r\n              }\r\n            : {\r\n                volume: bigNumberify(0),\r\n                discountUsd: bigNumberify(0),\r\n              },\r\n        });\r\n      })\r\n      .catch(console.warn)\r\n      .finally(() => {\r\n        setLoading(false);\r\n      });\r\n  }, [setData, chainId, account, ownerOnOtherChain]);\r\n\r\n  return {\r\n    data: data || null,\r\n    loading,\r\n  };\r\n}\r\n\r\nexport async function registerReferralCode(chainId, referralCode, library, opts) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const referralCodeHex = encodeReferralCode(referralCode);\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, library.getSigner());\r\n  return callContract(chainId, contract, \"registerCode\", [referralCodeHex], opts);\r\n}\r\n\r\nexport async function setTraderReferralCodeByUser(chainId, referralCode, library, opts) {\r\n  const referralCodeHex = encodeReferralCode(referralCode);\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, library.getSigner());\r\n  const codeOwner = await contract.codeOwners(referralCodeHex);\r\n  if (isAddressZero(codeOwner)) {\r\n    const errorMsg = \"Referral code does not exist\";\r\n    helperToast.error(errorMsg);\r\n    return Promise.reject(errorMsg);\r\n  }\r\n  return callContract(chainId, contract, \"setTraderReferralCodeByUser\", [referralCodeHex], opts);\r\n}\r\n\r\nexport async function getReferralCodeOwner(chainId, referralCode) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const provider = getProvider(null, chainId);\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, provider);\r\n  const codeOwner = await contract.codeOwners(referralCode);\r\n  return codeOwner;\r\n}\r\n\r\nexport function useUserReferralCode(library, chainId, account) {\r\n  const localStorageCode = window.localStorage.getItem(REFERRAL_CODE_KEY);\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: onChainCode } = useSWR(\r\n    account && [\"ReferralStorage\", chainId, referralStorageAddress, \"traderReferralCodes\", account],\r\n    { fetcher: fetcher(library, ReferralStorage) }\r\n  );\r\n  const { data: localStorageCodeOwner } = useSWR(\r\n    localStorageCode &&\r\n      REGEX_VERIFY_BYTES32.test(localStorageCode) && [\r\n        \"ReferralStorage\",\r\n        chainId,\r\n        referralStorageAddress,\r\n        \"codeOwners\",\r\n        localStorageCode,\r\n      ],\r\n    { fetcher: fetcher(library, ReferralStorage) }\r\n  );\r\n  const [attachedOnChain, userReferralCode, userReferralCodeString] = useMemo(() => {\r\n    if (onChainCode && !isHashZero(onChainCode)) {\r\n      return [true, onChainCode, decodeReferralCode(onChainCode)];\r\n    } else if (localStorageCodeOwner && !isAddressZero(localStorageCodeOwner)) {\r\n      return [false, localStorageCode, decodeReferralCode(localStorageCode)];\r\n    }\r\n    return [false];\r\n  }, [localStorageCode, localStorageCodeOwner, onChainCode]);\r\n\r\n  return {\r\n    userReferralCode,\r\n    userReferralCodeString,\r\n    attachedOnChain,\r\n  };\r\n}\r\n\r\nexport function useReferrerTier(library, chainId, account) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: referrerTier, mutate: mutateReferrerTier } = useSWR(\r\n    account && [`ReferralStorage:referrerTiers`, chainId, referralStorageAddress, \"referrerTiers\", account],\r\n    {\r\n      fetcher: fetcher(library, ReferralStorage),\r\n    }\r\n  );\r\n  return {\r\n    referrerTier,\r\n    mutateReferrerTier,\r\n  };\r\n}\r\n\r\nexport function useCodeOwner(library, chainId, account, code) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: codeOwner, mutate: mutateCodeOwner } = useSWR(\r\n    account && code && [`ReferralStorage:codeOwners`, chainId, referralStorageAddress, \"codeOwners\", code],\r\n    {\r\n      fetcher: fetcher(library, ReferralStorage),\r\n    }\r\n  );\r\n  return {\r\n    codeOwner,\r\n    mutateCodeOwner,\r\n  };\r\n}\r\n\r\nexport async function validateReferralCodeExists(referralCode, chainId) {\r\n  const referralCodeBytes32 = encodeReferralCode(referralCode);\r\n  const referralCodeOwner = await getReferralCodeOwner(chainId, referralCodeBytes32);\r\n  return !isAddressZero(referralCodeOwner);\r\n}\r\n\r\nexport function useAffiliateCodes(chainId, account) {\r\n  const [affiliateCodes, setAffiliateCodes] = useState({ code: null, success: false });\r\n  const query = gql`\r\n    query userReferralCodes($account: String!) {\r\n      referrerTotalStats: referrerStats(\r\n        first: 1000\r\n        orderBy: volume\r\n        orderDirection: desc\r\n        where: { period: total, referrer: $account }\r\n      ) {\r\n        referralCode\r\n      }\r\n    }\r\n  `;\r\n  useEffect(() => {\r\n    if (!chainId) return;\r\n    getGraphClient(chainId)\r\n      .query({ query, variables: { account: account?.toLowerCase() } })\r\n      .then((res) => {\r\n        const parsedAffiliateCodes = res?.data?.referrerTotalStats.map((c) => decodeReferralCode(c?.referralCode));\r\n        setAffiliateCodes({ code: parsedAffiliateCodes[0], success: true });\r\n      });\r\n    return () => {\r\n      setAffiliateCodes({ code: null, success: false });\r\n    };\r\n  }, [chainId, query, account]);\r\n  return affiliateCodes;\r\n}\r\n","import React, { useState } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport PositionSeller from \"./PositionSeller\";\r\nimport PositionEditor from \"./PositionEditor\";\r\nimport OrdersToa from \"./OrdersToa\";\r\n\r\nimport { ImSpinner2 } from \"react-icons/im\";\r\n\r\nimport {\r\n  helperToast,\r\n  bigNumberify,\r\n  getLiquidationPrice,\r\n  getUsd,\r\n  getLeverage,\r\n  formatAmount,\r\n  getOrderError,\r\n  USD_DECIMALS,\r\n  FUNDING_RATE_PRECISION,\r\n  SWAP,\r\n  LONG,\r\n  SHORT,\r\n  INCREASE,\r\n  DECREASE,\r\n  BASIS_POINTS_DIVISOR,\r\n  getDeltaStr,\r\n} from \"../../lib/legacyOptions\";\r\nimport PositionShare from \"./PositionShare\";\r\nimport PositionsItem from './PositionsItem';\r\nimport { ADDRESS_ZERO } from '@uniswap/v3-sdk';\r\nimport { GNS_PAIRS } from '../../lib/GNS_legacy';\r\nimport GNS_Trading from '../../abis/GNS/GNS_Trading.json';\r\nimport { errAlert, notifySuccess } from '../../../../components/utils/notifications';\r\nimport { ethers } from 'ethers';\r\nimport { BigNumber } from 'ethers';\r\nimport { getTokenBySymbol } from \"../../config/Tokens\";\r\nimport { expandDecimals, MARKET } from '../../lib/legacyOptions';\r\nimport { GNS_FEES_MULTIPLIER } from '../../../../components/utils/constants';\r\nimport SLTPModal from '../../../../components/UI/modal/SLTPModal';\r\nimport { formatForContract } from \"../../../../components/utils/math\";\r\n\r\nconst getOrdersForPosition = (account, position, orders, nativeTokenAddress) => {\r\n  if (!orders || orders.length === 0) {\r\n    return [];\r\n  }\r\n  /* eslint-disable array-callback-return */\r\n  return orders\r\n    .filter((order) => {\r\n      if (order.type === SWAP) {\r\n        return false;\r\n      }\r\n      const hasMatchingIndexToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      const hasMatchingCollateralToken =\r\n        order.collateralToken === nativeTokenAddress\r\n          ? position.collateralToken.isNative\r\n          : order.collateralToken === position.collateralToken.address;\r\n      if (order.isLong === position.isLong && hasMatchingIndexToken && hasMatchingCollateralToken) {\r\n        return true;\r\n      }\r\n    })\r\n    .map((order) => {\r\n      order.error = getOrderError(account, order, undefined, position);\r\n      if (order.type === DECREASE && order.sizeDelta.gt(position.size)) {\r\n        order.error = \"Order size is bigger than position, will only be executable if position increases\";\r\n      }\r\n      return order;\r\n    });\r\n};\r\n\r\nexport default function PositionsList(props) {\r\n  const {\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    setMarket,\r\n    positionsLoading,\r\n  } = props;\r\n\r\n  const hasPositions = false;\r\n\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  \r\n  const onPositionClick = (position) => {\r\n    helperToast.success(`${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol} market selected`);\r\n    setMarket(position.isLong ? LONG : SHORT, position.indexToken.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"PositionsList\">\r\n      <div className=\"Exchange-list small\">\r\n        <div>\r\n          {!hasPositions && positionsLoading && (\r\n            <div className=\"Exchange-empty-positions-list-note App-card\">\r\n              <Trans>Loading...</Trans>\r\n            </div>\r\n          )}\r\n          {!hasPositions && !positionsLoading && (\r\n            <div className=\"Exchange-empty-positions-list-note App-card Exchange-list-empty-note\">\r\n              <Trans>Will be available soon</Trans>\r\n            </div>\r\n          )}\r\n          {/* {positions.map((position) => {\r\n            return (\r\n              <PositionsItem\r\n                openSLTPModal={openSLTPModal}\r\n                key={position.key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={positionDelta}\r\n                liquidationPrice={liquidationPrice}\r\n                cx={cx}\r\n                borrowFeeUSD={borrowFeeUSD}\r\n                editPosition={editPosition}\r\n                sellPosition={sellPosition}\r\n                setSLTP={setSLTP}\r\n                isLarge={false}\r\n              />\r\n            );\r\n          })} */}\r\n        </div>\r\n      </div>\r\n      <table className=\"Exchange-list large App-box\">\r\n        <tbody>\r\n          {hasPositions && (\r\n            <tr className=\"Exchange-list-header\">\r\n              <th>\r\n                <Trans>Position</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Size</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Collateral</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Mark Price</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Entry Price</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Liq. Price</Trans>\r\n              </th>\r\n              <th>\r\n                PNL (ROE %)\r\n              </th>\r\n              <th>\r\n                Stop Loss\r\n              </th>\r\n              <th>\r\n                Take Profit\r\n              </th>\r\n              <th></th>\r\n            </tr>\r\n          )}\r\n          {!hasPositions && positionsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\">\r\n                <div className=\"Exchange-empty-positions-list-note\">Loading...</div>\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {!hasPositions && !positionsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\" className=\"Exchange-list-empty-note\">\r\n                Will be available soon\r\n              </td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nconst Loader = () => {\r\n\treturn (\r\n\t\t<div className='loader-container'>\r\n\t\t\t<svg viewBox=\"0 0 100 100\">\r\n\t\t\t\t<defs>\r\n\t\t\t\t</defs>\r\n\t\t\t\t<circle className=\"loader\" style={{fill:'transparent',stroke:'#fff',strokeWidth: '7px',strokeLinecap: 'round'}} cx=\"50\" cy=\"50\" r=\"45\"/>\r\n\t\t\t</svg>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Loader;","import React, { useRef } from 'react';\r\nimport { formatAmount, getTokenInfo, expandDecimals } from './../../../gmx-test/lib/legacy';\r\nimport { separateThousands } from './../../../../components/utils/sepThousands';\r\nimport { format } from 'date-fns';\r\nimport { msToTimeLeft } from './../../../../components/utils/utils';\r\nimport { USD_DECIMALS, formatAmountFree } from './../../lib/legacyOptions';\r\nimport { OPTIONS_DECIMALS } from '../../../../components/utils/constants';\r\nimport cx from 'classnames';\r\nimport Tooltip from './../Tooltip/Tooltip';\r\n\r\nconst OptionsItem = (props) => {\r\n\tconst {\r\n\t\toption,\r\n\t\tmarkPrice,\r\n\t} = props;\r\n\t\r\n\tconst curPrice = useRef(expandDecimals(markPrice, 10)).current;\r\n\r\n\tif (!option) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t\r\n\tconst expirationDate = Date.now() + option.period;\r\n\tconst logo = require(`../../../../img/icon-${option.market}.svg`).default;\r\n\tconst isITM = option.isCall\r\n\t\t? curPrice.gte(option.strike)\r\n\t\t: curPrice.lte(option.strike);\r\n\r\n\tconst cls = cx(isITM && 'hlight');\r\n\tconst isBtnDisabled = !option.liq || option.liq?.eq(0);\r\n\tif (isBtnDisabled) {\r\n\t\treturn null;\r\n\t}\r\n\tconst btnText = `Buy ${option.isCall ? 'Call' : 'Put'}`;\r\n\r\n\tconst disabledTooltip = \r\n\t\t<Tooltip\r\n\t\t\tclassName=\"Tooltip_disabled nowrap\"\r\n\t\t\thandle={btnText}\r\n\t\t\tposition=\"left-bottom\"\r\n\t\t\tenabled={true}\r\n\t\t\trenderContent={() => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"Tooltip__text\">\r\n\t\t\t\t\t\tThere isnt sufficient <br />liquidity. Please reduce <br />the option size\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t}}\r\n\t\t/>\r\n\r\n\treturn (\r\n\t\t<tr className={cls}>\r\n\t\t\t<td>\r\n\t\t\t\t<img src={logo} alt={`${option.market} logo`} />\r\n\t\t\t</td>\r\n\t\t\t<td>\r\n\t\t\t\t{option.type}\r\n\t\t\t</td>\r\n\t\t\t<td>\r\n\t\t\t\t${formatAmount(option.strike, OPTIONS_DECIMALS, 2, true)}\r\n\t\t\t</td>\r\n\t\t\t<td>\r\n\t\t\t\t{msToTimeLeft(option.period)}\r\n\t\t\t</td>\r\n\t\t\t<td>\r\n\t\t\t\t{format(expirationDate, 'dd MMM')}\r\n\t\t\t</td>\r\n\t\t\t<td>\r\n\t\t\t\t${formatAmount(option.cost, OPTIONS_DECIMALS, 2, true)}\r\n\t\t\t</td>\r\n\t\t\t<td>\r\n\t\t\t\t${formatAmount(option.price, OPTIONS_DECIMALS, 2, true)}\r\n\t\t\t</td>\r\n\t\t\t<td style={{textAlign: 'center'}}>\r\n\t\t\t\t{isBtnDisabled\r\n\t\t\t\t\t? disabledTooltip\r\n\t\t\t\t\t: <a href={option.buyUrl ?? '#'} target=\"_blank\" rel=\"noreferrer\"\r\n\t\t\t\t\t\t\tclassName={'btn_inline'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{btnText}\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t}\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t);\r\n};\r\n\r\nexport default OptionsItem;","import React, { useState } from 'react';\r\nimport icon_curve from '../../../img/icon-market.svg';\r\nimport cx from 'classnames';\r\nimport './Filter.scss';\r\nimport icon_down from '../../../img/icon-down-small.svg';\r\n\r\nconst Filter = (props) => {\r\n\tconst {\r\n\t\titems,\r\n\t\tselectedItems,\r\n\t\tsetSelectedItems,\r\n\t} = props;\r\n\r\n\tconst [open, setOpen] = useState(false);\r\n\r\n\tfunction openFilter(e) {\r\n\t\tif (open) {\r\n\t\t\tcloseFilter();\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\te.stopPropagation();\r\n\t\tdocument.addEventListener('click', closeFilter);\r\n\t\tsetOpen(true);\r\n\t}\r\n\tfunction closeFilter() {\r\n\t\tdocument.removeEventListener('click', closeFilter);\r\n\t\tsetOpen(false);\r\n\t}\r\n\r\n\t\r\n\treturn (\r\n\t\t<div className={cx(\"Filter\", open && 'active')}>\r\n\t\t\t<button className=\"Filter__header\" onClick={openFilter}>\r\n\t\t\t\t<div className=\"Filter__header-icon\">\r\n\t\t\t\t\t<img src={icon_curve} alt=\"Curve icon\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"Filter__header-title-container\">\r\n\t\t\t\t\t<span className='Filter__header-title nowrap'>\r\n\t\t\t\t\t\tChoose Markets\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<img className='Filter__chevron-down' src={icon_down} alt=\"chevron down\" />\r\n\t\t\t\t</div>\r\n\t\t\t</button>\r\n\t\t\t<div className=\"Filter__items\" onClick={(e) => e.stopPropagation()}>\r\n\t\t\t\t{items.map(item => {\r\n\t\t\t\t\tconst itemIcon = require(`../../../img/icon-${item}.svg`).default;\r\n\t\t\t\t\tconst isSelected = selectedItems.find(el => el === item);\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div className=\"Filter__item input-container\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tdefaultChecked={isSelected}\r\n\t\t\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\t\t\tif (e.target.checked) {\r\n\t\t\t\t\t\t\t\t\t\tselectedItems.push(item);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tconst index = selectedItems.findIndex(el => el === item);\r\n\t\t\t\t\t\t\t\t\t\tselectedItems.splice(index, 1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tsetSelectedItems(selectedItems.slice());\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t\t<img className='Filter__item-icon' src={itemIcon} alt={item} />\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Filter;","import React, { useState, useEffect } from 'react';\r\nimport './OptionsList.scss';\r\nimport Loader from './../../../../components/UI/loader/Loader';\r\nimport OptionsItem from './OptionsItem';\r\nimport Tooltip from './../Tooltip/Tooltip';\r\nimport Chai_ABI from '../../../../deployments/options/Chai_ABI.json';\r\nimport { CHAI_CONTRACT_ETH, CHAI_CONTRACT_BTC } from '../../../../components/utils/contracts';\r\nimport useSWR from 'swr';\r\nimport { ethers } from 'ethers';\r\nimport icon_btnUp from '../../../../img/icon-btn-up.svg';\r\nimport Filter from './../../../../components/UI/Filter/Filter';\r\nimport { marketsOptions, OPTION_LIST_FRONTIER } from './../../../../components/utils/constants';\r\nimport { useLocalStorageSerializeKey, ARBITRUM } from './../../lib/legacyOptions';\r\nimport { BigNumber } from 'ethers';\r\n\r\nconst OptionsList = (props) => {\r\n\tconst {\r\n\t\tactive,\r\n\t\tlibrary,\r\n\t\toptions,\r\n\t\tsetOptions,\r\n\t\toptionsExpectedLength,\r\n\t\toptionPrices,\r\n\t\tisLoading,\r\n\t\tscrollRef,\r\n\t\tswapOption,\r\n\t} = props;\r\n\r\n\tconst chaiAddress = options[0]?.token === 'ETH'\r\n    ? CHAI_CONTRACT_ETH : CHAI_CONTRACT_BTC;\r\n  const { data: markPrice } = useSWR(\r\n    active && [active, options[0]?.token, \"getMarkPrice\"],\r\n    async () => {\r\n      const contract = new ethers.Contract(chaiAddress, Chai_ABI, library.getSigner());\r\n      return await contract.latestAnswer();\r\n    }\r\n\t)\r\n\r\n\tconst isCall = swapOption === 'Call';\r\n\r\n\tconst listFrontierStep = OPTION_LIST_FRONTIER;\r\n\tconst [listFrontier, setListFrontier] = useState(listFrontierStep);\r\n\tconst [unfoldVisible, setUnfoldVisible] = useState(false);\r\n\t\r\n\tconst [markets, setMarkets] = useLocalStorageSerializeKey([ARBITRUM, \"Options-Markets\"], marketsOptions.slice());\r\n\r\n\tconst filterOptions = (arr) => {\r\n\t\treturn arr.filter(opt => {\r\n\t\t\tfor (let i = 0; i < markets.length; i++) {\r\n\t\t\t\tconst market = markets[i];\r\n\t\t\t\tif (market === opt.market) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst [sortType, setSortType] = useState('');\r\n\tconst [sortedOptions, setSortedOptions] = useState([]);\r\n\r\n\tconst sortOptions = (param, dir = 1, isInit = false) => {\r\n\t\tconst res = filterOptions(options);\r\n\t\t\r\n\t\tconst sortFn = (arr) => {\r\n\t\t\tarr.sort((a, b) => {\r\n\t\t\t\tconst prevEl = a[param];\r\n\t\t\t\tconst el = b[param];\r\n\t\t\t\t\r\n\t\t\t\tif (prevEl === null) {\r\n\t\t\t\t\treturn dir;\r\n\t\t\t\t} else if (el === null) {\r\n\t\t\t\t\treturn -dir;\r\n\t\t\t\t} else if (prevEl && el) {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tarr.sort((a, b) => {\r\n\t\t\t\tconst prevEl = a[param];\r\n\t\t\t\tconst el = b[param];\r\n\t\r\n\t\t\t\tif (!prevEl || !el) {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (prevEl.lt(el)) {\r\n\t\t\t\t\treturn dir;\r\n\t\t\t\t}\telse if (prevEl.eq(el)) {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn -dir;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\t\r\n\t\tif (!isInit) {\r\n\t\t\tconst [prevParam, prevDir] = sortType.split('_');\r\n\t\t\tif (param === prevParam) {\r\n\t\t\t\tdir = -prevDir;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsortFn(res);\r\n\t\t}\r\n\t\t\r\n\t\tconst arr = res.slice(0, listFrontier);\r\n\t\tif (!isInit) {\r\n\t\t\tsortFn(arr);\r\n\t\t}\r\n\r\n\t\tsetSortedOptions(arr.slice());\r\n\t\tsetSortType(`${param}_${dir}`);\r\n\t\t\r\n\t\tif (arr.length < res.length) {\r\n\t\t\tsetUnfoldVisible(true);\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tsetUnfoldVisible(false);\r\n\t\tconst [param, dir] = sortType.split('_');\r\n\t\tsortOptions(param, dir, true);\r\n\t}, [listFrontier, markets]);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tif (options.length) {\r\n\t\t\tsetListFrontier(listFrontierStep);\r\n\t\t\tsetUnfoldVisible(false);\r\n\r\n\t\t\tsortOptions('strike', isCall ? -1 : 1, true);\r\n\t\t} else {\r\n\t\t\tsetSortedOptions([]);\r\n\t\t}\r\n\t}, [options.length]);\r\n\r\n\tconst renderHead = () => {\r\n\t\treturn (\r\n\t\t\t<tr className=\"Exchange-list-header\">\r\n\t\t\t\t<th>\r\n\t\t\t\t\tMarket\r\n\t\t\t\t</th>\r\n\t\t\t\t<th>\r\n\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\tclassName=\"has-hint-tooltip nowrap\"\r\n\t\t\t\t\t\thandle=\"Type\"\r\n\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div className=\"Tooltip__text\">\r\n\t\t\t\t\t\t\t\t\tAmerican-style options may <br />exercise atany time before <br />the option expires.<br />European-style options may <br />exercise only atexpiration.\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</th>\r\n\t\t\t\t<th>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName='btn_table-sort'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsortOptions('strike');\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tStrike\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</th>\r\n\t\t\t\t<th>\r\n\t\t\t\t\tExpires in\r\n\t\t\t\t</th>\r\n\t\t\t\t<th>\r\n\t\t\t\t\tDate\r\n\t\t\t\t</th>\r\n\t\t\t\t<th>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName='btn_table-sort'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsortOptions('cost');\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tTotal Cost\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</th>\r\n\t\t\t\t<th>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName='btn_table-sort'\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsortOptions('price');\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tPrice per Option\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</th>\r\n\t\t\t\t<th></th>\r\n\t\t\t</tr>\r\n\t\t)\r\n\t}\r\n\r\n\tif (!options) {\r\n\t\treturn null;\r\n\t}\r\n\treturn (\r\n\t\t<div className=\"OptionsList block\" ref={scrollRef}>\r\n\t\t\t<div className=\"OptionsList__header\">\r\n\t\t\t\t<h1 className='OptionsList__title'>Available Options</h1>\r\n\t\t\t\t<Filter\r\n\t\t\t\t\titems={marketsOptions}\r\n\t\t\t\t\tselectedItems={markets}\r\n\t\t\t\t\tsetSelectedItems={setMarkets}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"table-wrapper\">\r\n\t\t\t\t<table className=\"Exchange-list large App-box\">\r\n\t\t\t\t\t{renderHead()}\r\n\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t{(!sortedOptions.length || !markPrice) ?\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td colSpan={8}>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tisLoading ?\r\n\t\t\t\t\t\t\t\t\t\t<Loader /> :\r\n\t\t\t\t\t\t\t\t\t\t\t(options.length \r\n\t\t\t\t\t\t\t\t\t\t\t\t? \"Please select markets from the list above\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Please choose the desired amount and period to view the available options\")\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t(isLoading\r\n\t\t\t\t\t\t\t\t? <tr>\r\n\t\t\t\t\t\t\t\t\t\t<td colSpan={8}>\r\n\t\t\t\t\t\t\t\t\t\t\t<Loader />\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t: sortedOptions.map(opt => {\r\n\t\t\t\t\t\t\t\t\t\tconst optPriceObj = optionPrices[opt.strategy];\r\n\t\t\t\t\t\t\t\t\t\topt.price = optPriceObj?.price;\r\n\t\t\t\t\t\t\t\t\t\topt.cost = optPriceObj?.cost;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\treturn(\r\n\t\t\t\t\t\t\t\t\t\t\t<OptionsItem\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={opt.strategy}\r\n\t\t\t\t\t\t\t\t\t\t\t\toption={opt}\r\n\t\t\t\t\t\t\t\t\t\t\t\tmarkPrice={markPrice}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</tbody>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t\t{unfoldVisible &&\r\n\t\t\t\t<button\r\n\t\t\t\t\tclassName=\"btn btn_hlight OptionsList__unfold-btn\"\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetUnfoldVisible(false);\r\n\t\t\t\t\t\tsetListFrontier(listFrontier + listFrontierStep);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tSee more\r\n\t\t\t\t</button>\r\n\t\t\t}\r\n\t\t\t<button className=\"btn_up\"\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\twindow.scrollTo({\r\n\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\tleft: 0,\r\n\t\t\t\t\t\tbehavior: 'smooth'\r\n\t\t\t\t\t});\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<img src={icon_btnUp} alt=\"scroll up button\" />\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default OptionsList;","import React, { useEffect, useState, useMemo, useCallback, forwardRef, useRef, useImperativeHandle } from \"react\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\nimport useSWR from \"swr\";\r\nimport { ethers, BigNumber } from \"ethers\";\r\nimport Lyra from '@lyrafinance/lyra-js';\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  formatAmount,\r\n  getTokenInfo,\r\n  useLocalStorageByChainId,\r\n  useChainId,\r\n  getPageTitle,\r\n  CALL,\r\n} from \"../../lib/legacyOptions\";\r\nimport { useInfoTokens } from \"../../domain/legacy\";\r\n\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport { getTokens, getToken } from \"../../config/Tokens\";\r\n\r\nimport Reader from \"../../abis/ReaderV2.json\";\r\n\r\nimport SwapBox from \"../../components/Exchange/SwapBoxOptions\";\r\nimport ExchangeTVChart from \"../../components/Exchange/ExchangeTVChartOptions\";\r\nimport PositionsList from \"../../components/Exchange/PositionsListOptions\";\r\nimport Tab from \"../../components/Tab/TabOptions\";\r\n\r\nimport \"../../../gmx-test/pages/Exchange/Exchange.scss\";\r\nimport \"./ExchangeOptions.scss\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { ARBITRUM } from './../../lib/legacyOptions';\r\nimport OptionsList from './../../components/Exchange/OptionsList';\r\nimport Chai_ABI from '../../../../deployments/options/Chai_ABI.json';\r\nimport { CHAI_CONTRACT_BTC, CHAI_CONTRACT_ETH } from './../../../../components/utils/contracts';\r\n\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport const Exchange = forwardRef((props) => {\r\n  const {\r\n    connectWallet,\r\n    walletAddress,\r\n  } = props;\r\n\r\n  const { account, library } = useWeb3React();\r\n  const active = Boolean(props.walletAddress);\r\n  const { chainId } = useChainId();\r\n  const defaultTokenSelection = AddressZero;\r\n\r\n  const [tokenSelection, setTokenSelection] = useLocalStorageByChainId(\r\n    chainId,\r\n    \"Exchange-token-selection-options\",\r\n    defaultTokenSelection\r\n  );\r\n  \r\n  const tokens = getTokens(chainId);\r\n\r\n  const tokenAddresses = tokens.map((token) => token.address);\r\n  const readerAddress = getContract(chainId, \"Reader\");\r\n  const { data: tokenBalances } = useSWR(active && [active, chainId, readerAddress, \"getTokenBalances\", account], {\r\n    fetcher: fetcher(library, Reader, [tokenAddresses]),\r\n  });\r\n  \r\n  const positionsDataIsLoading = active && false;\r\n\r\n  const { infoTokens } = useInfoTokens(library, chainId, active, tokenBalances);\r\n  const selectedToken = getTokenInfo(infoTokens, tokenSelection);\r\n\r\n  const chaiAddress = selectedToken.symbol === 'ETH'\r\n    ? CHAI_CONTRACT_ETH : CHAI_CONTRACT_BTC;\r\n  const { data: chaiMarkPrice } = useSWR(\r\n    active && [active, tokenSelection, \"getMarkPrice\", account],\r\n    async () => {\r\n      const contract = new ethers.Contract(chaiAddress, Chai_ABI, library.getSigner());\r\n      return await contract.latestAnswer();\r\n    }\r\n  )\r\n\r\n  useEffect(() => {\r\n    const toToken = getTokenInfo(infoTokens, tokenSelection);\r\n    let currentTokenPriceStr = formatAmount(toToken.maxPrice, USD_DECIMALS, 2, true);\r\n    let title = getPageTitle(currentTokenPriceStr + ` | ${toToken.symbol}${toToken.isStable ? \"\" : \"USD\"}`);\r\n    document.title = title;\r\n  }, [tokenSelection, infoTokens, chainId]);\r\n\r\n  const posLength = 0;\r\n\r\n  const LIST_SECTIONS = [\"Positions\"];\r\n  let [listSection, setListSection] = useLocalStorageByChainId(chainId, \"List-section-v2\", LIST_SECTIONS[0]);\r\n  const LIST_SECTIONS_LABELS = {\r\n    Positions: posLength ? `Positions (${posLength})` : undefined,\r\n  };\r\n  if (!LIST_SECTIONS.includes(listSection)) {\r\n    listSection = LIST_SECTIONS[0];\r\n  }\r\n\r\n  const getListSection = () => {\r\n    return (\r\n      <div>\r\n        <div className=\"Exchange-list-tab-container\">\r\n          <Tab\r\n            options={LIST_SECTIONS}\r\n            optionLabels={LIST_SECTIONS_LABELS}\r\n            option={listSection}\r\n            onChange={(section) => setListSection(section)}\r\n            type=\"inline\"\r\n            className=\"Exchange-list-tabs\"\r\n          />\r\n        </div>\r\n        {listSection === \"Positions\" && (\r\n          <PositionsList\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            account={account}\r\n            library={library}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderChart = () => {\r\n    return (\r\n      <ExchangeTVChart\r\n        tokenSelection={tokenSelection}\r\n        setTokenSelection={setTokenSelection}\r\n        infoTokens={infoTokens}\r\n        chainId={chainId}\r\n        savedShouldShowPositionLines={false}\r\n      />\r\n    );\r\n  };\r\n\r\n  const [leverageOption, setLeverageOption] = useLocalStorageByChainId(ARBITRUM, \"Period_Options\", 7);\r\n  const [amountValue, setAmountValue] = useState('');\r\n  const [swapOption, setSwapOption] = useLocalStorageByChainId(ARBITRUM, \"Swap-option_Options\", CALL);\r\n  const [assetOption, setAssetOption] = useLocalStorageByChainId(ARBITRUM, \"Asset-option_Options\", selectedToken.symbol);\r\n\r\n  const [options, setOptions] = useState([]);\r\n  const [optionsLength, setOptionsLength] = useState(0);\r\n  const [optionsExpectedLength, setOptionsExpectedLength] = useState(0);\r\n  const [isOptionsLoading, setIsOptionsLoading] = useState(false);\r\n  const [optionPrices, setOptionPrices] = useState({});\r\n\r\n  const scrollRef = useRef(null);\r\n  const scrollToList = () => {\r\n    if (scrollRef?.current) {\r\n      scrollRef.current.scrollIntoView({\r\n        behavior: 'smooth'\r\n      });\r\n    }\r\n  }\r\n  \r\n\r\n  useEffect(() => {\r\n    setAssetOption(selectedToken.symbol);\r\n  }, [selectedToken.symbol]);\r\n\r\n  if (!getToken(chainId, tokenSelection)) {\r\n    return null;\r\n  }\r\n  return (\r\n    <div className=\"Exchange page-layout\">\r\n      <div className=\"Exchange-content\">\r\n        <div className=\"Exchange-left\">\r\n          {renderChart()}\r\n        </div>\r\n        <div className=\"Exchange-right\">\r\n          <SwapBox\r\n            chainId={chainId}\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            connectWallet={connectWallet}\r\n            walletAddress={walletAddress}\r\n            library={library}\r\n            account={account}\r\n            selectedToken={selectedToken}\r\n            tokenSelection={tokenSelection}\r\n            setTokenSelection={setTokenSelection}\r\n            leverageOption={leverageOption}\r\n            setLeverageOption={setLeverageOption}\r\n            amountValue={amountValue}\r\n            setAmountValue={setAmountValue}\r\n            swapOption={swapOption}\r\n            setSwapOption={setSwapOption}\r\n            assetOption={assetOption}\r\n            setAssetOption={setAssetOption}\r\n            options={options}\r\n            setOptions={setOptions}\r\n            setOptionsLength={setOptionsLength}\r\n            setOptionsExpectedLength={setOptionsExpectedLength}\r\n            isOptionsLoading={isOptionsLoading}\r\n            setIsOptionsLoading={setIsOptionsLoading}\r\n            optionPrices={optionPrices}\r\n            setOptionPrices={setOptionPrices}\r\n            scrollToList={scrollToList}\r\n            chaiMarkPrice={chaiMarkPrice}\r\n          />\r\n        </div>\r\n        <div className=\"Exchange-lists large\">{getListSection()}</div>\r\n        <div className=\"Exchange-lists small\">{getListSection()}</div>\r\n        <div></div>\r\n        <div>\r\n          <OptionsList\r\n            active={active}\r\n            library={library}\r\n            options={options}\r\n            setOptions={setOptions}\r\n            optionsExpectedLength={optionsExpectedLength}\r\n            optionPrices={optionPrices}\r\n            isLoading={isOptionsLoading}\r\n            scrollRef={scrollRef}\r\n            swapOption={swapOption}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n","// date format: d MMM yyyy, H:mm, time should be specifed based on UTC time\r\n\r\nexport const homeEventsData = [\r\n  {\r\n    id: \"app-gmx-io-launch\",\r\n    title: \"Frontend Updates\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"Updates have been applied to the GMX frontend to inform users of the separation between gmx.io and app.gmx.io\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"arbitrum-nitro-upgrade\",\r\n    title: \"Arbitrum Nitro Upgrade\",\r\n    isActive: true,\r\n    validTill: \"31 Aug 2022, 20:00\",\r\n    bodyText: \"The Arbitrum Nitro upgrade has been completed.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/arbitrum-nitro-5f88c03a46fe\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nexport const appEventsData = [\r\n  // {\r\n  //   id: \"removal-of-min-profit-rule\",\r\n  //   title: \"Trading improvements\",\r\n  //   isActive: true,\r\n  //   validTill: \"1 Apr 2022, 12:00\",\r\n  //   bodyText: \"The 1.5% minimum profit rule has been removed\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read more\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/roadmap#30-march-2022\",\r\n  //       newTab: true,\r\n  //     },\r\n  //     {\r\n  //       text: \"Trade Now\",\r\n  //       link: \"https://gmx.io/trade\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"shorting-of-link-uni-re-enabled\",\r\n  //   title: \"Shorting of LINK and UNI\",\r\n  //   isActive: true,\r\n  //   validTill: \"20 Apr 2022, 12:00\",\r\n  //   bodyText: \"Shorting has been re-enabled for LINK and UNI.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Trade Now\",\r\n  //       link: \"https://gmx.io/trade\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"speed-up-page-loading\",\r\n  //   title: \"Speed Up Page Loading\",\r\n  //   isActive: true,\r\n  //   validTill: \"4 May 2022, 12:00\",\r\n  //   bodyText: \"If you experience data loading issues, please use a free RPC URL from Alchemy.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Learn More\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"referral-program-launch\",\r\n  //   title: \"Referral Program Launch\",\r\n  //   isActive: true,\r\n  //   validTill: \"4 May 2022, 12:00\",\r\n  //   bodyText: \"The GMX referral program is now live! Get fee discounts and refer traders to earn rewards.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://gmx.io/referrals\",\r\n  //     },\r\n  //     {\r\n  //       text: \"Join Now\",\r\n  //       link: \"https://gmx.io/referrals\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"gmx-arbitrum-odyssey\",\r\n  //   title: \"GMX Arbitrum Odyssey\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"The GMX Arbitrum Odyssey is taking place this week, all participants will receive prizes. Read on to find out more.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://medium.com/@gmx.io/gmx-arbitrum-odyssey-fc12cba2d10d\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"fix-arbitrum-transaction-issues\",\r\n  //   title: \"Fix Arbitrum Transactions\",\r\n  //   isActive: true,\r\n  //   validTill: \"30 Jun 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"If you experience transaction errors on Arbitrum or data loading issues, please use a free RPC URL from Alchemy.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Learn More\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"gmx-arbitrum-odyssey-paused\",\r\n  //   title: \"GMX Arbitrum Odyssey Paused\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText: \"The GMX Arbitrum Odyssey has been paused. Please read the linked post for more information.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://twitter.com/GMX_IO/status/1542163585111150592\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"app-gmx-io\",\r\n  //   title: \"Frontend Updates\",\r\n  //   isActive: true,\r\n  //   validTill: \"6 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"On 6 Jul 2022, updates will be applied to the GMX frontend to inform users of the separation between gmx.io and app.gmx.io\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"degraded-alchemy-performance\",\r\n  //   title: \"Alchemy RPC\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"There are ongoing syncing issues on Alchemy for Arbitrum at the moment, please check their status page and use the public Arbitrum RPC in the meantime\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Check Status\",\r\n  //       link: \"https://status.alchemy.com/\",\r\n  //       newTab: true,\r\n  //     },\r\n  //     {\r\n  //       text: \"Public RPC URL\",\r\n  //       link: \"https://metamask.zendesk.com/hc/en-us/articles/4415758358299-Network-profile-Arbitrum\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  {\r\n    id: \"app-gmx-io-settings\",\r\n    title: \"Frontend Updates\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"You are currently using app.gmx.io. Customized settings have been reset, you may need to adjust your settings by clicking on the menu in the top right after connecting your wallet.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"use-alchemy-rpc-url\",\r\n    title: \"Use Alchemy RPC URL\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"If you experience data loading or transaction issues on Arbitrum, please use a free RPC URL from Alchemy.\",\r\n    buttons: [\r\n      {\r\n        text: \"Learn More\",\r\n        link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"arbitrum-nitro-upgrade\",\r\n    title: \"Arbitrum Nitro Upgrade\",\r\n    isActive: true,\r\n    validTill: \"31 Aug 2022, 20:00\",\r\n    bodyText: \"The Arbitrum Nitro upgrade has been completed.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/arbitrum-nitro-5f88c03a46fe\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n];\r\n","function Icon({ className }) {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      aria-hidden=\"true\"\r\n      className={className}\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"2\"\r\n        d=\"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z\"\r\n      ></path>\r\n    </svg>\r\n  );\r\n}\r\n\r\nexport default Icon;\r\n","import \"./EventToast.css\";\r\nimport Icon from \"./AnnouncementIcon\";\r\nimport { MdOutlineClose } from \"react-icons/md\";\r\n\r\nexport default function EventToast({ event, id, onClick, t }) {\r\n  return (\r\n    <div className={`single-toast ${t.visible ? \"zoomIn\" : \"zoomOut\"}`} key={id}>\r\n      <header>\r\n        <div className=\"toast-title\">\r\n          <Icon className=\"announcement-icon\" />\r\n          <p>{event.title}</p>\r\n        </div>\r\n        <MdOutlineClose onClick={onClick} className=\"cross-icon\" color=\"white\" />\r\n      </header>\r\n      <p className=\"toast-body\">{event.bodyText}</p>\r\n      <div className=\"toast-links\">\r\n        {event.buttons.map((button) => {\r\n          if (button.newTab) {\r\n            return (\r\n              <a key={event.id + button.text} target=\"_blank\" rel=\"noreferrer noopener\" href={button.link}>\r\n                {button.text}\r\n              </a>\r\n            );\r\n          } else {\r\n            return (\r\n              <a key={event.id + button.text} href={button.link}>\r\n                {button.text}\r\n              </a>\r\n            );\r\n          }\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { useLocalStorage } from \"react-use\";\r\nimport toast from \"react-hot-toast\";\r\nimport { homeEventsData, appEventsData } from \"../../config/events\";\r\nimport { useEffect } from \"react\";\r\nimport EventToast from \"./EventToast\";\r\nimport { isFuture, parse } from \"date-fns\";\r\nimport { isHomeSite } from \"../../lib/legacyOptions\";\r\n\r\nfunction useEventToast() {\r\n  const isHome = isHomeSite();\r\n  const [visited, setVisited] = useLocalStorage(\"visited-announcements\", []);\r\n\r\n  useEffect(() => {\r\n    const eventsData = isHome ? homeEventsData : appEventsData;\r\n\r\n    eventsData\r\n      .filter((event) => event.isActive)\r\n      .filter((event) => isFuture(parse(event.validTill + \", +00\", \"d MMM yyyy, H:mm, x\", new Date())))\r\n      .filter((event) => Array.isArray(visited) && !visited.includes(event.id))\r\n      .forEach((event) => {\r\n        toast.custom(\r\n          (t) => (\r\n            <EventToast\r\n              event={event}\r\n              id={event.id}\r\n              t={t}\r\n              onClick={() => {\r\n                toast.dismiss(event.id);\r\n                visited.push(event.id);\r\n                setVisited(visited);\r\n              }}\r\n            />\r\n          ),\r\n          {\r\n            id: event.id,\r\n            style: {},\r\n          }\r\n        );\r\n      });\r\n  }, [visited, setVisited, isHome]);\r\n}\r\n\r\nexport default useEventToast;\r\n","import { Toaster } from \"react-hot-toast\";\r\nimport { useWindowScroll, createBreakpoint } from \"react-use\";\r\n\r\nfunction EventToastContainer() {\r\n  let { y: scrollY } = useWindowScroll();\r\n  const useBreakpoint = createBreakpoint({ XL: 1033, L: 768, S: 350 });\r\n  const breakpoint = useBreakpoint();\r\n  return (\r\n    <Toaster\r\n      position=\"top-right\"\r\n      reverseOrder={true}\r\n      gutter={30}\r\n      containerClassName=\"event-toast-container\"\r\n      containerStyle={{\r\n        zIndex: 2,\r\n        transition: \"all 200ms\",\r\n        top: scrollY > 60 ? \"30px\" : `${93 - scrollY}px`,\r\n        right: breakpoint === \"XL\" ? \"30px\" : \"1rem\",\r\n      }}\r\n      toastOptions={{\r\n        duration: Infinity,\r\n      }}\r\n    />\r\n  );\r\n}\r\nexport default EventToastContainer;\r\n","import { Helmet } from \"react-helmet\";\r\n\r\nimport { t } from \"@lingui/macro\";\r\n\r\nfunction SEO(props) {\r\n  const { children, ...customMeta } = props;\r\n  const meta = {\r\n    title: t`GMX | Decentralized Perpetual Exchange`,\r\n    description: t`Trade spot or perpetual BTC, ETH, AVAX and other top cryptocurrencies with up to 30x leverage directly from your wallet on Arbitrum and Avalanche.`,\r\n    image: \"https://gmx.io/og.png\",\r\n    type: \"exchange\",\r\n    ...customMeta,\r\n  };\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{meta.title}</title>\r\n        <meta name=\"robots\" content=\"follow, index\" />\r\n        <meta content={meta.description} name=\"description\" />\r\n        <meta property=\"og:type\" content={meta.type} />\r\n        <meta property=\"og:site_name\" content=\"GMX\" />\r\n        <meta property=\"og:description\" content={meta.description} />\r\n        <meta property=\"og:title\" content={meta.title} />\r\n        <meta property=\"og:image\" content={meta.image} />\r\n        <meta name=\"twitter:card\" content=\"summary_large_image\" />\r\n        <meta name=\"twitter:site\" content=\"@gmx_io\" />\r\n        <meta name=\"twitter:title\" content={meta.title} />\r\n        <meta name=\"twitter:description\" content={meta.description} />\r\n        <meta name=\"twitter:image\" content={meta.image} />\r\n      </Helmet>\r\n      {children}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default SEO;\r\n","import \"./RedirectModal.css\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\n\r\nexport function RedirectPopupModal({\r\n  redirectModalVisible,\r\n  setRedirectModalVisible,\r\n  appRedirectUrl,\r\n  setRedirectPopupTimestamp,\r\n  setShouldHideRedirectModal,\r\n  shouldHideRedirectModal,\r\n  removeRedirectPopupTimestamp,\r\n}) {\r\n  const onClickAgree = () => {\r\n    if (shouldHideRedirectModal) {\r\n      setRedirectPopupTimestamp(Date.now());\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      className=\"RedirectModal\"\r\n      isVisible={redirectModalVisible}\r\n      setIsVisible={setRedirectModalVisible}\r\n      label=\"Launch App\"\r\n    >\r\n      You are leaving GMX.io and will be redirected to a third party, independent website.\r\n      <br />\r\n      <br />\r\n      The website is a community deployed and maintained instance of the open source{\" \"}\r\n      <a href=\"https://github.com/gmx-io/gmx-interface\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        GMX front end\r\n      </a>\r\n      , hosted and served on the distributed, peer-to-peer{\" \"}\r\n      <a href=\"https://ipfs.io/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        IPFS network\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      Alternative links can be found in the{\" \"}\r\n      <a href=\"https://gmxio.gitbook.io/gmx/app-links\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        docs\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      By clicking Agree you accept the{\" \"}\r\n      <a href=\"https://gmx.io/#/terms-and-conditions\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        T&Cs\r\n      </a>{\" \"}\r\n      and{\" \"}\r\n      <a href=\"https://gmx.io/#/referral-terms\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        Referral T&Cs\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      <div className=\"mb-sm\">\r\n        <Checkbox isChecked={shouldHideRedirectModal} setIsChecked={setShouldHideRedirectModal}>\r\n          Don't show this message again for 30 days.\r\n        </Checkbox>\r\n      </div>\r\n      <a href={appRedirectUrl} className=\"App-cta Exchange-swap-button\" onClick={() => onClickAgree()}>\r\n        Agree\r\n      </a>\r\n    </Modal>\r\n  );\r\n}\r\n","import { i18n } from \"@lingui/core\";\r\nimport { en, es, zh, ko, ru, ja, fr } from \"make-plural/plurals\";\r\nimport { LANGUAGE_LOCALSTORAGE_KEY } from \"./legacyOptions\";\r\n\r\nexport const locales = {\r\n  en: \"English\",\r\n  es: \"Spanish\",\r\n  // zh: \"Chinese\",\r\n  ko: \"Korean\",\r\n  // ru: \"Russian\",\r\n  ja: \"Japanese\",\r\n  // fr: \"French\",\r\n};\r\n\r\nexport const defaultLocale = \"en\";\r\n\r\ni18n.loadLocaleData({\r\n  en: { plurals: en },\r\n  es: { plurals: es },\r\n  zh: { plurals: zh },\r\n  ko: { plurals: ko },\r\n  ru: { plurals: ru },\r\n  ja: { plurals: ja },\r\n  fr: { plurals: fr },\r\n});\r\n\r\nexport async function dynamicActivate(locale) {\r\n  // const { messages } = await import(`@lingui/loader!../config/locales/${locale}/messages.po`);\r\n  localStorage.setItem(LANGUAGE_LOCALSTORAGE_KEY, locale);\r\n  // i18n.load(locale, messages);\r\n  i18n.activate(locale);\r\n}\r\n","import React, { useState, useEffect, useCallback, useRef } from \"react\";\r\nimport { SWRConfig } from \"swr\";\r\nimport { ethers } from \"ethers\";\r\nimport { Web3ReactProvider, useWeb3React } from \"@web3-react/core\";\r\nimport { Web3Provider } from \"@ethersproject/providers\";\r\nimport useScrollToTop from \"../lib/useScrollToTop\";\r\n\r\nimport { Routes, Route, HashRouter as Router, Navigate, useLocation, useNavigate } from \"react-router-dom\";\r\n\r\nimport {\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  SLIPPAGE_BPS_KEY,\r\n  IS_PNL_IN_LEVERAGE_KEY,\r\n  SHOW_PNL_AFTER_FEES_KEY,\r\n  BASIS_POINTS_DIVISOR,\r\n  SHOULD_SHOW_POSITION_LINES_KEY,\r\n  getAppBaseUrl,\r\n  isHomeSite,\r\n  clearWalletConnectData,\r\n  helperToast,\r\n  getAlchemyWsUrl,\r\n  useChainId,\r\n  getInjectedHandler,\r\n  useEagerConnect,\r\n  useLocalStorageSerializeKey,\r\n  useInactiveListener,\r\n  getExplorerUrl,\r\n  getWalletConnectHandler,\r\n  activateInjectedProvider,\r\n  hasMetaMaskWalletExtension,\r\n  hasCoinBaseWalletExtension,\r\n  isMobileDevice,\r\n  clearWalletLinkData,\r\n  SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY,\r\n  CURRENT_PROVIDER_LOCALSTORAGE_KEY,\r\n  REFERRAL_CODE_KEY,\r\n  REFERRAL_CODE_QUERY_PARAM,\r\n  isDevelopment,\r\n  DISABLE_ORDER_VALIDATION_KEY,\r\n  LANGUAGE_LOCALSTORAGE_KEY,\r\n} from \"../lib/legacyOptions\";\r\nimport { Exchange } from \"../pages/Exchange/ExchangeOptions\";\r\n\r\nimport { cssTransition, ToastContainer } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Modal from \"../components/Modal/Modal\";\r\nimport Checkbox from \"../components/Checkbox/Checkbox\";\r\n\r\nimport \"../styles/Font.css\";\r\nimport \"./App.scss\";\r\nimport \"../styles/Input.scss\";\r\n\r\nimport metamaskImg from \"../img/metamask.png\";\r\nimport coinbaseImg from \"../img/coinbaseWallet.png\";\r\nimport walletConnectImg from \"../img/walletconnect-circle-blue.svg\";\r\nimport useEventToast from \"../components/EventToast/useEventToast\";\r\nimport EventToastContainer from \"../components/EventToast/EventToastContainer\";\r\nimport SEO from \"../components/Common/SEO\";\r\nimport useRouteQuery from \"../lib/useRouteQuery\";\r\nimport { encodeReferralCode, decodeReferralCode } from \"../domain/referrals\";\r\n\r\nimport { getContract } from \"../config/Addresses\";\r\nimport VaultV2 from \"../abis/VaultV2.json\";\r\nimport VaultV2b from \"../abis/VaultV2b.json\";\r\nimport PositionRouter from \"../abis/PositionRouter.json\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { RedirectPopupModal } from \"../components/ModalViews/RedirectModal\";\r\nimport { REDIRECT_POPUP_TIMESTAMP_KEY } from \"../config/ui\";\r\n\r\nimport { i18n } from \"@lingui/core\";\r\nimport { I18nProvider } from \"@lingui/react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { defaultLocale, dynamicActivate } from \"../lib/i18n\";\r\n\r\nimport { signer } from './../../../components/utils/providers';\r\nimport _AccountManager from \"../../../deployments/arbitrum_ddl/accountManager.json\";\r\nimport Banner from './../../../components/Banner';\r\n\r\nif (\"ethereum\" in window) {\r\n  window.ethereum.autoRefreshOnNetworkChange = false;\r\n}\r\n\r\nfunction getLibrary(provider) {\r\n  const library = new Web3Provider(provider);\r\n  return library;\r\n}\r\n\r\nconst Jelly = cssTransition({\r\n  enter: \"jellyIn\",\r\n  exit: \"jellyOut\",\r\n});\r\n\r\nconst arbWsProvider = new ethers.providers.WebSocketProvider(getAlchemyWsUrl());\r\n\r\nconst avaxWsProvider = new ethers.providers.JsonRpcProvider(\"https://api.avax.network/ext/bc/C/rpc\");\r\n\r\nfunction getWsProvider(active, chainId) {\r\n  if (!active) {\r\n    return;\r\n  }\r\n  if (chainId === ARBITRUM) {\r\n    return arbWsProvider;\r\n  }\r\n\r\n  if (chainId === AVALANCHE) {\r\n    return avaxWsProvider;\r\n  }\r\n}\r\n\r\nfunction FullApp(props) {\r\n  const { setRegisterVisible } = props; \r\n  const isHome = isHomeSite();\r\n  const exchangeRef = useRef();\r\n  const { connector, library, deactivate, activate, active } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n  const location = useLocation();\r\n  const history = useNavigate();\r\n  useEventToast();\r\n  const [activatingConnector, setActivatingConnector] = useState();\r\n  useEffect(() => {\r\n    if (activatingConnector && activatingConnector === connector) {\r\n      setActivatingConnector(undefined);\r\n    }\r\n  }, [activatingConnector, connector, chainId]);\r\n  const triedEager = useEagerConnect(setActivatingConnector);\r\n  useInactiveListener(!triedEager || !!activatingConnector);\r\n\r\n  const query = useRouteQuery();\r\n\r\n  useEffect(() => {\r\n    let referralCode = query.get(REFERRAL_CODE_QUERY_PARAM);\r\n    if (!referralCode || referralCode.length === 0) {\r\n      const params = new URLSearchParams(window.location.search);\r\n      referralCode = params.get(REFERRAL_CODE_QUERY_PARAM);\r\n    }\r\n\r\n    if (referralCode && referralCode.length <= 20) {\r\n      const encodedReferralCode = encodeReferralCode(referralCode);\r\n      if (encodeReferralCode !== ethers.constants.HashZero) {\r\n        localStorage.setItem(REFERRAL_CODE_KEY, encodedReferralCode);\r\n        const queryParams = new URLSearchParams(location.search);\r\n        if (queryParams.has(REFERRAL_CODE_QUERY_PARAM)) {\r\n          queryParams.delete(REFERRAL_CODE_QUERY_PARAM);\r\n          history.replace({\r\n            search: queryParams.toString(),\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }, [query, history, location]);\r\n\r\n  const disconnectAccount = useCallback(() => {\r\n    // only works with WalletConnect\r\n    clearWalletConnectData();\r\n    // force clear localStorage connection for MM/CB Wallet (Brave legacy)\r\n    clearWalletLinkData();\r\n    deactivate();\r\n  }, [deactivate]);\r\n\r\n  const disconnectAccountAndCloseSettings = () => {\r\n    disconnectAccount();\r\n    localStorage.removeItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY);\r\n    localStorage.removeItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY);\r\n    setIsSettingsVisible(false);\r\n  };\r\n\r\n  const connectInjectedWallet = getInjectedHandler(activate);\r\n  const activateWalletConnect = () => {\r\n    getWalletConnectHandler(activate, deactivate, setActivatingConnector)();\r\n  };\r\n\r\n  const userOnMobileDevice = \"navigator\" in window && isMobileDevice(window.navigator);\r\n\r\n  useEffect(() => {\r\n    attemptActivateWallet(\"MetaMask\");\r\n  }, [props.walletAddress])\r\n  \r\n  const activateMetaMask = () => {\r\n    if (!hasMetaMaskWalletExtension()) {\r\n      helperToast.error(\r\n        <div>\r\n          <Trans>MetaMask not detected.</Trans>\r\n          <br />\r\n          <br />\r\n          <a href=\"https://metamask.io\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            <Trans>Install MetaMask</Trans>\r\n          </a>\r\n          {userOnMobileDevice ? (\r\n            <Trans>, and use GMX with its built-in browser</Trans>\r\n          ) : (\r\n            <Trans> to start using GMX</Trans>\r\n          )}\r\n          .\r\n        </div>\r\n      );\r\n      return false;\r\n    }\r\n    attemptActivateWallet(\"MetaMask\");\r\n  };\r\n  const activateCoinBase = () => {\r\n    if (!hasCoinBaseWalletExtension()) {\r\n      helperToast.error(\r\n        <div>\r\n          <Trans>Coinbase Wallet not detected.</Trans>\r\n          <br />\r\n          <br />\r\n          <a href=\"https://www.coinbase.com/wallet\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            <Trans>Install Coinbase Wallet</Trans>\r\n          </a>\r\n          {userOnMobileDevice ? (\r\n            <Trans>, and use GMX with its built-in browser</Trans>\r\n          ) : (\r\n            <Trans> to start using GMX</Trans>\r\n          )}\r\n          .\r\n        </div>\r\n      );\r\n      return false;\r\n    }\r\n    attemptActivateWallet(\"CoinBase\");\r\n  };\r\n\r\n  const attemptActivateWallet = (providerName) => {\r\n    localStorage.setItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY, true);\r\n    localStorage.setItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY, providerName);\r\n    activateInjectedProvider(providerName);\r\n    connectInjectedWallet();\r\n  };\r\n\r\n  const [walletModalVisible, setWalletModalVisible] = useState(false);\r\n  const [redirectModalVisible, setRedirectModalVisible] = useState(false);\r\n  const [shouldHideRedirectModal, setShouldHideRedirectModal] = useState(false);\r\n  const [redirectPopupTimestamp, setRedirectPopupTimestamp, removeRedirectPopupTimestamp] =\r\n    useLocalStorage(REDIRECT_POPUP_TIMESTAMP_KEY);\r\n  const [selectedToPage, setSelectedToPage] = useState(\"\");\r\n  // const connectWallet = () => setWalletModalVisible(true);\r\n  const connectWallet = () => {\r\n    props.connectWallet();\r\n    attemptActivateWallet(\"MetaMask\");\r\n  };\r\n\r\n  const [isSettingsVisible, setIsSettingsVisible] = useState(false);\r\n  const [savedSlippageAmount, setSavedSlippageAmount] = useLocalStorageSerializeKey(\r\n    [chainId, SLIPPAGE_BPS_KEY],\r\n    DEFAULT_SLIPPAGE_AMOUNT\r\n  );\r\n  \r\n  const [slippageAmount, setSlippageAmount] = useState(0);\r\n  const [isPnlInLeverage, setIsPnlInLeverage] = useState(false);\r\n  const [shouldDisableValidationForTesting, setShouldDisableValidationForTesting] = useState(false);\r\n  const [showPnlAfterFees, setShowPnlAfterFees] = useState(false);\r\n\r\n  const [savedIsPnlInLeverage, setSavedIsPnlInLeverage] = useLocalStorageSerializeKey(\r\n    [chainId, IS_PNL_IN_LEVERAGE_KEY],\r\n    false\r\n  );\r\n\r\n  const [savedShowPnlAfterFees, setSavedShowPnlAfterFees] = useLocalStorageSerializeKey(\r\n    [chainId, SHOW_PNL_AFTER_FEES_KEY],\r\n    false\r\n  );\r\n  const [savedShouldDisableValidationForTesting, setSavedShouldDisableValidationForTesting] =\r\n    useLocalStorageSerializeKey([chainId, DISABLE_ORDER_VALIDATION_KEY], false);\r\n\r\n  const [savedShouldShowPositionLines, setSavedShouldShowPositionLines] = useLocalStorageSerializeKey(\r\n    [chainId, SHOULD_SHOW_POSITION_LINES_KEY],\r\n    false\r\n  );\r\n\r\n  const openSettings = () => {\r\n    const slippage = parseInt(savedSlippageAmount);\r\n    setSlippageAmount((slippage / BASIS_POINTS_DIVISOR) * 100);\r\n    setIsPnlInLeverage(savedIsPnlInLeverage);\r\n    setShowPnlAfterFees(savedShowPnlAfterFees);\r\n    setShouldDisableValidationForTesting(savedShouldDisableValidationForTesting);\r\n    setIsSettingsVisible(true);\r\n  };\r\n\r\n  const saveAndCloseSettings = () => {\r\n    const slippage = parseFloat(slippageAmount);\r\n    if (isNaN(slippage)) {\r\n      helperToast.error(t`Invalid slippage value`);\r\n      return;\r\n    }\r\n    if (slippage > 5) {\r\n      helperToast.error(t`Slippage should be less than 5%`);\r\n      return;\r\n    }\r\n\r\n    const basisPoints = (slippage * BASIS_POINTS_DIVISOR) / 100;\r\n    if (parseInt(basisPoints) !== parseFloat(basisPoints)) {\r\n      helperToast.error(t`Max slippage precision is 0.01%`);\r\n      return;\r\n    }\r\n\r\n    setSavedIsPnlInLeverage(isPnlInLeverage);\r\n    setSavedShowPnlAfterFees(showPnlAfterFees);\r\n    setSavedShouldDisableValidationForTesting(shouldDisableValidationForTesting);\r\n    setSavedSlippageAmount(basisPoints);\r\n    setIsSettingsVisible(false);\r\n  };\r\n\r\n  const localStorageCode = window.localStorage.getItem(REFERRAL_CODE_KEY);\r\n  const baseUrl = getAppBaseUrl();\r\n  let appRedirectUrl = baseUrl + selectedToPage;\r\n  if (localStorageCode && localStorageCode.length > 0 && localStorageCode !== ethers.constants.HashZero) {\r\n    const decodedRefCode = decodeReferralCode(localStorageCode);\r\n    if (decodedRefCode) {\r\n      appRedirectUrl = `${appRedirectUrl}?ref=${decodedRefCode}`;\r\n    }\r\n  }\r\n\r\n  const [pendingTxns, setPendingTxns] = useState([]);\r\n\r\n  const showRedirectModal = (to) => {\r\n    setRedirectModalVisible(true);\r\n    setSelectedToPage(to);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const checkPendingTxns = async () => {\r\n      const updatedPendingTxns = [];\r\n      for (let i = 0; i < pendingTxns.length; i++) {\r\n        const pendingTxn = pendingTxns[i];\r\n        const receipt = await library.getTransactionReceipt(pendingTxn.hash);\r\n        if (receipt) {\r\n          if (receipt.status === 0) {\r\n            const txUrl = getExplorerUrl(chainId) + \"tx/\" + pendingTxn.hash;\r\n            helperToast.error(\r\n              <div>\r\n                <Trans>Txn failed.</Trans>{\" \"}\r\n                <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>View</Trans>\r\n                </a>\r\n                <br />\r\n              </div>\r\n            );\r\n          }\r\n          if (receipt.status === 1 && pendingTxn.message) {\r\n            const txUrl = getExplorerUrl(chainId) + \"tx/\" + pendingTxn.hash;\r\n            helperToast.success(\r\n              <div>\r\n                {pendingTxn.message}{\" \"}\r\n                <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>View</Trans>\r\n                </a>\r\n                <br />\r\n              </div>\r\n            );\r\n          }\r\n          continue;\r\n        }\r\n        updatedPendingTxns.push(pendingTxn);\r\n      }\r\n\r\n      if (updatedPendingTxns.length !== pendingTxns.length) {\r\n        setPendingTxns(updatedPendingTxns);\r\n      }\r\n    };\r\n\r\n    const interval = setInterval(() => {\r\n      checkPendingTxns();\r\n    }, 2 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [library, pendingTxns, chainId]);\r\n\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n\r\n  useEffect(() => {\r\n    const wsVaultAbi = chainId === ARBITRUM ? VaultV2.abi : VaultV2b.abi;\r\n    const wsProvider = getWsProvider(active, chainId);\r\n    if (!wsProvider) {\r\n      return;\r\n    }\r\n\r\n    const wsVault = new ethers.Contract(vaultAddress, wsVaultAbi, wsProvider);\r\n    const wsPositionRouter = new ethers.Contract(positionRouterAddress, PositionRouter.abi, wsProvider);\r\n\r\n    const callExchangeRef = (method, ...args) => {\r\n      if (!exchangeRef || !exchangeRef.current) {\r\n        return;\r\n      }\r\n\r\n      exchangeRef.current[method](...args);\r\n    };\r\n\r\n    // handle the subscriptions here instead of within the Exchange component to avoid unsubscribing and re-subscribing\r\n    // each time the Exchange components re-renders, which happens on every data update\r\n    const onUpdatePosition = (...args) => callExchangeRef(\"onUpdatePosition\", ...args);\r\n    const onClosePosition = (...args) => callExchangeRef(\"onClosePosition\", ...args);\r\n    const onIncreasePosition = (...args) => callExchangeRef(\"onIncreasePosition\", ...args);\r\n    const onDecreasePosition = (...args) => callExchangeRef(\"onDecreasePosition\", ...args);\r\n    const onCancelIncreasePosition = (...args) => callExchangeRef(\"onCancelIncreasePosition\", ...args);\r\n    const onCancelDecreasePosition = (...args) => callExchangeRef(\"onCancelDecreasePosition\", ...args);\r\n\r\n    wsVault.on(\"UpdatePosition\", onUpdatePosition);\r\n    wsVault.on(\"ClosePosition\", onClosePosition);\r\n    wsVault.on(\"IncreasePosition\", onIncreasePosition);\r\n    wsVault.on(\"DecreasePosition\", onDecreasePosition);\r\n    wsPositionRouter.on(\"CancelIncreasePosition\", onCancelIncreasePosition);\r\n    wsPositionRouter.on(\"CancelDecreasePosition\", onCancelDecreasePosition);\r\n\r\n    return function cleanup() {\r\n      wsVault.off(\"UpdatePosition\", onUpdatePosition);\r\n      wsVault.off(\"ClosePosition\", onClosePosition);\r\n      wsVault.off(\"IncreasePosition\", onIncreasePosition);\r\n      wsVault.off(\"DecreasePosition\", onDecreasePosition);\r\n      wsPositionRouter.off(\"CancelIncreasePosition\", onCancelIncreasePosition);\r\n      wsPositionRouter.off(\"CancelDecreasePosition\", onCancelDecreasePosition);\r\n    };\r\n  }, [active, chainId, vaultAddress, positionRouterAddress]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"App GMX-Interface Options-Interface\">\r\n        <div className=\"App-content\">\r\n          <Exchange\r\n            ref={exchangeRef}\r\n            savedShowPnlAfterFees={savedShowPnlAfterFees}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            setSavedIsPnlInLeverage={setSavedIsPnlInLeverage}\r\n            savedSlippageAmount={savedSlippageAmount}\r\n            setPendingTxns={setPendingTxns}\r\n            pendingTxns={pendingTxns}\r\n            savedShouldShowPositionLines={savedShouldShowPositionLines}\r\n            setSavedShouldShowPositionLines={setSavedShouldShowPositionLines}\r\n            connectWallet={connectWallet}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            walletAddress={props.walletAddress}\r\n          />\r\n        </div>\r\n      </div>\r\n      <ToastContainer\r\n        limit={1}\r\n        transition={Jelly}\r\n        position=\"bottom-right\"\r\n        // autoClose={}\r\n        hideProgressBar={true}\r\n        newestOnTop={false}\r\n        closeOnClick={false}\r\n        draggable={false}\r\n        pauseOnHover\r\n      />\r\n      <EventToastContainer />\r\n      <RedirectPopupModal\r\n        redirectModalVisible={redirectModalVisible}\r\n        setRedirectModalVisible={setRedirectModalVisible}\r\n        appRedirectUrl={appRedirectUrl}\r\n        setRedirectPopupTimestamp={setRedirectPopupTimestamp}\r\n        setShouldHideRedirectModal={setShouldHideRedirectModal}\r\n        shouldHideRedirectModal={shouldHideRedirectModal}\r\n        removeRedirectPopupTimestamp={removeRedirectPopupTimestamp}\r\n      />\r\n      <Modal\r\n        className=\"App-settings\"\r\n        isVisible={isSettingsVisible}\r\n        setIsVisible={setIsSettingsVisible}\r\n        label=\"Settings\"\r\n      >\r\n        <div className=\"App-settings-row\">\r\n          <div>\r\n            <Trans>Allowed Slippage</Trans>\r\n          </div>\r\n          <div className=\"App-slippage-tolerance-input-container\">\r\n            <input\r\n              type=\"number\"\r\n              className=\"App-slippage-tolerance-input\"\r\n              min=\"0\"\r\n              value={slippageAmount}\r\n              onChange={(e) => setSlippageAmount(e.target.value)}\r\n            />\r\n            <div className=\"App-slippage-tolerance-input-percent\">%</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-settings-row\">\r\n          <Checkbox isChecked={showPnlAfterFees} setIsChecked={setShowPnlAfterFees}>\r\n            <Trans>Display PnL after fees</Trans>\r\n          </Checkbox>\r\n        </div>\r\n        <div className=\"Exchange-settings-row\">\r\n          <Checkbox isChecked={isPnlInLeverage} setIsChecked={setIsPnlInLeverage}>\r\n            <Trans>Include PnL in leverage display</Trans>\r\n          </Checkbox>\r\n        </div>\r\n        {isDevelopment() && (\r\n          <div className=\"Exchange-settings-row\">\r\n            <Checkbox isChecked={shouldDisableValidationForTesting} setIsChecked={setShouldDisableValidationForTesting}>\r\n              <Trans>Disable order validations</Trans>\r\n            </Checkbox>\r\n          </div>\r\n        )}\r\n\r\n        <button className=\"App-cta Exchange-swap-button\" onClick={saveAndCloseSettings}>\r\n          <Trans>Save</Trans>\r\n        </button>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction Options(props) {\r\n  useEffect(() => {\r\n    const defaultLanguage = defaultLocale;\r\n    dynamicActivate(defaultLanguage);\r\n  }, []);\r\n\r\n  return (\r\n    <SWRConfig value={{ refreshInterval: 5000 }}>\r\n      <Web3ReactProvider getLibrary={getLibrary}>\r\n        <SEO>\r\n          {/* <I18nProvider i18n={i18n}> */}\r\n            <FullApp {...props} />\r\n          {/* </I18nProvider> */}\r\n        </SEO>\r\n      </Web3ReactProvider>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default Options;\r\n","import React from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nexport default function useRouteQuery() {\r\n  const { search } = useLocation();\r\n  return React.useMemo(() => new URLSearchParams(search), [search]);\r\n}\r\n","import React, { useState, useEffect, useContext } from 'react';\r\nimport { Routes, Route, Navigate, useNavigate, useLocation } from \"react-router-dom\";\r\nimport { DDL_POOL, USDC } from './utils/contracts';\r\nimport { UserStatsContext } from '../context/context';\r\nimport { ethers } from 'ethers';\r\nimport GMXInterface from '../views/gmx-test/App/App';\r\nimport { connectWallet } from './utils/wallet';\r\nimport { HOMEPAGE_HREF } from './utils/constants';\r\nimport Options from './../views/options/App/App';\r\nimport { useLocalStorageByChainId } from './../views/gmx-test/lib/legacy';\r\nimport { ARBITRUM } from './../views/options/lib/legacyOptions';\r\n\r\n\r\nconst AppRouter = ({ walletAddress, setWalletAddress, account }) => {\r\n\t// Supply Market state\r\n\tconst {userStats} = useContext(UserStatsContext)\r\n\tconst [supplyStep, setSupplyStep] = useState(0)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (walletAddress) {\r\n\t\t\tUSDC.allowance(walletAddress, DDL_POOL.address)\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (Number(ethers.utils.formatUnits(res, 6)) >= userStats.balance) {\r\n\t\t\t\t\t\tsetSupplyStep(1)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetSupplyStep(0)\r\n\t\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}, [userStats.balance, walletAddress])\r\n\r\n\tconst [path, setPath] = useLocalStorageByChainId(ARBITRUM, \"path\", HOMEPAGE_HREF);\r\n\r\n\tconst nav = useNavigate();\r\n\tconst loc = useLocation();\r\n\tuseEffect(() => {\r\n\t\tif (!loc.pathname) {\r\n\t\t\tnav(path);\r\n\t\t}\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetPath(loc.pathname);\r\n\t}, [loc.pathname]);\r\n\r\n\t\r\n\treturn (\r\n\t\t<Routes>\r\n\t\t\t<Route path=\"/perpetuals\" element={\r\n\t\t\t\t<GMXInterface\r\n\t\t\t\t\tconnectWallet={() => {\r\n\t\t\t\t\t\tconnectWallet(setWalletAddress)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\twalletAddress={walletAddress} />\r\n\t\t\t} />\r\n\t\t\t<Route path=\"/options\" element={\r\n\t\t\t\t<Options\r\n\t\t\t\t\tconnectWallet={() => {\r\n\t\t\t\t\t\tconnectWallet(setWalletAddress)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\twalletAddress={walletAddress} />\r\n\t\t\t} />\r\n\t\t\t<Route\r\n\t\t\t\tpath=\"*\"\r\n\t\t\t\telement={<Navigate to={path} replace />}\r\n\t\t\t/>\r\n\t\t</Routes>\r\n\t);\r\n};\r\n\r\nexport default AppRouter;","import React from 'react';\r\n\r\nconst Warning = (props) => {\r\n\treturn (\r\n\t\t<div className=\"warning\">\r\n\t\t\t{props.children}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Warning;","// Style\r\nimport './style/App.scss'\r\n\r\n// Main\r\nimport React, { useState, useEffect } from 'react';\r\n\r\nimport Header from './Header';\r\nimport Footer from './Footer';\r\nimport AppRouter from './components/AppRouter';\r\nimport { HashRouter } from 'react-router-dom';\r\nimport { UserStatsContext } from './context/context';\r\nimport { GlobalStatsContext } from './context/context';\r\nimport Warning from './components/UI/warning/Warning';\r\nimport { ToastContainer } from 'react-toastify';\r\nimport { cssTransition } from 'react-toastify';\r\nimport EventToastContainer from './views/gmx-test/components/EventToast/EventToastContainer';\r\nimport { i18n } from '@lingui/core';\r\nimport { I18nProvider } from '@lingui/react';\r\nimport { defaultLocale, dynamicActivate } from './views/gmx-test/lib/i18n';\r\nimport { LANGUAGE_LOCALSTORAGE_KEY } from './views/gmx-test/lib/legacy';\r\n\r\n\r\n\r\nfunction App() {\r\n\tconst [walletAddress, setWalletAddress] = useState('');\r\n\tconst [dgAddress, setDgAddress] = useState('');\r\n\tconst [registerVisible, setRegisterVisible] = useState(false);\r\n\t\r\n\tconst [userStats, setUserStats] = useState({\r\n\t\tbalance: undefined,\r\n\t\tcurBalance: undefined,\r\n\t\tavail: undefined\r\n\t})\r\n\tconst [globalStats, setGlobalStats] = useState(\r\n\t\t{\r\n\t\t\ttotalSupplied: \"\",\r\n\t\t\ttotalBorrowed: \"\",\r\n\t\t\tutilRate: \"\",\r\n\t\t\tavailToBorrow: \"\",\r\n\t\t\tborrowAPY: \"\",\r\n\t\t}\r\n\t)\r\n\r\n\tconst Jelly = cssTransition({\r\n\t\tenter: \"jellyIn\",\r\n\t\texit: \"jellyOut\",\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n    const defaultLanguage = localStorage.getItem(LANGUAGE_LOCALSTORAGE_KEY) || defaultLocale;\r\n    dynamicActivate(defaultLanguage);\r\n  }, []);\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{/* <Favicon url=\"https://i.imgur.com/dLCWse0.png\" /> */}\r\n\t\t\t<GlobalStatsContext.Provider value={{\r\n\t\t\t\tglobalStats,\r\n\t\t\t\tsetGlobalStats\r\n\t\t\t}}>\r\n\t\t\t\t<UserStatsContext.Provider value={{\r\n\t\t\t\t\tuserStats,\r\n\t\t\t\t\tsetUserStats\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<HashRouter>\r\n\t\t\t\t\t\t<I18nProvider i18n={i18n}>\r\n\t\t\t\t\t\t\t<ToastContainer\r\n\t\t\t\t\t\t\t\tlimit={1}\r\n\t\t\t\t\t\t\t\ttransition={Jelly}\r\n\t\t\t\t\t\t\t\tposition=\"bottom-right\"\r\n\t\t\t\t\t\t\t\t// autoClose={}\r\n\t\t\t\t\t\t\t\thideProgressBar={true}\r\n\t\t\t\t\t\t\t\tnewestOnTop={false}\r\n\t\t\t\t\t\t\t\tcloseOnClick={false}\r\n\t\t\t\t\t\t\t\tdraggable={false}\r\n\t\t\t\t\t\t\t\tpauseOnHover={false}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<EventToastContainer />\r\n\t\t\t\t\t\t\t<div className=\"App\">\r\n\t\t\t\t\t\t\t\t<Header walletAddress={walletAddress}\r\n\t\t\t\t\t\t\t\t\tsetWalletAddress={setWalletAddress}\r\n\t\t\t\t\t\t\t\t\tregisterVisible={registerVisible}\r\n\t\t\t\t\t\t\t\t\tsetRegisterVisible={setRegisterVisible}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t<main className='_container'>\r\n\t\t\t\t\t\t\t\t\t<AppRouter\r\n\t\t\t\t\t\t\t\t\t\twalletAddress={walletAddress}\r\n\t\t\t\t\t\t\t\t\t\tsetWalletAddress={setWalletAddress} \r\n\t\t\t\t\t\t\t\t\t\tdgAddress={dgAddress}\r\n\t\t\t\t\t\t\t\t\t\tsetDgAddress={setDgAddress}\r\n\t\t\t\t\t\t\t\t\t\tsetRegisterVisible={setRegisterVisible}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</main>\r\n\r\n\t\t\t\t\t\t\t\t<Footer />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</I18nProvider>\r\n\t\t\t\t\t</HashRouter>\r\n\t\t\t\t\t\r\n\t\t\t\t</UserStatsContext.Provider>\r\n\t\t\t</GlobalStatsContext.Provider>\r\n\t\t\t<Warning>\r\n\t\t\t\tDeDeLend is in alpha. Use at your own risk\r\n\t\t\t</Warning>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport App from './App';\r\n\r\nconst root = ReactDOM.createRoot(document.getElementById('root'));\r\nroot.render(\r\n\t<React.StrictMode>\r\n\t\t<App />\r\n\t</React.StrictMode>\r\n);\r\n"],"sourceRoot":""}